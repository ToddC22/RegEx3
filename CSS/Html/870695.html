<header><h1>Outdated Active Directory objects generate event ID 1988 in Windows Server 2003</h1></header><div class='kb-notice-section section'><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/22010.asp' title='Link only available for Microsoft corporate network users' target='_blank'>22010 (Content Maintenance)</a></p></div></div></div></div></div><div class='kb-symptoms-section section'>On your Microsoft Windows Server 2003-based domain controller, the following Error event is logged in the Directory Service event log:</div><div class='kb-cause-section section'>This issue occurs if the source domain controller has outdated objects that have been out of replication for more than one tombstone lifetime. The source domain controller is identified in the event message. These outdated objects are referred to as lingering objects. A domain controller that was offline for longer than the value of the tombstone lifetime setting may contain objects that have been deleted on other domain controllers or global catalog servers. The default tombstone lifetime value is 60 days. Additionally, tombstones for these objects may no longer exist. When you bring the outdated domain controller back online, it cannot be notified of the object deletions. </div><div class='kb-resolution-section section'>To resolve this issue, you can use the Repadmin tool to remove lingering objects from a directory partition. The <span class='text-base'>repadmin /removelingeringobjects</span> command does the following:<br> <ol class='sbody-num_list'><li>Designates an up-to-date domain controller as the authority. This domain controller acts as the authoritative directory replica.<br></li><li>Compares the Active Directory Directory service database objects on the authoritative server with the objects that are on the source replication partner that contains the lingering objects. </li><li>Either removes the lingering objects or logs the potential deletions to the Directory Services event log. The behavior depends on whether you use the <span class='text-base'>/advisory_mode</span> parameter.</li></ol>To use the <span class='text-base'>repadmin /removelingeringobjects</span> command, follow these steps.<br><br><span class='text-base'>Note</span> To use the <span class='text-base'>repadmin /removelingeringobjects</span> command, both the source domain controller and the destination domain controllers must be running Windows Server 2003.<br> <ol class='sbody-num_list'><li>Install the Repadmin tool. The Repadmin tool is included with the Windows Server 2003 Support Tools that are included with the Windows Server 2003 CD-ROM. To install the support tools, double-click<br><strong class='uiterm'>Suptools.msi</strong> in the<br><strong class='sbody-strong'>CD_Drive</strong>:\Support\Tools folder.</li><li>At the command prompt, type <span class='sbody-userinput'>repadmin /removelingeringobjects <strong class='sbody-strong'> Destination_domain_controller<br></strong><strong class='sbody-strong'> Source_domain_controller_GUID<br></strong><strong class='sbody-strong'> Directory_partition </strong>/advisory_mode</span>, and then press ENTER.<br><br><span class='text-base'>Note</span> The <span class='text-base'>/advisory_mode</span> parameter is optional. You can use this parameter to make sure that the lingering object that is reported in event ID 1988 exists in the Active Directory database on the server that you suspect has the lingering objects. When you use this parameter, the lingering objects are not removed. Instead, the <span class='text-base'>/advisory_ mode</span> parameter lets you view the results of the command before you take action to remove any objects from the folder. We recommend that you always use the <span class='text-base'>/advisory_ mode</span> parameter before you use Repadmin to delete the lingering objects.<br><ul class='sbody-free_list'><li><strong class='sbody-strong'>Destination_domain_controller</strong> is the domain name system (DNS) name or IP address of the domain controller that has lingering objects. In the event ID 1988, this value is the server that is identified in the source domain controller field.<br><br><span class='text-base'>Note</span> You can use the <span class='text-base'>dc_list</span> parameter if you want to specify multiple destination domain controllers that have lingering objects. Because lingering object removal is not replicated to other domain controllers, you must run the <span class='text-base'>repadmin /removelingeringobjects</span> command against all destination domain controllers and global catalog servers that have lingering objects. For more information about the <span class='text-base'>dc_list</span> parameter, type <span class='text-base'>repadmin /listhelp</span> at the command prompt, and then press ENTER.</li><li><strong class='sbody-strong'>Source_domain_controller_GUID</strong> is the object GUID of the source domain controller that you are using as the authoritative server. To obtain the object GUID of the source domain controller, use one of the following methods.<h4 class='sbody-h4'>Method one</h4>At a command prompt, type <span class='sbody-userinput'>repadmin /showrepl /v<br> <strong class='sbody-strong'>name of the authoritative server</strong></span>, and then press ENTER. The object GUID of the domain controller is listed in the<br> <strong class='uiterm'>DC object GUID</strong> field. <h4 class='sbody-h4'>Method two</h4>Use the Active Directory Sites and Services tool to locate the object GUID of the source domain controller. To do this, follow these steps:<br> <ol class='sbody-alpha_list'><li>Click <strong class='uiterm'>Start</strong>, point to<br> <strong class='uiterm'>Administrative Tools</strong>, and then click <strong class='uiterm'>Active Directory Sites and Services</strong>.</li><li>Expand <strong class='uiterm'>Sites</strong>, expand the site where your authoritative domain controller is located, expand<br> <strong class='uiterm'>Servers</strong>, and then expand the domain controller.</li><li>Right-click <strong class='uiterm'>NTDS Settings</strong>, and then click <strong class='uiterm'>Properties</strong>. </li><li>View the value in the <strong class='uiterm'>DNS Alias</strong>  box. The GUID that appears in front of<br> <strong class='uiterm'>_msdcs.<strong class='sbody-strong'>forest_root_name</strong>.com</strong> is the object GUID of the domain controller. The Repadmin tool only requires the GUID. Do not include the<br> <strong class='uiterm'>_msdcs.<strong class='sbody-strong'>forest_root_domain_name</strong>.com</strong>  component in the Repadmin syntax.</li></ol></li><li><strong class='sbody-strong'>Directory_partition</strong> is the distinguished name (DN) of the directory partition that contains the lingering objects. This is part of the<br> <strong class='sbody-strong'>object_distinguished_name</strong> in the event message.</li></ul></li><li>Repeat the procedure for the following partitions, as needed:<br><ul class='sbody-free_list'><li> Domain directory partition (dc=<strong class='sbody-strong'>domain_DN</strong>)</li><li> Configuration directory partition (cn=Configuration,dc=<strong class='sbody-strong'>forest_root_DN</strong>)</li><li>Application directory partition or partitions <div class='indent'>(cn=<strong class='sbody-strong'>Application_directory_partition_name</strong>,dc=<strong class='sbody-strong'>domain_DN</strong>)<br>(cn=<strong class='sbody-strong'>Application_directory_partition_name</strong>,dc=<strong class='sbody-strong'>forest_root_DN</strong>)</div></li><li>Schema directory partition (cn=Schema, cn=Configuration,dc=,dc=<strong class='sbody-strong'>forest_root_DN</strong>)</li></ul></li></ol></div><div class='kb-moreinformation-section section'><h3 class='sbody-h3'>Example of the command syntax</h3>The following is an example of the <span class='text-base'>repadmin /removelingeringobjects</span> command syntax for the fictional Example.com domain:<div class='indent'><span class='sbody-userinput'>C:\&gt;repadmin /removelingeringobjects <strong class='sbody-strong'>domain_controller</strong>.example.com A0AE6093-15F5-4DB8-836B-4495E3A15396 dc=example,dc=com /advisory_mode</span></div>If the command runs successfully, you receive the following message: <div class='message'>RemoveLingeringObjects successful on<br> <strong class='sbody-strong'>domain_controller_name</strong>.<strong class='sbody-strong'>domain_name</strong>.com</div><br><br><span class='text-base'>Note</span> To access the Repadmin tool advanced help, you can use the <span class='text-base'>/experthelp</span> parameter.<h3 class='sbody-h3'>Events that are associated with lingering object removal<br></h3>When you remove the lingering objects, the domain controller with the lingering objects records all removal information. This information includes the source domain controller, the objects that are removed, and a total count of all the objects that are removed. During lingering object removal the following events are logged to the Directory Service log:For more information about lingering object removal in Windows Server 2003, see the &quot;Lingering Object Removal&quot; topic on the following Microsoft Web site:<div class='indent'><a id='kb-link-1' href='http://technet2.microsoft.com/windowsserver/en/library/1465d773-b763-45ec-b971-c23cdc27400e1033.mspx' target='_self'>http://technet2.microsoft.com/windowsserver/en/library/1465D773-B763-45EC-B971-C23CDC27400E1033.mspx</a></div></div><div class='kb-idea-section section'><h3 class='sbody-h3'>Falsely reported lingering objects</h3>If you check the domain controller by using the Repadmin tool together with the <span class='text-base'>removelingeringobjects</span> syntax in advisory mode, you may find that some objects that have been deleted are reported as lingering in the following directory service event log: This event may be logged when a deleted object is already garbage collected on the source domain controller, but the deleted object is not yet garbage collected on the destination domain controller. In this case, the  Repadmin tool detects the objectGuid of the object and reports it as a lingering object. Additionally, the objectGuid of the object is still present on the destination domain controller, but the objectGuid of the object is not present on the source domain controller. Because this object will be removed during the next Garbage Collection cycle, you can safely ignore all NTDS replication 1946 events  that contain the object GUID.<br><br>When an object is deleted, the <span class='text-base'>isDeleted</span> attribute is set to <span class='text-base'>TRUE</span>. This change of the <span class='text-base'>isDeleted</span> attribute is the last object change that is replicated.  Garbage collection refers to the removal of an object from the NTDS database. Garbage collection is a local process on the domain controller. This final change is not replicated. In some cases, an object is reported as lingering when it was created on the destination domain controller, but the object has not yet been replicated to the source domain controller. You can check this by using the Repadmin tool together with the <span class='text-base'>removelingeringobjects</span> syntax after the typical replication delay time span. If the object is not reported as lingering, you may also safely ignore it as a falsely reported lingering object.</div><div class='kb-securedata-section section'>replication old outdated</div><div class='kb-securedata-section section'>Author: herbertm<br>Writer: v-twoole <br>Tech Reviewer: v-dahedm<br>Editor: v-cgold</div>