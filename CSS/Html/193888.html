<header><h1>How to delay loading of specific services</h1></header><div></div><div class='kb-securedata-section section'> - Microsoft Windows 2000 Datacenter Server<br></div><div class='kb-summary-section section'>This article describes how to&#160;delay the loading of specific services.&#160;On some computers (especially older systems and those with slower peripherals), it may be necessary to delay the loading of a specific Windows service for the computer to boot properly. Or, you may want to make sure that one service has started and is available for use before another for troubleshooting purposes. This can impact such issues as a domain controller, which cannot access the network where a protocol, or a service such as DHCP, attempts to load BEFORE the network card has had a chance to be bound (for example, Compaq Netflex). </div><div class='kb-moreinformation-section section'>You will first need to verify that the dependency you want to create does not already exist. The following are some of the most common dependencies that already exist in a default configuration:<br><br><pre class='sbody-pre'><br>   Service      Depends on<br>   -------      ----------<br>   Alerter      LanmanWorkstation<br>   Browser      LanmanWorkstation, LanmanServer, LmHosts<br>   ClipSrv      NetDDE<br>   DHCP         Afd, NetBT, TCP/IP<br>   Messenger    LanmanWorkstation, NetBIOS<br>   NetBT        TCP/IP<br>   NetDDE       NetDDEDSDM<br>   NetLogon     LanmanWorkstation, LmHosts<br>   Parallel     Parport<br>   Replicator   LanmanServer, LanmanWorkstation<br> </pre><br>The Registry subkeys for services are located in the following path and can control how services are loaded.<br><br><div class='indent'>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\&lt;Service name&gt;<br></div><span><span class='text-base'>Important</span> This section, method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/en-us/help/322756'>322756 </a> How to back up and restore the registry in Windows</div></span>To create a new dependency, select the subkey representing the service you want to delay, click <span class='text-base'>Edit</span>, and then click <span class='text-base'>Add Value</span>. Create a new value name &quot;DependOnService&quot; (without the quotation marks) with a data type of REG_MULTI_SZ, and then click <span class='text-base'>OK</span>. When the <span class='text-base'>Data</span> dialog box appears, type the name or names of the services that you prefer to start before this service with one entry for each line, and then click <span class='text-base'>OK</span>.<br><br><br>The name of the service you would enter in the Data dialog box is the exact name of the service as it appears in the registry under the Services key.<br><br><br>When the computer starts, it uses this entry to verify that the service or services listed in this value are started before attempting to start the dependent service.<br><br><br>For example, you may want to ensure that your Server service loads before the Windows Internet Name Service (WINS). If you select the WINS key in the registry, you will notice that the DependOnService value already exists in the WINS key. In a default installation, WINS is already dependent on both RPCSS (Remote Procedure Call) and NTLMSSP (Windows NT LanMan Security Support Provider) services. To add the Server service to this list, double-click the <span class='text-base'>DependOnService</span> value. In the Multi-String Editor, on the line below NTMLSSP, add the entry &quot;LANMANSERVER&quot; (without quotation marks), and then click <span class='text-base'>OK</span>.<br><br><br>In addition, Windows 2000 and Windows 2003 Active Directory needs to find and use the DNS Server service. The Netlogon service can be delayed to ensure that the DNS Server service is up and running for Dynamic DNS registration and query for existing Active Directory domain controllers that are in the DNS server database. Use the DependOnService in the Netlogon and add DNS to the list of LanmanWorkstation and LanmanServer. This delays Netlogon from starting until the DNS Server service on that same computer is started and ready.  <br><br><br><span class='text-base'>Note</span> Only delay the Netlogon service for DNS on a Windows 2000 or Windows 2003 Server when the DNS service is on the same Windows 2000 or Windows 2003-based server.<br><br><br><span class='text-base'>Note</span> Entries in this field are NOT case-sensitive.<br><br><br><span class='text-base'>Warning</span> Adding this entry manually may prevent the system from starting properly if you establish a &quot;circular dependency.&quot; In its simplest form, such a problem would occur when you make two differing services dependent on one another. Neither service would be able to start as they would both require the other to be started first.<br><br><span class='text-base'>Note</span> If you have a service that needs to start late in the boot cycle but you do not have a specific service dependency, as explained above, then choose one of the services which startup last as the data value for the value &quot;Depends on Service&quot;.  Services commonly selected are Spooler and Messenger.<br></div><div class='kb-references-section section'>For further information, refer to Chapter 8, General Troubleshooting, in the Windows NT Server Resource Kit.<br></div><div class='kb-securedata-section section'>registry dependency boot delay kbhowto kbDSupport</div><div class='kb-textlegacy-section section'>DOC INFO: DOC ID:35881 35881 SR#/SO#:SRX971211601346/SRX980323600525 Author: keithvh (1998-10-08T08:30:00) Edit Reviewer: cathyan (1998-10-08T15:10:00) Tech Reviewer: stewartc (1998-10-08T15:10:00)<br></div>