<header><h1>A secure WSD device may not work correctly on a computer that is running Windows 7</h1></header><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/116684.asp' title='Link only available for Microsoft corporate network users' target='_blank'>116684 (Content Maintenance)</a></div><div class='kb-symptoms-section section'>When you try to use  a secure Web Services on Devices  (WSD) device with  a computer that is running Windows 7, you may encounter one or more of the following problems:<ul class='sbody-free_list'><li>You cannot install or use a secure WSD device.</li><li>A secure WSD device that  worked does not  work after its  certificate is updated.</li></ul></div><div class='kb-cause-section section'>This problem occurs because the Function Discovery Provider Host (fdPHost) service cannot access certificates that are installed or updated after the fdPHost service was started. <br><br>This problem affects device certificates and root certificates that have a trust chain to the device.  If either of these certificates is installed or updated after the fdPHost service was started, the device seems to be unavailable or offline. However, this problem occurs with all Web Services on Devices (DPWS) devices that implement security.<br><br>For more information about certificates that a secure WSD device requires, see the &quot;More information&quot; section. </div><div class='kb-workaround-section section'>To work around  this problem, restart the fdPHost service. <div class='indent'><span class='text-base'>Note</span> After you restart the fdPHost service, you may also have to restart any affected third-party services that use fdPHost for discovering or for using WSD devices.</div>To restart the fdPHost service, use one of the following methods.<h4 class='sbody-h4'>Method 1</h4><ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong><img class="graphic" src="/library/images/support/kbgraphics/public/en-us/vistastartbutton.jpg" alt="Start button " title="Start button ">,   type <span class='sbody-userinput'>services.msc</span>  in the <strong class='uiterm'>Start Search</strong> box, and then press ENTER.</li><li>In the list of services, right-click <strong class='uiterm'>Function Discovery Provider Host</strong>, and then click <strong class='uiterm'>Restart</strong>.</li></ol><h4 class='sbody-h4'>Method 2</h4><ol class='sbody-num_list'><li> Click <strong class='uiterm'>Start</strong><img class="graphic" src="/library/images/support/kbgraphics/public/en-us/vistastartbutton.jpg" alt="Start button " title="Start button ">, click <strong class='uiterm'>All Programs</strong>, click <strong class='uiterm'>Accessories</strong>, right-click <strong class='uiterm'>Command Prompt</strong>, and then click <strong class='uiterm'>Run as administrator</strong>. <br><div class='indent'><img class="graphic" src="/library/images/support/kbgraphics/public/en-us/securityshield.jpg" alt="User Account Control permission " title="User Account Control permission "> If you are prompted for an administrator password or for confirmation, type the password, or click <strong class='uiterm'>Yes</strong>. </div></li><li>At the  command prompt, type  the following command to stop the fdPHost service, and then press ENTER:<div class='indent'><span class='sbody-userinput'>net stop fdphost</span></div></li><li>After the fdPHost service is stopped, type  the following command to restart the fdPHost service, and then press ENTER:<div class='indent'><span class='sbody-userinput'>net start fdphost</span></div></li></ol></div><div class='kb-moreinformation-section section'><h4 class='sbody-h4'>Certificates</h4>A Windows-based  client and a secure WSD device  that communicate over a security channel use certificates when they establish a connection. <br><br>A secure WSD device must meet the following certificate requirement: <ul class='sbody-free_list'><li>The  secure device must have an X.509 public key certificate. <br></li><li>The Enhanced Key Usage section of the certificate must contain the Server Authentication (1.3.6.1.5.5.7.3.1) object identifier (also known as OID). <br></li></ul>A Windows-based WSD client must be  configured correctly to use certificates before it interacts with a secure WSD device. <br><br>For more information about secure WSD device certificates  and Windows-based   client configuration, visit the following Microsoft Web sites:<div class='indent'><a id='kb-link-1' href='http://msdn.microsoft.com/en-us/library/bb204786(vs.85).aspx' target='_self'>http://msdn.microsoft.com/en-us/library/bb204786(VS.85).aspx</a><br><br><a id='kb-link-2' href='http://msdn.microsoft.com/en-us/library/aa823078(vs.85).aspx' target='_self'>http://msdn.microsoft.com/en-us/library/aa823078(VS.85).aspx</a></div></div><div class='kb-securedata-section section'>renew a certificate ce.cer file Device Profile on Web Services (DPWS)</div><div class='kb-securedata-section section'><span class='text-base'>Author:  nedpyle; ashayc </span><br><span class='text-base'>Writer: qianyu</span><br><span class='text-base'>Tech Reviewer: nedpyle; ashayc;  joshuare; danv; a-lolang; bobbymi</span><br><span class='text-base'>Editor: v-doskir</span></div>