<header><h1>Description of the IRPStackSize parameter in Windows 2000, in Windows XP, and in Windows Server 2003</h1></header><div class='kb-summary-section section'>This article describes the functionality of the <span class='sbody-italic'>IRPStackSize</span> parameter in Microsoft Windows 2000 Server, in Microsoft Windows XP, and in Microsoft Windows Server 2003.</div><div class='kb-moreinformation-section section'><span><span class='text-base'>Important</span> This section, method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/en-us/help/322756'>322756 </a> How to back up and restore the registry in Windows</div></span><br><br>The <span class='sbody-italic'>IRPStackSize</span> parameter specifies the number of stack locations in I/O request packets (IRPs) that are used by Windows 2000 Server, by Windows Server 2003, and by Windows XP. You may have to increase this number for certain transports, for media access control (MAC) drivers, or for file system drivers. Each stack uses 36 bytes of memory for each receive buffer. This value is set in the following registry subkey:<div class='indent'><strong class='sbody-strong'>  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters</strong></div>The default value of the <span class='sbody-italic'>IRPStackSize</span> parameter is 15. The range is from 11 (0xb  hexadecimal) through 50 (0x32 hexadecimal).<br><br>If the subkey is not present, you can use Registry Editor to add the subkey. To do this, follow these steps: <br> <ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>regedit</span>, and then click<br><strong class='uiterm'>OK</strong>.</li><li>Locate and then click the following registry subkey:<div class='indent'><strong class='uiterm'>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters</strong></div></li><li>Click <strong class='uiterm'>Edit</strong>, point to <strong class='uiterm'>New</strong>, and then click <strong class='uiterm'>DWORD Value</strong>.</li><li>Type <span class='sbody-userinput'>IRPStackSize</span>, and then press ENTER to name the value.<br><br><span class='text-base'>Note</span> Type <span class='sbody-userinput'>IRPStackSize</span> exactly as it is displayed. The value name is case sensitive.</li><li>Click <strong class='uiterm'>Edit</strong>, and then click<br><strong class='uiterm'>Modify</strong>.</li><li>In the<strong class='uiterm'> Data Value</strong> box, type the value that is appropriate for the network, and then click <strong class='uiterm'>OK</strong>.</li></ol>If the problem persists after you complete this procedure, increase the value of IRPStackSize even more.<br><br><span class='text-base'>Note</span> On some computers, values from 33 through 38 can cause problems. For information about a hotfix that addresses these problems, click the following article number to visit the article in the Microsoft Knowledge Base:<span><div class='indent'><a id='kb-link-2' href='/en-us/help/924749'>924749 </a> Event ID 2021 is logged even though lots of non-paged pool memory is available in Windows Server 2003<br><br></div></span></div><div class='kb-securedata-section section'>irpstacksize lanmanserver IRP</div><div class='kb-securedata-section section'>Author: amcvety (2001-01-11T01:11:00)<br>Writer: v-gcrisp<br>Tech reviewer:<br>Editor: v-crweb</div>