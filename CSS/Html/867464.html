<header><h1>Event ID 4515 is logged in the DNS Server log in Windows Server 2003</h1></header><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/22093.asp' title='Link only available for Microsoft corporate network users' target='_blank'>22093 (Content Maintenance)</a></div><div class='kb-symptoms-section section'>When you view the DNS Server log in Event Viewer, you may see an event that resembles the following event.<br><br><span class='text-base'>Note </span>In the following example event and throughout this article, <strong class='sbody-strong'>contoso.com</strong> is used as a placeholder for an actual domain.</div><div class='kb-cause-section section'> This issue may occur  when the DNS zone  that is listed in the Event 4515  exists in more than one location in Active Directory. <br><br><span class='text-base'>Note</span> A DNS zone must exist in only one Active Directory partition at the same time.<br><br>A DNS zone  may be incorrectly created in more than one location in Active Directory in the following scenarios:<ul class='sbody-free_list'><li>The DNS zone was moved from one directory partition to another directory partition.</li><li>The replication scope for Windows 2000 Active Directory integrated DNS zones are transitioned to domain DNS application partitions or to forest-wide DNS application partitions that are supported by Windows Server 2003 domain controllers.</li></ul></div><div class='kb-resolution-section section'>To resolve this behavior,  determine which Active Directory partition for <strong class='sbody-strong'>contoso.com</strong> you would like to use, and  then  remove the other <strong class='sbody-strong'>contoso.com</strong> zone(s) from Active Directory.<br><br>The following locations are the three default directory partition locations in Active Directory that DNS can be stored in on a Windows Server 2003 Domain Controller (DC).  These are:<ol class='sbody-num_list'><li>To all DNS servers in the Active Directory Forest <strong class='sbody-strong'>contoso.com</strong>. [ForestDNSZones]</li><li>To all DNS servers in the Active Directory domain <strong class='sbody-strong'>contoso.com</strong>. [DomainDNSZones]</li><li>To all domain controllers in the Active Directory domain <strong class='sbody-strong'>contoso.com</strong>.</li></ol>To determine which zone should be deleted, you should take into consideration the information below, where you would like to have the DNS zone replicated to in your environment, and which zone currently has the majority of the records.  Typically, all of the DNS zones for <strong class='sbody-strong'>contoso.com</strong> should be set to utilize the same Active Directory partition for all Microsoft DNS servers in the environment.<br><br>Option 1 [<strong class='uiterm'>ForestDNSZones</strong>] and Option 2 [<strong class='uiterm'>DomainDNSZones</strong>]  listed above are only understood by Windows Server 2003 domain controllers.  Option 3 is understood by Windows 2000 and Windows Server 2003 domain controllers.  If you have any Windows 2000 DCs that need to host this zone, you  must  choose Option 3.<br><br>If possible, it is recommended to use either Option 1 or 2.  Here are some benefits of storing DNS zones in default DNS application partitions:<ul class='sbody-free_list'><li>Relocating DNS zones from the Active Directory integrated domain partitions to application partitions removes DNS records from non-DNS Servers in the domain and Global Catalog domain controllers in the forest. DNS zones and their records are only present on the domain controllers running the Microsoft DNS Server service in the domain for zones placed in domain-wide partitions or DNS Servers in the forest for forest-wide DNS application partitions.  This reduces the amount of replication required throughout the domain or forest as compared to using option 3.</li><li>When the _MSDCS sub-domain is placed in a forest-wide DNS application partition, all DNS servers in the forest host a local copy of the _MSDCS.&lt;forest root domain&gt; zones containing CNAME and SRV locator records for all DCs in the forest. This configuration is easier to administer and has less overhead for DCs to resolve these records which are required for AD replication. The Windows 2000 alternative is to utilize secondary zones or forwarders to internal DNS servers which host the _MSDCS zone when in a forest with multiple domains.  For more information about how to convert the _MSDCS zone, see the following Microsoft Knowledge Base article: <span><div class='indent'><a id='kb-link-1' href='/en-us/help/817470'>817470 </a> How to reconfigure an _msdcs Subdomain to a Forest-wide DNS application directory partition when you upgrade from Windows 2000 to Windows Server 2003<br><br></div></span></li></ul>There are two ways to migrate off of Windows 2000 Active Directory-integrated DNS zones in your environment and convert to <strong class='uiterm'>DomainDNSZones</strong> or <strong class='uiterm'>ForestDNSZones</strong>:<ol class='sbody-num_list'><li>Upgrade existing Windows 2000 DCs  that are running the Microsoft DNS Server Service to Windows Server 2003.</li><li>Remove the DNS Server Service on Windows 2000 DCs and optionally install the Microsoft DNS Server Service on Windows Server 2003 DCs, ideally on the same subnet as the deprecated Windows 2000  DNS Server. When  you relocate the DNS Server service from one computer to another, remember to modify the IP address for DNS Server settings on member computers, member servers, domain controllers, DHCP Servers and DNS Servers (forwarders + delegations + NS records). Alternatively, have the new Windows Server 2003 DNS Server swap IP address with the deprecated Windows 2000 DNS Server if both computers are on the same subnet. Again, remember to verify record registration for new and deprecated DNS Servers.</li></ol><br>To view the records for the various DNS partitions or to delete the <strong class='sbody-strong'>contoso.com</strong> zone in the desired directory partition(s), follow these steps.<br><br><span><span class='text-base'>Warning</span> If you use the ADSI Edit snap-in, the LDP utility, or any other LDAP version 3 client, and you incorrectly modify the attributes of Active Directory objects, you can cause serious problems. These problems may require you to reinstall Microsoft Windows 2000 Server, Microsoft Windows Server 2003, Microsoft Exchange 2000 Server, Microsoft Exchange Server 2003, or both Windows and Exchange. Microsoft cannot guarantee that problems that occur if you incorrectly modify Active Directory object attributes can be solved. Modify these attributes at your own risk.<br></span><h3 class='sbody-h3'>For Option 1: [ForestDNSZones]</h3><ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>adsiedit.msc</span>, and then click <strong class='uiterm'>OK</strong>.</li><li>In the console tree, right-click <strong class='uiterm'>ADSI Edit</strong>, and then click <strong class='uiterm'>Connect to</strong>. </li><li>Click <strong class='uiterm'>Select</strong> or type a Distinguished Name or Naming Context, type the following text in the list, and then click <strong class='uiterm'>OK</strong>:<br><div class='indent'><span class='sbody-userinput'>DC=ForestDNSZones, DC=contoso, DC=com</span></div></li><li>In the console tree, double-click <strong class='uiterm'>DC=ForestDNSZones, DC=<strong class='sbody-strong'>contoso</strong>, DC=<strong class='sbody-strong'>com</strong></strong>.</li><li>Double-click <strong class='uiterm'>CN=MicrosoftDNS</strong>, and click the  zone (<strong class='sbody-strong'>contoso.com</strong>).  You should now be able to view the DNS records which exist in this DNS partition.  If you desire to remove this partition, right-click on <strong class='sbody-strong'>contoso.com</strong> and then click <strong class='uiterm'>Delete</strong>. <br><br><span class='text-base'>Note</span>  Deleting a zone is a destructive operation.  Please confirm that a duplicate zone exists before you perform a deletion.</li><li>If you have deleted a zone, restart the DNS service. To do this, follow these steps:<ol class='sbody-alpha_list'><li>Click <strong class='uiterm'>Start</strong>, point to <strong class='uiterm'>All Programs</strong>, point to <strong class='uiterm'>Administrative Tools</strong>, and then click <strong class='uiterm'>DNS</strong>.</li><li>In the console tree, right-click <strong class='uiterm'><strong class='sbody-strong'>contoso.com</strong></strong>, point to <strong class='uiterm'>All Tasks</strong>, and then click <strong class='uiterm'>Restart</strong>.</li></ol></li></ol><h3 class='sbody-h3'>For Option 2: [DomainDNSZones]</h3><ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>adsiedit.msc</span>, and then click <strong class='uiterm'>OK</strong>.</li><li>In the console tree, right-click <strong class='uiterm'>ADSI Edit</strong>, and then click <strong class='uiterm'>Connect to</strong>.</li><li>Click <strong class='uiterm'>Select or type a Distinguished Name or Naming Context</strong>,  type the following text in the list, and then click <strong class='uiterm'>OK</strong>: <span class='sbody-userinput'>DC=DomainDNSZones,DC=<strong class='sbody-strong'>contoso</strong>,DC=com</span>.</li><li>In the console tree, double-click <strong class='uiterm'>DC=DomainDNSZones,DC=<strong class='sbody-strong'>contoso</strong>,DC=com</strong></li><li>Double-click <strong class='uiterm'>CN=MicrosoftDNS</strong>, and click the  zone (<strong class='sbody-strong'>contoso.com</strong>).  You should now be able to view the DNS records which exist in this DNS partition.  If you desire to remove this partition, right-click on <strong class='sbody-strong'>contoso.com</strong> and then click <strong class='uiterm'>Delete</strong>. <br><br><span class='text-base'>Note</span>  Deleting a zone is a destructive operation.  Please confirm that a duplicate zone exists before you perform a deletion. </li><li>If you have deleted a zone, restart the DNS service. To do this, follow these steps:<ol class='sbody-alpha_list'><li>Click <strong class='uiterm'>Start</strong>, point to <strong class='uiterm'>All Programs</strong>, point to <strong class='uiterm'>Administrative Tools</strong>, and then click <strong class='uiterm'>DNS</strong>.</li><li>In the console tree, right-click <strong class='uiterm'><strong class='sbody-strong'>contoso.com</strong></strong>, point to <strong class='uiterm'>All Tasks</strong>, and then click <strong class='uiterm'>Restart</strong>.</li></ol></li></ol><h3 class='sbody-h3'>For Option 3</h3><ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>adsiedit.msc</span>, and then click <strong class='uiterm'>OK</strong>.</li><li>In the console tree, double-click <strong class='uiterm'>Domain NC [servername.contoso.com]</strong>. </li><li> If, for some reason, Domain NC is not already present in the console tree, follow these steps: <ol class='sbody-alpha_list'><li>In the console tree, right-click <strong class='uiterm'>ADSI Edit</strong>, and then click <strong class='uiterm'>Connect to</strong>. </li><li>Click <strong class='uiterm'>Select</strong> or type a Distinguished Name or Naming Context, type the following text in the list, and then click OK: <div class='indent'><span class='sbody-userinput'>DC=contoso,DC=com</span></div></li></ol></li><li>In the console tree, double-click <strong class='uiterm'>DC=<strong class='sbody-strong'>contoso</strong>,DC=com</strong> and double-click <strong class='uiterm'>CN=System</strong>.</li><li>Double-click <strong class='uiterm'>CN=MicrosoftDNS</strong>, and click the  zone (<strong class='sbody-strong'>contoso.com</strong>).  You should now be able to view the DNS records which exist in this DNS partition.  If you desire to remove this partition, right-click on <strong class='sbody-strong'>contoso.com</strong> and then click <strong class='uiterm'>Delete</strong>. <br><br><span class='text-base'>Note</span>  Deleting a zone is a destructive operation.  Please confirm that a duplicate zone exists before you perform a deletion. </li><li>If you have deleted a zone, restart the DNS service. To do this, follow these steps:<ol class='sbody-alpha_list'><li>Click <strong class='uiterm'>Start</strong>, point to <strong class='uiterm'>All Programs</strong>, point to <strong class='uiterm'>Administrative Tools</strong>, and then click <strong class='uiterm'>DNS</strong>.</li><li>In the console tree, right-click <strong class='uiterm'><strong class='sbody-strong'>contoso.com</strong></strong>, point to <strong class='uiterm'>All Tasks</strong>, and then click <strong class='uiterm'>Restart</strong>.</li></ol></li></ol><h3 class='sbody-h3'>Restart the services and reset DNS</h3>After you perform these operations, follow these steps:<ol class='sbody-num_list'><li>Restart the DNS service.</li><li>Restart the Net Logon service.</li><li>At a command prompt, type the following commands. Press ENTER after each command.<ul class='sbody-free_list'><li><span class='sbody-userinput'>ipconfig /flushdns<br>ipconfig /registerdns</span></li></ul></li></ol></div><div class='kb-securedata-section section'>Author: lbrash<br>Writer: v-sanair <br>Tech reviewer: v-jomcc<br>Editor:  v-jocoop<br>Rewrite editor: v-doskir</div>