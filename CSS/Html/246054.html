<header><h1>DCOMCNFG and AppID\.exe mapping and implications</h1></header><div class='kb-summary-section section'>This article explains entries that are made for AppID\.exe mapping under the HKEY_CLASSES_ROOT key in the registry by using the DCOMCNFG utility, and the implications of it.<br></div><div class='kb-moreinformation-section section'>Component Object Model (COM) applications are identified by a Globally Unique Identifier (GUID) that is called AppID and represent a server process for one or more classes. The remote activation, security, and other application-specific settings are stored in the local registry under the following key:<br><br><div class='indent'>HKEY_CLASSES_ROOT\AppID<br></div>All AppID settings can be manipulated by using the DCOMCNFG utility (Dcomcnfg.exe). The DCOMCNFG utility provides users with an easy-to-use interface for controlling these application-specific settings.<br><br>However, a few issues must be noted when you use DCOMCNFG to make entries under the AppID key in the registry:<br><br><br><ul class='sbody-free_list'><li><span class='text-base'>AppID\.exe Mapping</span>:<ul class='sbody-free_list'><li>DCOMCNFG adds AppID\.exe mapping under HKEY_CLASSES_ROOT in the registry only if none of the following keys is present:<br><br><ul class='sbody-free_list'><li>HKCR\CLSID\&lt;Guid&gt; (AppID key, named value)</li><li>HKCR\APPID\&lt;Guid&gt;</li><li>HKCR\APPID\Exename.exe</li></ul><br>In this case, DCOMCNFG automatically synthesizes an AppID by using the first CLSID it encounters in that server (as done for legacy servers that were implemented before Windows NT 4.0), and adds it in the registry.<br></li><li>If any of these AppID keys is present, DCOMCNFG does not add the HKCR\APPID\Exename.exe key and or its value if it is not already present.<br><br>This AppID-to-.exe mapping is used by COM to get some of the application-specific settings. If this mapping missing, such settings as Custom Access Permission, static endpoint, Authentication level, and so on are not used by COM, because COM has no way to map the .exe file name to the AppID.<br></li></ul></li><li><span class='text-base'>Setting Custom Access Permission</span>:<br><br>When you set Custom Access permission by using DCOMCNFG, DCOMCNFG does not make the entry under AppID\{GUID} in the registry unless you click <span class='text-base'>Edit</span>, and then click <span class='text-base'>OK</span>. To do this:<ol class='sbody-alpha_list'><li>Start DCOMCNFG, and then select your application properties.</li><li>Click the <span class='text-base'>Security</span> tab.</li><li>Click <span class='text-base'>Custom Access permissions</span>, click <span class='text-base'>Edit</span>, and then click <span class='text-base'>OK</span>. The Custom access permissions are registered.</li></ol>If permissions are removed or groups are denied from any one key under HKCR\AppID, the COM+ MMC snap-in may display no entries under <strong class='uiterm'>DCOM Config</strong>. When the snap-in is looping through the list to see what it has to display, it seems to fail if it is denied access to any key. Therefore, the snap-in displays an empty list.</li><li><span class='text-base'>Long File Names for Applications</span>:<br><br>DCOM uses the <span class='text-base'>GetModuleFileName</span> function to map the .exe file name to AppID for access permissions.<br><br><span class='text-base'>GetModuleFileName</span> returns long or short file names, based on what was passed to the <span class='text-base'>CreateProcess</span> function. Therefore, if your localServer32 value (under HKEY_CLASSES_ROOT\CLSID\{guid}\LocalServer32)  has a long file name, this AppID\.exe mapping needs to be a long file name, or vice versa, for a short file name.</li></ul></div><div class='kb-references-section section'><span>For more information about a DCOMCNFG bug in Windows NT 4.0 Service Pack 4 (SP4), click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-1' href='/en-us/help/216051'>216051 </a> FIX: DCOMCNFG Windows NT 4.0 Service Pack 4 does not write .exe name under HKCR\APPID<br><br></div></span></div><div class='kb-securedata-section section'>dcom appid exemapping appid/exe</div><div class='kb-textlegacy-section section'>DOC INFO: KBPRIORITY2 Tech_review: Author: riyazp (1999-11-11T17:50:00) Edit Reviewer: sharonwa (2001-01-05T15:56:00) Tech Reviewer: SNEWBURY (2000-01-22T02:10:00)<br></div>