<header><h1>Unable to log on if the boot partition drive letter has changed</h1></header><div><span></span></div><div class='kb-securedata-section section'>DO NOT DELETE OR ARCHIVE THIS ARTICLE<br>This article is referenced by the &quot;Disaster Recovery for Microsoft Exchange 2000 Server&quot; white paper.<br>Contact the Content Business Manager for this product if you have any questions.<br></div><div class='kb-symptoms-section section'>After you try to log on to your Windows 2000-based computer by using a valid user name and password, the <strong class='uiterm'>Loading your personal settings</strong> dialog box is displayed, followed by the <strong class='uiterm'>Saving your settings</strong> dialog box. However, the desktop does not appear, and the <strong class='uiterm'>Welcome to Windows</strong> logon screen is displayed again.<br><br><span class='text-base'>Note</span> If the paging file is located on the system or boot partition, you may also receive the following warning message before returning to the &quot;Welcome to Windows&quot; logon screen:<br><div class='indent'>[Limited Virtual Memory]<br>Your system has no paging file, or the paging file is too small.<br></div></div><div class='kb-cause-section section'>This problem can occur if your Windows 2000 boot partition drive letter does not match the drive letter assigned during the initial Windows 2000 Setup. Windows 2000 maintains a record of drive letters in a registry based database and re-assigns drive letters based on Globally Unique Identifiers (GUID) recorded for each volume. Should the volume GUID change or be duplicated (by hard drive cloning software), the original drive letter may not be re-assigned to the boot volume.<br><br>This may also occur if you break a system/boot mirror, and then attempt to boot to the old shadow drive if the original primary drive is missing or inaccessible. This is because the volume GUID for the shadow drive is different than that of the original primary drive and does not get the same drive letter assigned.<br></div><div class='kb-resolution-section section'><span><span class='text-base'>Important</span> This section, method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/en-us/help/322756'>322756 </a> How to back up and restore the registry in Windows</div></span><br><br><span class='text-base'>Note</span> If the computer is networked but not part of a domain, you may need to map a connection to the machines IPC$ share using that computer&#39;s local administrator credentials before being able to attach using Regedit.exe or Regedt32.exe as described below to make changes.<br><br>To permit a logon and/or change the boot volume drive letter back to its originally assigned letter, use any of the following methods:<br><div class='indent'><span class='sbody-userinput'>net use \\remote_machine_name\IPC$ /user:administrator *</span></div>Use one of the following procedures to facilitate repairs:<br><ol class='sbody-num_list'><li>Remove any cloned hard disks added to your computer since the time the logon failures occurred, restart your computer, and then try to log on.</li><li>If the computer is networked, run Regedit.exe on another computer to open and modify the registry of the computer that is experiencing the logon failure. Use the information in the following Microsoft Knowledge Base article to change the drive letter back to the original letter assigned to the boot partition:<br><span><div class='indent'><a id='kb-link-2' href='/en-us/help/223188'>223188 </a> How to restore the system/boot drive letter in Windows<br><br></div></span></li><li>If the computer is networked, run Regedt32.exe or Regedit.exe on another computer to open and modify the registry of the computer that is experiencing the logon failure. Change the following entry to remove the full path to the Userinit.exe entry as follows:<br><br>Change from:<br><div class='indent'><span class='text-base'>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\Current Version\Winlogon\Userinit:Reg_SZ:C:\WINNT\system32\userinit.exe</span></div>Change to:<br><div class='indent'><span class='text-base'>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\Current Version\Winlogon\Userinit:Reg_SZ:userinit.exe</span></div>After you change the preceding registry entry and are able to logon, perform the steps in the following Microsoft Knowledge Base article to re-assign the proper drive letter to your boot partition and reboot:<br><span><div class='indent'><a id='kb-link-3' href='/en-us/help/223188'>223188 </a> How to restore the system/boot drive letter in Windows<br><br></div></span></li><li>Create a &quot;fake&quot; Winnt\System32 folder structure on the drive that is suspected as being assigned the original boot partition drive letter, and then expand and copy the Userinit.exe file from the Windows 2000 CD-ROM into the Winnt\System32 folder on that drive.<br><br>You can use the Recovery Console to perform this procedure provided the local security policy\security option &quot;Recovery Console: Allow floppy copy and access to all drives and all folders&quot; is enabled. This will permit the following Recovery Console command to work so you can gain unlimited access to all drives and paths:<br><span class='sbody-userinput'>SET allowallpaths = TRUE</span>This can be implemented as a policy on a domain controller to be applied to the local computer by using the information contained in the following Microsoft Knowledge Base article:<br><span><div class='indent'><a id='kb-link-4' href='/en-us/help/235364'>235364 </a> Description of the SET Command in Recovery Console<br><br></div></span>After you perform the preceding procedure and you are able to log on, perform the steps in the following Microsoft Knowledge Base article to re-assign the proper drive letter to your boot partition and reboot:<br><span><div class='indent'><a id='kb-link-5' href='/en-us/help/223188'>223188 </a> How to restore the system/boot drive letter in Windows<br><br></div></span></li><li>With only the system/boot drive in the system, or powered on, boot to a DOS or Windows 9X Start-up diskette that contains fdisk.exe and run the following command:<br><div class='indent'><span class='sbody-userinput'>FDISK /MBR</span></div>This re-writes the Master Boot Record and erase the disk signature  associated with volume GUID. Windows 2000 should assign default drive letters and allow you logon. Click the article number below for more information about FDISK:<br><span><div class='indent'><a id='kb-link-6' href='/en-us/help/69013'>69013 </a> FDISK /MBR rewrites the Master Boot Record<br><br></div></span></li></ol></div><div><span>Microsoft has confirmed that this is a problem in the Microsoft products that are listed at the beginning of this article. </span></div><div class='kb-securedata-section section'>The full path to the Userinit.exe file in the registry is causing the logon failure when the drive letter changes. This may be resolved in a future service pack by removing the full path to the Userinit.exe file in the registry.<br></div><div class='kb-moreinformation-section section'><span>For more information about this issue, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-7' href='/en-us/help/234048'>234048 </a> How Windows 2000 assigns, reserves, and stores drive letters<br><br></div></span></div><div class='kb-securedata-section section'>reoccurring secedit blank desktop login repeats &quot;Control Alt Delete&quot; &quot;CTRL DEL&quot; loop MountedDevices</div><div class='kb-textlegacy-section section'>NTBUG:438704 Author: mjacquet (1999-12-28T16:50:00) Edit Reviewer: cgolden (2000-01-10T14:15:00) Tech Reviewer: darrellg (2000-01-06T14:19:00)<br></div>