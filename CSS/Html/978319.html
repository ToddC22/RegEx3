<header><h1>How to restore the Windows Remote Management settings when all authentication schemes are disabled on a computer that is running Windows Server 2008 R2</h1></header><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/124527.asp' title='Link only available for Microsoft corporate network users' target='_blank'>124527 (Content Maintenance)</a></div><div class='kb-summary-section section'>This article introduces how to restore Windows Remote Management settings when all authentication methods are disabled in Windows Server 2008 R2.</div><div class='kb-moreinformation-section section'>In Windows Remote Management 2.0, all operations are handled as if they come from a remote computer.  Therefore, the requests that use a destination of &quot;localhost&quot; require that the Windows Remote Management service is running and that the correct authentication methods are enabled.<br><br><br><br>Specifically, Windows Remote Management lets you configure which authentication schemes are allowed on both the client-side and on the server-side.  These settings are as follows:<br><br><pre class='sbody-pre'>C:\Windows\system32&gt;winrm get winrm/config/client/auth<br>Auth<br>    Basic = true<br>    Digest = true<br>    Kerberos = true<br>    Negotiate = true<br>    Certificate = true<br>    CredSSP = false<br> </pre><pre class='sbody-pre'>C:\Windows\system32&gt;winrm get winrm/config/service/auth<br>Auth<br>    Basic = false<br>    Kerberos = true<br>    Negotiate = true<br>    Certificate = false<br>    CredSSP = false<br>    CbtHardeningLevel = None [Source=&quot;GPO&quot;] </pre><span class='text-base'>Note</span>  The first example displays the authentication schemes that are allowed on the client-side, and the second example does the same on the server-side.<br><br>There are two possible situations where a user can effectively make Windows Remote Management inaccessible:<br><ul class='sbody-free_list'><li>  If the user disables all authentication schemes for the service, the service no longer accepts requests from any client.  In this situation, a Windows Remote Management operation cannot pass through the locked service. Therefore, the configuration settings cannot be changed.</li><li>If the user disables all authentication schemes for the client, the client can no longer connect to any Windows Remote Management endpoint.  In this situation, Windows Remote Management cannot connect to the local endpoint. Therefore, you cannot change the client-side settings.<br></li></ul>Windows Remote Management supports an <span class='text-base'>invoke restore</span> operation that sets back the configuration to the default settings. However, this operation has to use the service. Therefore, this operation is useless in the situations that were mentioned earlier.<br><br><br>If one of these situations occurs, the following can be done to restore Windows Remote Management to a usable state.<br><br>The user changes the relevant Group Policy settings to enable at least one authentication mechanism.  The user can then run a <span class='text-base'>winrm</span> command in order to enable all the necessary authentication mechanisms in both the client-specific and in the service-specific configuration settings.  Then the user reverts the Group Policy settings back to their original state.<br><br><br>The relevant Group Policy settings can be found in the following location:<span class='text-base'><div class='indent'>Administrative Templates &gt; Windows Components &gt; Windows Remote Management (WinRM)</div></span>The following are the relevant policies:<br><pre class='sbody-pre'>WinRM Client &gt; Allow Basic authentication<br>WinRM Client &gt; Allow CredSSP authentication<br>WinRM Client &gt; Disallow Digest authentication<br>WinRM Client &gt; Disallow Kerberos authentication<br>WinRM Client &gt; Disallow Negotiate authentication<br><br>WinRM Service &gt; Allow Basic authentication<br>WinRM Service &gt; Allow CredSSP authentication<br>WinRM Service &gt; Disallow Kerberos authentication<br>WinRM Service &gt; Disallow Negotiate authentication<br> </pre><br><br>The following command examples enable particular authentication schemes on either the Windows Remote Management client or on the Windows Remote Management service:<br><span class='text-base'><div class='indent'>winrm set winrm/config/client/Auth @{Basic=&quot;true&quot;}<br></div></span><span class='text-base'><div class='indent'>winrm set winrm/config/service/Auth @{Basic=&quot;true&quot;}</div></span><pre class='sbody-pre'></pre><span class='text-base'>Note</span>  These command examples enable Basic authentication.</div><div class='kb-securedata-section section'><span class='text-base'>Author: nburkhar</span><br><span class='text-base'>Writer: meidx</span><br><span class='text-base'>Tech Reviewer: nburkhar</span><br><span class='text-base'>Editor: v-lynan</span></div>