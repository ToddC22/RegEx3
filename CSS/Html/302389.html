<header><h1>Description of the properties of the cluster Network Name resource in Windows Server 2003</h1></header><div><span></span></div><div class='kb-securedata-section section'>DO NOT DELETE OR ARCHIVE THIS ARTICLE<br>This article is referenced by Online Help docs and Windows Server 2003 release notes.<br>Contact the Content Business Manager for this product if you have any questions.<br></div><div class='kb-summary-section section'> This article describes the properties that are available for the Network Name resource in Microsoft Windows Server 2003 that are not included in earlier versions of Windows.</div><div> One of the features of the Network Name resource in Windows Server 2003 is the ability to create a computer object in Active Directory that allows programs to use Kerberos as an authentication protocol when the program contacts a service by using a cluster virtual name. Programs on a virtual server that are Active Directory aware now have a correctly-maintained Active Directory computer object. Other features include better DNS integration and three status indicators for NetBIOS, DNS, and Kerberos. The rest of this article describes how to enable and use these features. <h3 class='sbody-h3'>Enable Kerberos authentication</h3><span class='text-base'>Note</span> You receive the following error message if you try to set the Enable Kerberos Authentication option without taking the Network Name resource offline:<div class='sbody-error'>An error occurred attempting to set properties: The group or resource is not in the correct state to perform the requested operation. Error ID: 5023 (0000139f)</div>A VirtualServer is comprised of a Network Name and IP Address resource. The Network Name resource has been updated for Windows Server 2003 to enable the use of Kerberos authentication and the creation of a corresponding computer object. By default, Kerberos authentication and the creation of a computer object for the VirtualServer is disabled and NTLM is used for authentication. To enable the Kerberos authentication and the creation of a computer object: <br> <ol class='sbody-num_list'><li>Start Cluster Administrator, right-click the Network Name resource, and then click <strong class='uiterm'>Take Offline</strong>.<br><br><span class='text-base'>Note</span> Access to the VirtualServer by clients cannot now occur because the Network Name resource is now offline.</li><li>Double-click the Network Name resource where you want to enable Kerberos authentication to view the properties for the resource, and then click the <strong class='uiterm'>Parameters</strong> tab.</li><li>Click the <strong class='uiterm'>Enable Kerberos Authentication</strong>option, click <strong class='uiterm'>OK</strong>, right-click the Network Name resource, and then click <strong class='uiterm'>Bring Online</strong>. A client can now use Kerberos authentication when it connects to the VirtualServer. If you view the Active Directory Users and Computers MMC, a new computer object that correlates to the Network Name resource is visible.</li></ol> The Cluster service must have the proper permissions to create computer objects in the Active Directory. This should occur by default because the Cluster service, at the minimum, has to be a domain user. By default, this group has the &quot;Add workstations to a domain&quot; privilege.<br><br> By default, domain users are limited to creating ten computer objects in the Active Directory. To create more computer objects, you must increase the limit, or the domain administrator can pre-create the computer objects. If the domain administrator gives explicit &quot;Create Computer Objects&quot; rights to the Cluster service account, the quota is over-ridden. If the computer object is pre-created, the Cluster service account will need proper permissions to be able to &quot;hijack&quot; the object so that it can write the correct attributes to it.<br> <br><br> The three attributes that are written to the VirtualServer&#39;s computer object are: <br> <ul class='sbody-free_list'><li><span class='text-base'>DnsHostName</span> - This is created from the Network Name resource and the Cluster&#39;s primary DNS suffix.</li><li><span class='text-base'>ServicePrincipalName</span> - Like the DnsHostName, this is created from the Network Name resource and the Cluster&#39;s primary DNS suffix in the following format:<br><br> HOST/<strong class='sbody-strong'>VirtualServer&#39;s NetBIOS name</strong><br> HOST/<strong class='sbody-strong'>FQDN for the VirtualServer</strong><br>MSClusterVirtualServer/<strong class='sbody-strong'>VirtualServer&#39;s NetBIOS name</strong><br> MSClusterVirtualServer/<strong class='sbody-strong'>FQDN for the VirtualServer</strong><br> MSServerCluster/<strong class='sbody-strong'>VirtualServer&#39;s NetBIOS name</strong> (This SPN is only created for the default Cluster Name)<br> MSServerCluster/<strong class='sbody-strong'>FQDN for the VirtualServer</strong> (This SPN is only created for the default Cluster Name) </li><li><span class='text-base'>DisplayName</span> - This is the friendly name for the computer object as it appears in the directory or address book. This is the Network Name resource&#39;s NetBIOS name. Default access may prevent the DisplayName from being updated. However, it is not problematic if it cannot write the change, and the resource will come online.</li></ul> In addition, a password is set on the computer object.<br><br> You can view these attributes by using the Adsiedit.msc utility that is included on the Windows Server 2003 CD-ROM in the SUPPORT folder.<br><br> You can view the primary DNS suffix by running the<br> <span class='sbody-userinput'>ipconfig /all</span> command at a command prompt. Under<br> <strong class='uiterm'>Windows IP Configuration</strong>, the <strong class='uiterm'>Primary DNS Suffix</strong> section contains the primary DNS suffix that is used for the computer object. Note that the individual network adapters may have different specific suffixes, however, the Network Name resource uses the primary DNS suffix. <h3 class='sbody-h3'>Renaming the Network Name and its corresponding computer object</h3> The process of renaming a VirtualServer that has an associated computer object is similar to renaming a standard Network Name resource, except the resource has to be offline to make the change. Take the Network Name resource offline, and then change the Parameters property to the new name. The Network Name resource will automatically contact Active Directory and change the computer object&#39;s name. For the rename operation to be successful, both the Network Name on the cluster and the computer name in the Active Directory must be changed. If both cannot be changed, the original name is rolled back, and the change is not completed. The Cluster service account will require the &quot;Write all Properties&quot; access right to make the change to the computer object. computer objects cannot be manually renamed in the Active Directory Computers and Users MMC. <h3 class='sbody-h3'>Disabling Kerberos authentication</h3> The Cluster service never deletes a computer object from Active Directory. Instead, the Cluster service disables it. To disable the computer object, click to clear the <strong class='uiterm'>Enable Kerberos Authentication</strong>  option. After the computer object is disabled, the Network Name resource does not come online until you either select the <strong class='uiterm'>Enable Kerberos Authentication</strong> option again or manually delete the computer object from Active Directory. <h3 class='sbody-h3'>DNS settings</h3> The <strong class='uiterm'>DNS Registration Must Succeed</strong> option on a Network Name resource helps to make sure that DNS is updated before the resource comes online. If you select this option, the DNS HOST (A) record for the VirtualServer must be registered or the Network Name Resource fails to come online. If the DNS server accepts dynamic updates but the record could not be updated, that is considered a failure. If the DNS server does not accept dynamic updates (older versions of DNS) or there are no DNS servers associated with the resource&#39;s associated network, the Network Name will still come online. To enable the <strong class='uiterm'>DNS Registration Must Succeed</strong> option, follow these steps: <br> <ol class='sbody-num_list'><li>Start Cluster Administrator, right-click the Network Name resource, and then click <strong class='uiterm'>Take Offline</strong>.<br><br><span class='text-base'>Note</span> Access to the VirtualServer by clients cannot now occur because the Network Name resource is offline.</li><li>Double-click the Network Name resource where you want to enable the <strong class='uiterm'>DNS Registration Must Succeed</strong> option, and then click the <strong class='uiterm'>Parameters</strong> tab.</li><li>Click the <strong class='uiterm'>DNS Registration Must Succeed</strong>option, click <strong class='uiterm'>OK</strong>, right-click the Network Name resource, and then click <strong class='uiterm'>Bring Online</strong>. When the Network Name resource comes online, it will verify that it can register the VirtualServer with the DNS server.</li></ol><span class='text-base'>Note</span>: The Network Name is registered in DNS under the Cluster service account. Make sure that the Cluster service account has correct permissions to register records in DNS or the registration will not work.<h3 class='sbody-h3'>Status indicators</h3> When you view the properties of a Network Name resource, three status indicators are available, NetBIOS Status, DNS Status, and Kerberos Status. To view these indicators: <br> <ol class='sbody-num_list'><li>Start Cluster Administrator.</li><li>Double-click the Network Name resource, and then click the<br><strong class='uiterm'>Parameters</strong> tab. The three status indicators are listed in the middle of the <strong class='uiterm'>Parameters</strong> tab.</li></ol> The following list describes what each Status indicator displays. These indicators are changed when the Network Name is coming online or going offline. <br> <ul class='sbody-free_list'><li>NetBIOS Status: The NetBIOS Status indicator reflects the success or failure of the NetBIOS name registration with the local network redirector. A value of 0 is successful; otherwise it displays an error code. This does not indicate whether the NetBIOS name was registered to the respective WINS or DNS servers. To view the text of the error code, type<br><span class='sbody-userinput'>net helpmsg %errorcode%</span> at a command prompt, and then press ENTER.</li><li>DNS Status: The DNS Status indicator reflects the success or failure of the Network Name being registered with the DNS server. A value of 0 is successful; otherwise it displays an error code. To view the text of the error code, type <span class='sbody-userinput'>net helpmsg %errorcode%</span> at a command prompt, and then press ENTER.</li><li>Kerberos Status: The Kerberos Status indicator displays a code that indicates if the creation or updating of the Computer Object was successful or not. A value of 0 is successful; otherwise it displays an error code. To view the text of the error code, type <span class='sbody-userinput'>net helpmsg %errorcode%</span> at a command prompt, and then press ENTER.</li></ul><h3 class='sbody-h3'>Seven parameters for the Network Name resource in Windows Server 2003 that are not included in earlier versions of Windows</h3> The following parameters under the Network Name resource are used to support the features of the Network Name Resource in Windows Server 2003 that are not included in earlier versions of Windows. To view these Network Name resource parameters, type <span class='sbody-userinput'>cluster res &quot;network_name_resource&quot; /priv</span> at a command prompt, and then press ENTER. The parameters are as follows:<ul class='sbody-free_list'><li><span class='text-base'>RequireDNS</span> - The <span class='text-base'>RequireDNS</span> parameter matches the <span class='text-base'>DNS Registration Must Succeed</span> option in the user interface for the Network Name resource. It can have a value of 0 or 1:<ul class='sbody-free_list'><li>0 - Failed DNS registration does not prevent resource from coming online.</li><li>1 - If the DNS server cannot be updated, the resource will not come online.</li></ul></li><li><span class='text-base'>RequireKerberos</span> - The <span class='text-base'>RequireKerberos</span> parameter matches the <span class='text-base'>Enable Kerberos Authentication</span> option in the user interface for the Network Name resource. It can have a value of 0 or 1:<ul class='sbody-free_list'><li>0 - Kerberos Authentication is not enabled, and a computer object is not created for the Network Name resource.</li><li>1 - Computer object is created and Kerberos Authentication is enabled.</li></ul></li><li><span class='text-base'>CreatingDC</span> - The <span class='text-base'>CreatingDC</span> parameter displays the domain controller that was used by the cluster server to create or to modify the VirtualServer computer object. <span class='text-base'>CreatingDC</span> also displays the domain controller that was contacted to &quot;hijack&quot; the existing computer object if a computer object was pre-created by the domain administrator. This value is cleared when the <span class='text-base'>RequireKerberos</span> parameter is cleared. If kerberos was never enabled on the Network Name resource, you might see the following entry in the cluster.log file: <div class='message'>Unable to read CreatingDC parameter, error=2</div>You can ignore this entry. This does not indicate a problem because although you see the entry, the extry does not actually exist. <br></li><li><span class='text-base'>ResourceData</span> - The <span class='text-base'>ResourceData</span> value contains the encrypted password. Access to <span class='text-base'>ResourceData</span> in the registry is limited to the local administrator, to the system administrator, and to the creator owner. If kerberos was never enabled on the Network Name resource, you might see the following entry in the cluster.log file: <div class='message'>Unable to read ResourceData parameter, error=2</div>You can ignore this entry. This does not indicate a problem because although you see the entry, the entry does not actually exist. <br></li><li><span class='text-base'>StatusNetBIOS</span> - This matches what is displayed in the user interface under the Network Name resource.</li><li><span class='text-base'>StatusDNS</span> - This matches what is displayed in the user interface under the Network Name resource.</li><li><span class='text-base'>StatusKerberos</span> - This matches what is displayed in the user interface under the Network Name resource.</li></ul></div><div class='kb-securedata-section section'> NOTE for ResourceData bullet:<br><br> At this point, the computer object&#39;s password does not change and the passwords do not change.<br></div><div class='kb-moreinformation-section section'><h3 class='sbody-h3'>Command-line options</h3> Like most of administration tasks of a server cluster, you can enable the &quot;DNS Registration Must Succeed&quot; and &quot;Enable Kerberos Authentication&quot; features from a command prompt by using the Cluster.exe tool. Cluster.exe is installed by default, so to use it, issue the following commands at a command prompt (assuming you are running these commands from one of the cluster nodes).<br><br> To enable the <span class='text-base'>DNS Registration Must Succeed</span> option from the command prompt, type the following command:<div class='indent'><span class='sbody-userinput'>cluster res &quot;NETWORK_NAME_RESOURCE&quot; /priv RequireDNS=1</span></div> Set RequireDNS=0 to disable RequireDNS.<br><br> To enable the <span class='text-base'>Enable Kerberos Authentication</span> option from the command prompt, type the following command:<div class='indent'><span class='sbody-userinput'>cluster res &quot;NETWORK_NAME_RESOURCE&quot; /priv RequireKerberos=1</span></div> Set RequireKerberos=0 to disable RequireKerberos.<br><br> To view the Status indicators from Cluster.exe, type the following command:<div class='indent'><span class='sbody-userinput'>cluster.exe res &quot;NETWORK_NAME_RESOURCE&quot; /priv</span></div> For more information about Cluster.exe and other uses, see &quot;Help and Support,&quot; and then search for Cluster.exe. <h3 class='sbody-h3'>The File Replication service and server clusters</h3> The File Replication service (FRS) does not replicate with a file share that is on a server cluster under a virtual server&#39;s computer object. The FRS service looks for subscription information only under the node&#39;s computer object. The FRS service does not scan the virtual server&#39;s computer object. Distributed File System (DFS) uses the FRS to replicate data among multiple servers when a replication policy is enabled. If the DFS link with the replication policy is a virtual server, data is not replicated with any other partner. You may have to use another method to replicate the data. For example, you may have to use a file copy script.<h3 class='sbody-h3'>Troubleshooting</h3> For information about troubleshooting the creation and manipulation of computer objects by the Cluster service account, see the following article in the Microsoft Knowledge Base:<span><div class='indent'><a id='kb-link-1' href='/en-us/help/307532'>307532 </a> Troubleshooting the manipulation of computer objects by the Cluster service account<br><br></div></span></div><div class='kb-securedata-section section'>mscs</div><div class='kb-textlegacy-section section'>Author: stevemat (2001-06-20T07:01:00) Edit Reviewer: cgolden (2001-10-12T13:39:00) Tech Reviewer: dmorgan (2001-10-08T13:40:00)<br> </div>