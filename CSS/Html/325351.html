<header><h1>HOW TO: Apply Local Policies to All Users Except Administrators on Windows Server 2003 in a Workgroup Setting</h1></header><div><span></span></div><div class='kb-securedata-section section'>DO NOT DELETE OR ARCHIVE THIS ARTICLE<br>This article is referenced by TechNet.<br>Contact the Content Business Manager for this product if you have any questions.</div><div class='kb-notice-section section'><a class='bookmark' id='toc'></a><h3 class='sbody-h3'>IN THIS TASK</h3><ul class='sbody-free_list'><li><a managed-link="" href='#summary' target="" bookmark-id='summary'>SUMMARY</a><ul class='sbody-free_list'><li><a managed-link="" href='#task1' target="" bookmark-id='task1'>Apply Local Policies to All Users Except Administrators</a></li><li><a managed-link="" href='#task2' target="" bookmark-id='task2'>Restore Original Local Policies</a></li></ul></li></ul><a class='bookmark' id='summary'></a></div><div> This article describes how to apply local policies to all users except administrators on a Windows Server 2003-based computer that is in a workgroup setting. <br><br> When you use a Windows Server 2003-based computer in a workgroup setting (not a domain), you may have to implement local policies on that computer that can apply to all users of that computer, but not to administrators. This exception permits the administrator to retain unlimited access and control of the computer, and also permits the administrator to restrict the users who can log on to that computer. <br><br> The Windows Server 2003-based computer must be in a workgroup setting for this procedure to work. In this situation, the domain policies cannot overwrite the local policies because the domain policies do not exist. Microsoft recommends that you make backup copies of all the files that you edit during this procedure.<br> <br><br><a class='bookmark' id='task1'></a><h3 class='sbody-h3'>Apply Local Policies to All Users Except Administrators</h3> To implement local policies to all users except administrators, follow these steps: <br> <ol class='sbody-num_list'><li>Log on to the computer as an administrator.</li><li>Open your local security policy. To do this, do one of the following:<br><br><ul class='sbody-free_list'><li>Click <span class='text-base'>Start</span>, click <span class='text-base'>Run</span>, type <span class='sbody-userinput'>gpedit.msc</span>, and then press ENTER.<br><br> -or- </li><li>Click <span class='text-base'>Start</span>, click <span class='text-base'>Run</span>, type <span class='sbody-userinput'>mmc</span>, press ENTER, add the Group Policy Object Editor, and then configure it for the local security policy.</li></ul> If the removal of the <span class='text-base'>run</span> command is one of the policies that you want, Microsoft recommends that you edit the policy by means of Microsoft Management Console (MMC), and then save the results as an icon. Then, you do not need the <span class='text-base'>run</span> command to reopen the policy.</li><li>Expand the <span class='text-base'>User Configuration</span> object, and then expand the <span class='text-base'>Administrative Templates</span> object.</li><li>Enable whatever policies that you want (for example, Desktop for &quot;Hide My Network Places&quot; or &quot;Hide Internet Explorer Icon on Desktop&quot;). <br><br><span class='text-base'>NOTE</span>: Make sure that you select the correct policies; otherwise, you may restrict the ability of the administrator to log on to the computer (and to complete the necessary steps to configure the computer). Microsoft recommends that you record any changes that you make (you can also use this information for step 10).</li><li>Close the Gpedit.msc Group Policy snap-in. Or, if you use MMC, save the console as an icon to make it accessible later, and then log off the computer.</li><li>Log on to the computer as an administrator.<br><br> You can verify in this logon session the policy changes that were made earlier, because, by default, the local policies apply to all users, which includes administrators.</li><li>Log off the computer, and then log on to the computer as all of the other users for this computer for whom you want these policies to apply. The policies are implemented for all of these users and the administrator.<br><br><span class='text-base'>NOTE</span>: Any user account that is not logged on to the computer at this step cannot have the policies implemented for that account.</li><li>Log on to the computer as an administrator.</li><li>Click <span class='text-base'>Start</span>, point to <span class='text-base'>Control Panel</span>, and then click <span class='text-base'>Folder Options</span>. Click the <span class='text-base'>View</span> tab, click <strong class='uiterm'>Show Hidden Files and Folders</strong>, and then click <span class='text-base'>OK</span> so that you can view the Group Policy hidden folder. Or, open Windows Explorer, click <span class='text-base'>Tools</span>, and then click <span class='text-base'>Folder Options</span> to view these settings.</li><li>Copy the Registry.pol file that is located in the %Systemroot%\System32\GroupPolicy\User folder to a backup location (for example, to a different hard disk, floppy disk, or folder).</li><li>Open your local policy again by using either the Gpedit.msc Group Policy snap-in or your MMC icon, and then enable the exact features that were disabled in the original policy that was created for that computer.<br><br><br><span class='text-base'>NOTE</span>: When you do this, Policy Editor creates a new Registry.pol file.</li><li>Close your policy editor, and then copy the backup Registry.pol file that you created in step 10 back into the %Systemroot%\System32\GroupPolicy\User folder. <br><br> When you are prompted to replace the existing file, click <span class='text-base'>Yes</span>.</li><li>Log off the computer, and then log on as an administrator.<br><br> You can verify that the changes that were originally made are not implemented for you because you have logged on to the computer as an administrator.</li><li>Log off the computer, and then log on as another user (or users).<br><br> You can verify that the changes that were originally made are implemented for you because you have logged on to the computer as a user (not an administrator) to that computer .</li><li>Log on to the computer as an administrator to verify that the local policy does not affect you as the local administrator to that computer.</li></ol></div><div class='kb-securedata-section section'> Another method to turn on this functionality is to use the Poledit.exe program available with Microsoft Windows NT 4.0.<br><br> This method can permit the same functionality, but note that those changes are made to the registry and cannot be reversed unless a reversal policy is created or it is manually removed from the registry. This method may work for most policy configurations and is the same as the Windows NT 4.0 policy editor.<br></div><div class='kb-summary-section section'><a class='bookmark' id='task2'></a><h3 class='sbody-h3'>Restore Original Local Policies</h3> To reverse the process described in the &quot;Apply Local Policies to All Users Except Administrators&quot; section of this article, follow these steps: <br> <ol class='sbody-num_list'><li>Log on to the computer as an administrator.</li><li>Click <span class='text-base'>Start</span>, point to <span class='text-base'>Control Panel</span>, and then click <span class='text-base'>Folder Options</span>. Click the <span class='text-base'>View</span> tab, click <strong class='uiterm'>Show Hidden Files and Folders</strong>, and then click <span class='text-base'>OK</span> so that you can view the Group Policy hidden folder. Or, open Windows Explorer, click <span class='text-base'>Tools</span>, and then click <span class='text-base'>Folder Options</span>.</li><li>Move, rename, or delete the Registry.pol file from the %Systemroot%\System32\GroupPolicy\User folder.<br><br> Another default Registry.pol file is created by the Windows File Protection system after you log off from or restart the computer.</li><li>Open the local policy. To do this, click <span class='text-base'>Start</span>, click <span class='text-base'>Run</span>, and then type <span class='sbody-userinput'>gpedit.msc</span>. Or, click <span class='text-base'>Start</span>, click <span class='text-base'>Run</span>, type <span class='sbody-userinput'>mmc</span>, and then load the local security policy. Then, set all of the items that are set to either <span class='text-base'>disable</span> or <span class='text-base'>enable</span> to <span class='text-base'>not configured</span> to reverse any policy changes that were implemented to the Windows Server 2003 registry as specified by the Registry.pol file.</li><li>Log off the computer as an administrator, and then log on to the computer again as an administrator.</li><li>Log off the computer, and then log on to the computer as all of the users on the local computer so that the changes can be reversed on their accounts too.</li></ol><a class='bookmark' id='8'></a></div><div class='kb-securedata-section section'>kbmgmtsvc</div><div class='kb-textlegacy-section section'>Author: dbrandt (2002-06-25T10:30:00) Edit Reviewer: V-RHOWAR (2002-08-13T16:31:00) Tech Reviewer: BOBQIN (2002-08-12T06:15:00)<br> </div>