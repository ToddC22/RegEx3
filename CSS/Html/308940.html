<header><h1>How to troubleshoot error 1928 &quot;Error registering COM+ application&quot;</h1></header><div class='kb-summary-section section'> This article describes how to troubleshoot error 1928 &quot;Error registering COM+ application.&quot; You may receive this error message when you run an .msi file (which is created when you export a COM+ application) on a client computer or another server computer. </div><div> The cause of this error message is usually divided into two distinct areas: <br> <ul class='sbody-free_list'><li>Dependency issues</li><li>Permissions issues</li></ul><h3 class='sbody-h3'>Dependency issues</h3> The steps to troubleshoot dependency problems differ depending on how you exported the application. You can export a COM+ application in two different ways: <br> <ul class='sbody-free_list'><li>Application proxy</li><li>Server application</li></ul><h4 class='sbody-h4'>Exporting as an application proxy</h4> If you exported the COM+ application as an application proxy, follow these steps to troubleshoot error 1928.<br><br><span class='text-base'>Note</span> To create an application proxy in Microsoft Windows Server 2003 or in Microsoft Windows XP that will install on a Microsoft Windows 2000-based computer, you must click to select the <strong class='uiterm'>Save application in COM+ 1.0 format</strong> check box.<br> <ol class='sbody-num_list'><li>To rule out a dependency issue, simply export the type library (.tlb or typelib) files instead of the dynamic-link libraries (DLLs). <br><ul class='sbody-free_list'><li>If your components are built with Microsoft Visual Basic, a separate typelib is not automatically created for you.<span> For more information about how to create a separate typelib for your DLL, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/en-us/help/153569'>153569 </a> How to get a Typelib (.tlb) file for a Visual Basic OLE server<br><br></div></span></li><li>If all of your client computers are running Microsoft Windows 2000, verify that you have at least Windows 2000 Service Pack 2 (SP2) installed on the COM+ server.</li><li>If some of your client computers are running Microsoft Windows NT 4.0, Microsoft Windows 98, or Microsoft Windows 95, verify that you also have at least Windows 2000 Post-Service Pack 2 COM+ Hotfix Rollup 9 installed on the COM+ server. <br><br><span class='text-base'>Note</span> To check which hotfixes are installed on the server, view the subkeys under the following key in your registry:<div class='indent'><span class='text-base'>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\HotFix</span></div></li></ul> When you export the typelibs for your COM+ application, you not only eliminate potential dependency problems, you also minimize the number of files that are installed on the client computer. Because the object is created on the server, the client computer only needs the interface definitions (which is all that a typelib is) and not the full implementation of the DLL.<br><br> To install a typelib into a COM+ application, follow these steps: <br><ol class='sbody-alpha_list'><li>On the <span class='text-base'>Start</span> menu, point to <span class='text-base'>Programs</span>, point to <span class='text-base'>Administrative Tools</span>, and then click <span class='text-base'>Component Services</span> to open the Component Services Microsoft Management Console (MMC) and create your new COM+ application.</li><li>In Component Services, click to expand the <span class='text-base'>Component Services</span>, <span class='text-base'>Computers</span>, <span class='text-base'>My Computer</span>, and <span class='text-base'>COM+ Applications</span> nodes.</li><li>Click to expand your new COM+ application.</li><li>Right-click the <span class='text-base'>Components</span> folder, point to <span class='text-base'>New</span>, and then click <span class='text-base'>Component</span>.</li><li>In the COM Component Install Wizard, click <span class='text-base'>Next</span>.</li><li>On the second page of the wizard, click <strong class='uiterm'>Install new component(s)</strong>.</li><li>When the wizard prompts you to select your component, select both the .dll file <span class='sbody-italic'>and</span> the .tlb file. Notice that you cannot see the .tlb file in the Component Services MMC; you can only see the DLL.</li><li>After you install your component, export your COM+ application as an application proxy.</li></ol></li><li> When you export the typelibs for your COM+ application, you not only eliminate potential dependency problems, you also minimize the number of files that are installed on the client computer. Because the object is created on the server, the client computer only needs the interface definitions (which is all that a typelib is) and not the full implementation of the DLL.Run the .msi file on your client computer. If error 1928 occurred because of a dependency issue, the .msi file should run smoothly on the client computer. Search the file system of the client computer, and notice that only the .tlb file for your component has been installed.</li><li> If you still receive error 1928 when you run the .msi file on the client computer, you most likely have a permissions issue on the client computer.</li></ol></div><div class='kb-securedata-section section'> The history of the bug (which is fixed in Q291244) is as follows:<br><br> The last COM+ Rollup Hotfix to be included in Windows 2000 SP2 (Q282896) corrects the problem of exporting typelibs in a COM+ application. <br><span> For more information, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-5' href='/en-us/help/255973'>255973 </a> FIX: Exporting application proxy in COM+ gives export application error<br><br></div></span> However, when you install Windows 2000 SP2, you introduce the problem that is outlined in the following article: <br><span><div class='indent'><a id='kb-link-6' href='/en-us/help/289821'>289821 </a> FIX: COM+ application proxy does not register CLSID after you install COM+ Rollup Hotfix 5<br><br></div></span> This bug only affects Windows 95, Windows 98, and Windows NT 4.0 client computers. The fix for this bug is in Q291244, but the recommended fix is in the following article (at least until Windows 2000 SP3 is released): <br><span><div class='indent'><a id='kb-link-7' href='/en-us/help/302845'>302845 </a> Availability of Windows 2000 Post-Service Pack 2 COM+ Hotfix Rollup Package 14<br><br></div></span></div><div class='kb-securedata-section section'> Add Microsoft Windows .NET Server to the preceding sentence when it releases to the public. </div><div class='kb-moreinformation-section section'><h4 class='sbody-h4'>Exporting as a server application</h4><span class='text-base'>Note</span> To create an application proxy in Microsoft Windows Server 2003 or in Microsoft Windows XP that will install on a Microsoft Windows 2000-based computer, you must click to select the <strong class='uiterm'>Save application in COM+ 1.0 format</strong> check box.<br><br>When you export your COM+ application as a server application, you cannot export only the typelib because the server requires the full implementation of the DLL.<br><br> If DLLs in your COM+ application contain dependencies that are not present on the new target Microsoft Windows XP Server or Microsoft Windows 2000 Server, you must ensure that these DLLs are registered properly on the target server before you run the .msi file on the target server. <br>  If the dependencies are not Component Object Model (COM) DLLs, ensure that they are installed in the<br> <strong class='sbody-strong'>windir</strong>\WINNT\System32 folder of the target server before you run the .msi file.<br><br> If you continue to receive error 1928 after you try these troubleshooting methods, follow these steps on the target computer (the computer from which you run the .msi file) to obtain more useful error information: <br> <ol class='sbody-num_list'><li>Open the Component Services MMC.</li><li>Click to expand the <span class='text-base'>Component Services</span>, <span class='text-base'>Computers</span>, and <span class='text-base'>My Computer</span> nodes.</li><li>Click and then right-click <span class='text-base'>COM+ Applications</span>, point to <span class='text-base'>New</span>, and then click <span class='text-base'>Application</span>.</li><li>In the COM Application Install Wizard, click <span class='text-base'>Next</span>.</li><li>On the second page of the wizard, click <strong class='uiterm'>Install pre-built application(s)</strong>.</li><li>When the wizard prompts you to choose either a default directory or a specific directory, choose <span class='text-base'>Default directory</span>, and then complete the steps in the wizard.</li><li>The wizard generates two error message dialog boxes. In the second error message dialog box, click <span class='text-base'>Details</span> to obtain more detailed error information. This error information may provide better insight about the cause of the problem.</li></ol><h3 class='sbody-h3'>Permissions issues</h3> The steps to troubleshoot a permissions issue do not necessarily depend on how you exported the COM+ application. When you troubleshoot a permissions issue, the primary goal is to make sure that the user who is currently logged on to the client computer has the necessary permissions to run the .msi file.<br><br> For example, the user must have read/write permissions to the <span class='text-base'>HKEY_CLASSES_ROOT</span> registry subtree. The Regmon and Filemon utilities (which are available from<br> <a id='kb-link-8' href='http://technet.microsoft.com/en-us/sysinternals/default.aspx' target='_self'>SysInternals</a>) may provide assistance.<br><br><span class='text-base'>Note</span> Installing Crystal Reports 8.0 is known to alter the permissions on certain registry keys. <br> <span> For more information, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-9' href='/en-us/help/266621'>266621 </a> Error &quot;Library not registered&quot; with Crystal Reports 8.0<br><br></div></span></div><div class='kb-securedata-section section'>80110425</div><div class='kb-textlegacy-section section'>DOC INFO: kbsweptCOMplus150 v-kargif February 20,2002 Author: BRADLIN (2001-09-28T09:14:00) Edit Reviewer: V-CARAPO (2001-12-20T10:29:00) Tech Reviewer: MADHUP (2001-12-05T09:44:00)<br> </div>