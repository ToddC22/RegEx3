<header><h1>You receive an &quot;Access is denied&quot; error message when you try to access an event log on a Windows Server 2003-based computer or on a Windows 2000-based computer</h1></header><div class='kb-notice-section section'><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/17878.asp' title='Link only available for Microsoft corporate network users' target='_blank'>17878 (Content Maintenance)</a></p></div></div></div></div><br></div><div class='kb-symptoms-section section'>When you try to access an event log on a Microsoft Windows Server 2003-based computer or on a Microsoft Windows 2000-based computer, you receive the following error message: <div class='sbody-error'>Unable to complete the operation on <strong class='sbody-strong'>event log</strong>. Access is denied.</div></div><div class='kb-cause-section section'>By default, the built-in guest group and the built-in domain guest group cannot access the event logs. When a user is a member of the guest group or of the domain guest group, the user cannot access the event logs.</div><div class='kb-resolution-section section'>To resolve this problem, use one of the following methods.<h3 class='sbody-h3'>Method 1</h3>Remove any user or group that must access the event logs from the guest group and from the domain guest group. <br><br>If the problem persists, add the user or the group to the permissions list for the event log files. To view an event log, the user or group must have Read permission. <br><br><span class='text-base'>Note</span> The event log files are located in the following folder: <div class='indent'>%systemroot%\system32\config</div><h3 class='sbody-h3'>Method 2</h3><span><span class='text-base'>Important</span> This section, method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/en-us/help/322756'>322756 </a> How to back up and restore the registry in Windows</div></span><br><br>Disable the <span class='text-base'>Restrict guest access to application log</span> guest policy, the <span class='text-base'>Restrict guest access to security log</span> guest policy, or the <span class='text-base'>Restrict guest access to system log</span> group policy from the Guest account in Windows 2000 Server if you want the policy to remain enabled. <br><br>To remove policies from the <span class='text-base'>Default Domain Policy</span> Group Policy settings, follow these steps: <ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>mmc</span>, and then click <strong class='uiterm'>OK</strong>.</li><li>On the Console menu, click <strong class='uiterm'>Add/Remove Snap-in</strong>. </li><li>Click <strong class='uiterm'>Add</strong>, click <strong class='uiterm'>Group Policy</strong>, click <strong class='uiterm'>Add</strong>, click <strong class='uiterm'>Browse</strong>, click <strong class='uiterm'>Default Domain Policy</strong>, click <strong class='uiterm'>OK</strong>, and then click <strong class='uiterm'>Finish</strong>.</li><li>Click <strong class='uiterm'>Close</strong>, and then click <strong class='uiterm'>OK</strong>.</li><li>In the left-pane, expand <strong class='uiterm'>Default Domain Policy</strong>, expand <strong class='uiterm'>Computer Configuration</strong>, expand <strong class='uiterm'>Windows Settings</strong>, expand <strong class='uiterm'>Security Settings</strong>, expand <strong class='uiterm'>Event Log</strong>, and then click <strong class='uiterm'>Settings for Event Logs</strong>. Double-click <strong class='uiterm'>Restrict guest access to application log</strong>, click to clear the <strong class='uiterm'>Define this policy setting</strong> check box, and then click <strong class='uiterm'>OK</strong>. </li><li>Double-click <strong class='uiterm'>Restrict guest access to security log</strong>, click to clear the <strong class='uiterm'>Define this policy setting</strong> check box, and then click <strong class='uiterm'>OK</strong>.</li><li>Double-click <strong class='uiterm'>Restrict guest access to system log</strong>, click to clear the <strong class='uiterm'>Define this policy setting</strong> check box, and then click <strong class='uiterm'>OK</strong>.</li><li>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>regedit</span>, and then click <strong class='uiterm'>OK</strong>.</li><li>Locate and then click the following registry subkey: <div class='indent'><strong class='uiterm'>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Application</strong></div></li><li>Point to <strong class='uiterm'>New</strong> on the <strong class='uiterm'>Edit</strong> menu, and then click <strong class='uiterm'>DWORD Value</strong>. Type <span class='sbody-userinput'>RestrictGuestAccess</span>, and then press ENTER.</li><li>Double-click <strong class='uiterm'>RestrictGuestAccess</strong>, type <span class='sbody-userinput'>1</span> in the <strong class='uiterm'>Value data</strong> box, and then click <strong class='uiterm'>OK</strong>. </li><li>Repeat steps 9 through 11 for the following registry subkeys: <div class='indent'><strong class='uiterm'>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\System</strong></div><div class='indent'><strong class='uiterm'>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Security</strong></div></li></ol></div><div class='kb-securedata-section section'>grant gpo </div><div class='kb-securedata-section section'>Author: tomau<br>Writer: Kirk Pinneo (v-kirkp)<br>Tech Reviewer: v-dahedm<br>Editor:   v-joyhan</div>