<header><h1>Users may receive an &quot;Access is denied&quot; error message if you make files and folders available for offline use</h1></header><div class='kb-notice-section section'>This article applies to Windows 2000. <span class='text-base'>Support for Windows 2000 ends on July 13, 2010.</span> The <a id='kb-link-1' href='/win2000' target='_self'>Windows 2000 End-of-Support Solution Center</a> is a starting point for planning your migration strategy from Windows 2000. For more information see the <a id='kb-link-2' href='/lifecycle/' target='_self'>Microsoft Support Lifecycle Policy</a>.</div><div class='kb-symptoms-section section'>If you are an administrator and you try to make folders or files available for offline use, the users may  receive one of the following error messages:<br><br><span class='text-base'>Message 1</span><div class='sbody-error'>Offline Files <br>Unable to make <strong class='sbody-strong'>folder name</strong> available offline on \\<strong class='sbody-strong'>server name</strong>\<strong class='sbody-strong'>share name</strong>\<strong class='sbody-strong'>folder name</strong> access is denied</div><span class='text-base'>Message 2</span><div class='sbody-error'>Errors occurred while Windows was synchronizing your data. Offline files (\\<strong class='sbody-strong'>server_name</strong>\<strong class='sbody-strong'>share_name</strong>): Access to &#39;<strong class='sbody-strong'>filename</strong>&#39; is denied on \\<strong class='sbody-strong'>server_name</strong>\<strong class='sbody-strong'>share_name</strong>\<strong class='sbody-strong'>user_name</strong>.</div>This symptom occurs if the users do not have the appropriate permissions to the root of the share that they are trying to synchronize with when they create the file for offline use.<br></div><div class='kb-cause-section section'>This issue may occur if you  create a share,  put the user&#39;s subfolder under a root share folder, and then include the folder name as part of the drive mapping.  For example, this issue may occur in the following scenario:<br><ol class='sbody-num_list'><li>On a server that has a folder named Home, you   create a share for users to connect named \\<strong class='sbody-strong'>server_name</strong>\home$.</li><li>You map a drive on the client computer as \\<strong class='sbody-strong'>server_name</strong>\home$\<strong class='sbody-strong'>user_name</strong>.</li></ol></div><div>To configure a share so that users can synchronize with a subfolder under the Home$ share, grant all of the users at least Read permissions on the Home folder.  You must do so because  the Offline Folder functionality checks the user&#39;s permissions on the root share when it first establishes synchronization.<br><br></div><div class='kb-moreinformation-section section'>From Developers: <br><br>The issue occurs because of the way that permissions are processed when users access a file.   For performance reasons, intervening folders are not checked, only the permissions of the object itself are checked.  Therefore,  when you access the  \\<strong class='sbody-strong'>Server_name</strong>\<strong class='sbody-strong'>Share_name</strong>\<strong class='sbody-strong'>Folder_1</strong>\<strong class='sbody-strong'>File_1</strong>.txt share,  the permissions on <strong class='sbody-strong'>Folder_1</strong> are not important, but the permissions on <strong class='sbody-strong'>File_1</strong>.txt are. <br><br>However, when you mark a folder or file for offline use, Client Side Caching (CSC) has to create objects in the database that represent each object or folder  down to the folder or file that you mark for offline use.  Windows must create  a cached copy of &#39;<strong class='sbody-strong'>Folder_1</strong>&#39; (and <strong class='sbody-strong'>Server_name</strong> and <strong class='sbody-strong'>Share_name</strong>) in the database.  However, because <strong class='sbody-strong'>Folder_1</strong> has restricted permissions, Windows cannot enumerate or get information about <strong class='sbody-strong'>Folder_1</strong>, and you receive the &quot;Access is denied &quot; error message.   (This issue is fixed in Windows XP.)<br><br>If you try to synchronize after you change the permissions, and then change the permissions back to what they were after you make the folder available offline, if you mark <strong class='sbody-strong'>Folder_1</strong> so that anyone can access it, the cache is populated correctly.  At this point, Windows has a representation of <strong class='sbody-strong'>Folder_1</strong> in the cache.  If you go back and configure tight security on <strong class='sbody-strong'>Folder_1</strong>, you can now synchronize because at this point Windows does not have to do anything with <strong class='sbody-strong'>Folder_1</strong>.  Windows looks in the database and compares what has been changed, and then proceeds to synchronize the folders. <br></div><div class='kb-securedata-section section'>csc client side caching</div><div class='kb-securedata-section section'>Author: kfrost (2000-10-04T07:25:00)<br><br>Tech Reviewer: RDAMUTH (2002-06-20T18:13:00)<br><br>Edit Reviewer: V-JANHAL (2002-06-25T13:05:00)<br></div>