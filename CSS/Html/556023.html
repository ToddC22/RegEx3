<header><h1>How to retrieve a list of shared folders shared using a script</h1></header><div class='kb-notice-section section'>Nirmal Sharma MVP</div><div class='kb-notice-section section'><div class='kb-disclaimer-msi'>MICROSOFT CORPORATION AND/OR ITS RESPECTIVE SUPPLIERS MAKE NO REPRESENTATIONS ABOUT THE SUITABILITY, RELIABILITY, OR ACCURACY OF THE INFORMATION AND RELATED GRAPHICS CONTAINED HEREIN. ALL SUCH INFORMATION AND RELATED GRAPHICS ARE PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND. MICROSOFT AND/OR ITS RESPECTIVE SUPPLIERS HEREBY DISCLAIM ALL WARRANTIES AND CONDITIONS WITH REGARD TO THIS INFORMATION AND RELATED GRAPHICS, INCLUDING ALL IMPLIED WARRANTIES AND CONDITIONS OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, WORKMANLIKE EFFORT, TITLE AND NON-INFRINGEMENT.  YOU SPECIFICALLY AGREE THAT IN NO EVENT SHALL MICROSOFT AND/OR ITS SUPPLIERS BE LIABLE FOR ANY DIRECT, INDIRECT, PUNITIVE, INCIDENTAL, SPECIAL, CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER INCLUDING, WITHOUT LIMITATION, DAMAGES FOR LOSS OF USE, DATA OR PROFITS, ARISING OUT OF OR IN ANY WAY CONNECTED WITH THE USE OF OR INABILITY TO USE THE INFORMATION AND RELATED GRAPHICS CONTAINED HEREIN, WHETHER BASED ON CONTRACT, TORT, NEGLIGENCE, STRICT LIABILITY OR OTHERWISE, EVEN IF MICROSOFT OR ANY OF ITS SUPPLIERS HAS BEEN ADVISED OF THE POSSIBILITY OF DAMAGES.</div></div><div class='kb-summary-section section'><div class='indent'><span class='sbody-italic'>The following knowledgebase will explain the methods you can use to check the shared folders shared on local and remote computer.</span></div></div><div class='kb-moreinformation-section section'><strong class='sbody-strong'>To check on local computer:</strong><br>&#160;<br>You can use the following methods:<br>&#160;<br><ol class='sbody-num_list'><li>Connecting to Remote Registry Service</li><li>Using a script </li></ol>&#160;<br>The first method is easy but includes a lot of efforts. You can navigate to the following location in registry after connecting to remote registry:<br>&#160;<br><strong class='sbody-strong'>HKLM\System\CurrentcontrolSet\Services\Lanmanserver\Shares</strong><br><strong class='sbody-strong'></strong>&#160;<br>The above registry key includes the list of shared folders in right pane.<br>&#160;<br><strong class='sbody-strong'>To check on a Remote Computer:</strong><br>&#160;<br>You can use the below script to check the list of shared folders on a remote computer:<br>&#160;<br>@echo off<br>&#160;<br>Srvlist=C:\Temp\Srvlist.txt<br>&#160;<br>Echo Computer Name, Shared Folders Lists &gt;&gt; Result.csv<br>&#160;<br>SET Share_name=<br>&#160;<br>For /F “Tokens=*” %%a In (%srvlist%) Do (<br>&#160;<br>Set Comp_name=%%a<br>&#160;<br>Set RegQry=”\\%%a\HKLM\System\CurrentcontrolSet\Services\Lanmanserver\Shares”<br>&#160;<br>REG.exe Query %RegQry% &gt; CheckCC.txt<br>&#160;<br>FOR /f “Skip=4 Tokens=1” %%b in (CheckCC.txt) DO (<br>&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SET Share_name=%%b<br>&#160;<br>Echo %Share_name% &gt;&gt; Result.csv<br>&#160;<br>)<br>&#160;<br>)<br>&#160;<br>The above script will check remote computer for each registry entry in the right pane fto check the share name and the results will be saved in a CSV format file.<br></div>