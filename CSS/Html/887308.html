<header><h1>&quot;Error loading type library/DLL&quot; error after you install Systems Management Server Advanced Client on a computer that is running Microsoft Internet Information Services</h1></header><div class='kb-notice-section section'><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/27962.asp' title='Link only available for Microsoft corporate network users' target='_blank'>27962 (Content Maintenance)</a></p></div></div></div></div></div><div class='kb-symptoms-section section'>After you install Microsoft Systems Management Server (SMS) 2003 Advanced Client on a computer that is running Microsoft Internet Information Services (IIS), ASP.NET Web-based programs that use    Windows Management Instrumentation (WMI) may not be able to connect. Additionally, you may receive the following error message:<br><br><div class='sbody-error'>Error loading type library/DLL</div></div><div class='kb-cause-section section'>This problem typically occurs  after you the install SMS 2003 Advanced Client. During the installation of SMS Advanced Client, the Setup program registers the Policyagent.dll file. This action may change the current WMI COM registrations. In this case,   the type library reference is updated to point to the Policyagent.dll-type library instead of the Wbemdisp.dll-type library. <br><br>When this problem occurs, the account that is used by the ASP.NET Web-based program may not have access to the Policyagent.dll file. <br><br><br><br><br><br><span class='text-base'>Note</span> This problem does not occur if you are using VBScript or the System.Management namespace to access WMI.<br><br><br></div><div class='kb-resolution-section section'>To resolve this problem, follow these steps:<ol class='sbody-num_list'><li>  Re-register the Wbemdisp.dll file. To do this, follow these steps:<ol class='sbody-alpha_list'><li>Use an administrative account to log on to the SMS Advanced Client computer. Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>cmd</span>, and then click <strong class='uiterm'>OK</strong>.</li><li>At the command prompt, type <span class='sbody-userinput'>regsvr32 wbemdisp.dll</span>.</li><li>In the <strong class='uiterm'>Regsvr32</strong> dialog box, click <strong class='uiterm'>OK</strong>.</li></ol><br><span class='text-base'>Note</span> If you re-install SMS Advanced Client or apply a service pack hotfix, you may have to re-register the Wbemdisp.dll file. </li><li>If the error still occurs, make sure that the ASP.NET or IIS account that is used to run the Web-based program has the correct permissions to use the Policyagent.dll file. To do this, follow these steps:<ol class='sbody-alpha_list'><li>Use Windows Explorer to locate and open the WINNT\system32\CCM folder. <br><span class='text-base'>Note</span> On an SMS management point computer, the Policyagent.dll file may reside in the SMS_CCM folder.</li><li>Right-click the Policyagent.dll file, and then click <strong class='uiterm'>Properties</strong>.</li><li>In the <strong class='uiterm'>Policyagent.dll Properties</strong> dialog box, click the <strong class='uiterm'>Security</strong> tab.</li><li>Make sure that the ASP.NET or IIS account that is used to run the Web-based program has read access permissions for the Policyagent.dll file, and then click <strong class='uiterm'>OK</strong>.</li></ol></li><li>You may also be able to work around this problem by changing the account under which your ASP.NET program runs. ASP.NET Web-based programs are typically run by the Aspnet_wp.exe or W3wp.exe process. <br><br><span>For additional information, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-1' href='/en-us/help/317012'>317012 </a> Process and request identity in ASP.NET<br><br></div></span></li></ol><span class='text-base'>Note</span> This problem typically occurs on Windows XP-based computers that are  running IIS. Windows Server 2003-based computers that are running IIS are not affected by this problem  because the ASP.NET program  runs under the system account. The system account has access to the Policyagent.dll file.</div><div class='kb-status-section section'><span>Microsoft has confirmed that this is a problem in the Microsoft products that are listed in the &quot;Applies to&quot; section.</span></div><div class='kb-securedata-section section'>ASP.NET IIS SMS Advanced client</div><div class='kb-securedata-section section'>Author: melvinb<br>Writer: v-lgomm<br>Tech Reviewer:v-jomcc<br> Editor:  v-crweb</div>