<header><h1>Certain Web sites and HTML Help features may not work after you install security update 896358 or security update 890175</h1></header><div class='kb-symptoms-section section'>After you install security update 896358 or security update 890175, you may experience one or more of the following symptoms: <br> <ul class='sbody-free_list'><li>Certain kinds of Web-based programs may not work correctly. For example, a table of contents in HTML Help may no longer work.</li><li>Certain HTML Help features may not work when you open a .chm file from a remote location. For example, the Related Topics feature may not work.</li></ul><span class='text-base'>Note</span> This article contains information that is supplemental to the following Microsoft Knowledge Base articles:<span><div class='indent'><a id='kb-link-1' href='/en-us/help/896358'>896358 </a> MS05-026: A vulnerability in HTML Help could allow remote code execution<br><br></div></span><span><div class='indent'><a id='kb-link-2' href='/en-us/help/890175'>890175 </a> MS05-001: Vulnerability in HTML Help could allow code execution<br><br></div></span></div><div class='kb-cause-section section'>This problem occurs because security update 896358 and 890175 prevent HTML content that is outside the Local Machine zone from creating an instance of the HTML Help ActiveX control (HHCTRL). This change was introduced to reduce security vulnerabilities in HTML Help.</div><div class='kb-resolution-section section'><span class='text-base'>Warning</span> The symptoms are an expected and intended effect of installing the security updates. This section provides examples for administrators who must re-enable the HTML Help ActiveX control for business-critical programs. The workarounds may make the computer more vulnerable to the threats the security updates address. The safest course is not to use the registry workarounds. If you must use workarounds, set the registry values to be as restrictive as possible.<br><br><span><span class='text-base'>Important</span> This section, method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-3' href='/en-us/help/322756'>322756 </a> How to back up and restore the registry in Windows</div></span><br><br>The first of the following examples is the most restrictive example. The next examples are successively less restrictive.<h3 class='sbody-h3'>Example 1: Use the UrlAllowList entry to enable specific URLs</h3><span class='text-base'>Warning</span> Include only URLs for sites that you trust.<br><br>The .reg file in this example re-enables hosting of the HTML Help ActiveX control in the following remote content: <br> <ul class='sbody-free_list'><li>Any .chm files that are in the \\productmanuals\helpfiles folder</li><li>A Web application that located at http://www.wingtiptoys.com/help.</li></ul>Paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.<div class='sbody-code'><pre><code>REGEDIT4<br>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\HTMLHelp] <br>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\HTMLHelp\1.x\HHRestrictions]<br>&quot;UrlAllowList&quot;=&quot;\\\\productmanuals\\helpfiles;http://www.wingtiptoys.com/help/&quot;</code></pre></div>You cannot use wildcard characters in the URL string of any site that is added to the UrlAllowList registry key. For example, you cannot use the following URL string: <div class='indent'>&quot;UrlAllowList&quot;=&quot;http://*.wingtiptoys.com&quot;</div>However, you can use the following URL string:<div class='indent'>&quot;UrlAllowList&quot;=&quot;http://help.wingtiptoys.com&quot;</div> This string lets the following sites host the HTML Help ActiveX control: <br> <ul class='sbody-free_list'><li>http://help.wingtiptoys.com/research</li><li>http://help.wingtiptoys.com/sales</li></ul><h3 class='sbody-h3'>Example 2: Use the MaxAllowedZone entry to enable a security zone</h3><span class='text-base'>Warning</span> The MaxAllowedZone entry enables all sites in a particular zone. Using the UrlAllowList entry may be safer. If you must use the MaxAllowedZone entry, set the value no higher than is required. If you set the MaxAllowedZone value to 3 or higher, you expose systems to attack from the Internet.<br><br><span class='text-base'>Note</span> By default, the value for the MaxAllowedZone entry is set to zero. The following table summarizes how different entries are interpreted by the value for the MaxAllowedZone entry. <br> <div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>MaxAllowedZone</span></td><td class='sbody-td'><span class='text-base'>Local Machine zone</span></td><td class='sbody-td'><span class='text-base'>Local intranet zone</span></td><td class='sbody-td'><span class='text-base'>Trusted sites zone</span></td><td class='sbody-td'><span class='text-base'>Internet zone</span></td><td class='sbody-td'><span class='text-base'>Restricted sites zone</span></td></tr><tr class='sbody-tr'><td class='sbody-td'>0</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Blocked</td><td class='sbody-td'>Blocked</td><td class='sbody-td'>Blocked</td><td class='sbody-td'>Blocked</td></tr><tr class='sbody-tr'><td class='sbody-td'>1</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Blocked</td><td class='sbody-td'>Blocked</td><td class='sbody-td'>Blocked</td></tr><tr class='sbody-tr'><td class='sbody-td'>2</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Blocked</td><td class='sbody-td'>Blocked</td></tr><tr class='sbody-tr'><td class='sbody-td'>3</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Blocked</td></tr><tr class='sbody-tr'><td class='sbody-td'>4</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Allowed</td><td class='sbody-td'>Allowed</td></tr></table></div>Paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension. This .reg file lets all content in the Intranet zone host the HTML Help ActiveX control.<div class='sbody-code'><pre><code>REGEDIT4<br>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\HTMLHelp]<br>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\HTMLHelp\1.x\HHRestrictions]<br>&quot;MaxAllowedZone&quot;=dword:00000001</code></pre></div><h3 class='sbody-h3'>Example 3: Use the UrlAllowList entry and the MaxAllowedZone entry</h3><span class='text-base'>Warning</span> The MaxAllowedZone entry enables all sites in a particular zone. Using the UrlAllowList entry may be safer. If you must use the MaxAllowedZone entry, set the value no higher than is required. If you set the MaxAllowedZone value to 3 or higher, you expose systems to attack from the Internet.<br><br>Paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension. The following .reg file lets all content in the Intranet zone host the HTML Help ActiveX control. This .reg file also lets two Internet sites host the control.<div class='sbody-code'><pre><code>REGEDIT4<br>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\HTMLHelp] <br>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\HTMLHelp\1.x\HHRestrictions]<br>&quot;MaxAllowedZone&quot;=dword:00000001<br><br>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\HTMLHelp\1.x\HHRestrictions]<br>&quot;UrlAllowList&quot;=&quot;http://www.wingtiptoys.com/;http://www.contoso.com/&quot;</code></pre></div><h3 class='sbody-h3'>Deploying the registry keys  across a domain</h3>We recommend that you use Group Policy to deploy the settings that are mentioned in the examples in this article as startup scripts. You can also deploy these settings as logon scripts. However, this method is less desirable because of permissions constraints.<br><br>The following steps are an example of how to deploy the settings in Example 1 as a Group Policy startup script. <br> <ol class='sbody-num_list'><li>Paste the following text into a text editor such as Notepad:<div class='sbody-code'><pre><code>REGEDIT4<br>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\HTMLHelp]<br>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\HTMLHelp\1.x\HHRestrictions]<br>&quot;UrlAllowList&quot;=&quot;http://myintranetapplication/help/helpfiles;http://www.wingtiptoys.com/help/helpdocuments&quot;</code></pre></div></li><li>Save the file as a .reg file. Name the file AllowTrustedSites.reg.</li><li>Paste the following text into a text editor such as Notepad:<div class='sbody-code'><pre><code>REGEDIT.EXE /S AllowTrustedSites.reg</code></pre></div></li><li>Save the file as a batch file. Name the file AllowTrustedSites.bat.</li><li>Import the batch file into the Group Policy object (GPO). To do this, follow these steps: <br><ol class='sbody-alpha_list'><li>Paste the batch file that you created in step 4 and the .reg file that you created in step 2 to the \\<span class='sbody-italic'>DomainName</span>\SysVol\<span class='sbody-italic'>DomainName</span>\Policies\<span class='sbody-italic'>GUID of the selected GPO</span>\Machine\Scripts\Startup folder. </li><li>On the computer on which you want to run the Group Policy object, click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type<br> <span class='sbody-userinput'>dsa.msc</span>, and then click <strong class='uiterm'>OK</strong>.</li><li>Right-click your domain, and then click<br> <strong class='uiterm'>Properties</strong>.</li><li>Click <strong class='uiterm'>Group Policy</strong>, and then click<br> <strong class='uiterm'>New</strong>.</li><li>Type the name that you want to use for this policy, and then press ENTER.</li><li>Click <strong class='uiterm'>Edit</strong>.</li><li>Expand <strong class='uiterm'>Computer Configuration</strong>, expand<br> <strong class='uiterm'>Windows Settings</strong>, and then click <strong class='uiterm'>Scripts (Startup/Shutdown)</strong>. </li><li>In the right panel, double-click<br> <strong class='uiterm'>Startup</strong>, and then click <strong class='uiterm'>Add</strong>.</li><li>Locate and then click the batch file that you created in step 4.</li><li>Click <strong class='uiterm'>Add</strong>.</li><li>Click <strong class='uiterm'>OK</strong>, click <strong class='uiterm'>Yes</strong>, and then click <strong class='uiterm'>OK</strong> two times.</li></ol></li></ol></div><div class='kb-moreinformation-section section'>If you  download an HTML Help .chm file  and either open it directly or save it locally and then open it, you may experience one or more of the following symptoms: <br><ul class='sbody-free_list'><li>Certain kinds of Web-based programs may not work correctly. For example, a table of contents in HTML Help may no longer work.<br></li><li>Certain HTML Help features may not work when you open a .chm file from a remote location. For example, the Related Topics feature may not work.</li></ul><span>For more informationhow to resolve this issue, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-4' href='/en-us/help/902225'>902225 </a> You cannot open HTML Help files from Internet Explorer after you install security update 896358 or Windows Server 2003 Service Pack 1<br><br></div></span><h3 class='sbody-h3'>Overview and examples for system administrators</h3><span>For more information about security update 896358 and how you can re-enable Web applications that are affected by this update, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-5' href='/en-us/help/896358'>896358 </a> MS05-026: A vulnerability in HTML Help could allow remote code execution<br><br></div></span><h3 class='sbody-h3'>Internet Explorer security zones</h3><span>For more information about how to use security zones in Internet Explorer, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-6' href='/en-us/help/174360'>174360 </a> How to use security zones in Internet Explorer<br><br></div></span><h3 class='sbody-h3'>Group Policy</h3>For more information about Group Policy, visit the following Microsoft Web sites: <br> <ul class='sbody-free_list'><li><a id='kb-link-7' href='http://technet.microsoft.com/en-us/library/cc779838(ws.10).aspx' target='_self'>Group Policy collection</a></li><li><a id='kb-link-8' href='http://technet.microsoft.com/en-us/library/cc737816(ws.10).aspx' target='_self'>What is Group Policy Object Editor?</a></li><li><a id='kb-link-9' href='http://technet.microsoft.com/en-us/library/cc784165(ws.10).aspx' target='_self'>Core Group Policy tools and settings</a></li></ul><h3 class='sbody-h3'>Technical support for x64-based versions of Microsoft Windows </h3>On computers that are running x64-based versions of Microsoft Windows, you may have to adapt the instructions in the &quot;Resolution&quot; section about how to modify the registry. For example, you might have to modify a different part of the registry, depending on whether you want to modify the 32-bit or the 64-bit functionality.<span>For more information, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-10' href='/en-us/help/896459'>896459 </a> Registry changes in x64-based versions of Windows Server 2003 and in Windows XP Professional x64 Edition<br><br></div></span>If your hardware came with an x64-based version of Microsoft Windows already installed, your hardware manufacturer provides technical support and assistance for the x64-based version. In this case, your hardware manufacturer provides support because an x64-based version was included with your hardware. Your hardware manufacturer might have customized the x64-based version installation by using unique components. Unique components might include specific device drivers or might include optional settings to maximize the performance of the hardware. Microsoft will provide reasonable-effort assistance if you need technical help with an x64-based version. However, you might have to contact your manufacturer directly. Your manufacturer is best qualified to support the software that your manufacturer installed on the hardware. If you purchased an x64-based version such as an x64-based version of  Microsoft Windows Server 2003 separately, contact Microsoft for technical support.<br><br>For product information about Microsoft Windows XP Professional x64 Edition, visit the following Microsoft Web site: <div class='indent'><a id='kb-link-11' href='http://www.microsoft.com/windowsxp/64bit/default.mspx' target='_self'>http://www.microsoft.com/windowsxp/64bit/default.mspx</a></div> For product information about x64-based versions of Microsoft Windows Server 2003, visit the following Microsoft Web site: <div class='indent'><a id='kb-link-12' href='http://www.microsoft.com/windowsserver2003/64bit/x64/editions.mspx' target='_self'>http://www.microsoft.com/windowsserver2003/64bit/x64/editions.mspx</a></div></div><div class='kb-securedata-section section'>hhctrl.ocx Winx64 Windowsx64 64bit 64-bit</div><div class='kb-securedata-section section'>Author: alewis<br>Writer: v-meidon; Lauracar<br>Tech reviewer:alewis<br>Editor: v-befaul<br>Rewrite editor: v-jocoop<br>Rewrite editor: v-tcarey (08/09/05)</div>