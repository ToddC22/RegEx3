<header><h1>Different ways to determine CPU speed in Windows XP or in Windows Server 2003</h1></header><div class='kb-notice-section section'><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/29181.asp' title='Link only available for Microsoft corporate network users' target='_blank'>29181 (Content Maintenance)</a></p></div></div></div></div><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/28820.asp' title='Link only available for Microsoft corporate network users' target='_blank'>28820 (Content Maintenance)</a></p></div></div></div></div></div><div class='kb-symptoms-section section'>This article describes the different locations  where CPU speed is reported in Microsoft Windows XP and in Microsoft Windows Server 2003.<br><br><br><br><br><span class='text-base'>Note</span> CPU speed may be reported differently in some locations. For example, the <strong class='uiterm'>System Properties</strong> dialog box displays basic information about your computer, including the computer&#39;s processor speed. However, the value for the processor speed in this dialog box may differ slightly from the manufacturer&#39;s specification. <br></div><div class='kb-moreinformation-section section'>In Windows XP and in Windows Server 2003, CPU speed is reported in the following locations:<br><br><ul class='sbody-free_list'><li>The <strong class='uiterm'>System Properties</strong> tab<br>To view the CPU speed on the <strong class='uiterm'>System Properties</strong> tab, right-click <strong class='uiterm'>My Computer</strong>, and then click <strong class='uiterm'>Properties</strong>. Click the <strong class='uiterm'>General</strong> tab. CPU information is listed in the first or second line of the <strong class='uiterm'>Computer</strong> area. <br><br>The CPU information that is listed in the <strong class='uiterm'>Computer</strong> area is retrieved from the ProcessorNameString entry under the following registry subkey:<br><br><div class='indent'><strong class='sbody-strong'>HKEY_LOCAL_MACHINE\HARDWARE\DESCRIPTION\System\CentralProcessor\0<br></strong></div><span class='text-base'>Note</span> In this example, <strong class='uiterm'>0</strong> refers to the first CPU in the computer. In a multiprocessor system, <strong class='uiterm'>1</strong> refers to the second physical CPU, or the second logical CPU in a system, such as a Intel hyper-threading technology system, that use multiple logical cores. <br><br>Windows reads the CPUID at startup and populates the ProcessorNameString entry accordingly. The CPUID string is the CPU brand string that is returned from the CPUID instruction. Some processors may include the CPU’s maximum-rated frequency as part of the CPU brand string. <br><br>The second or third line of the <strong class='uiterm'>Computer</strong> area is calculated by the kernel very early during the initialization of Windows. Computers that use processor power management features, such as Advanced Configuration and Power Interface (ACPI) processor performance state technologies, may start with the processor running in a decreased performance state.  This behavior reduces power consumption and avoids thermal problems until an ACPI-aware operating system can take control of these features. This initial speed setting is determined by the system designer and is controlled by the BIOS. When the system starts at a decreased performance state, the kernel performs the early CPU speed calculation before ACPI and the Windows processor driver have loaded. Therefore, the kernel incorrectly uses the reduced frequency rate to determine the maximum frequency of the processor.</li></ul></div><div class='kb-moreinformation-section section'>The source code appears to use current CPU speed unless the value is null. If the value is null, the source code uses maximum CPU speed. <br></div><div class='kb-moreinformation-section section'><ul class='sbody-free_list'><li>System Information utility<br>To use the System Information utility to see CPU speed, click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>Msinfo32</span>, and then click <strong class='uiterm'>OK</strong>. Click <strong class='uiterm'>System Summary</strong>. CPU speed is displayed in the <strong class='uiterm'>Processor</strong> line. <br><br>This information is updated dynamically whenever you run the System Information utility. The utility uses the Windows Management Instrumentation (WMI) component of the Windows operating system to retrieve the current processor performance state from the processor driver. </li><li>Help and Support Center<br>To use the Help and Support Center to see CPU speed, use one of the following methods.<br><br><ul class='sbody-free_list'><li>Method 1: View Detailed System Information<ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong>, and then click <strong class='uiterm'>Help and Support</strong>. </li><li>Click <strong class='uiterm'>What&#39;s new in Windows XP</strong>, click <strong class='uiterm'>Tools</strong>, click <strong class='uiterm'>Advanced System Information</strong>, and then click <strong class='uiterm'>View Detailed System Information</strong>.</li></ol></li><li>Method 2: My Computer Information<ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong>, and then click <strong class='uiterm'>Help and Support</strong>. </li><li>Click <strong class='uiterm'>Use Tools to view your computer information and diagnose problems.</strong></li><li> In the <strong class='uiterm'>Tools</strong> list, click <strong class='uiterm'>My Computer Information</strong>, and then click <strong class='uiterm'>Find information about the hardware installed on this computer</strong>. </li></ol></li></ul><span class='text-base'>Note</span> Both of these methods use the System Information utility to retrieve CPU information.</li><li><strong class='uiterm'>Device Manager</strong><br>To use Device Manager to determine CPU speed, click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>Devmgmt.msc</span>, and then click <strong class='uiterm'>OK</strong>. Expand <strong class='uiterm'>Processors</strong> to see  CPU information. <br><br>This information is retrieved from the FriendlyName entry under a registry subkey that is similar to the following: <br><br><div class='indent'><strong class='sbody-strong'>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\ACPI\GenuineIntel_-_x86_Family_15_Model_&lt;number&gt;\_0</strong></div><span class='text-base'>Note</span> In this example, <strong class='uiterm'>0</strong> refers to the first CPU in the computer. In a multiprocessor system, <strong class='uiterm'>1</strong> refers to the second physical CPU or to the second logical CPU in a multiple logical core processor system. <br><br>The information in the FriendlyName registry entry is retrieved directly from the CPU by  using the CPUID instruction from the processor driver. The information is retrieved when the driver is initialized or when the computer is restarted. If this information changes at some point, either because of corruption  or because of user modifications, this information is updated with information that is returned directly from the processor or processors. The CPU speed is referred to as the &quot;Brand String&quot; or the &quot;Friendly Name&quot;.</li></ul></div><div class='kb-moreinformation-section section'>The CPU speed that is reported in <strong class='uiterm'>Device Manager</strong> is retrieved directly from the processor. The Processor driver populates the FriendlyName registry entry for processor devices. The string that is displayed is retrieved directly from the processor by using CPUID extended functions 0x80000002 through 80000004.<br></div><div class='kb-moreinformation-section section'><ul class='sbody-free_list'><li>DirectX Diagnostic Tool<br>To view the CPU speed in the DirectX DiagnosticTool, click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>DXDiag</span>, and then click <strong class='uiterm'>OK</strong>. Click the <strong class='uiterm'>System</strong> tab. CPU information is displayed in the <strong class='uiterm'>Processor</strong> line. The DirectX Diagnostic Tool uses the CPUID to retrieve CPU speed information.<br><br></li><li>Windows Management Instrumentation Tester utility<br>You can use the Windows Management Instrumentation   Tester utility to determine the current speed (CurrentClockSpeed) and the maximum speed (MaxClockSpeed) of the CPU. WMI uses the WBEMTEST and WMIC tests to retrieve this information. <br><br>To use the WBEMTEST test to determine the current speed and the maximum speed, follow these steps:<br><ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>wbemtest</span>, and then click <strong class='uiterm'>OK</strong>.</li><li>Click <strong class='uiterm'>Connect</strong>. </li><li>In the namespace box at the top of the dialog box, type <span class='sbody-userinput'>root\cimv2</span>, and then click <strong class='uiterm'>Connect</strong>. </li><li>Click <strong class='uiterm'>Enum Classes</strong>. </li><li>Click <strong class='uiterm'>Recursive</strong>, and then click <strong class='uiterm'>OK</strong>.  Do not enter a superclass name. </li><li>Locate and then double-click <strong class='uiterm'>Win32_Processor (CIM_Processor)</strong>. </li><li>Click <strong class='uiterm'>Instances</strong>. The CPU instances on the computer are displayed. Double-click the CPU that you want. For example, double-click <strong class='uiterm'>Win32_Processor.DeviceID=&quot;CPUO&quot;</strong>. </li><li>In the <strong class='uiterm'>Properties</strong> box, scroll down  to see <strong class='uiterm'>MaxClockSpeed</strong> and <strong class='uiterm'>CurrentClockSpeed</strong>.</li></ol></li><li>System Monitor<br>If your computer supports ACPI processor performance states, such as  Enhanced Intel SpeedStep technology or AMD PowerNow! technology, you can use the System Monitor part of the Windows Performance tool to determine current CPU speed.<br><br>To  use System Monitor to determine CPU speed, follow these steps:<br><ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>perfmon</span>, and then click <strong class='uiterm'>OK</strong>.</li><li>Remove the default counters. </li><li>Right-click the chart, and then click <strong class='uiterm'>Add Counters</strong>.</li><li>Click <strong class='uiterm'>ProcessorPerformance</strong> in the <strong class='uiterm'>Performance object</strong> box. <br><br><br><br><span class='text-base'>Note</span> <br><br>If <strong class='uiterm'>ProcessorPerformance</strong> is not listed in the <strong class='uiterm'>Performance object</strong> box, follow these steps:<br><ol class='sbody-alpha_list'><li> In the <strong class='uiterm'>Performance object</strong> box, click <strong class='uiterm'>WMI Objects</strong>, click <strong class='uiterm'>HiPerf Classes</strong> in the list of counters, and then click <strong class='uiterm'>Add</strong>. </li><li>Click <strong class='uiterm'>Close</strong>, and then remove the <strong class='uiterm'>HiPerfClasses</strong> counter.</li><li>Right-click the chart, and then click <strong class='uiterm'>Add Counters</strong>.</li><li>Click <strong class='uiterm'>ProcessorPerformance</strong> in the <strong class='uiterm'>Performance object</strong> box. </li></ol></li><li>Click <strong class='uiterm'>% of Maximum Frequency</strong> in the list of counters, and then click <strong class='uiterm'>Add</strong>. Alternatively, you can click <strong class='uiterm'>Processor Frequency</strong> in the list of counters, and then click <strong class='uiterm'>Add</strong>.<br><br><br><br><span class='text-base'>Note</span> If you use the <strong class='uiterm'>Processor Frequency</strong> counter, you must also set the y-axis maximum scale to handle your processor’s maximum frequency. Otherwise, the counter will appear to run at the top of the scale. <br><br></li></ol>Windows uses processor performance states to comply with the power scheme and the processor dynamic throttling policy. To test demand-based switching, verify that your power scheme is set to<strong class='uiterm'> Portable/Laptop</strong> in <strong class='uiterm'>Power Options</strong> in Control Panel. This power scheme uses the Adaptive processor dynamic throttling policy.  Alternatively, you can use the Powercfg.exe utility to set your processor policy to Adaptive. <br><br><br><span>For additional information about the Powercfg.exe utility, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-1' href='/en-us/help/324347'>324347 </a>  How to use Powercfg.exe in Windows Server 2003<br><br></div></span><br>If you use an Adaptive processor policy, the current processor speed will change in response to an increased workload. On some portable computers, the system may limit the highest performance state currently available when on battery power. In this case, you will see the top frequency that is reported fall to a value that is lower than the frequency that the CPU runs at while on AC power. </li><li>Additional locations <br>There may be other locations where CPU speed information is displayed, depending on your computer hardware. For example, some computers display CPU speed when the computer first starts. The system BIOS may also show CPU speed. The information in these locations is not controlled by the operating system but  may be useful to help determine CPU speed. <br><br></li></ul></div><div class='kb-moreinformation-section section'>In Windows Server 2003 and in Windows XP, WMI primarily uses the NTPowerInformation API to obtain either maximum or current CPU speed. <br></div><div class='kb-moreinformation-section section'>The CPU returns all its information in registers. For more information about the CPUID, see pages 3 through 115 of the <span class='sbody-italic'>Intel IA-32 Architecture Guide VOL 2</span>. (See &quot;Table 3-6: Information Returned by CPUID Instruction&quot;.)<br><br><br><span>For information about how to contact the third-party companies mentioned in this article, visit the following Microsoft Web site: <div class='indent'><a id='kb-link-2' href='/gp/vendors' target='_self'>http://support.microsoft.com/gp/vendors</a></div></span><span>For additional information about how the processor speed is reported to a computer, click the following article numbers to view the articles in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-3' href='/en-us/help/312104'>312104 </a> How processor speed is reported to a computer<br><br></div></span><span><div class='indent'><a id='kb-link-4' href='/en-us/help/311051'>311051 </a> CPU speed in System Properties dialog box may differ from actual CPU speed<br><br></div></span>For information about the Microsoft support policy for multiprocessor systems and processor steppings, visit the following Microsoft Web page: <div class='indent'><a id='kb-link-5' href='http://www.microsoft.com/whdc/system/sysinternals/smp.mspx' target='_self'>http://www.microsoft.com/whdc/system/sysinternals/SMP.mspx</a></div><br><span>The third-party products that are discussed in this article are manufactured by companies that are independent of Microsoft. Microsoft makes no warranty, implied or otherwise, regarding the performance or reliability of these products.<br></span></div><div class='kb-securedata-section section'>Author: chwall<br>Contributors: Toddcar;Allenma;Seanwalk;Chwall<br>Writer: Darryl Gittins V-DGit <br>Tech Reviewer: Davidwin;chwall;Seanwalk <br>Microsoft Notify list: Davidwin;chwall;Seanwalk <br><br>Editor: v-crweb<br></div>