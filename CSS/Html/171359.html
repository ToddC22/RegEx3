<header><h1>FIX: DLLHOST.EXE Causes an Error with RPC_C_AUHN_LEVEL_NONE</h1></header><div class='kb-symptoms-section section'>Dllhost.exe is the system-provided surrogate that is used by a COM DLL (in- process) server to run in its own separate process. When the default (machine-wide) authentication is set to None on Windows NT 4.0, an error occurs during the launching of Dllhost.exe and it terminates. The client&#39;s creation API gets a CO_E_SERVER_EXEC_FAILURE error. This error does not occur under Windows 95.<br></div><div class='kb-cause-section section'>This is caused by a bug in the security initialization for Dllhost.exe.<br></div><div class='kb-resolution-section section'>Set the machine-wide COM authentication level to a value other than None to resolve this problem. You can use the DCOMCNFG utility to change the machine-wide authentication level. If the machine-wide authentication level must be None, then you can use a custom surrogate instead of Dllhost.exe.<br></div><div class='kb-status-section section'>Microsoft has confirmed this to be a bug in the Microsoft products listed at the beginning of this article.<br><br><span>This problem was corrected in Windows NT Service Pack 4 and Windows 2000.<br></span></div><div class='kb-moreinformation-section section'><h3 class='sbody-h3'>Steps to Reproduce Behavior</h3><ol class='sbody-num_list'><li>Use DCOMCNFG to set the machine-wide authentication level to None. To do this, run Dcomcnfg.exe, select the Default Properties tab and from the Default Authentication Level list box choose None. Click OK.</li><li>Run OLEVIEW and select any in-process DLL server object. Select the Implementation tab, and select the Use Surrogate Process check box. Select the Registry tab (this will add the DllSurrogate named value under the AppID key). From the OLEVIEW menu, choose Object...CoCreateInstance flags, select CLSCTX_LOCAL_SERVER and deselect all other items.</li><li>Instantiate the object from OLEVIEW. You will get the error message.</li></ol></div><div class='kb-securedata-section section'>kbbuglist</div><div class='kb-textlegacy-section section'>DOC INFO: DOC ID:14775 14775 DocTypeID: 1315870455; DS - Bug (confirmed bug) Author: SAJIA Written by: SAJIA KBPriority3 This bug has been fixed NT SP4 kbsweptCOM+ A-MALPUT Oct-23-1999 NTBUG:92760 Author: sajia (1997-07-14T15:29:00) Edit Reviewer: a-kathgl (1997-07-16T10:55:00) Tech Reviewer: sajia (1997-07-16T10:55:00)<br></div>