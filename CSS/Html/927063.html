<header><h1>Error message when you try to install a MSI package on a Windows Server 2003-based computer by using RDP connection: &quot;Windows Installer does not permit installation from a Remote Desktop Connection&quot;</h1></header><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/49048.asp' title='Link only available for Microsoft corporate network users' target='_blank'>49048 (Content Maintenance)</a></div><div class='kb-symptoms-section section'>Consider the following scenario:<ul class='sbody-free_list'><li>You try to install a Microsoft Windows Installer (MSI) package on a computer that is running Microsoft Windows Server 2003. You do this from another computer by using Remote Desktop Protocol (RDP) connection.</li><li>The computer that is running Windows Server 2003 has Microsoft Windows Installer 2.0.3790, or a later version of installed. </li></ul>In this scenario, you receive an error message on the computer that is running Windows Server 2003. This error message resembles the following:<div class='sbody-error'>Windows Installer does not permit installation from a Remote Desktop Connection.</div>When you view the verbose log file that was taken during the installation,  you see an error message that resembles the following:<div class='sbody-error'>MainEngineThread is returning 1645</div></div><div class='kb-cause-section section'>This problem occurs if the installation source is specified by using the TSClient share through Universal Naming Convention (UNC) notation.  For example, you receive the error when you use the following command:<div class='indent'><span class='text-base'>msiexec /i \\TSClient\<strong class='sbody-strong'>Drive</strong>\<strong class='sbody-strong'>package_name</strong>.msi</span></div></div><div class='kb-resolution-section section'>To resolve this problem, use one of the following methods. <h3 class='sbody-h3'>Method 1</h3> Do not use the TSClient share as an installation source. Use standard UNC notation to specify a specific server and share name. For example, use the following standard UNC notation:<div class='indent'><span class='text-base'>msiexec /i \\<strong class='sbody-strong'>server_name</strong>\<strong class='sbody-strong'>share_name</strong>\<strong class='sbody-strong'>package_name</strong>.msi</span></div><h3 class='sbody-h3'>Method 2</h3> Map a drive to the network location where the installation source exists. Specify the mapped drive in the installation command. For example, use the following installation command:<div class='indent'><span class='text-base'>msiexec /i <strong class='sbody-strong'>Drive</strong>:\<strong class='sbody-strong'>package_name</strong>.msi</span></div><span class='text-base'>Note</span> In this command, the <strong class='sbody-strong'>Drive</strong> placeholder represents the drive that is mapped to the \\<strong class='sbody-strong'>server_name</strong>\<strong class='sbody-strong'>share_name</strong> location.</div><div class='kb-moreinformation-section section'>You can use the TSClient share when the RDP connection is established and the local computer disk drives are added to the local resources for sharing. Letting the MSI package installation to continue is a security risk. This is because the TSClient share may point to different physical locations, depending on the user who logs on remotely. <br><br>Error 1645 was first included in Windows Installer version 2.0 for Windows Server 2003.<br><br>For more information about Windows Installer error codes, visit the following Microsoft Web site: <div class='indent'><a id='kb-link-1' href='http://msdn2.microsoft.com/en-us/library/aa368542.aspx' target='_self'>http://msdn2.microsoft.com/en-us/library/aa368542.aspx</a></div></div><div class='kb-securedata-section section'><span class='text-base'>Author: aldenr</span><br><span class='text-base'>Writer: v-sanair</span><br><span class='text-base'>Tech Reviewer: v-jomcc</span><br><span class='text-base'>Editor: v-tcarey</span></div>