<header><h1>FIX: You cannot apply Group Policy settings on a computer that is running Windows 7 or Windows Server 2008 R2 when security group filters are used in Group Policy preference settings</h1></header><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/122140.asp' title='Link only available for Microsoft corporate network users' target='_blank'>122140 (Content Maintenance)</a>BUG #: <a href='http://bugcheck/bugs/WindowsSE/292389.asp' title='Link only available for Microsoft corporate network users' target='_blank'>292389 (Windows SE)</a></div><div class='kb-symptoms-section section'>Consider the following scenario:<ol class='sbody-num_list'><li>You configure Group Policy preference settings in a Group Policy object.</li><li>You use a security group filter in these Group Policy preference settings. This filter checks whether the current computer belongs to a security group that is not empty.</li><li>This Group Policy object applies to a computer that is running Windows 7 or Windows Server 2008 R2. This computer does not belong to the security group that is specified in the security group filter.</li></ol>In this scenario, the Group Policy applying process stops, and Group Policy preference settings and other Group Policy settings cannot be applied.<br><br>When this issue occurs, the following event descriptions are added to the Application log:</div><div><h3 class='sbody-h3'>Hotfix information</h3><span> A supported hotfix is available from Microsoft. However, this hotfix is intended to correct only the problem that is described in this article. Apply this hotfix only to systems that are experiencing the problem described in this article. This hotfix might receive additional testing. Therefore, if you are not severely affected by this problem, we recommend that you wait for the next software update that contains this hotfix.<br><br>If the hotfix is available for download, there is a &quot;Hotfix download available&quot; section at the top of this Knowledge Base article. If this section does not appear, contact Microsoft Customer Service and Support to obtain the hotfix. <br><br><span class='text-base'>Note</span> If additional issues occur or if any troubleshooting is required, you might have to create a separate service request. The usual support costs will apply to additional support questions and issues that do not qualify for this specific hotfix. For a complete list of Microsoft Customer Service and Support telephone numbers or to create a separate service request, visit the following Microsoft Web site: <div class='indent'><a id='kb-link-1' href='/contactus/?ws=support' target='_self'>http://support.microsoft.com/contactus/?ws=support</a></div><span class='text-base'>Note</span> The &quot;Hotfix download available&quot; form displays the languages for which the hotfix is available. If you do not see your language, it is because a hotfix is not available for that language.</span><h4 class='sbody-h4'>Prerequisites</h4>To apply this hotfix, your computer must be running one of the following Windows operating systems:<ul class='sbody-free_list'><li>Windows 7</li><li>Windows Server 2008 R2</li></ul><h4 class='sbody-h4'>Restart requirement</h4><span>You do not have to restart the computer after you apply this hotfix.</span><h4 class='sbody-h4'>Hotfix replacement information</h4><span>This hotfix does not replace a previously released hotfix.</span><h4 class='sbody-h4'>File information</h4>The English (United States) version of this hotfix installs files that have the attributes that are listed in the following tables. The dates and the times for these files are listed in Coordinated Universal Time (UTC). The dates and the times for these files on your local computer are displayed in your local time together with your current daylight saving time (DST) bias. Additionally, the dates and the times may change when you perform certain operations on the files.<br><br><h5 class='sbody-h5 text-subtitle'>Windows 7 and Windows Server 2008 R2 file information notes<br></h5><br><br><span class='text-base'>Important</span> Windows 7 hotfixes and Windows Server 2008 R2 hotfixes are included in the same packages. However, hotfixes on the Hotfix Request page are listed under both operating systems. To request the hotfix package that applies to one or both of these operating systems, select the hotfix that is listed under &quot;Windows 7/Windows Server 2008 R2&quot; on the page. Always refer to the &quot;Applies To&quot; section in articles to determine the actual operating system that each hotfix applies to. The MANIFEST files (.manifest) and the MUM files (.mum) that are installed for each environment are <a managed-link="" href='#manifests' target="" bookmark-id='manifests'>listed separately</a> in the &quot;Additional file information for Windows Server 2008 R2 and for Windows 7&quot; section. MUM and MANIFEST files, and the associated security catalog (.cat) files, are extremely important to maintaining the state of the updated component. The security catalog files, for which the attributes are not listed, are signed with a Microsoft digital signature.<br><br><h5 class='sbody-h5 text-subtitle'>For all supported x86-based versions of Windows 7</h5><br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><th class='sbody-th'>File name</th><th class='sbody-th'>File version</th><th class='sbody-th'>File size</th><th class='sbody-th'>Date</th><th class='sbody-th'>Time</th><th class='sbody-th'>Platform</th></tr><tr class='sbody-tr'><td class='sbody-td'>Gpprefcl.dll</td><td class='sbody-td'>6.1.7600.20555</td><td class='sbody-td'>582,656</td><td class='sbody-td'>22-Oct-2009</td><td class='sbody-td'>06:19</td><td class='sbody-td'>x86</td></tr></table></div><h5 class='sbody-h5 text-subtitle'>For all supported x64-based versions of Windows 7 and of Windows Server 2008 R2</h5><br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><th class='sbody-th'>File name</th><th class='sbody-th'>File version</th><th class='sbody-th'>File size</th><th class='sbody-th'>Date</th><th class='sbody-th'>Time</th><th class='sbody-th'>Platform</th><th class='sbody-th'>Service branch</th></tr><tr class='sbody-tr'><td class='sbody-td'>Gpprefcl.dll</td><td class='sbody-td'>6.1.7600.20555</td><td class='sbody-td'>781,824</td><td class='sbody-td'>22-Oct-2009</td><td class='sbody-td'>06:48</td><td class='sbody-td'>x64</td><td class='sbody-td'>Not Applicable</td></tr><tr class='sbody-tr'><td class='sbody-td'>Gpprefcl.dll</td><td class='sbody-td'>6.1.7600.20555</td><td class='sbody-td'>582,656</td><td class='sbody-td'>22-Oct-2009</td><td class='sbody-td'>06:19</td><td class='sbody-td'>x86</td><td class='sbody-td'>WOW</td></tr></table></div><h5 class='sbody-h5 text-subtitle'>For all supported IA-64-based versions of Windows Server 2008 R2</h5><br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><th class='sbody-th'>File name</th><th class='sbody-th'>File version</th><th class='sbody-th'>File size</th><th class='sbody-th'>Date</th><th class='sbody-th'>Time</th><th class='sbody-th'>Platform</th></tr><tr class='sbody-tr'><td class='sbody-td'>Gpprefcl.dll</td><td class='sbody-td'>6.1.7600.20555</td><td class='sbody-td'>1,498,112</td><td class='sbody-td'>22-Oct-2009</td><td class='sbody-td'>05:06</td><td class='sbody-td'>IA-64</td></tr></table></div><span></span></div><div class='kb-securedata-section section'>If this hotfix is not posted for public download (meaning a public URL for this hotfix is not provided in this article), distribution requires technical lead, escalation team member, or manager approval and the following information applies:<br><br><ul class='sbody-free_list'><li>To receive the hotfix, customers must be experiencing the bug that is mentioned in the &quot;Symptoms&quot; section.</li><li> You must track the customers you send this to and supply them with the next service pack when it becomes available (if a service pack is released).</li></ul>This hotfix is scheduled to be included with Windows 7 Service Pack 1 and with Windows Server 2008 R2 Service Pack 1.<br><br></div><div class='kb-securedata-section section'>The &quot;Resolution&quot; section states whether this hotfix is available as a hotfix or in the latest service pack. For comparison and testing, the original hotfix is available on the <a id='kb-link-3' href='http://hotfix' target='_self'>http://hotfix</a> Web site.<br></div><div class='kb-resolution-section section'><span></span></div><div class='kb-status-section section'><span>Microsoft has confirmed that this is a problem in the Microsoft products that are listed in the &quot;Applies to&quot; section.</span></div><div class='kb-moreinformation-section section'><span>For more information about software update terminology, click the following article number to view the article in the Microsoft Knowledge Base:<div class='indent'><a id='kb-link-4' href='/en-us/help/824684'>824684 </a> Description of the standard terminology that is used to describe Microsoft software updates</div></span><span>For more information, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-5' href='/en-us/help/976398'>976398 </a> LDAP filters in the Group Policy preference settings do not take effect on a computer that is running Windows Server 2008 R2 or Windows 7<br><br></div></span><h3 class='sbody-h3'>Additional file information</h3><a class='bookmark' id='manifests'></a><h4 class='sbody-h4'>Additional file information for Windows 7 and for Windows Server 2008 R2</h4><a class='bookmark' id='manifests'></a><h5 class='sbody-h5 text-subtitle'>Additional files for all supported x86-based versions of Windows 7</h5><br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><th class='sbody-th'>File name</th><th class='sbody-th'>File version</th><th class='sbody-th'>File size</th><th class='sbody-th'>Date</th><th class='sbody-th'>Time</th><th class='sbody-th'>Platform</th></tr><tr class='sbody-tr'><td class='sbody-td'>Package_for_kb976399_rtm~31bf3856ad364e35~x86~~6.1.1.0.mum</td><td class='sbody-td'>Not Applicable</td><td class='sbody-td'>1,454</td><td class='sbody-td'>22-Oct-2009</td><td class='sbody-td'>18:12</td><td class='sbody-td'>Not Applicable</td></tr><tr class='sbody-tr'><td class='sbody-td'>X86_microsoft-windows-g..ppolicy-policymaker_31bf3856ad364e35_6.1.7600.20555_none_37c9998bc354d271.manifest</td><td class='sbody-td'>Not Applicable</td><td class='sbody-td'>53,968</td><td class='sbody-td'>22-Oct-2009</td><td class='sbody-td'>06:50</td><td class='sbody-td'>Not Applicable</td></tr></table></div><h5 class='sbody-h5 text-subtitle'>Additional files for all supported x64-based versions of Windows 7 and of Windows Server 2008 R2</h5><br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><th class='sbody-th'>File name</th><th class='sbody-th'>File version</th><th class='sbody-th'>File size</th><th class='sbody-th'>Date</th><th class='sbody-th'>Time</th><th class='sbody-th'>Platform</th></tr><tr class='sbody-tr'><td class='sbody-td'>Amd64_microsoft-windows-g..ppolicy-policymaker_31bf3856ad364e35_6.1.7600.20555_none_93e8350f7bb243a7.manifest</td><td class='sbody-td'>Not Applicable</td><td class='sbody-td'>53,972</td><td class='sbody-td'>22-Oct-2009</td><td class='sbody-td'>17:02</td><td class='sbody-td'>Not Applicable</td></tr><tr class='sbody-tr'><td class='sbody-td'>Package_for_kb976399_rtm~31bf3856ad364e35~amd64~~6.1.1.0.mum</td><td class='sbody-td'>Not Applicable</td><td class='sbody-td'>2,658</td><td class='sbody-td'>22-Oct-2009</td><td class='sbody-td'>18:12</td><td class='sbody-td'>Not Applicable</td></tr><tr class='sbody-tr'><td class='sbody-td'>Wow64_microsoft-windows-g..ppolicy-policymaker_31bf3856ad364e35_6.1.7600.20555_none_9e3cdf61b01305a2.manifest</td><td class='sbody-td'>Not Applicable</td><td class='sbody-td'>34,836</td><td class='sbody-td'>22-Oct-2009</td><td class='sbody-td'>06:38</td><td class='sbody-td'>Not Applicable</td></tr></table></div><h5 class='sbody-h5 text-subtitle'>Additional files for all supported IA-64-based versions of Windows Server 2008 R2</h5><br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><th class='sbody-th'>File name</th><th class='sbody-th'>File version</th><th class='sbody-th'>File size</th><th class='sbody-th'>Date</th><th class='sbody-th'>Time</th><th class='sbody-th'>Platform</th></tr><tr class='sbody-tr'><td class='sbody-td'>Ia64_microsoft-windows-g..ppolicy-policymaker_31bf3856ad364e35_6.1.7600.20555_none_37cb3d81c352db6d.manifest</td><td class='sbody-td'>Not Applicable</td><td class='sbody-td'>53,970</td><td class='sbody-td'>22-Oct-2009</td><td class='sbody-td'>07:11</td><td class='sbody-td'>Not Applicable</td></tr><tr class='sbody-tr'><td class='sbody-td'>Package_for_kb976399_rtm~31bf3856ad364e35~ia64~~6.1.1.0.mum</td><td class='sbody-td'>Not Applicable</td><td class='sbody-td'>1,954</td><td class='sbody-td'>22-Oct-2009</td><td class='sbody-td'>18:12</td><td class='sbody-td'>Not Applicable</td></tr></table></div></div><div class='kb-moreinformation-section section'><h3 class='sbody-h3'>Call stack information</h3><pre class='sbody-pre'>ChildEBP RetAddr Args to Child <br>01f1e70c 1692996a 025ab1e8 026ba794 026ba864 gpprefcl!RecursiveIsMember+0x4e <br>01f1e890 16929ed6 00a21090 a20ef000 3c81a1a2 gpprefcl!apmFilterSecurityGroup::isCompInGroup+0x426<br>01f1e9ac 16925989 00a20ef0 01f1eb84 3c81a36a gpprefcl!apmFilterSecurityGroup::Expand+0x34c <br>01f1eb64 16900eeb 00a20c18 01f1eb84 3c81a3a2 gpprefcl!apmFilterGroup::Expand+0x34a <br>01f1ebac 1690359b 00a1a508 3c81a4ba 01f1f01c gpprefcl!apmClientConfigs::handleFilter+0xd4 <br>01f1ecb4 16900dbf 00a203f8 00000000 3c81a50e gpprefcl!apmClientConfigs::handleClass+0x278 <br>01f1ed00 16903651 00a21160 00000000 3c81a602 gpprefcl!apmClientConfigs::HandleChildren+0x7d <br>01f1ee0c 169038f5 00a21160 00000000 00000000 gpprefcl!apmClientConfigs::handleClass+0x32e <br>01f1ee28 168fd693 00a21160 00000000 3c81a6b6 gpprefcl!apmClientConfigs::Execute+0x6f <br>01f1eeb8 168fe46d 013eb4d0 00a828f0 00a1a568 gpprefcl!apmClient::cseApplyGpoPolicies+0x136 <br>01f1ef64 1691e95e 3c81b082 168f2dac 168e0000 gpprefcl!apmClient::processGpoLists+0x314 <br>01f1f88c 1691ed3a 3c81b1b2 025a6020 0136f830 gpprefcl!apmCse::StartClient&lt;apmClientProfessional&gt;+0x52 <br>01f1f9bc 1691fbb9 168e0000 168f196c 168f2dac gpprefcl!apmCse::PolicyMain&lt;apmClientProfessional&gt;+0x14d <br>01f1fa48 6fe1e321 00000411 000007b0 80000002 gpprefcl!ProcessGroupPolicyExRegistry+0x64 <br>01f1fc34 6fe1e7a8 025a6020 0136f830 00000000 gpsvc!ProcessGPOList+0x4d3 <br>01f1fe7c 6fe17600 0136f830 26a6d118 00000000 gpsvc!ProcessGPOs+0x1d37 <br>01f1ff88 77e31174 013b3b68 01f1ffd4 77f1b3f5 gpsvc!GPOThread+0x451 <br>01f1ff94 77f1b3f5 013b3b68 760808f1 00000000 kernel32!BaseThreadInitThunk+0xe <br>01f1ffd4 77f1b3c8 6fe1729b 013b3b68 00000000 ntdll!__RtlUserThreadStart+0x70 <br> </pre></div><div class='kb-securedata-section section'><span><div class='kb-securedata-section section'><span class='text-base'>Author: stevenxu;fengli<br>Writer: v-stxu<br>Tech Reviewer: fengli;stevenxu<br>Editor: v-sbrenn</span></div></span></div>