<header><h1>Setup program crashes when you try to install a 2007 Office suite on a 64-bit version of Windows Server 2003</h1></header><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/Office12/762853.asp' title='Link only available for Microsoft corporate network users' target='_blank'>762853 (Office12)</a>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/65075.asp' title='Link only available for Microsoft corporate network users' target='_blank'>65075 (Content Maintenance)</a></div><div class='kb-symptoms-section section'>When you try to install a 2007 Microsoft Office suite on a 64-bit version of Microsoft Windows Server 2003, the 2007 Office suite Setup program may abruptly exit or crash.<br><br>You may also receive the following error message in the installation log file:<div class='sbody-error'>Error: failed MsiEnumProducts ErrorCode: 2(0x2). </div>Additionally, you  may receive the following error when you try to install a 2007 Office suite on a 64-bit Terminal Server: <div class='sbody-error'>Setup did not complete successfully. We are sorry for the inconvenience.</div></div><div class='kb-cause-section section'>This problem may occur when the 64-bit version of Windows Server 2003 is running Terminal Services in relaxed security mode. The 2007 Office suite Setup program is only supported when Terminal Services is running in full security mode. <br> <ul class='sbody-free_list'><li>Relaxed security mode provides an environment that is compatible with most legacy programs. It also emulates the Windows NT Server 4.0, Terminal Server Edition permissions compatibility mode.</li><li>Full security mode helps provides a secure environment, and programs must be written to run in the context of an ordinary user.</li></ul></div><div class='kb-workaround-section section'>To work around this issue, you must run Terminal Services in full security mode. When you run Terminal Services in full security mode, Terminal Server users will have the same permissions as members of the Users group. To do this, follow these steps: <br> <ol class='sbody-num_list'><li>Open <strong class='uiterm'>Terminal Services Configuration</strong>.<br></li><li>Click <strong class='uiterm'>Server Settings</strong>. </li><li>Right-click <strong class='uiterm'>Permission Compatibility</strong>, and then click <strong class='uiterm'>Properties</strong>. </li><li>Click to select the <strong class='uiterm'>Full Security</strong> check box, and then click <strong class='uiterm'>OK</strong>. </li></ol><span><span class='text-base'>Important</span> This section, method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/en-us/help/322756'>322756 </a> How to back up and restore the registry in Windows</div></span><br><br>Alternatively, follow these steps to work around this issue:<br> <ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>regedit</span>, and then click <strong class='uiterm'>OK</strong>.</li><li> Expand <strong class='uiterm'><strong class='sbody-strong'>HKEY_CLASSES_ROOT</strong></strong>, right-click<br><strong class='uiterm'><strong class='sbody-strong'>Wow6432Node</strong></strong>, point to<br><strong class='uiterm'>New</strong>, and then click <strong class='uiterm'>Key</strong>.</li><li>Right-click the new registry subkey, click<br><strong class='uiterm'>Rename</strong>, type <span class='sbody-userinput'>Installer</span>, and then press ENTER.</li><li> Right-click <strong class='uiterm'><strong class='sbody-strong'>Installer</strong></strong>, point to<br><strong class='uiterm'>New</strong>, and then click <strong class='uiterm'>Key</strong>.</li><li> Right-click the new registry subkey, click<br><strong class='uiterm'>Rename</strong>, type <span class='sbody-userinput'>Products</span>, and then press ENTER. </li><li> Exit Registry Editor.</li></ol></div><div class='kb-status-section section'><span>Microsoft has confirmed that this is a problem in the Microsoft products that are listed in the &quot;Applies to&quot; section.</span></div><div class='kb-moreinformation-section section'>If you are using a Retail version of a 2007 Office suite or program, the suite or program may not run. <br> <span>For more information, click the following article number about this issue to view the article about this issue in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-2' href='/en-us/help/924622'>924622 </a> Error message when you try to start a 2007 Office program within a Terminal Server client session: &quot;This copy of Microsoft Office &lt;Program&gt; cannot be used on Terminal Server&quot;<br><br></div></span></div><div class='kb-securedata-section section'>OFF2007 Office2007 Office 2007</div><div class='kb-securedata-section section'><span class='text-base'>Author: sloanc</span><br><span class='text-base'>Writer: v-johnre</span><br><span class='text-base'>Tech Reviewer: off12set</span><br><span class='text-base'>Editor: v-rmart</span></div>