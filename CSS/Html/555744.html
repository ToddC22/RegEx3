<header><h1>NETSH INTERFACE PORTPROXY do not work when doing port redirection between IPv4 and IPv4 addresses.</h1></header><div class='kb-notice-section section'>Andrei Ungureanu MVP</div><div class='kb-notice-section section'><div class='kb-disclaimer-msi'>MICROSOFT CORPORATION AND/OR ITS RESPECTIVE SUPPLIERS MAKE NO REPRESENTATIONS ABOUT THE SUITABILITY, RELIABILITY, OR ACCURACY OF THE INFORMATION AND RELATED GRAPHICS CONTAINED HEREIN. ALL SUCH INFORMATION AND RELATED GRAPHICS ARE PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND. MICROSOFT AND/OR ITS RESPECTIVE SUPPLIERS HEREBY DISCLAIM ALL WARRANTIES AND CONDITIONS WITH REGARD TO THIS INFORMATION AND RELATED GRAPHICS, INCLUDING ALL IMPLIED WARRANTIES AND CONDITIONS OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, WORKMANLIKE EFFORT, TITLE AND NON-INFRINGEMENT.  YOU SPECIFICALLY AGREE THAT IN NO EVENT SHALL MICROSOFT AND/OR ITS SUPPLIERS BE LIABLE FOR ANY DIRECT, INDIRECT, PUNITIVE, INCIDENTAL, SPECIAL, CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER INCLUDING, WITHOUT LIMITATION, DAMAGES FOR LOSS OF USE, DATA OR PROFITS, ARISING OUT OF OR IN ANY WAY CONNECTED WITH THE USE OF OR INABILITY TO USE THE INFORMATION AND RELATED GRAPHICS CONTAINED HEREIN, WHETHER BASED ON CONTRACT, TORT, NEGLIGENCE, STRICT LIABILITY OR OTHERWISE, EVEN IF MICROSOFT OR ANY OF ITS SUPPLIERS HAS BEEN ADVISED OF THE POSSIBILITY OF DAMAGES.</div></div><div class='kb-summary-section section'><div class='indent'><span class='sbody-italic'>The Netsh.exe can be used as a port redirector for the TCP protocol.</span></div></div><div class='kb-symptoms-section section'>Rules for port redirection are set by using &lt;add v4tov4&gt; command but are not working.<br>&#160;<br></div><div class='kb-cause-section section'>Netsh.exe is a tool an administrator can use to configure and monitor Windows-based computers at a command prompt. The Netsh.exe tool direct the context commands you enter to the appropriate helper, and the helper then carries out the command. A helper is a Dynamic Link Library (.dll) file that extends the functionality of the Netsh.exe tool by providing configuration, monitoring, and support for one or more services, utilities, or protocols. The &lt;add v4tov4&gt; command is sent to the IPV6MON.DLL helper, and because of that&#160;it will work only if IPv6 protocol is installed.<br>This is the output of the SHOW HELPER command:<br>netsh interface portproxy&gt;show helper<br>Helper GUID&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; DLL Filename&#160; Command<br>--------------------------------------&#160; ------------&#160; -------<br>{05BB0FE9-8D89-48DE-B7BB-9F138B2E950C}&#160; IPV6MON.DLL&#160;&#160;&#160;&#160; ipv6<br>{F1EFA7E5-7169-4EC0-A63A-9B22A743E19C}&#160; IPV6MON.DLL&#160;&#160;&#160;&#160;&#160;&#160; 6to4<br>{F1EFA7E5-7169-4EC0-A63A-9B22A743E19C}&#160; IPV6MON.DLL&#160;&#160;&#160;&#160;&#160;&#160; isatap<br>{86A3A33F-4D51-47FF-B24C-8E9B13CEB3A2}&#160; IPV6MON.DLL&#160;&#160;&#160;&#160; portproxy<br></div><div class='kb-resolution-section section'>Install IPv6 protocol.<br></div><div class='kb-moreinformation-section section'>Here is an example on how to use NETSH INTERFACE PORTPROXY to forward all requests&#160;that came to local IP on port 25 to&#160;192.168.0.100 on port 80.<br>c:\&gt;netsh<br>netsh&gt;interface portproxy<br>netsh interface portproxy&gt;add v4tov4 listenport=25 connectaddress=192.168.0.100 connectport=80 protocol=tcp<br>&#160;<br>A help for NETSH commands for INTERFACE PORTPROXY can be found here:<br><br>&#160;<br></div>