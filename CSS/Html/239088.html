<header><h1>Windows 2000 or Windows Server 2003 Terminal Services server logs events 1111, 1105, and 1106</h1></header><div class='kb-symptoms-section section'> Windows 2000 Terminal Services and Windows Server 2003 Terminal Services support the automatic redirection of printers that are configured to use local ports (such as LPT1, LPT2, or LPT3) on computers that have open client sessions through the Remote Desktop Protocol (RDP) 5 client. This printer redirection occurs at logon, and occurs by default. <br><br> However, if you are using third-party drivers or some Microsoft Windows 95/Microsoft Windows 98 drivers on the client, printer redirection does not work. When this occurs, the following error messages are logged in the System event log on the server: <div class='indent'>Type: Error<br>Event ID: 1111<br>Description: Driver <strong class='sbody-strong'>drivername</strong> required for printer <strong class='sbody-strong'>printertype</strong> is unknown. Contact the administrator to install the driver before you log in again. <br><br>Type: Error<br>Event ID: 1105<br>Description: Printer security information for the <strong class='sbody-strong'>printername</strong>/<strong class='sbody-strong'>clientcomputername</strong>/Session <strong class='sbody-strong'>number</strong> could not be set. <br><br>Type: Error<br>Event ID: 1106<br>Description: The printer could not be installed.<br></div></div><div class='kb-cause-section section'> When a client logs on, the Windows 2000-based server or the Windows Server 2003-based server checks the name of the printer driver on the client and looks for the same printer driver name in the Ntprint.inf file. If the name of the driver is not found, the error messages are logged and the printer is not redirected.<br> </div><div>Prior to Windows 2000 Service Pack 2, you had to edit the Ntprint.inf file to fix this problem. This broke the digital signature on Ntprint.inf and caused the system to return a warning each time a user installed a new printer. The following steps are currently the recommended method of fixing this problem and require that the Windows 2000 Service Pack 2 or later be applied first. If you use Windows Server 2003, you do not have to install a specific service pack to perform these steps. This allows you to specify a different .inf file in the registry for Windows to see if it is not able to locate the driver in Ntprint.inf.<br><br><span class='text-base'>Important</span> The Event 1110 error may also be caused by an incorrect INF name reference in the <span class='text-base'>PrinterMappingINFName</span> value that you add. Make sure that you use the correct INF name. <br> </div><div class='kb-securedata-section section'> (or the post-SP1 hot fix from Q275495) </div><div class='kb-resolution-section section'><span><span class='text-base'>Important</span> This section, method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/en-us/help/322756'>322756 </a> How to back up and restore the registry in Windows</div></span><ol class='sbody-num_list'><li>Open Regedt32.exe and locate the following key: <div class='indent'><span class='text-base'>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd</span></div></li><li>Add the following values:<div class='indent'>Name: <span class='text-base'>PrinterMappingINFName</span><br> Type: REG_SZ<br> Data: Name of the .inf file to which you want to redirect lookups.<br> Example: c:\winnt\inf\ntprintsubs.inf<br><br>Name: <span class='text-base'>PrinterMappingINFSection</span><br> Type: REG_SZ<br> Data: Name of the section in the .inf file to which you want to redirect lookups. Example: Printers<br></div></li></ol> After you add the new registry values, create or modify an .inf file to include the user-defined mappings from the client-side to server-side drivers. To do this, follow the following example:<br><br> Example of the format for creating a new .inf file: <pre class='sbody-pre'><br>[Version]<br>Signature=&quot;$CHICAGO$&quot;<br><br>[Printers]<br>&quot;OEM Printer Driver Name&quot; = &quot;&lt;?xm-deletion_mark author=&quot;v-vincli&quot; time=&quot;20071120T143949+0800&quot; data=&quot;Windows 2000 &quot;?&gt;Printer Driver Name&quot;<br> </pre> Such as: <pre class='sbody-pre'><br>&quot;HP DeskJet 720C Series v10.3&quot;  =  &quot;HP DeskJet 722C&quot;<br> </pre> The left side of the &quot;=&quot; is the exact name of the printer driver associated with the client-side print queue that is being redirected to the server. The right side of the &#39;=&#39; is the exact name of the server-side driver equivalent that is installed on the Terminal Server.<br><br> The friendly printer name that is displayed when you click <span class='text-base'>Start</span>, click <span class='text-base'>Setting</span>, and then click <span class='text-base'>Printers</span> on the client may not be the actual printer driver name that should be redirected to point to a print driver on the Terminal Server. To find the printer driver name to add to the left side of the equal sign in the .inf file that you create, look in the system event log on the Terminal Server at the Event ID 1111&#39;s being logged. The Event ID 1111 contains the actual printer driver name that is failing to be redirected. Some Event ID 1111&#39;s also contain printer resources on the client that cannot and must not be redirected like fax drivers or software printers. If you do not know the printer driver name to add to the right side of the equal sign in the .inf file, you can install the printer on the server. After the printer is installed the printer driver name appears to the right of &quot;Model:&quot; under the &quot;General&quot; tab of the printer properties. When possible the built in print drivers that are included with the operating system, signed, or WHQL print drivers should be used to improve system stability. <br><br> This example instructs Windows 2000 and Windows Server 2003 to use the HP DeskJet 722C driver when a client with Hewlett-Packard&#39;s HP DeskJet 720C Series v10.3 driver connects. These names must match exactly, with the exact same spacing; the names are also case sensitive.<br><br><span class='text-base'>NOTE</span>: The format of the [Previous Names] section in Ntprint.inf is exactly the reverse of the user-defined .inf. In Ntprint.inf, the client-side driver is on the right and the server-side driver is on the left.<br><br> You can create this file with Notepad and you must save it with a .inf file name extension. In this example, you would specify the .inf file name that you just created in the <span class='text-base'>PrinterMappingINFName</span> registry value and &quot;Printers&quot; in the <span class='text-base'>PrinterMappingINFSection</span> registry value.<br><br> When a client connects, the computer will first see if a user-defined .inf has been defined in the registry. If so, it will then see if there is a match to the client-side driver to use it. If one does not exist, it then sees if there is mapping defined in the [Previous Names] section of Ntprint.inf to use that. If there is not, it will try to install the server-side printer using the name of the client-side printer driver as a direct map to a server-side driver. If no drivers are found, you will receive the error messages mentioned in this article. <br><br> If the custom .inf file contains syntax errors, you may receive the following message in the event log: <div class='indent'>Event 1110: &quot;Error processing ntprint.inf. If the file on the system is corrupt, you can restore it from the installation media.<br></div> This message is misleading because it refers to the Ntprint.inf. Although this error may really mean that the Ntprint.inf is corrupted, it frequently refers to errors in the custom .inf file.<br><br> The custom .inf file must have at least one mapping in its printer name mapping section. If the custom .inf file has a blank name-mapping section, you may receive Event 1110 in the event log. You must restart the Spooler service or reboot the Terminal Server for these changes to take affect. <br><br><h3 class='sbody-h3'>Terminal Server Printer Driver Redirection Wizard</h3>The Terminal Server Printer Driver Redirection Wizard  automates the process of creating the .inf file. The wizard helps you troubleshoot and replace print drivers that were unsuccessfully redirected.<br><br><span>The following file is available for download from the Microsoft Download Center:<br></span><br><br><span><img class="graphic" src="/library/images/support/kbgraphics/public/en-us/download.gif" alt="Download " title="Download "><a id='kb-link-2' href='http://download.microsoft.com/download/9/f/2/9f237742-e057-4e00-a0d5-62de2ebf9fbd/tspdrw_package.exe' target='_self'>Download the 9f237742-e057-4e00-a0d5-62de2ebf9fbd/TSPDRW_Package.exe package now.</a></span></div><div class='kb-moreinformation-section section'> Printer redirection is not possible with the RDP 4 client in Windows NT Server 4.0, Terminal Server Edition. In a Windows NT 4.0 Terminal Server environment, you must use Citrix MetaFrame and the Independent Computing Architecture (ICA) client to redirect client printers.<br><br> For information about how to perform this procedure for Citrix ICA clients, see the following Microsoft Knowledge Base article: <br> <span><div class='indent'><a id='kb-link-3' href='/en-us/help/214593'>214593 </a> Windows Terminal Server with MetaFrame ICA client cannot autocreate some printers<br><br></div></span></div><div class='kb-securedata-section section'>terminalsvr auto-create auto-creation</div><div class='kb-textlegacy-section section'>NTBUG:317176 Author: JBOLLING (1999-08-09T13:21:00) Edit Reviewer: davidg (1999-08-11T07:28:00) Tech Reviewer: WWOODARD (2000-05-30T14:00:00) </div>