<header><h1>You may not be able to connect to an instance of SQL Server 2000 Service Pack 2 or earlier that is installed on a Windows Server 2003 computer through the TCP/IP port</h1></header><div class='kb-symptoms-section section'>You may not be able to connect to an instance of Microsoft SQL Server 2000 Service Pack 2 (SP2) or to an earlier version of Microsoft SQL Server 2000 through a TCP/IP port. This problem occurs when the following conditions are true:<br><br><ul class='sbody-free_list'><li>You try to connect to an instance of SQL Server 2000 that is installed on a computer that is running Microsoft Windows Server 2003.</li><li>You try to connect to an instance of SQL Server 2000 from a remote computer on your network.<br></li></ul><br><br>Additionally, you may receive one of the following error messages:<br><br><span class='text-base'>Error message 1</span><div class='sbody-error'><br>[TCP/IP Sockets]SQL Server does not exist or access denied.<br><br>[TCP/IP Sockets]ConnectionOpen (Connect()).</div><br><span class='text-base'>Error message 2</span><div class='sbody-error'><br>Unable to connect to server <strong class='sbody-strong'>&lt;SQL Server Instance Name&gt;</strong>:<br><br><br>Server: Msg 17, Level 16, State 1<br><br>[Microsoft][ODBC SQL Server Driver][TCP/IP Sockets]SQL Server does not exist or access denied.</div><br><span class='text-base'>Error message 3</span><div class='sbody-error'><br>Connection failed:<br>SQLState: &#39;01000&#39;<br>SQL Server Error: 10061<br>[Microsoft][ODBC SQL Server Driver][TCP/IP Sockets]ConnectionOpen (Connect()).<br><br> <br>Connection failed:<br>SQLState: &#39;08001&#39;<br>SQL Server Error: 11<br>[Microsoft][ODBC SQL Server Driver][TCP/IP Sockets]General network error. Check your network documentation.</div><br><br><br><br><span class='text-base'>Note</span> You may also notice this behavior when you try to connect to an instance of Microsoft SQL Server 2000 Service Pack 3 (SP3) or to a later version of SQL Server 2000 that is installed on a computer that is running Window Server 2003, if the instance of SQL Server 2000 SP2 or the earlier version of SQL Server 2000 is installed on the same computer.</div><div class='kb-cause-section section'>Because the Windows Server 2003 family does not support SQL Server 2000 SP2 or earlier versions of SQL Server 2000, Windows Server 2003 blocks both the TCP/IP network ports and the UDP network ports that are required to connect to an instance of SQL Server 2000. Therefore, you cannot connect to an instance of SQL Server from a remote computer on your network by using the TCP/IP protocol.</div><div class='kb-resolution-section section'>To resolve this problem, upgrade all the instances of SQL Server 2000 that are running on a Windows Server 2003-based computer to SQL Server 2000 Service Pack 3 (SP3) or to a later version of SQL Server 2000.<br><br><span>For additional information about how to obtain latest service pack for SQL Server 2000, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-1' href='/en-us/help/290211'>290211 </a> How to obtain the latest SQL Server 2000 service pack<br><br></div></span><br><br><span class='text-base'>Note</span> You cannot work around this problem. You must  upgrade all the instances of  SQL Server 2000 to SQL Server 2000 SP3 or to a later version of SQL Server 2000.</div><div class='kb-status-section section'><span> This behavior is by design.</span></div><div class='kb-moreinformation-section section'>When you install an instance of SQL Server 2000 SP2 or an earlier version of SQL Server 2000 on a computer that is running Windows Server 2003, Windows Server 2003 logs an Information event that is similar to the following in the application log. The message states that the instance of SQL Server is vulnerable to virus attacks. <br><br><div class='sbody-error'><br>Type: Information<br>Source: MSSQLSERVER/MSDE <br><br>Category: None <br><br>Event ID: 1<br>Date: 5/6/2004 <br><br>Time: 5:29:24 AM <br><br>User: N/A <br><br>Computer: &lt;Computer Name&gt;<br><br>Description: <br><br><br>You are running a version of Microsoft SQL Server 2000 or Microsoft SQL Server 2000 Desktop Engine (also called MSDE) that has known security vulnerabilities when used in conjunction with the Microsoft Windows Server 2003 family.  To reduce your computer&#39;s vulnerability to certain virus attacks, the TCP/IP and UDP network ports of Microsoft SQL Server 2000, MSDE, or both have been disabled.  To enable these ports, you must install a patch, or the most recent service pack for Microsoft SQL Server 2000 or MSDE from http://technet.microsoft.com/en-us/sqlserver/bb331754.aspx<br><br><br><br>For more information, see Help and Support Center at http://support.microsoft.com.</div></div><div class='kb-references-section section'><span>For additional information, click the following article numbers to view the articles in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-2' href='/en-us/help/841375'>841375 </a> A message stating that an instance of SQL Server is vulnerable to virus attacks is logged in the application event log when you install SQL Server 2000 or MSDE 2000 on a computer that is running Windows XP Service Pack 2<br><br></div></span><br><span><div class='indent'><a id='kb-link-3' href='/en-us/help/815431'>815431 </a> Installation of a named instance of SQL Server 2000 virtual server on a Windows 2003-based cluster fails<br><br></div></span><br><span><div class='indent'><a id='kb-link-4' href='/en-us/help/328306'>328306 </a> Potential causes of the &quot;SQL Server does not exist or access denied&quot; error message<br><br></div></span><br><span><div class='indent'><a id='kb-link-5' href='/en-us/help/329329'>329329 </a> Windows Server 2003 support for SQL Server 2000<br><br></div></span><br><br></div><div class='kb-securedata-section section'>Author: <br>Writer: vellayappan.annapoorna@wipro.com (KMS ID: Partners\v-9annap)<br>Tech Reviewer: jayashree.kota@wipro.com (KMS ID: v-9jayashreek)<br>Editor: Vernettp </div>