<header><h1>Description of the Point and Print Restrictions policy setting in Windows Server 2003 and Windows XP</h1></header><div class='kb-summary-section section'> If you are using Windows XP, you can use the Point and Print functionality to print to shared printers that are hosted on computers that are running Microsoft Windows NT 4.0, Microsoft Windows 2000, Windows XP, and Windows Server 2003. If you use the Point and Print functionality to connect to a shared printer, the print driver for that shared printer is automatically downloaded to your workstation. This article describes how to use the Point and Print Restrictions policy setting. <br><br><span class='text-base'>Note</span> It is possible for malicious users to embed viruses or other malicious code into a print driver. If you receive a damaged driver from a shared printer, your computer may be compromised. </div><div> Windows Server 2003 and Windows XP Service Pack 1 (SP1) include the Point and Print Restrictions policy setting. If you are an administrator, you can use this policy setting to control the servers that users can connect to for printing. This policy setting does not affect users who are members of the Administrators group. Additionally, this policy setting does not affect users who use the Point and Print functionality with shared printers that are hosted by computers that are running either Microsoft Windows 95, Microsoft Windows 98, Microsoft Windows 98 Second Edition, or Microsoft Windows Millennium Edition (Me) (these platforms cannot supply drivers). In this scenario, you must have Administrator rights to create connections.<br><br> The Point and Print Restrictions policy is located in the following location in Group Policy Object Editor: <div class='indent'>User Configuration\Administrative Templates\Control Panel\Printers<br></div> You can configure the Point and Print Restrictions Group Policy setting in any of the following ways: <br> <ul class='sbody-free_list'><li>If you set the policy setting to <span class='text-base'>Enabled</span> and you select the <strong class='uiterm'>Users can only Point and Print to machines in their Forest</strong> check box, users can use the Point and Print functionality to select only computers that have active computer accounts in the same forest as the user. <br><br><span class='text-base'>Note</span> Cross-forest trust relationships are not supported by this policy setting. This is so that this policy setting can be effective for shared printers in Windows NT 4.0 and later environments. </li><li>If you set the policy setting to <span class='text-base'>Enabled</span> and you select the <strong class='uiterm'>Users can only Point and Print to these servers</strong> check box, users can use the Point and Print functionality to select only the servers that are listed. When you add servers to this list, you must use their fully qualified domain names (FQDNs) and use a semi-colon (;) to separate the FQDNs. Also, you cannot put any spaces between the FQDNs and the semicolon (<span class='text-base'>;</span>). For example: <div class='indent'>server1.domain1.microsoft.com;server2.domain1.microsoft.com</div> To locate the FQDN of a server, click the <span class='text-base'>Computer Name</span> tab in System Properties.</li><li>If you set the policy to <span class='text-base'>Enabled</span> and you select both the <strong class='uiterm'>Users can only Point and Print to machines in their Forest</strong> check box and the <strong class='uiterm'>Users can only Point and Print to these servers</strong> check box, users can use the Point and Print functionality to select any server in their forest and any servers that are explicitly listed. You can use this configuration to grant the user the ability to use the Point and Print functionality to select any server in their forest and specific servers that are outside the forest.</li><li>If you set the policy to <span class='text-base'>Disabled</span>, users can use the Point and Print functionality to select any shared printer they have access to.</li><li>By default, this policy setting is not configured. If you do not configure this policy setting,  users cannot download Point and Print drivers from computers that are not in their Active Directory forest. The result of not configuring the setting is the same as enabling the policy and setting it to <strong class='uiterm'>Users can only Point and Print to machines in their Forest</strong>.</li><li>The policy can also be set under the following registry subkey:<br><br><strong class='sbody-strong'>HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint</strong><br><br>Value:  InForest<br>Type:   REG_DWORD<br>Data:  0 or 1<br>A setting of 0 disables this entry.  A setting of 1 restricts printer access to  printers in the forest.<br><br>Value:  Restricted<br>Type:   REG_DWORD<br>Data:  0 or 1<br>A setting of 0 disables this entry.  A setting of 1 restricts all printers.<br><br>Value:  TrustedServers<br>Type:   REG_DWORD<br>Data:  0 or 1<br> A setting of 0 disables this entry.  A setting of 1 allows printers from the servers in Server List.<br><br>Value:  ServerList<br>Type:   String<br>Data: <strong class='sbody-strong'>Trusted server list separated by semicolons</strong><br></li></ul> If you try to connect to a shared printer that is running on a computer that this policy setting does not permit you to access, Windows tries to find and install the appropriate driver and the Driver.cab file on the your local computer. If Windows cannot find a suitable driver, you receive the following error message, which indicates that a policy setting is preventing this action: <div class='sbody-error'> A policy is in effect on your computer which prevents you from connecting to this print queue. Please contact your system administrator. </div><span class='text-base'>Note</span> This message also occurs when you use OEM print drivers if the reverse lookup zone for the print server is not working correctly, and if the client cannot resolve the IP address of the print server to the fully qualified domain name (FQDN). If the <span class='text-base'>NSLOOKUP &lt;IP_Address_Of_Printserver&gt;</span> command does not resolve a server name, the client cannot resolve the IP address of the print server to the FQDN.<br><br><span>For additional information, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-1' href='/en-us/help/323445'>323445 </a> How to create a new zone on a DNS Server in Windows Server 2003<br><br></div></span></div><div class='kb-securedata-section section'>IDS_TEXT_POINTANDPRINT_POLICY</div><div class='kb-securedata-section section'>IDS_TEXT_POINTANDPRINT_WARNING</div><div class='kb-moreinformation-section section'> Similarly, if you are using a computer that is not a member of a domain, the computer is not subject to any of the configurations of this policy setting. You receive the following informational message: <div class='indent'>You are about to connect to a printer on -SERVERNAME-, which will automatically install a print driver on your machine. Printer drivers may contain viruses or scripts that can be harmful to your computer. It is important to be certain that the computer sharing this printer is trustworthy. Would you like to continue?<br></div><span>For additional information, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-2' href='/en-us/help/314073'>314073 </a> How to troubleshoot network printing problems in Windows XP<br><br></div></span> If you are a mobile user and you travel with your laptop computer, Microsoft recommends that you either set this policy to <span class='text-base'>Disabled</span> or that you ask your administrator to give you administrative rights on your computer so that you can connect to shared printers while you are traveling.<br><br> The following policy settings are related to the Point and Print Restrictions policy setting: <br> <ul class='sbody-free_list'><li>Policy setting: Add Workstations to Domain<br> Location: Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment</li><li>Policy setting: Prevent Users from Installing Printer Drivers<br> Location: Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options </li></ul></div><div class='kb-textlegacy-section section'>Windows Bugs:565316 Author: JBOLLING (2002-03-18T14:08:00) Edit Reviewer: V-JANHAL (2002-06-03T17:46:00) Tech Reviewer: JAMIRC (2002-05-29T09:32:00) </div>