<header><h1>Startup may take longer than usual and you may receive an &quot;At least one of services failed to start&quot; error message</h1></header><div class='kb-notice-section section'><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/19426.asp' title='Link only available for Microsoft corporate network users' target='_blank'>19426 (Content Maintenance)</a></p></div></div></div></div></div><div class='kb-notice-section section'><span><span class='text-base'>Important</span> This article contains information about modifying the registry. Before you modify the registry, make sure to back it up and make sure that you understand how to restore the registry if a problem occurs. For information about how to back up, restore, and edit the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/en-us/help/256986'>256986 </a> Description of the Microsoft Windows Registry</div></span></div><div class='kb-symptoms-section section'>In Microsoft Windows Server 2003, startup may take longer than usual and you may receive the following error message:<div class='sbody-error'>At least one of services  or driver failed during system startup. Use Event Viewer to examine the event log for details.<br></div><span class='text-base'>Note</span> If Microsoft Background Intelligent Transfer Service (BITS) has any pending jobs, BITS will be set to automatically start at startup, and you may notice this behavior.</div><div class='kb-cause-section section'>This behavior occurs because of a race condition. In Windows Server 2003, BITS depends on the EventSystem service. Therefore, if BITS starts before the EventSystem service starts, BITS tries to start the EventSystem service and then waits until the EventSystem service starts. However, even after the timeout period (typically, 80 seconds), if the EventSystem service does not start, the Service Control Manager (SCM) causes BITS to timeout and then adds a message in the event log. Then, you receive the &quot;At least one of services failed to start&quot; error message in the SCM that is mentioned in the &quot;Symptoms&quot; section. After you receive this error message, the EventSystem service may start, and BITS may enter the &quot;Running&quot; state. Because of this behavior, startup may take longer (typically, two minutes more) than usual.</div><div class='kb-resolution-section section'>To resolve this behavior, add the EventSystem service to the list of dependencies for BITS. If you add the EventSystem service to the list of dependencies for BITS, BITS will start only after the EventSystem service starts. To use the Service Control utility (Sc.exe) to add the EventSystem service to the list of dependencies for BITS, follow these steps:<ol class='sbody-num_list'><li>Log on to your computer as an administrator.</li><li>Click <strong class='uiterm'>Start</strong>, and then click<br><strong class='uiterm'>Run</strong>. The <strong class='uiterm'>Run</strong> dialog box appears.</li><li>In the <strong class='uiterm'>Open</strong> box, type<br><span class='sbody-userinput'>cmd</span>, and then click <strong class='uiterm'>OK</strong>.</li><li>At the command prompt, run the following command:<div class='indent'><span class='sbody-userinput'>sc config bits depend= rpcss/eventsystem</span></div><span class='text-base'>Note</span> By default, in Windows Server 2003, the list of dependencies for BITS includes the RpcSs service. Therefore, when you run this command, you must specify &quot;rpcss&quot; as an <span class='sbody-italic'>OptionValue</span> parameter for the depend<br><span class='sbody-italic'>OptionName</span> parameter.</li><li>To verify the contents of the list of dependencies for BITS, run the following command at the command prompt:<div class='indent'><span class='sbody-userinput'>sc qc bits</span></div><span class='text-base'>Note</span> This command will display the service settings for BITS. The list of dependencies is one of the service settings.</li></ol>For more information about the changes that Sc.exe makes to your Windows registry if you run the command that is mentioned in step 4, see the &quot;<a managed-link="" href='#1' target="" bookmark-id='1'>Changes that Sc.exe makes to the Windows registry</a>&quot; subsection of the &quot;More Information&quot; section.</div><div class='kb-status-section section'><span> This behavior is by design.</span> This behavior does occur in Windows Server 2003 Service Pack 1 (SP1).</div><div class='kb-moreinformation-section section'><h3 class='sbody-h3'>BITS</h3>BITS is a service that asynchronously transfers files between a client and an HTTP server. BITS transfers files in the background.<h3 class='sbody-h3'><a class='bookmark' id='1'></a>Changes that Sc.exe makes to the Windows registry</h3>To add the EventSystem service to the list of dependencies for BITS, run the following command at the command prompt:<div class='indent'><span class='sbody-userinput'>sc config bits depend= rpcss/eventsystem</span></div>When you run this command, Sc.exe changes the value of the following REG_MULT_SZ type registry entry:<div class='indent'><strong class='sbody-strong'>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\BITS\DependOnService</strong></div>The new value of this registry entry is as follows:<div class='sbody-code'><pre><code>rpcss<br>Eventsystem</code></pre></div><span><span class='text-base'>Warning</span> If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.</span><br><br>If you use Registry Editor to make these changes to your Windows registry, type one dependent service on each line in the <strong class='uiterm'>Value data</strong> box of the <strong class='uiterm'>Edit Multi-String</strong> dialog box.<br><br><span class='text-base'>Note</span> If you use Registry Editor to make these changes, you must restart your computer for the changes to take effect.</div><div class='kb-references-section section'><span>For additional information, click the following article numbers to view the articles in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-2' href='/en-us/help/818746'>818746 </a> Background Intelligent Transfer Service in Windows Server 2003 white paper<br><br></div></span><span><div class='indent'><a id='kb-link-3' href='/en-us/help/331716'>331716 </a> List of known issues for Background Intelligent Transfer Service (BITS)<br><br></div></span>For more information, visit the following Microsoft Developer Network (MSDN) Web sites:<div class='indent'>Background Intelligent Transfer Service<br><a id='kb-link-4' href='http://msdn2.microsoft.com/en-us/library/aa362827.aspx' target='_self'>http://msdn2.microsoft.com/en-us/library/aa362827.aspx</a><br><br>Service Control Manager<br><a id='kb-link-5' href='http://msdn2.microsoft.com/en-us/library/ms685150.aspx' target='_self'>http://msdn2.microsoft.com/en-us/library/ms685150.aspx</a><br><br>Service Control Utility<br><a id='kb-link-6' href='http://msdn2.microsoft.com/en-us/library/ms691621.aspx' target='_self'>http://msdn2.microsoft.com/en-us/library/ms691621.aspx</a></div></div><div class='kb-securedata-section section'>Author: <br>Writer: krishnamurthy.lakshmi@wipro.com (KMS-ID: Partners\v-9lakshmik)<br>Tech Reviewer: ajay.abraham@wipro.com (KMS-ID: Partners\v-9ajaya)<br>Editor: v-smohun</div>