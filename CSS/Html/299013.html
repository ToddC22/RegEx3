<header><h1>Routing and Remote Access Service does not start and event ID 20103 message is logged</h1></header><div class='kb-idea-section section'>The SOX011227700054 has been consolidated into this Microsoft Knowledge Base article. This article is included in the DNS FastTrack Troubleshooter. Insert a cross-reference to the DNS FastTrack Troubleshooter article in a Public section when the DNS FastTrack Troubleshooter article is available. </div><div class='kb-notice-section section'>This article applies to Windows 2000. <span class='text-base'>Support for Windows 2000 ends on July 13, 2010.</span> The <a id='kb-link-1' href='/win2000' target='_self'>Windows 2000 End-of-Support Solution Center</a> is a starting point for planning your migration strategy from Windows 2000. For more information see the <a id='kb-link-2' href='/lifecycle/' target='_self'>Microsoft Support Lifecycle Policy</a>.</div><div class='kb-symptoms-section section'> After you install and enable the Routing and Remote Access service on a Windows 2000-based server, the service does not start. The following event ID message may be logged in Event Viewer. <div class='indent'>Event ID: 20103<br>Source: Router<br>Description: Unable to load C:\Winnt\System32\Iprtrmgr.dll<br></div> In addition, the available ports may not be displayed in the Ports container in the Routing and Remote Access service management tool.<br> </div><div class='kb-resolution-section section'><span><span class='text-base'>Important</span> This section, method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-3' href='/en-us/help/322756'>322756 </a> How to back up and restore the registry in Windows</div></span><br>To resolve this problem, use the following troubleshooting procedure: <br> <ol class='sbody-num_list'><li>Start Registry Editor (Regedt32.exe), and then verify that the following registry key is present: <div class='indent'><span class='text-base'>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\RemoteAccess\RouterManagers\IP</span></div> If this registry key is present, verify that it contains the following three values: <br><ul class='sbody-free_list'><li>Value name: <span class='text-base'>DLLPath</span><br> Data type: REG_EXPAND_SZ<br> Value data: %SystemRoot%\System32\Iprtrmgr.dll</li><li> Value name: <span class='text-base'>GlobalInfo</span><br> Data type: REG_BINARY<br> Value data: The data varies between computers</li><li> Value name: <span class='text-base'>ProtocolID</span><br> Data type: REG_DWORD<br> Value data: 0x21 (Hexadecimal)</li></ul></li><li>If the registry key and values that are described in step 1 exist, verify that Iprtrmgr.dll is located in the path that is specified.<br></li><li> If the file exists and the path is correct, reinstall the modem: <br><ol class='sbody-alpha_list'><li>Disable the Routing and Remote Access service.</li><li>Use Device Manager to uninstall the modem.</li><li>Restart the server and wait for the Plug and Play process to redetect the modem.</li><li>Enable the Routing and Remote Access service.</li></ol></li><li>If the problem is not resolved after you reinstall the modem, remove and reinstall Transmission Control Protocol/Internet Protocol (TCP/IP).</li><li>Start the Remote Registry service if it is not running: <ol class='sbody-alpha_list'><li>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>services.msc</span>, and then click <strong class='uiterm'>OK</strong>.</li><li>Locate the Remote Registry service in the right pane.</li><li>Right-click the service, and then click <strong class='uiterm'>Start</strong>.</li></ol></li></ol><span> For additional information about how to remove TCP/IP from a Windows 2000-based domain controller, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-4' href='/EN-US/help/299451'>299451 </a> HOW TO: Remove and Reinstall TCP/IP on a Windows 2000 Domain Controller<br></div></span><span> For additional information about how to remove TCP/IP from a Windows 2000-based member server, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-5' href='/EN-US/help/285034'>285034 </a> How to Remove and Reinstall TCP/IP for Windows 2000<br></div></span></div><div class='kb-moreinformation-section section'> If the problem that is described in the &quot;Symptoms&quot; section of this article occurs, the following event ID message may also be logged: <div class='indent'>Event: 4191 <br>Source: TCP/IP <br>Description: IP could not open the registry key for adapter TCPIP\Parameters\Adapters\NDISWANIP. Interfaces on this adapter will not be initialized. <br></div>or<div class='indent'>Event ID   : 7024<br>Source     : Service Control Manager<br>Description: The Routing And Remote Access Service service terminated with service-specific error 1003.</div><span> For additional information about this event ID message, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-6' href='/EN-US/help/284955'>284955 </a> Event ID 4191: IP Could Not Open the Registry Key for Adapter TCPIP\Parameters\Adapters\NDISWANIP <br></div></span></div><div class='kb-securedata-section section'>NDISWANIP</div><div class='kb-textlegacy-section section'>DOC INFO: This article was created from Solution Object SOX010111700121 by MKoduri (originator of SO). This article was created from Solution Object SOX000429700003 by kylewil (originator of SO). This article was created from Solution Object SOX001222700127 by v_1kimca (originator of SO). Author: rpesenko (2001-05-15T10:31:00) Edit Reviewer: V-JANHAL (2002-02-13T10:18:00) Tech Reviewer: MARKSTAN (2002-02-08T08:17:00)<br> </div>