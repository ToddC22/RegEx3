<header><h1>How to change the Volume Licensing product key on a Windows XP-based or a Windows Server 2003-based computer</h1></header><div class='kb-notice-section section'><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/55320.asp' title='Link only available for Microsoft corporate network users' target='_blank'>55320 (Content Maintenance)</a></p></div></div></div></div></div><div class='kb-notice-section section'><br><br><span class='text-base'>Warning</span>The steps in this article only apply to Volume License media. If you follow these steps on OEM media or on retail media, you will not change the product key. <br><br><br><br></div><div class='kb-summary-section section'>When you use a <span class='sbody-italic'>leaked</span> product key in a Volume Licensing installation to install Microsoft Windows XP or Microsoft Windows Server 2003  on  multiple computers, various issues may occur. <br><br><span class='text-base'>Note</span>  A <span class='sbody-italic'>leaked</span> product key is a product key that is available to the general public. <br><br>For example, you may not be able to install Windows service packs or to automatically obtain updates from the Windows Update Web site. You may experience the symptoms that are described in the following Microsoft Knowledge Base articles when you install a Windows service pack: <br><br><span><div class='indent'><a id='kb-link-1' href='/en-us/help/326904'>326904 </a> You receive a &quot;The product key used to install Windows is invalid&quot; error message<br><br></div></span><span><div class='indent'><a id='kb-link-2' href='/en-us/help/883254'>883254 </a> You receive a &quot;The product key used to install Microsoft Windows may not be valid&quot; error message when you try to install Windows XP Service Pack 2<br><br></div></span><span><div class='indent'><a id='kb-link-3' href='/en-us/help/842196'>842196 </a> &quot;The product key used to install Microsoft Windows may not be valid&quot; error message when you try to install a Windows update in Windows Server 2003 <br><br></div></span>This article describes how to change the Windows XP or Windows Server 2003 Volume Licensing product key after a Volume Licensing installation. For this procedure, you can use the Windows Activation Wizard graphical user interface (GUI) or a Windows Management Instrumentation (WMI) script. The Activation Wizard method may be  easier. However, you may prefer  the script method if you must change the product key for multiple computers. <br></div><div class='kb-moreinformation-section section'><h3 class='sbody-h3'>Use the Activation Wizard </h3><span><span class='text-base'>Important</span> This section, method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-4' href='/en-us/help/322756'>322756 </a> How to back up and restore the registry in Windows</div></span><br><br>If you do not have to change many Volume Licensing product keys, you can use the Activation Wizard. <br><br><span class='text-base'>Note</span>We recommend that you run System Restore  on Windows XP  to create a new restore point before you follow these steps. For information about how to create a restore point by using System Restore, see the  &quot;To Create a Restore Point&quot;  help topic in Help and Support.  <br><ol class='sbody-num_list'><li> Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>regedit</span>, and then click <strong class='uiterm'>OK</strong>. </li><li> In the left pane, locate and then click the following registry subkey: <div class='indent'><strong class='uiterm'>HKEY_LOCAL_MACHINE\Software\Microsoft\WindowsNT\Current Version\WPAEvents</strong></div></li><li> In the right pane, right-click <strong class='uiterm'>OOBETimer</strong>, and then click <strong class='uiterm'>Modify</strong>. </li><li>Change at least one digit of the <strong class='uiterm'>OOBETimer</strong> value to deactivate Windows.</li><li> Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type the following command, and then click <strong class='uiterm'>OK</strong>: <div class='indent'><span class='sbody-userinput'>%systemroot%\system32\oobe\msoobe.exe /a</span></div></li><li> Click <strong class='uiterm'>Yes, I want to telephone a customer service representative to activate Windows</strong>, and then click <strong class='uiterm'>Next</strong>. </li><li> Click <strong class='uiterm'>Change Product key</strong>, type the new product key in the <strong class='uiterm'>New key</strong> boxes, and then click <strong class='uiterm'>Update</strong>. <br><br><span class='text-base'>Note</span> If the previous Activation Wizard screen appears again, click <strong class='uiterm'> Remind me later</strong>, and then restart the computer. </li><li> Repeat steps 6 and 7 to verify that Windows is started. Click <strong class='uiterm'>OK</strong> when you receive the following message: <div class='message'>Windows is already activated. Click OK to exit.</div></li><li> Install any Windows service packs that you want to install. <br><br><span class='text-base'>Note</span>If you cannot restart Windows after you install a service pack, press F8 when you restart the computer, click <strong class='uiterm'>Last Known Good Configuration</strong>, and then repeat this procedure. </li></ol><h3 class='sbody-h3'>Use a script</h3>You can create a WMI script that changes the Volume Licensing product key, and then deploy this script in a startup script. The ChangeVLKey2600.vbs and   ChangeVLKeySP1 sample scripts use the new Volume Licensing key that you want to use, in a five-part alphanumeric form, as a single argument. We recommend that you use the ChangeVLKey2600.vbs script on Windows XP-based computers that are not running Service Pack 1 (SP1) or a later service pack. We also recommend that  you use the ChangeVLKeySP1.vbs script on Windows XP-based computers that are running SP1 or a later service pack. These scripts perform the following functions: <ul class='sbody-free_list'><li>They remove the hyphen characters (-) from the five-part alphanumeric product key.</li><li>They  create an instance of the <span class='text-base'>win32_WindowsProductActivation</span>class. </li><li>They call the<span class='text-base'> SetProductKey</span>method with the new Volume Licensing product key. </li></ul>You can create a batch file or a file that uses either of the following sample scripts together with the new product key as an argument. Then, you can deploy that file as part of a startup script or you can run the file from the command line to change the product key on a single computer. <br><br>For more information about how to script the product key, visit the following Microsoft Web site: <div class='indent'><a id='kb-link-5' href='http://technet.microsoft.com/en-us/library/bb457096.aspx' target='_self'>http://technet.microsoft.com/en-us/library/bb457096.aspx</a></div><h4 class='sbody-h4'>ChangeVLKeySP1.vbs </h4><div class='sbody-code'><pre><code>&#39; <br>&#39; WMI Script - ChangeVLKey.vbs<br>&#39;<br>&#39; This script changes the product key on the computer.<br>&#39;<br>&#39;***************************************************************************<br><br>ON ERROR RESUME NEXT<br><br><br>if Wscript.arguments.count&lt;1 then<br>   Wscript.echo &quot;Script can&#39;t run without VolumeProductKey argument&quot;<br>   Wscript.echo &quot;Correct usage: Cscript ChangeVLKey.vbs ABCDE-FGHIJ-KLMNO-PRSTU-WYQZX&quot;<br>   Wscript.quit<br>end if<br><br>Dim VOL_PROD_KEY<br>VOL_PROD_KEY = Wscript.arguments.Item(0)<br>VOL_PROD_KEY = Replace(VOL_PROD_KEY,&quot;-&quot;,&quot;&quot;) &#39;remove hyphens if any<br><br>for each Obj in GetObject(&quot;winmgmts:{impersonationLevel=impersonate}&quot;).InstancesOf (&quot;win32_WindowsProductActivation&quot;)<br><br>   result = Obj.SetProductKey (VOL_PROD_KEY)<br><br>   if err &lt;&gt; 0 then<br>      WScript.Echo Err.Description, &quot;0x&quot; &amp; Hex(Err.Number)<br>      Err.Clear<br>   end if<br><br>Next<br></code></pre></div><h4 class='sbody-h4'>ChangeVLKey2600.vbs </h4><div class='sbody-code'><pre><code>&#39; <br>&#39; WMI Script - ChangeVLKey.vbs<br>&#39;<br>&#39; This script changes the product key on the computer.<br>&#39;<br>&#39;***************************************************************************<br><br>ON ERROR RESUME NEXT<br><br>if Wscript.arguments.count&lt;1 then<br>   Wscript.echo &quot;Script can&#39;t run without VolumeProductKey argument&quot;<br>   Wscript.echo &quot;Correct usage: Cscript ChangeVLKey.vbs ABCDE-FGHIJ-KLMNO-PRSTU-WYQZX&quot;<br>   Wscript.quit<br>end if<br><br>Dim VOL_PROD_KEY<br>VOL_PROD_KEY = Wscript.arguments.Item(0)<br>VOL_PROD_KEY = Replace(VOL_PROD_KEY,&quot;-&quot;,&quot;&quot;) &#39;remove hyphens if any<br>Dim WshShell<br>Set WshShell = WScript.CreateObject(&quot;WScript.Shell&quot;)<br>WshShell.RegDelete &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WPAEvents\OOBETimer&quot; &#39;delete OOBETimer registry value<br>for each Obj in GetObject(&quot;winmgmts:{impersonationLevel=impersonate}&quot;).InstancesOf (&quot;win32_WindowsProductActivation&quot;)<br><br>   result = Obj.SetProductKey (VOL_PROD_KEY)<br><br>   if err &lt;&gt; 0 then<br>      WScript.Echo Err.Description, &quot;0x&quot; &amp; Hex(Err.Number)<br>      Err.Clear<br>   end if<br><br>Next <br></code></pre></div>You can  use the ChangeVLKeySP1.vbs script from a command line by performing the following action: <br><br>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>  type the following command, and then click <strong class='uiterm'>OK</strong>:<div class='indent'><span class='sbody-userinput'>c:\changevlkeysp1.vbs <strong class='sbody-strong'>ab123-123ab-ab123-123ab-ab123</strong></span></div><span class='text-base'>Note</span> In this command, <strong class='sbody-strong'>ab123-123ab-ab123-123ab-ab123</strong>is a placeholder that represents the new product key. </div><div class='kb-securedata-section section'>pid WMI ProductID license scripting piracy block blocking legal invalid product key sp1 install</div><div class='kb-securedata-section section'>Author: darrellg<br>Writer: v-dehaas<br>Tech Reviewer: v-jomcc<br>Editor: v-valedo </div>