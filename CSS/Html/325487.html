<header><h1>Advanced network adapter troubleshooting for Windows workstations</h1></header><div class='kb-summary-section section'> This article describes advanced troubleshooting for network adapters.  For information about network troubleshooting in Windows Vista, please visit the following Microsoft Web site: <div class='indent'><a id='kb-link-1' href='http://windowshelp.microsoft.com/windows/en-us/help/33307acf-0698-41ba-b014-ea0a2eb8d0a81033.mspx' target='_self'>http://windowshelp.microsoft.com/Windows/en-us/Help/33307acf-0698-41ba-b014-ea0a2eb8d0a81033.mspx</a></div></div><div> Network connectivity problems have various causes, but they typically occur because of incorrect network adapters, incorrect switch settings, faulty hardware, or driver issues. Some connectivity symptoms are intermittent and do not clearly point to any one of these causes.<br><br><br> Common causes of connectivity problems are as follows: <ul class='sbody-free_list'><li>Network adapters and switch ports have mismatching duplex levels or transfer speed settings.</li><li>Network adapters or switches with transmission rates of 10/100 megabits per second (Mbps) do not switch over correctly. Some autosense settings may not correctly detect the speed of some network adapters.</li><li>The network adapter is incompatible with the motherboard or other hardware or software components and drivers.</li></ul> Typical error messages include the following:<br> <div class='sbody-error'> Error 55: &quot;The specified network resource is no longer available&quot; (ERROR_DEV_NOT_EXIST). </div><div class='sbody-error'> Error 64: &quot;The specified network name is no longer available&quot; (ERROR_NETNAME_DELETED).<br> </div><div class='sbody-error'> Error 121: &quot;The semaphore timeout period has expired&quot; (ERROR_SEM_TIMEOUT). </div><div class='sbody-error'> Error 1231: &quot;The remote network is not reachable by the transport&quot; (ERROR_NETWORK_UNREACHABLE).<br> </div> The system event logs of the client computer may show any one of the following entries: <div class='indent'>Type: Warning<br>Source: MrxSmb<br>Event ID: 50<br>Description: <br>{Lost Delayed-Write-Data} The system was attempting to transfer file data from buffers to \Device\LanmanRedirector. The write operation failed, and only some of the data may have been written to the file.<br></div><div class='indent'>Type:Warning<br>Source:MrxSmb<br>Event ID: 3013<br>Description:<br>The redirector has timed out to <strong class='sbody-strong'>ServerName</strong></div><div class='indent'>Type:Warning<br>Source:MrxSmb<br>Event ID: 3036<br>Description:<br>The redirector detected a security signature mismatch. The connection has been disconnected.<br></div> There may be multiple occurrences of the following TCPIP 4201 entry in the event logs: <div class='indent'>Type:Information<br>Source: TCPIP<br>Event ID: 4201 <br>Description:<br>The system detected that network adapter Compaq NC6134 Gigabit NIC was connected to the network, and has initiated normal operation over the network adapter.<br></div> A single TCPIP 4201 event is typical after you restart the computer or after you disable or enable the network adapter. <h3 class='sbody-h3'>Troubleshooting</h3> To troubleshoot network adapter problems, follow these steps: <br> <ol class='sbody-num_list'><li>Use the Ping or PathPing command-line tools to test basic connectivity. Use Ping to isolate network hardware problems and incompatible configurations. Use PathPing to detect packet loss over multiple-hop trips.<br><br> To watch Ping statistics, use the <strong class='uiterm'>ping -t</strong>command. To see statistics and continue, press CTRL+BREAK. To stop, press CTRL+C. If you detect lost packets in the statistics output, it indicates networking problems up to Open Systems Interconnection (OSI) layer 3 (IP-level connectivity). <br><br> If the remote system that you ping is across a high-delay link, such as a satellite link, responses may take longer. Use the <span class='text-base'>-w</span> (wait) switch to specify a longer time-out.<br><br></li><li>Check the event logs for network-card-related entries or connectivity-related entries.<br><br><span>For more information, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-2' href='/en-us/help/308427'>308427 </a> How to view and manage event logs in Event Viewer in Windows XP<br><br></div></span></li><li>Check whether the network adapter is on the Microsoft Hardware Compatibility List (HCL). </li><li>Check other computers that use the same default gateway that are plugged into the same hub or switch. If these computers do not experience network connectivity problems, the problem may be a faulty network adapter on one computer.<br><br> If this is the case, update the network adapter driver to the latest version.</li><li>Contact the vendor of each motherboard and update the BIOS of the boards. Some network adapters and motherboards or BIOS versions are incompatible. Obtain the latest version from the vendor&#39;s Web site or contact your hardware vendor.</li><li>Check the network adapter and uplink hardware (hub or switch) for common settings. Make sure that all complementing network resources (network adapter, hub, and switch) are set to the same speed and duplex level. If the media type is set to autosense, autosensing, or autodetect, or &quot;Auto Select,&quot; make sure that all components are autosensing correctly.<br><br> On some switches, a duplex setting of Auto may cause it to use half-duplex. You may have to force it to use full-duplex.<br><br> Reset the switch, restart the client, and test the connectivity.<br><br> Put the client and the server on a passive hub. If communication resumes, the problem may be caused by an incorrect network switch configuration.<br><br> For more information about how to configure the devices, contact your hardware vendor.</li><li>Manually set the network adapter of the computer that has connectivity problems to half-duplex and a lower speed.<br><br> Connect the system to a switch that is configured to half-duplex and 10-Mbps, or use a 10-Mbps hub, to see whether connection can be established at a lower transmission speed.<br><br> To increase performance, increase the speed settings manually to 100 Mbps, and then restart the computers. Test for network connectivity loss, increase the setting to full-duplex, and then restart the computers. If network loss occurs, reduce the duplex setting and the speed to the previous settings.</li><li>Swap the network cable between the failing system and the hub or switch.</li><li>Replace the network adapter with a network adapter that has been tested and proven reliable. To do this, follow these steps:<br><ol class='sbody-alpha_list'><li>Remove the network adapter diagnostics program.</li><li>Remove the network adapter in Network properties.</li><li>Install the new network adapter.</li></ol></li><li>Run Network Monitor at the same time on both ends of the network connection. After you filter the traces on the addresses of the two systems, compare both traces to see whether you can see the same traffic.<br><br>Use TCP Retransmit, the Network Monitor Experts tool, to detect TCP retransmissions. To do this, follow these steps:<br><ol class='sbody-alpha_list'><li>Start Network Monitor.</li><li>On the <span class='text-base'>Tools</span> menu, click <span class='text-base'>Experts</span>, and then click <span class='text-base'>TCP Retransmit</span> in the navigation pane.</li><li>Click <strong class='uiterm'>Add to Runlist</strong>.</li><li>Click <span class='text-base'>Run Experts</span>.</li></ol><div class='indent'>If frames are missing in one of the traces, check all intermediate cabling, hubs, switches, and routers for hardware or configuration errors.<br><br>In Network Monitor, view the Capture Statistics summary frame. This frame is the last frame of the trace. If it contains a value other than 0 in the following statistic counters, the connectivity problem may be caused by a hardware or configuration problem:<br><div class='indent'>STATS: MAC CRC Errors = 0<br>STATS: MAC Frames Dropped due to HardWare Errors = 0<br></div></div></li></ol></div><div class='kb-securedata-section section'>If there is a failure, a reply that resembles the following example is returned:<br> ...<br> Reply from 172.16.48.7: bytes=32 time&lt;10ms TTL=128<br> Reply from 172.16.48.7: bytes=32 time&lt;10ms TTL=128<br> Request timed out.<br><br> Ping statistics for 172.16.48.7:<br>Packets: Sent = 473, Received = 355, Lost = 118 (25% loss) </div><div class='kb-moreinformation-section section'> Network switches and server network adapters have to have the duplex settings matched for communication to function correctly. Both must be set to full-duplex or half-duplex. They cannot be mismatched.<br><br> The computers on a local area network (LAN) typically share a common full-duplex network medium. This configuration permits two computers to transmit data at the same time.<br><br> Connectivity problems may occur if either of the following conditions is true: <br> <ul class='sbody-free_list'><li>The computer was moved to a new Ethernet switch port that automatically senses network speed. However, the computer&#39;s network adapter is configured to force full-duplex communication with a static network transfer speed setting (10 Mbps, 100 Mbps, or 1 gigabit per second [Gbps]).</li><li>Both the Ethernet switch port and the computer&#39;s network adapter are configured to force 100-Mbps or 1-Gbps full-duplex communication. However, the Ethernet switch or the network adapter may not be able to communicate at that rate or may not be able to use full-duplex transmissions.</li></ul> You can improve network performance in an Ethernet LAN environment by using full-duplex hardware. This configuration permits two-way communication between networked devices. Without full-duplex hardware, information is sent one way and then sent the other way. Packets frequently collide on the network in a half-duplex hardware configuration, and every time a collision occurs, the packets that collided must be resent. This creates even more traffic that can decrease network performance.<br><br> With full-duplex, transmit and receive paths are separate. Therefore, you can transmit and receive at the same time, and collisions are prevented. Because of the increased throughput and lack of collisions, full-duplex is more susceptible to bad cable terminations or to cable attenuation that exceeds recommended limits. This can generate data retransmissions that become sufficient to degrade performance. </div><div class='kb-references-section section'><span><div class='indent'><a id='kb-link-6' href='/en-us/help/321554'>321554 </a> Connectivity loss that is caused by incompatibilities or incorrect network adapter settings<br><br></div></span></div><div class='kb-securedata-section section'>NIC network_interface network adapter card fail unable connect loose connectivity sporadic connection drops HW failure speed full-duplex half-duplex autosense Mbit packet drop pinging Cisco routing router gateway hardware error slow performance</div><div class='kb-textlegacy-section section'>Author: WALTERE (2002-06-26T14:02:00) Edit Reviewer: V-LINJ (2002-10-24T07:04:00) Tech Reviewer: ERICSHEN (2002-10-15T19:02:00)<br> </div>