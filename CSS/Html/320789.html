<header><h1>Service Control Manager reports Event ID 7016</h1></header><div class='kb-symptoms-section section'>If a service is not written correctly, the Service Control Manager (SCM) may log the following error in the system event log when you use the <span class='text-base'>net start</span> command to start the service:<br><br><div class='sbody-error'>   Event ID: 7016<br>   Source: Service Control Manager<br>   Type: Error<br>   Category: None<br>   Description: The <strong class='sbody-strong'>ServiceName</strong> service has reported an invalid current state 0.<br></div>However, this error message may not be generated if the Services tool in Control Panel (on a Windows NT 4.0-based system) or the Microsoft Management Console (MMC) Services snap-in (on a Windows 2000 or Windows XP-based system) is used to start the service.<br></div><div class='kb-cause-section section'>After you use the <span class='text-base'>net start</span> command to start the service, Net.exe interrogates the service by calling the <span class='text-base'>ControlService</span> function with a SERVICE_CONTROL_INTERROGATE control code until the service reports a status of SERVICE_RUNNING or SERVICE_STOPPED. If the service control handler of the corresponding service calls <span class='text-base'>SetServiceStatus</span> with an invalid value for <span class='text-base'>dwCurrentState</span>, the SCM reports the aforementioned error in the system event log.<br></div><div class='kb-resolution-section section'>To resolve this issue, the service must be fixed (rewritten correctly) so that it reports a valid status when it receives a SERVICE_CONTROL_INTERROGATE (or any other) control code from the SCM.<br></div><div class='kb-moreinformation-section section'>If the Services tool in Control Panel (on a Windows NT 4.0-based system) or the MMC Services snap-in (on a Windows 2000 or Windows XP-based system) is used to start the service, the <span class='text-base'>QueryServiceStatus</span> function is used to track the progress of the service until it reports a status of SERVICE_RUNNING or SERVICE_STOPPED. <span class='text-base'>QueryServiceStatus</span> returns the most recent status information reported to the SCM. The SCM does not call the service control handler in this scenario.<br><br>However, Net.exe determines the current service status by interrogating the service periodically by using the <span class='text-base'>ControlService</span> function with a SERVICE_CONTROL_INTERROGATE control code. This control code is delivered to the control handler for the service. In response, the service posts its current status information back to the SCM by calling <span class='text-base'>SetServiceStatus</span>. The service control handler code should report one of the following valid states, which are defined in the winsvc.h header file:<br><br><div class='sbody-code'><pre><code>// <br>// Service State -- for CurrentState<br>// <br>#define SERVICE_STOPPED                        0x00000001<br>#define SERVICE_START_PENDING                  0x00000002<br>#define SERVICE_STOP_PENDING                   0x00000003<br>#define SERVICE_RUNNING                        0x00000004<br>#define SERVICE_CONTINUE_PENDING               0x00000005<br>#define SERVICE_PAUSE_PENDING                  0x00000006<br>#define SERVICE_PAUSED                         0x00000007<br></code></pre></div>If a service state not listed in the preceding code sample is reported by the service, the SCM will log an error with Event ID 7016 in the system event log, together with the name of the service.<br><br>These same symptoms may occur if any other application interrogates the service to determine its current status.<br></div><div class='kb-references-section section'><span>For additional information, click the article numbers below to view the articles in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-1' href='/EN-US/help/257509'>257509 </a> Hardware Inventory May Cause Third-Party Win32 Services to Stop<br></div></span><span><div class='indent'><a id='kb-link-2' href='/EN-US/help/257689'>257689 </a> Error Message When You Use &quot;Net&quot; Command with Microsoft Exchange Connector for POP3 Mailboxes<br></div></span></div><div class='kb-textlegacy-section section'>Author: prabagar (2002-04-03T15:04:00) Edit Reviewer: V-RHOWAR (2002-05-19T12:52:00) Tech Reviewer: jruss (2002-04-26T12:05:00)<br></div>