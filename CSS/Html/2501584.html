<header><h1>Microsoft Security Advisory: Microsoft Office File Validation for Office 2003, 2007 Office, and Office 2010: April 12, 2011</h1></header><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/MSRC/10801.asp' title='Link only available for Microsoft corporate network users' target='_blank'>10801 (MSRC)</a>; BUG #: <a href='http://bugcheck/bugs/Office14/827885.asp' title='Link only available for Microsoft corporate network users' target='_blank'>827885 (Office14)</a>; BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/141103.asp' title='Link only available for Microsoft corporate network users' target='_blank'>141103 (Content Maintenance)</a></div><div class='kb-summary-section section'><span></span>Office File Validation (OFV) is a security feature that was introduced in Microsoft Office 2010. Office File Validation verifies that a particular binary file complies with the application’s expectations. Office File Validation can help prevent unknown binary file format attacks against Microsoft Office 97-2003 file formats. <br><br>When you open Microsoft Office 97-2003 binary file (such as .doc) the file is compared to a binary schema. If the file fails this validation, you are notified that the document could be considered to be compromised. In Office 2003 and in the 2007 Office system, you are prompted about the file status and can decide to cancel opening the file or to continue to open the file.<br></div><div class='kb-moreinformation-section section'>To help protect your computer from risk, we recommend that you do not open files that you receive as email message attachments, especially if the messages arrive unexpectedly. Additionally, do not open files that you receive as attachments if the files are from a person who is unknown to you. <br><br>For Enterprise customers visit the following TechNet webpage:<br><div class='indent'><a id='kb-link-1' href='http://technet.microsoft.com/en-us/library/53782285-736e-4d00-b458-6170054287af.aspx' target='_self'>Office File Validation for Office 2003 and Office 2007</a></div><h3 class='sbody-h3'>Install Office File Validation</h3><h4 class='sbody-h4'>Prerequisites</h4>To install Office File Validation, you must have the following prerequisites:<br><ul class='sbody-free_list'><li>You must have Office 2003, the 2007 Office system, or Office 2010 installed. </li><li>You must have all recommended updates for all Office programs. To install all recommended updates, visit the Microsoft Update website:<br><div class='indent'><a id='kb-link-2' href='http://update.microsoft.com/microsoftupdate/v6/default.aspx' target='_self'>Microsoft Update</a></div></li><li>You must install the following architecture updates to Microsoft Publisher before you install Office File Validation:<br><ul class='sbody-free_list'><li>Microsoft Publisher Architecture update:<br><div class='indent'><br><a id='kb-link-3' href='http://www.microsoft.com/download/details.aspx?familyid=2d86de98-cb54-4cb4-89f3-5639e427f38c' target='_self'>Microsoft Office Publisher 2007 Architecture update</a><br><br><a id='kb-link-4' href='http://www.microsoft.com/download/details.aspx?familyid=99d94db4-f74f-4675-af7f-3d42c4163022' target='_self'>Microsoft Office Publisher 2003 Architecture update</a></div></li></ul></li></ul><h4 class='sbody-h4'>Install Office File Validation</h4>The following file is available for download from the Microsoft Download Center:<br><br><img class="graphic" src="/library/images/support/kbgraphics/public/en-us/download.gif" alt="Download " title="Download "><a id='kb-link-5' href='http://www.microsoft.com/download/details.aspx?familyid=6a4e39a4-4c3f-4cc7-98ec-1cb2d5cb5881' target='_self'>Download the Office File Validation package now.</a><br><br>Release Date: April 12, 2011<br><br>For more information about how to download Microsoft support files, click the following article number to view the article in the Microsoft Knowledge Base:<br><div class='indent'><a id='kb-link-6' href='/en-us/help/119591'>119591 </a> How to obtain Microsoft support files from online services </div>Microsoft scanned this file for viruses. Microsoft used the most current virus-detection software that was available on the date that the file was posted. The file is stored on security-enhanced servers that help prevent any unauthorized changes to the file. <br><br><h4 class='sbody-h4'>Known issues with Office File Validation</h4><ul class='sbody-free_list'><li>Files that were created in Microsoft Excel 2.0, Microsoft Excel 3.0, or Microsoft Excel 4.0 will fail validation when you use Office File Validation in Office 2003. </li><li>Solver.xla will fail validation when you use Office File Validation in Office 2003. </li><li>When you paste lots of charts or points of data into an Office 2003 document, the paste function may take a long time to complete while Office File Validation tries to validate the new data. </li><li>Opening files from a network share that have many charts or points of data will take longer to open in Office 2003. <br><br>For more information about this issue, click the following article number to view the article in the Microsoft Knowledge Base:<br><div class='indent'><a id='kb-link-7' href='/en-us/help/2570623'>2570623 </a> Excel 2003 Office File Validation (OFV) opens workbooks slower across the network</div></li></ul><h3 class='sbody-h3'>Default Behavior</h3>When you try to open a Word, Excel, PowerPoint, or Publisher 97-2003 file, and that file fails Office File Validation, you receive the following warning:<br><br><img class="graphic" src="/Library/Images/2528455.png" alt="Office File Validation detected a problem while trying to open this file. Opening it may be dangerous.  " title="Office File Validation detected a problem while trying to open this file. Opening it may be dangerous.  "><br><br><br><br><h3 class='sbody-h3'>Resolution</h3><br><h4 class='sbody-h4'>For Office 2010</h4>You can manually set the registry entries by using the following values:<br><div class='indent'><span class='text-base'>Value</span><span class='text-base'>:</span> DisableEditFromPV<br><span class='text-base'>Type</span><span class='text-base'>:</span> REG_DWORD<br><span class='text-base'>Default value</span>: 0<span class='sbody-italic'><br></span><span class='text-base'>Description</span>: When Office File Validations fails<br>0 = Enable Edit in Protected View. <br>1 = Disable Edit in Protected View. </div>Add the DisableEditFromPV REG_DWORD to any or all the following registry subkeys to disable Edit in Protected View in Office 2010:<br><div class='indent'><strong class='sbody-strong'>HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\Excel\Security\FileValidation</strong><br><strong class='sbody-strong'>HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\PowerPoint\Security\FileValidation</strong><br><strong class='sbody-strong'>HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\Word\Security\FileValidation</strong></div><br><h4 class='sbody-h4'>For the 2007 Microsoft Office system and Office 2003</h4>You can manually set the registry entries by using the following values:<br><br><div class='indent'><span class='text-base'>Value</span>: InvalidFileUIOptions<br><span class='text-base'>Type</span>: REG_DWORD<br><span class='text-base'>Default value</span>: 0<span class='sbody-italic'><br></span><span class='text-base'>Description</span>: When Office File Validations fails<br>0 = Notify user file failed. Give user the option to load the file or not <br>1 = Notify user file failed. No option to load the file. </div><h5 class='sbody-h5 text-subtitle'>For the 2007 Microsoft Office system</h5>Add the InvalidFileUIOptions REG_DWORD to any or all the following registry subkeys for Office File Validation in 2007 Microsoft Office system:<br><br><div class='indent'><strong class='sbody-strong'>HKEY_CURRENT_USER\Software \Microsoft\Office\12.0\Excel\Security\FileValidation</strong><br><strong class='sbody-strong'>HKEY_CURRENT_USER\Software \Microsoft\Office\12.0\Word\Security\FileValidation </strong><br><strong class='sbody-strong'>HKEY_CURRENT_USER\Software \Microsoft\Office\12.0\PowerPoint\Security\FileValidation</strong></div><h5 class='sbody-h5 text-subtitle'>For Office 2003</h5>Add the InvalidFileUIOptions REG_DWORD to any or all the following registry subkeys for Office File Validation in Office 2003:<br><div class='indent'><strong class='sbody-strong'>HKEY_CURRENT_USER\Software \Microsoft\Office\11.0\Excel\Security\FileValidation </strong><br><strong class='sbody-strong'>HKEY_CURRENT_USER\Software \Microsoft\Office\11.0\Word\Security\FileValidation</strong><br><strong class='sbody-strong'>HKEY_CURRENT_USER\Software \Microsoft\Office\11.0\PowerPoint\Security\FileValidation</strong></div></div><div class='kb-securedata-section section'><span class='text-base'>Author: secure</span><br><span class='text-base'>Writer: kbSec (v-johnre)</span><br><span class='text-base'>Tech Reviewer: secure</span><br><span class='text-base'>Editor: </span></div>