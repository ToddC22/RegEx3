<header><h1>Workflow: Net: DNS: Troubleshooting issues where host names do not resolve or resolve incorrectly</h1></header><span asset="4476087" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4476087]</span><ul><li><strong>Content Idea (CI): </strong><a managed-link="" href="https://aka.ms/CIEdit?id=71515" target="" data-content-type="" data-content-id="" bookmark-id="">71515</a></li></ul><div><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:18pt;">Scenario</span></b></p><p style="margin:0px 0px 10.66px;"><span lang="EN" style="margin:0px;font-size:12pt;">Troubleshooting issues where host names do not resolve or
resolve incorrectly. </span></p><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:18pt;">Scoping</span></b></p><ol type="1" start="1">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">[Ask the customer] to describe the issue and who is impacted.</span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">How many users are affected?</span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Is name resolution failing or resolving incorrectly?</span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">All queries or just certain ones? </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- Internal</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- External</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- Short names</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- Certain types
of records (MX, SRV, CNAME, etc.)</span></p><ol type="1" start="5">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">A specific record or records? Collect details about the record(s). </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- Record name</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- IP address the
record resolves to.</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- IP address the
record should resolve to.</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- What DNS server
holds the record(s)?</span></p><ol type="1" start="6">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">When does the issue occur?</span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Does it resolve itself after some time? &nbsp;</span></li></ol><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:18pt;">Data Collection</span></b></p><span lang="EN" style="margin:0px;font-size:18pt;"><span style="color:black;font-size:10.5pt;"><p style="color:rgb(34, 34, 34);font-family:Calibri;font-size:11pt;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:8pt;margin-top:0px;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;" dir="ltr"><span style="color:black;font-size:10.5pt;">In general: for all scenarios start with SDP data collection and then make use of more <span style="background-color:rgb(249, 249, 249);display:inline;font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;">specific </span><b>TSS </b>data collections later on.</span></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:5.2pt;margin-left:0in;margin-right:0in;margin-top:5.2pt;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;"><span style="color:black;font-size:10.5pt;">For collecting <b>MSDT = SDP</b> reports of any kind, you can use CMD command: <b>TSS SDP</b> (default will be NET SDP report, you can specify any specialty <span style="background-color:rgb(249, 249, 249);display:inline;">here, i.e.: <b>TSS SDP:Setup&nbsp;</b></span></span></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:5.2pt;margin-left:0in;margin-right:0in;margin-top:5.2pt;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">C<span style="color:black;font-size:10.5pt;">ustomer ready <b>General instruction</b> on TSS data collection:&nbsp;</span></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:5.2pt;margin-left:0in;margin-right:0in;margin-top:5.2pt;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">D<span style="color:black;font-size:10.5pt;">ownload the latest version of&nbsp;<b> tss_toolset*.zip</b> from the public website:&nbsp; https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/TSS</span></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:5.2pt;margin-left:0in;margin-right:0in;margin-top:5.2pt;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;"><span style="color:black;font-size:10.5pt;">Expand zip file on local disk, i.e. in folder C:\Tools, open an elevated CMD window, CD&nbsp;<span style="background-color:rgb(255, 255, 255);display:inline;">C:\Tools, then start datacollection using given TSS command line below.</span></span></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-size-adjust:none;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:5.2pt;margin-left:0in;margin-right:0in;margin-top:5.2pt;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;"><font color="#b00000"><font style="background-color:rgb(255, 255, 255);">A<span style="font-size:10.5pt;"><span style="display:inline;">t the end of data collection you may be asked for SDP (Support Diagnostic Package) report, please answer: <b>Y </b>&lt;enter&gt;&nbsp;</span></span></font></font></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-size-adjust:none;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:5.2pt;margin-left:0in;margin-right:0in;margin-top:5.2pt;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;"><font color="#b00000">A<span style="font-size:10.5pt;">fter Diagnostic report has completed, please upload resulting C:\MS_DATA\*.zip file onto provided Microsoft Workspace.</span></font></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:5.2pt;margin-left:0in;margin-right:0in;margin-top:5.2pt;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;"><span style="color:black;font-size:10.5pt;"><b>Engineer Note</b>: for SDP data analysis/evaluation,&nbsp; use RFLcheck:&nbsp; see internal KB: <span style="background-color:rgb(255, 255, 255);display:inline;"><b>3070416 </b></span>Servicing: Tools: SDP + RFL PS scripts identify missing updates (Recommended Fix List)<br>&nbsp; https://internal.support.services.microsoft.com/en-us/help/3070416</span></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:5.2pt;margin-left:0in;margin-right:0in;margin-top:5.2pt;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">T<span style="color:black;font-size:10.5pt;">he automated SDP/RFLchecker tool requires at least a minimal SDP report (to be collected with command <b style="color:rgb(0, 0, 0);font-size:14px;font-weight:700;">TSS SDP</b>:Mini)</span></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:5.2pt;margin-left:0in;margin-right:0in;margin-top:5.2pt;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;"><span style="color:black;font-size:10.5pt;"><br></span></p></span><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:0pt;margin-top:0px;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;"><b><u>Simplified data collection</u></b></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:0pt;margin-top:0px;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">Relevant DFS data collection is two fold, issue could be related to DNS client or DNS server, best if you collect simultaneously data on both ends at same time of 'failure', but depending on actual issue, you can start with single data set on DNS client or DNS server.</p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:0pt;margin-top:0px;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;"><br></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:0pt;margin-top:0px;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">On <b>Windows DNS client</b>, run in elevated CMD window</p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:0pt;margin-top:0px;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">&nbsp; <b>TSS rOn DNScli</b></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:0pt;margin-top:0px;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">&nbsp;adding <b>Video </b>switch on client OS may help if the problem needs to be investigated in network trace later on with exact timestamps.<br></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:0pt;margin-top:0px;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">&nbsp;stop data collection immediately after first error is seen/observed, by <span style="background-color:rgb(255, 255, 255);display:inline;">activating </span>the TSS CMD window and '<b>Hit any key</b>', this will stop data collection.</p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:0pt;margin-top:0px;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;"><br></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:0pt;margin-top:0px;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">On <b>Windows DNS server</b>, run in elevated CMD window</p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:0pt;margin-top:0px;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">&nbsp; <b>TSS rOn General DNSsrv</b><br></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:0pt;margin-top:0px;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">&nbsp;stop data collection immediately after first error is seen/observed, by <span style="background-color:rgb(255, 255, 255);display:inline;">activating </span>the TSS CMD window and '<b>Hit any key</b>', this will stop data collection.</p><p style="margin:0px 0px 0pt;text-align:left;color:rgb(34, 34, 34);text-transform:none;text-indent:0px;letter-spacing:normal;font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-variant:normal;word-spacing:0px;orphans:2;"><br></p><p style="color:rgb(34, 34, 34);font-family:Segoe UI,Helvetica Neue,Helvetica,Arial,Verdana;font-size:14px;font-style:normal;font-variant:normal;font-weight:400;letter-spacing:normal;margin-bottom:0pt;margin-top:0px;orphans:2;text-align:left;text-indent:0px;text-transform:none;word-spacing:0px;">The below listed <b>manual </b>steps are pretty much included in above simplified automated data collection.</p><p style="margin:0px 0px 10.66px;"><b></b><i></i><u></u><sub></sub><sup></sup><strike></strike><br></p><p style="margin:0px 0px 10.66px;">Manual steps</p></span><p style="margin:0px 0px 1.4px 44.6px;text-indent:-0.25in;"><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;"><span style="margin:0px;">1.<span style="font:7pt &quot;Times New Roman&quot;;margin:0px;font-size-adjust:none;">&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;">Collect a Windows
Networking Diagnostic from an affected client and its configured DNS server.</span></p><p style="margin:2.8px 0px 6.93px 44.6px;text-indent:-0.25in;"><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;"><span style="margin:0px;">2.<span style="font:7pt &quot;Times New Roman&quot;;margin:0px;font-size-adjust:none;">&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;">Start network captures
on client and server(s) </span></p><p style="margin:0px 0px 1.4px 48px;"><span style="background:rgb(249, 249, 249);margin:0px;padding:1pt;border:1pt solid rgb(221, 221, 221);color:black;font-family:&quot;Courier New&quot;;font-size:10pt;">netsh trace start capture=yes
tracefile=c:\%computername%_nettrace.etl</span><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;"></span></p><p style="margin:0px 0px 1.4px 44.6px;text-indent:-0.25in;"><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;"><span style="margin:0px;">3.<span style="font:7pt &quot;Times New Roman&quot;;margin:0px;font-size-adjust:none;">&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;">Clear DNS cache on DNS
client by running Ipconfig /flushdns</span></p><p style="margin:0px 0px 1.4px 44.6px;text-indent:-0.25in;"><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;"><span style="margin:0px;">4.<span style="font:7pt &quot;Times New Roman&quot;;margin:0px;font-size-adjust:none;">&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;">Reproduce issue</span></p><p style="margin:2.8px 0px 6.93px 44.6px;text-indent:-0.25in;"><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;"><span style="margin:0px;">5.<span style="font:7pt &quot;Times New Roman&quot;;margin:0px;font-size-adjust:none;">&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;">Stop and save traces </span></p><p style="margin:0px 0px 1.4px 48px;"><span style="background:rgb(249, 249, 249);margin:0px;padding:1pt;border:1pt solid rgb(221, 221, 221);color:black;font-family:&quot;Courier New&quot;;font-size:10pt;">netsh trace stop</span><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;"></span></p><p style="margin:0px 0px 1.4px 44.6px;text-indent:-0.25in;"><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;"><span style="margin:0px;">6.<span style="font:7pt &quot;Times New Roman&quot;;margin:0px;font-size-adjust:none;">&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;">Upload the
nettrace.cab files from each machine to the workspace.</span></p><p style="margin:6.93px 0px;"><span style="margin:0px;color:rgb(37, 37, 37);font-family:&quot;Arial&quot;,sans-serif;font-size:10.5pt;">See
<a title="Windows - DNS:Analyzing Traffic" href="https://www.csssupportwiki.com/index.php/Windows_-_DNS:Analyzing_Traffic"><span style="margin:0px;color:rgb(6, 69, 173);"></span></a><a href="https://internal.support.services.microsoft.com/en-us/help/4052926">Windows -
DNS:Analyzing Traffic</a></span> for examples of name resolution traffic. </p><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:18pt;">&nbsp;</span></b></p><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:18pt;">Troubleshooting</span></b></p><p style="margin:0px 0px 10.66px;"><span lang="EN" style="margin:0px;font-size:12pt;">Name resolution issues can be broken down into client
side and server side issues. In general, you should start with client side
troubleshooting unless you determine the issue is a server side issue during
the scoping phase. </span></p><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:13.5pt;">Client Side
Troubleshooting</span></b></p><ol type="1" start="1">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Open an administrative command prompt on the client machine and run </span><b><span lang="EN" style="margin:0px;font-size:10pt;">ipconfig /all</span></b><span lang="EN" style="margin:0px;"></span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Verify that the client has a valid IP address, subnet mask, and
     default gateway for the network where it is attached and being used.</span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Check the DNS servers listed in the output and verify that the IP
     addresses listed are correct.</span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Check the connection specific DNS suffix in the output and verify the
     suffix is correct.</span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">If the client does not have a valid TCP/IP configuration, you can
     either: </span></li>
 <ul>
  <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">For dynamically configured clients, use the </span><b><span lang="EN" style="margin:0px;font-size:10pt;">ipconfig /renew</span></b><span lang="EN" style="margin:0px;"> command to
      manually force the client to renew its IP address configuration with the
      DHCP server.</span></li>
  <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">For statically configured clients, modify the client TCP/IP
      properties to use valid configuration settings or complete its DNS
      configuration for the network.</span></li>
 </ul>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Verify that the client can contact a preferred (or alternate) DNS
     server by pinging the preferred DNS server by its IP address. </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">For example, if
the client uses a preferred DNS server of 10.0.0.1, run this command in the
command prompt: </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">ping 10.0.0.1</span><span lang="EN" style="margin:0px;font-size:12pt;"> </span></p><ol type="1" start="7">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">If no configured DNS servers respond to a direct pinging of their IP
     address, it indicates that the source of the problem is more likely a
     network connectivity problem between the client and the DNS servers. If
     that is the case, follow basic TCP/IP network troubleshooting steps to fix
     the problem. <i>Keep in mind that ICMP traffic must be allowed through the
     firewall in order for the ping command to work.</i></span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">If the DNS client can ping the DNS server computer, try using the </span><b><span lang="EN" style="margin:0px;font-size:10pt;">nslookup</span></b><span lang="EN" style="margin:0px;"> command to test whether the server can respond to
     DNS clients. Since </span><b><span lang="EN" style="margin:0px;font-size:10pt;">nslookup</span></b><span lang="EN" style="margin:0px;"> does not use the client's DNS cache, name resolution will use the
     client's configured DNS server. </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">Nslookup
&lt;client&gt;</span></p><p style="margin:0px 0px 0px 48px;text-indent:0.5in;"><span lang="EN" style="margin:0px;font-size:12pt;">For example, if the client machine is named client1, run this command: </span><span lang="EN" style="margin:0px;font-size:10pt;">nslookup client1</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;text-indent:0.5in;"><span lang="EN" style="margin:0px;font-size:12pt;">If a successful response is not returned, try </span><b><span lang="EN" style="margin:0px;font-size:10pt;">nslookup &lt;fqdn
of client&gt;</span></b><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 96px;"><span lang="EN" style="margin:0px;font-size:12pt;">For example, if
the FQDN is client1.corp.contoso.com, run this command: <br></span><span lang="EN" style="margin:0px;font-size:10pt;">nslookup client1.corp.contoso.com.</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;text-indent:0.5in;"><i><span lang="EN" style="margin:0px;font-size:12pt;">It is important to include the trailing period when running this test.</span></i><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;text-indent:0.5in;"><span lang="EN" style="margin:0px;font-size:12pt;">If looking up the FQDN is successful but the short name is not, check the
DNS Suffix configuration in the DNS tab of the Advanced TCP/IP Settings of the
NIC. See the section titled Configuring DNS Resolution <a href="https://msdn.microsoft.com/en-us/library/dd163570.aspx" target="_blank"><span style="margin:0px;color:blue;">here</span></a> for more information</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">&nbsp;</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">Nslookup &lt;DNS
Server&gt;</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;text-indent:0.5in;"><span lang="EN" style="margin:0px;font-size:12pt;">For example, if the DNS server is named DC1, run this command: </span></p><p style="margin:0px 0px 0px 48px;text-indent:0.5in;"><span lang="EN" style="margin:0px;font-size:10pt;">nslookup dc1</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;text-indent:0.5in;"><span lang="EN" style="margin:0px;font-size:12pt;">If the previous tests were successful, this test should be successful as
well. If this test is not successful, verify connectivity to the DNS server. If
connectivity is good, see the Data Collection section.</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">&nbsp;</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">Nslookup
&lt;failed internal record&gt;</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;text-indent:0.5in;"><span lang="EN" style="margin:0px;font-size:12pt;">For example, if the failing record was app1.corp.contoso.com, run this
command: </span></p><p style="margin:0px 0px 0px 48px;text-indent:0.5in;"><span lang="EN" style="margin:0px;font-size:10pt;">nslookup app1.corp.contoso.com</span></p><p style="margin:0px 0px 0px 48px;text-indent:0.5in;"><span lang="EN" style="margin:0px;font-size:12pt;">&nbsp;</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">Nslookup
&lt;external name&gt;</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;text-indent:0.5in;"><span lang="EN" style="margin:0px;font-size:12pt;">For example: </span><span lang="EN" style="margin:0px;font-size:10pt;">nslookup bing.com</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;text-indent:0.5in;"><span lang="EN" style="margin:0px;font-size:12pt;">If this test is unsuccessful, see the Data Collection section.</span></p><ol type="1" start="9">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">If all of the tests in step 8 were successful, run </span><b><span lang="EN" style="margin:0px;font-size:10pt;">ipconfig /displaydns</span></b><span lang="EN" style="margin:0px;"> and check the
     output for the name that failed. </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If you see </span><span lang="EN" style="margin:0px;font-size:10pt;">&quot;Name does not exist.&quot;</span><span lang="EN" style="margin:0px;font-size:12pt;"> under the failing name,
a negative response was returned from a DNS server and cached on the client. </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">Clear the cache
by running </span><b><span lang="EN" style="margin:0px;font-size:10pt;">ipconfig /flushdns</span></b><span lang="EN" style="margin:0px;font-size:12pt;">, then check to
see if the issue is resolved.</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">See How to <a href="https://support.microsoft.com/en-us/kb/318803" target="_blank"><span style="margin:0px;color:blue;">Disable Client-Side DNS Caching in Windows XP and Windows
Server 2003</span></a> for more information.</span></p><ol type="1" start="10">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span>If name resolution is still failing, continue on to the below section.</span></li><li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;">If no DNS packet send out for both nslookup and ping test, yet PowerShell command <i>Resolve-DnsName -Name &lt;String&gt; </i>works as expected. That could be caused by UDP socket issue during DNS Query. Check if customer hit the issue described in internal KB below</li></ol><span style="font-family:Calibri, sans-serif;font-size:12pt;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><div>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<a href="https://internal.support.services.microsoft.com/en-us/help/4026068">NET: Socket based apps / operations may fail if Bypass Traverse Checking policy or folder permissions prevent socket creation</a></div><div><br><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:13.5pt;">DNS Server
Troubleshooting</span></b></p><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:12pt;">No answer or name
not found</span></b></p><p style="margin:0px 0px 10.66px;"><span lang="EN" style="margin:0px;font-size:12pt;">Is the IP configuration correct? </span></p><ol type="1" start="1">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Run ipconfig /all from the command prompt and verify the IP address,
     subnet mask, and default gateway </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">Yes - See the <a href="https://www.csssupportwiki.com/index.php/curated:Windows_-_DNS_Name_Resolution#Check_server_for_problems"><span style="margin:0px;color:windowtext;">Check server
for problems</span></a> section.</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">No - Correct the
IP configuration</span></p><ol type="1" start="2">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Is the DNS server authoritative for the name that is being looked up? </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">Yes - See Checking
for problems with authoritative data</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">No - Proceed to
step 3</span></p><ol type="1" start="3">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Run </span><b><span lang="EN" style="margin:0px;font-size:10pt;">nslookup &lt;name&gt; &lt;IP address of the DNS
     server&gt;</span></b><span lang="EN" style="margin:0px;"> </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">Example: </span><span lang="EN" style="margin:0px;font-size:10pt;">nslookup app1 10.0.0.1</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If you get a
failure or timeout response, see <a href="https://www.csssupportwiki.com/index.php/curated:Windows_-_DNS_Name_Resolution#Checking_for_recursion_problems"><span style="margin:0px;color:windowtext;">Checking for
recursion problems</span></a></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If the answer is
incorrect, proceed to step 4.</span></p><ol type="1" start="4">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Flush the resolver cache. </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">From an
administrative command prompt: </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">Dnscmd
/clearcache</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">Or, from
Powershell run: </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">Clear-DnsServerCache</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><ol type="1" start="5">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Repeat step 3. If the answer is still incorrect, see <a href="https://www.csssupportwiki.com/index.php/curated:Windows_-_DNS_Name_Resolution#Checking_for_problems_with_authoritative_data"><span style="margin:0px;color:windowtext;">Checking
     for problems with authoritative data</span></a></span></li></ol><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:12pt;">Check server for
problems</span></b></p><ol type="1" start="1">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Are there errors in the Event Logs? Check the following logs: </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- Application</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- System</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- DNS Server</span></p><ol type="1" start="2">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Is the DNS server reachable from client machines? (If you've completed
     the <a href="https://www.csssupportwiki.com/index.php/curated:Windows_-_DNS_Name_Resolution#Client_Side_Troubleshooting"><span style="margin:0px;color:windowtext;">Client
     Side Troubleshooting</span></a> section, you should have the answer to
     this question already and can proceed to step 3) </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">Ping DNS server
by IP address from client machine </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">For example, if
the client uses a preferred DNS server of 10.0.0.1, run this command in the
command prompt: </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">ping 10.0.0.1</span><span lang="EN" style="margin:0px;font-size:12pt;"> </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- <b>Yes:</b>
Proceed to Step 3.</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- <b>No:</b> The
source of the problem could be an issue with network connectivity between the
client and the DNS servers. If that is the case, follow basic TCP/IP network
troubleshooting steps to fix the problem.</span></p><p style="margin:0px 0px 0px 48px;"><i><span lang="EN" style="margin:0px;font-size:12pt;">Note: ICMP
traffic must be allowed through firewall in order for the ping command to work.</span></i><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><ol type="1" start="3">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Run </span><span lang="EN" style="margin:0px;font-size:10pt;">nslookup &lt;client name&gt; &lt;server IP
     address&gt;</span><span lang="EN" style="margin:0px;"> </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">Is the DNS server
reachable from client machines? </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- From client
machine run NSLookup &lt;client name&gt; &lt;Server IP Address&gt; </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">For example, if
the client name is client1 and the DNS server's IP address is 10.0.0.1, run: </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">nslookup client1
10.0.0.1</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- If the resolver
returns the IP address of the client, the server does not have any problems.
Return to <a href="https://www.csssupportwiki.com/index.php/curated:Windows_-_DNS_Name_Resolution#No_answer_or_name_not_found"><span style="margin:0px;color:windowtext;">No answer or
name not found</span></a></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- If the resolver
returns the response &quot;Server failure&quot; or &quot;Query refused,&quot;
proceed to step 4. </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- If the resolver
returns the response &quot;Request to server timed out&quot; or &quot;No
response from server,&quot; proceed to step 5. </span></p><ol type="1" start="4">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">If the resolver returns the response &quot;Server failure&quot; or
     &quot;Query refused,&quot; the zone is probably paused, or the server is
     possibly overloaded. You can find out whether it is paused by checking the
     General tab of the zone properties, from within the DNS console.</span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">If the resolver returns the response &quot;Request to server timed
     out&quot; or &quot;No response from server,&quot; the DNS server probably
     is not running. Try to restart the server by typing the following at the
     command prompt on the server: </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">net start DNS</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- Or - </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If it is running,
the server might not be listening on the IP address that you used in your
Nslookup query. From the Interfaces tab of the server properties page in the
DNS console, administrators can restrict a DNS server to listen only on
selected addresses. If the DNS server has been configured to limit service to a
specific list of its configured IP addresses, it is possible that the IP
address used to contact the DNS server is not in the list. You can try a
different IP address in the list or add the IP address to the list. </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- Or - </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">In rare cases,
the DNS server might have an advanced security or firewall configuration. If
the server is located on another network that is reachable only through an
intermediate host (such as a packet filtering router or proxy server), the DNS
server might use a non-standard port to listen for and receive client requests.
By default, Nslookup sends queries to DNS servers on UDP port 53, so if the DNS
server uses any other port, Nslookup queries fail. If you think this might be
the problem, check whether an intermediate filter is intentionally used to
block traffic on well-known DNS ports. If not, try to modify the packet filters
or port rules on the firewall to allow traffic on UDP/TCP port 53. </span></p><ol type="1" start="6">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Return to <a href="https://www.csssupportwiki.com/index.php/curated:Windows_-_DNS_Name_Resolution#No_answer_or_name_not_found"><span style="margin:0px;color:windowtext;">No
     answer or name not found</span></a></span></li></ol><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:12pt;">Checking for
problems with authoritative data</span></b></p><ol type="1" start="1">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Is the server returning the incorrect response a primary server? </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If the server is
a primary server for the zone — either the standard primary server for the zone
or a server that uses Active Directory integration to load the zone — the data
is incorrect on the primary zone. Go to step&nbsp;6. </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">– Or – </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If the server is
hosting a secondary copy of the zone, proceed to the next step. </span></p><ol type="1" start="2">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Examine the zone on the master server (the server from which this
     server pulls zone transfers). You can determine which server is the master
     server by examining the properties of the secondary zone in the DNS
     console. </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">Is the name
correct on the master server? </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">– If the name is
not correct on the master server, go to step&nbsp;5. </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">– If the name was
correct on the master server, proceed to the next step. </span></p><ol type="1" start="3">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Check whether the serial number on the master server is lower than or
     equal to the serial number on the secondary server. If not, proceed to the
     next step. </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">– Or – </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If the serial
number on the master server is lower than or equal to the serial number on the
secondary server, modify either the master server or the secondary server so
that the serial number on the master server is higher than the serial number on
the secondary server. Then, proceed to the next step. </span></p><ol type="1" start="4">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">From the secondary server, force a zone transfer from within the DNS
     console or by running dnscmd /zonerefresh &lt;zone name&gt; </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">– For example if
the zone is corp.contoso.com, type: </span><span lang="EN" style="margin:0px;font-size:10pt;">dnscmd /zonerefresh
corp.contoso.com</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><ol type="1" start="5">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Next, examine the secondary server again to see whether the zone was
     transferred correctly. If not, you probably have a zone transfer problem;
     see <a href="https://www.csssupportwiki.com/index.php/curated:Windows_-_DNS_Name_Resolution#Zone_Transfer_Problems"><span style="margin:0px;color:windowtext;">Zone
     Transfer Problems</span></a>. </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">– Or – </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If the zone was
transferred correctly, check whether the data is now correct. If not, the data
is incorrect on the primary zone. Proceed to the next step. </span></p><ol type="1" start="6">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">If the data is incorrect on the primary zone, the problem might be
     caused by user error when entering data into the zone, a problem with
     Active Directory replication, or a problem with dynamic update.</span></li></ol><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:12pt;">Checking for
recursion problems</span></b></p><p style="margin:0px 0px 10.66px;"><span lang="EN" style="margin:0px;font-size:12pt;">For recursion to work successfully, all DNS servers that
are used in the path of a recursive query must be able to respond and forward
correct data. If they cannot, a recursive query can fail for any of the
following reasons: </span></p><ol type="1" style="margin-top:0in;" start="1">
 <li style="margin:0px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">- The query times out before it can be completed.</span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- A server used
during the query fails to respond.</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- A server used
during the query provides incorrect data.</span></p><p style="margin:0px 0px 10.66px;"><span lang="EN" style="margin:0px;font-size:12pt;">Start troubleshooting with the server used in your
original query. </span></p><ol type="1" start="1">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Check whether this server forwards queries to another server by
     examining the Forwarders tab in the server properties in the DNS console.
     If the check box Enable forwarders is selected and one or more servers are
     listed, this server forwards queries. </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- If this server
does forward queries to another server, check for problems with the server to
which this server forwards queries. To check for problems, see Check server for
problems. When that section instructs you to perform a task on the client,
perform it on the server instead. </span></p><p style="margin:0px 0px 10.66px;"><span lang="EN" style="margin:0px;font-size:12pt;">If the server is healthy and can forward queries, repeat
this step, examining the server to which this server forwards queries. </span></p><ol type="1" style="margin-top:0in;" start="1">
 <li style="margin:0px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">- Or - </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If this server
does not forward queries to another server, proceed to the next step. </span></p><ol type="1" start="2">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Test whether this server can query a root server by typing the
     following: </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">nslookup</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">server &lt; IP
address of the server you are examining &gt;</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">set q=NS</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">&nbsp;</span></p><ol type="1" start="1">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">If the resolver returns the IP address of a root server, you probably
     have a broken delegation between the root server and the name or IP
     address that you are attempting to resolve. Follow the procedure To test
     for a broken delegation to determine where you have a broken delegation. </span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">If the resolver returns the response &quot;Request to server timed
     out,&quot; check whether the root hints points to functioning root servers
     by following the procedure &quot;To view the current root hints.&quot; If
     the root hints does point to functioning root servers, you might have a
     network problem, or the server might use an advanced firewall configuration
     that prevents the resolver from querying the server, as described in the
     Check server for problems section. It is also possible that the recursive
     time-out default is too short. See DNS: The recursion timeout must be
     greater than the forwarding timeout for more information.</span></li></ol><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:12pt;">To test for a
broken delegation</span></b></p><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:12pt;">Note:</span></b><span lang="EN" style="margin:0px;font-size:12pt;"> Begin the tests in the
following procedure by querying a valid root server. The test takes you through
a process of querying all the DNS servers from the root down to the server that
you are testing for a broken delegation. </span></p><p style="margin:0px 0px 10.66px 72px;text-indent:-0.25in;"><span lang="EN" style="margin:0px;font-size:12pt;"><span style="margin:0px;">1.<span style="font:7pt &quot;Times New Roman&quot;;margin:0px;font-size-adjust:none;">&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span lang="EN" style="margin:0px;font-size:12pt;">At the command prompt on
the server that you are testing, type the following: </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">nslookup</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">server &lt;
server IP address&gt;</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">set norecursion</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">set querytype=
&lt;resource record type&gt;</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:10pt;">&lt;FQDN &gt;</span><span lang="EN" style="margin:0px;font-size:12pt;"></span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">where resource
record type is the type of resource record that you were querying for in your
original query, and FQDN is the FQDN for which you were querying (terminated by
a period). </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">&nbsp;</span></p><p style="margin:0px 0px 0px 72px;text-indent:-0.25in;"><span lang="EN" style="margin:0px;font-size:12pt;"><span style="margin:0px;">2.<span style="font:7pt &quot;Times New Roman&quot;;margin:0px;font-size-adjust:none;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span lang="EN" style="margin:0px;font-size:12pt;">If the response includes a list of NS and A resource records for delegated
servers, repeat step&nbsp;1 for each server and use the IP address from the A
resource records as the server IP address. </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">– Or – </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If the response
does not contain an NS resource record, you have a broken delegation. </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">– Or – </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If the response
contains NS resource records, but no A resource records, type set recursion and
query individually for A resource records of servers listed in the NS records.
If for each NS resource record in a zone, you do not find at least one valid IP
address of an A resource record for each NS resource record, you have a broken
delegation. </span></p><p style="margin:0px 0px 10.66px 72px;text-indent:-0.25in;"><span lang="EN" style="margin:0px;font-size:12pt;"><span style="margin:0px;">3.<span style="font:7pt &quot;Times New Roman&quot;;margin:0px;font-size-adjust:none;">&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span lang="EN" style="margin:0px;font-size:12pt;">If you determine that you
have a broken delegation, fix it by adding or updating an A resource record in
the parent zone with a valid IP address for a correct DNS server for the
delegated zone.</span></p><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:12pt;">To view the
current root hints</span></b></p><ol type="1" start="1">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Start the DNS console.</span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Add or connect to the DNS server that failed a recursive query.</span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Right-click the server and select Properties .</span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Click Root Hints .</span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">Check for basic
connectivity to the root servers.</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If root hints
appear to be configured correctly, verify that the DNS server used in a failed
name resolution can ping the root servers by IP address. </span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If the root
servers do not respond to pinging by IP address, the IP addresses for the root
servers might have changed. However, reconfiguration of root servers is
uncommon.</span></p><p style="margin:0px 0px 10.66px;"><b><span lang="EN" style="margin:0px;font-size:12pt;">Zone Transfer
Problems</span></b></p><ol type="1" start="1">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Check Event Viewer for both the primary and secondary DNS server. </span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Check the master server to see whether it is refusing to send the
     transfer for security reasons. Check the <b>Zone Transfers</b> tab of the
     zone properties in the DNS console. If the server restricts zone transfers
     to a list of servers, such as those listed on the <b>Name Servers</b> tab
     of the zone properties, make sure that the secondary server is on that
     list. Make sure that the server is configured to send zone transfers.</span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Check the master server for problems by following the steps in Check
     server for problems. When prompted to perform a task on the client,
     perform the task on the secondary server instead.</span></li>
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Check whether the secondary server is running another DNS server
     implementation, such as BIND. If so, the problem might have one of several
     causes: </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- The Windows
master server might be configured to send fast zone transfers, but the
third-party secondary server might not support fast zone transfers. If so,
disable fast zone transfers on the master server by selecting the check box <b>Enable
Bind secondaries</b> on the <b>Advanced</b> tab of the properties for your
server, from within the DNS console.</span></p><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">- If a forward
lookup zone on the Windows&nbsp;server contains a record type (for example, an
SRV record) the secondary server does not support, the secondary server might
have problems pulling the zone.</span></p><ol type="1" start="5">
 <li style="margin:0px 0px 10.66px;color:rgb(0, 0, 0);font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;font-style:normal;font-weight:normal;"><span lang="EN" style="margin:0px;">Check whether the master server is running another DNS server
     implementation, such as BIND. </span></li></ol><p style="margin:0px 0px 0px 48px;"><span lang="EN" style="margin:0px;font-size:12pt;">If so, it is
possible that the zone on the master server includes incompatible resource
records that Windows&nbsp;does not recognize. </span></p><span lang="EN" style="margin:0px;font-family:&quot;Calibri&quot;,sans-serif;font-size:12pt;">If either the master or
secondary server is running another DNS server implementation, check both
servers to make sure that they support the same features. You can check the
Windows&nbsp;server from the <b>Advanced</b> tab of the properties page for the
server from within the DNS console. In addition to the <b>Enable Bind
secondaries</b> box, this page includes the <b>Name checking</b> drop down
list, which enables you to select enforcement of strict RFC compliance for
characters in DNS names.</span></div></div><div><span style="box-sizing:border-box;font-size:10.5pt;font-family:&quot;Segoe UI&quot;, sans-serif;">Contributing engineer: joswoo@microsoft.com<br style="box-sizing:border-box;">Feedback/ suggestions:<span>&nbsp;</span><font color="rgba(0, 0, 0, 0)"><span style="text-decoration-style:initial;text-decoration-color:initial;cursor:pointer;"><u><a href="mailto:networkflowdevs@microsoft.com; joswoo@microsoft.com?subject=DNS-Workflow%20feedback">EMAIL</a></u></span></font><br style="box-sizing:border-box;">For more Windows Networking Workflows, go to:&nbsp;</span><span style="box-sizing:border-box;font-size:10.5pt;font-family:&quot;Segoe UI&quot;, sans-serif;"><a href="https://aka.ms/networkflows" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">https://aka.ms/networkflows</a></span></div>