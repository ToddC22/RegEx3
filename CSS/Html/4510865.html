<header><h1>Informational: Azure Active Directory - Cross-tenant Synchronization and Federation with Sovereign Cloud Tenants Azure China Overview</h1></header><p><a id="top" name="top"></a><span asset="4462485" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4462485]</span></p>

<h3>Table of Contents</h3>

<p><a bookmark-id="Introduction" href="#Introduction" managed-link=""><strong>1. Introduction</strong></a><br>
<a bookmark-id="CustomerRequirement" href="#CustomerRequirement" managed-link=""><strong>2. Customer Requirement</strong></a><br>
<a bookmark-id="SolutionOverview" href="#SolutionOverview" managed-link=""><strong>3. Solution Overview</strong></a><br>
<a bookmark-id="SolutionRequir" href="#SolutionRequir" managed-link=""><strong>4. Solution Requirements</strong></a><br>
<a bookmark-id="SupportedScenarios" href="#SupportedScenarios" managed-link=""><strong>5. Supported Scenarios</strong></a><br>
<a bookmark-id="SolutionLimitations" href="#SolutionLimitations" managed-link=""><strong>6. Solution Limitations</strong></a><br>
<a bookmark-id="SolutionImplementation" href="#SolutionImplementation" managed-link=""><strong>7. Solution Implementation</strong></a><br>
<a bookmark-id="UserExperience" href="#UserExperience" managed-link=""><strong>8. User Experience</strong></a></p>

<h3><span><a id="Introduction" name="Introduction"></a>Introduction</span></h3>

<p>Microsoft recommends customers adopt a one cloud approach for the full seamless experience across all Microsoft cloud services; however, there are customers with business requirements that force consumption of multiple clouds. <span>For example, a Multi-national organization wants to expand business in China.</span> Up until now, Azure documentation <a href="https://docs.microsoft.com/en-us/azure/active-directory/connect/active-directory-aadconnect-topologies#multiple-azure-ad-tenants">Topologies for Azure AD Connect</a> offers clear guidance on the issue of synchronizing to more than one Azure Active Directory (AAD) tenant from a single on-premises directory - Don&#39;t Do It. The guidance in that document offers a model where syncing to more than one tenant is supported, but only if you filter your synced users (so they don&#39;t appear simultaneously in two different tenants).</p>

<p>However, the Sovereign Cloud available in Azure China creates a new wrinkle to these limitations. Some Microsoft services rely on authentication to a sovereign tenant, and others in the same subscription rely on authentication to a global tenant. If Bob wants to login using his AD credentials and access Microsoft Office in global tenant, then also access Power BI in Azure China, he&#39;s going to have to have two logins, which is sub-optimal.</p>

<p><span>For those situations where a customer is required to operate in multiple clouds (requiring an Azure AD tenant in more than one cloud instance), </span>this article describes the identity management practices. Given you have on premise identity system (including Active Directory and Active Directory Federation Service), it focuses on using existing identity from on premise tenant to access and manage resources cross Azure clouds.</p>

<p><strong>Note</strong>: Guidance provided in t<span>his document is strictly meant for enabling the simultaneous synchronization of your on-</span><span>prem</span><span> directory to two Azure AD tenants: one global tenant with Office 365 and one Azure China sovereign tenant.</span></p>

<div class="faq-section" faq-section="">
<div class="faq-panel">
<div class="faq-panel-heading" faq-panel-heading="" faq-panel-id="CustomerRequirement"><span class="link-expand-image"><span class="faq-chevron win-icon win-icon-ChevronUpSmall"></span></span><span class="bold btn-link link-expand-text">&nbsp;Customer Requirement</span></div>

<div class="faq-panel-body" faq-panel-body="">
<p><span>The Dual sync scenarios are only intended for large multi-national customers or implementing the solution described in this document customer need to meet following requirements:</span></p>

<ul>
	<li>Customer must have a Premier Microsoft support contract</li>
	<li>Customer must have at-least 1,500 paid seats (&quot;Commercial, non-edu, non-trial seats&quot;) in each instance (in Global and in China)</li>
	<li><span><span><span>Customer must have pre-approval (your MS Account Rep must submit a request, fill out the form at: <span><a href="https://aka.ms/dual-federation-China">https://aka.ms/dual-federation-China</a></span><span>)</span></span></span></span></li>
	<li>Customer is willing to work with Microsoft Fast-Track Center for implementing the solution for Office scenarios and willing to work with Microsoft PFE in China for Azure scenarios.</li>
	<li>Customer must meet Solution Requirements described below.</li>
</ul>
</div>
</div>

<div class="faq-panel">
<div class="faq-panel-heading" faq-panel-heading="" faq-panel-id="SolutionOverview"><span class="link-expand-image"><span class="faq-chevron win-icon win-icon-ChevronUpSmall"></span></span><span class="bold btn-link link-expand-text">&nbsp;Solution Overview</span></div>

<div class="faq-panel-body" faq-panel-body="">
<p><span><span><span>At a high level, this solution enables the synchronization of a single Active Directory (AD) user account to multiple clouds with same domain and single ADFS farm. </span></span></span></p>

<p><span><span><span><strong>Note</strong>: The solution depicts a two-cloud scenario in the following figure.</span></span></span></p>

<p><span asset="4510875" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4510875]</span></p>

<p>In this solution:</p>

<ul>
	<li>Source of Identity is to the same account on-premises.</li>
	<li>Users/Admins only manage one password/credential.</li>
	<li>Identity is propagated to both clouds as UPN</li>
	<li>Users/Admins only need to know one sign-in name to access services in both clouds.</li>
	<li>Users/Admins can access Azure services in both clouds.</li>
</ul>
</div>
</div>

<div class="faq-panel">
<div class="faq-panel-heading" faq-panel-heading="" faq-panel-id="SolutionRequir"><span class="link-expand-image"><span class="faq-chevron win-icon win-icon-ChevronUpSmall"></span></span><span class="bold btn-link link-expand-text">&nbsp;Solution Requirements</span></div>

<div class="faq-panel-body" faq-panel-body="">
<ul>
	<li><strong>Azure AD (AAD)</strong>&nbsp;

	<ul>
		<li>At least two Azure AD Tenants:
		<ul>
			<li><span>One from Global Azure and one from Azure China.</span></li>
		</ul>
		</li>
	</ul>
	</li>
	<li><strong>AAD Connect</strong>
	<ul>
		<li>An AAD Connect instance per each AAD tenant.</li>
	</ul>
	</li>
	<li><strong>Federation Services</strong>
	<ul>
		<li>Federation with on-prem AD</li>
		<li>Single federation service farm with two relying party trusts. This recommended option is only supported with Azure AD Federation service (ADFS).
		<ul>
			<li><strong>Microsoft Office 365 Identity Platform</strong>
			<ul>
				<li>Identifiers
				<ul>
					<li>https://login.microsoftonline.com/extSTS.srf</li>
					<li>urn:federation:MicrosoftOnline</li>
				</ul>
				</li>
				<li>Default WS-Federation Passive Endpoint
				<ul>
					<li><span><a data-content-id="" data-content-type="" href="https://login.microsoftonline.com/login.srf" managed-link="" target="_blank">https://login.microsoftonline.com/login.srf</a></span></li>
				</ul>
				</li>
			</ul>
			</li>
			<li><strong>Microsoft China Identity Platform</strong>
			<ul>
				<li>Identifiers
				<ul>
					<li>urn:federation:chinacloudapi.cn</li>
				</ul>
				</li>
				<li>Default WS-Federation Passive Endpoint
				<ul>
					<li><a href="https://login.chinacloudapi.cn/login.srf" managed-link="" target="_blank">https://login.chinacloudapi.cn/login.srf</a></li>
				</ul>
				</li>
			</ul>
			</li>
		</ul>
		</li>
		<li><span>You can also choose to implement dedicated federation service farm per AAD tenant. If you choose to do that you can have flexibility to configure&nbsp;</span></li>
	</ul>
	</li>
	<li><strong><span>DNS Resolvable Custom Domain Names Added to Both Clouds</span></strong>
	<ul>
		<li>Example: contoso.com
		<ul>
			<li>See <a data-content-id="" data-content-type="" href="https://docs.microsoft.com/en-us/azure/active-directory/add-custom-domain" managed-link="" target="_blank">Add a custom domain name to Azure Active Directory</a></li>
		</ul>
		</li>
		<li>This domain will be users&rsquo; Azure AD Sign-In Name.</li>
	</ul>
	</li>
</ul>
</div>
</div>

<div class="faq-panel">
<div class="faq-panel-heading" faq-panel-heading="" faq-panel-id="SupportedScenarios"><span class="link-expand-image"><span class="faq-chevron win-icon win-icon-ChevronUpSmall"></span></span><span class="bold btn-link link-expand-text">&nbsp;Supported Scenarios</span></div>

<div class="faq-panel-body" faq-panel-body="">
<p>The Azure AD service is partitioned for each cloud environment (Global, China, etc.). Services resident within each cloud environment provide full GA feature availability to users registered within that respective cloud Azure AD service. For example, Global Azure AD Users accessing Global Application Services / Azure China AD Users accessing China Application Services.</p>

<p>Cross-tenant Cloud Service access provides a feature availability set outlined in table below. For example, Azure China AD users accessing Global Application Services or Global Azure AD users accessing China Application Services. Requests for new scenario to be added in supported scenarios will be initiated through Microsoft Support as a support ticket and will be routed directly to the appropriate engineering team(s) for review and testing.</p>

<table class="table">
	<tbody>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="center"><span><span><strong>ID</strong></span></span></p>
			</td>
			<td width="407">
			<p align="center"><span><span><strong>Scenario Description</strong></span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span><strong>Azure Global</strong></span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><strong>Azure </strong></span></span><span><span><strong>China</strong></span></span></p>
			</td>
		</tr>
		<tr>
			<td colspan="4" nowrap="nowrap" width="624">
			<p align="center"><span><span><strong><span>User and Group Synchronization</span></strong></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>A.1</span></span></p>
			</td>
			<td width="407">
			<p><span><span>Sync of all/filtered users and groups in both Azure AD Tenants</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span class="win-icon win-icon-CheckMark"></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span>&nbsp;<span class="win-icon win-icon-CheckMark"></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>A.2</span></span></p>
			</td>
			<td width="407">
			<p><span><span>New group in on-premises AD that meets filter criteria sync to both Azure AD Tenants</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span class="win-icon win-icon-CheckMark"></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span class="win-icon win-icon-CheckMark"></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>A.3</span></span></p>
			</td>
			<td width="407">
			<p><span><span>User added/removed/disabled as member of group in on-premises AD that meets filter criteria sync to both Azure AD Tenants</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span class="win-icon win-icon-CheckMark"></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span class="win-icon win-icon-CheckMark"></span></p>
			</td>
		</tr>
		<tr>
			<td colspan="4" nowrap="nowrap" width="624">
			<p align="center"><span><span><strong><span>User Authentication</span></strong></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>B.1</span></span></p>
			</td>
			<td width="407">
			<p><span><span>User synchronized to both Azure AD Tenants can authenticate via Azure Portal/PowerShell/CLI in both clouds using Federated authentication</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span class="win-icon win-icon-CheckMark"></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span class="win-icon win-icon-CheckMark"></span></p>
			</td>
		</tr>
		<tr>
			<td colspan="4" nowrap="nowrap" width="624">
			<p align="center"><span><span><strong><span>Service Principal Authentication</span></strong></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>C.1</span></span></p>
			</td>
			<td width="407">
			<p><span><span>Provision Service Principal in AD Tenant</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span class="win-icon win-icon-CheckMark"></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span class="win-icon win-icon-CheckMark"></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>C.2</span></span></p>
			</td>
			<td width="407">
			<p><span><span>Authenticate service principal via Azure PowerShell/CLI</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span class="win-icon win-icon-CheckMark"></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span class="win-icon win-icon-CheckMark"></span></p>
			</td>
		</tr>
		<tr>
			<td colspan="4" nowrap="nowrap" width="624">
			<p align="center"><span><span><strong><span>Azure RBAC &ndash; User/Group/Service Principal - Assign, Validate and Remove Admin Roles</span></strong></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>D.1</span></span></p>
			</td>
			<td width="407">
			<p><span><span>All Azure RBAC roles</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span> <span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td colspan="4" nowrap="nowrap" width="624">
			<p align="center"><span><span><strong><span>Azure AD Roles - Assign, Validate and Remove Admin Roles</span></strong></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>E.1</span></span></p>
			</td>
			<td width="407">
			<p><span><span>All Azure AD Roles</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span> <span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td colspan="4" nowrap="nowrap" width="624">
			<p align="center"><span><span><strong><span>Azure SQL Database</span></strong></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>F.1</span></span></p>
			</td>
			<td width="407">
			<p><span><span>Create and Authenticate to Azure SQL Database as Azure AD User</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span> <span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td colspan="4" nowrap="nowrap" width="624">
			<p align="center"><span><span><strong><span>Azure Web App</span></strong></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>G.1</span></span></p>
			</td>
			<td width="407">
			<p><span><span>Provision Azure Web App for Azure AD Easy Auth</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span> <span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>G.2</span></span></p>
			</td>
			<td width="407">
			<p><span><span>Authenticate to Azure Web App as Azure AD User</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span> <span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td colspan="4" nowrap="nowrap" width="624">
			<p align="center"><span><span><strong><span>Azure Key Vault</span></strong></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>H.1</span></span></p>
			</td>
			<td width="407">
			<p><span><span>Authorize and validate Azure AD User/Group/Service Principal to access a stored secret</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span> <span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td colspan="4" nowrap="nowrap" width="624">
			<p align="center"><span><span><strong><span>Dynamics 365 Retail, Finance and Operation Access &amp; Services Integration</span></strong></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>I.1</span></span></p>
			</td>
			<td width="407">
			<p><span><span>Ability for Azure AD User to access Dynamics 365 F&amp;O (China) where said Azure AD User is created and maintained via dual-tenant sync / dual federation configuration.</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span>Not Applicable</span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>I.2</span></span></p>
			</td>
			<td width="407">
			<p><span><span>Dynamics 365 F&amp;O (China) integration with Office 365 (China) or Office on-prem (in China) when utilizing the auth pattern outlined in L1.</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span>Not Applicable</span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>I.3 </span></span></p>
			</td>
			<td width="407">
			<p><span><span>Dynamics 365 F&amp;O (China) integration with Power BI (China) when utilizing the auth pattern outlined in L1.</span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span>Not Applicable</span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td colspan="4" nowrap="nowrap" width="624">
			<p align="center"><span><span><strong><span>Office 365 Collaboration Scenarios</span></strong></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>J.1</span></span></p>
			</td>
			<td width="407">
			<p><span><span><span>Unified GAL: users see complete list of users in all tenants</span></span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span> <span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>J.2</span></span></p>
			</td>
			<td width="407">
			<p><span><span><span>Users can see each other&rsquo;s Free/Busy info (users only have one level of access such as free/busy blocks)</span></span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span> <span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>J.3</span></span></p>
			</td>
			<td width="407">
			<p><span><span><span><span>SharePoint users may grant access to users from the other tenant</span></span></span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span> <span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>J.4</span></span></p>
			</td>
			<td width="407">
			<p><span><span><span>Users can IM (Skype for Business) each other regardless of their tenants</span></span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span> <span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>J.5</span></span></p>
			</td>
			<td width="407">
			<p><span><span><span>Users can join (Skype for Business) meetings regardless of their tenants</span></span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span> <span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="41">
			<p align="right"><span><span>J.6</span></span></p>
			</td>
			<td width="407">
			<p><span><span><span>Users can share a single email domain</span></span></span></p>
			</td>
			<td nowrap="nowrap" width="84">
			<p align="center"><span><span> <span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
			<td nowrap="nowrap" width="91">
			<p align="center"><span><span><span><span><span class="win-icon win-icon-CheckMark"></span></span></span></span></span></p>
			</td>
		</tr>
	</tbody>
</table>
</div>
</div>

<div class="faq-panel">
<div class="faq-panel-heading" faq-panel-heading="" faq-panel-id="SolutionLimitations"><span class="link-expand-image"><span class="faq-chevron win-icon win-icon-ChevronUpSmall"></span></span><span class="bold btn-link link-expand-text">&nbsp;Solution Limitations</span></div>

<div class="faq-panel-body" faq-panel-body="">
<p>This solution <em>does not</em> support:</p>

<ul>
	<li>Dynamics 365 F&amp;O Cross-Tenant integration services with O365, Power BI or Azure Services
	<ul style="list-style-type:circle">
		<li>Cross Cloud/AAD Tenant (Global | Sovereign) integration between Dynamics 365 F&amp;O and Power BI. For example: Dynamics 365 F&amp;O in 21ViaNet Cloud integrated with Power BI in Global Cloud or vice versa.</li>
		<li>Cross Cloud/AAD Tenant (Global | Sovereign) integration between Dynamics 365 F&amp;O and Office 365. For example: Dynamics 365 F&amp;O in 21ViaNet Cloud integrated with Office 365 in Global Cloud or vice versa.</li>
	</ul>
	</li>
	<li>User, group, password and/or device writeback from more than one Azure AD Tenant (or any services or features with a dependency on such writeback). For example: users cannot use Azure AD self-service password reset feature in both 21ViaNet and Global Cloud. Password write back for a user synced in both 21ViaNet and Global Cloud can be only configured in one of the cloud tenants. If multiple clouds tenants are configured for the same writeback feature, only the last to writeback will take effect.</li>
	<li>Device registration in more than one Azure AD Tenant (or any services or features with a dependency on such device registration. For example: Conditional Access of cloud applications based on device registration state can only be configured in one cloud tenant). Ideally, devices should be registered to the cloud that also performs device writeback or where the need for device based conditional access is greater.</li>
</ul>
</div>
</div>

<div class="faq-panel">
<div class="faq-panel-heading" faq-panel-heading="" faq-panel-id="SolutionImplementation"><span class="link-expand-image"><span class="faq-chevron win-icon win-icon-ChevronUpSmall"></span></span><span class="bold btn-link link-expand-text">&nbsp;Solution Implementation</span></div>

<div class="faq-panel-body" faq-panel-body="">
<p><span>For details steps of Single federation service farm with two relying party trusts implementation refer to <a href="https://internal.support.services.microsoft.com/en-us/help/4510884" managed-link="" target="_blank">Azure Active Directory </a></span><a data-content-id="" data-content-type="" href="https://internal.support.services.microsoft.com/en-us/help/4510884" managed-link="" target="_blank">Cross-tenant Synchronization and Federation with Sovereign Cloud Tenants Azure China Implementation</a></p>
</div>
</div>

<div class="faq-panel">
<div class="faq-panel-heading" faq-panel-heading="" faq-panel-id="UserExperience" faq-panel-id-="UserExperience"><span class="link-expand-image"><span class="faq-chevron win-icon win-icon-ChevronUpSmall"></span></span><span class="bold btn-link link-expand-text">&nbsp;<span>User Experience&nbsp;</span></span></div>

<div class="faq-panel-body" faq-panel-body="">
<p><span asset="4510882" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4510882]</span></p>

<p>Below is the breakdown of the five-step process illustrated above:</p>

<p class="indent-1"><span>Step 1: User accesses Global Office Portal or China Azure portal with (corp.admin@contoso.com), then gets redirected to the Azure AD STS for authentication.</span></p>

<p class="indent-1"><span>Step </span><span>2: The Azure AD STS performs a domain lookup, discovers that the domain is federated, and redirects the browser to the customer&rsquo;s federated STS endpoint configured on the domain.</span></p>

<p class="indent-1"><span>Step </span><span>3: The request to AD FS includes the Azure AD STS&rsquo;s entityID (urn:federation:MicrosoftOnline or urn:federation:chinacloudapi.cn) in the wtrealm parameter. AD FS looks up the relying party trust containing that entityID based on the value of wtrealm parameter.</span></p>

<p class="indent-1"><span>Step </span><span>4: ADFS issues a SAML token with the identity configured in the UPN claim rule.</span></p>

<p class="indent-1">Step 5: Browser posts issued token back to Azure AD STS; which in turn issues a JWT with the identity/UPN based on the original resource requested (Global or China Portal).</p>
</div>
</div>
</div>

<p><a bookmark-id="top" href="https://internal.support.services.microsoft.com/en-us/help/4510865#top" managed-link="">Top</a></p>
<table class="table">
	<tbody>
		<tr>
			<td><strong>Ref#</strong></td>
			<td><strong>Date</strong></td>
			<td><strong>Description</strong></td>
		</tr>
		<tr>
			<td><a href="https://dev.azure.com/ContentIdea/ContentIdea/_workitems/edit/124823" managed-link="" target="_blank">COMMERCIAL CONTENT TRACKING 124823</a></td>
			<td>November 9, 2020</td>
			<td>Updated Customer Requirement</td>
		</tr>
		<tr>
			<td><a class="caption" href="https://dev.azure.com/ContentIdea/ContentIdea/_workitems/edit/105341">Commercial Content Tracking 105341</a></td>
			<td>August 12, 2019</td>
			<td>Updated Customer Requirement</td>
		</tr>
		<tr>
			<td><span class="work-item-type-icon-host"></span>
			<div class="host_3e21a177 ms-TooltipHost work-item-type-icon-wrapper"><span class="work-item-type-icon-host"></span></div>
			<a class="caption" data-content-id="" data-content-type="" href="https://dev.azure.com/contentidea/ContentIdea/_workitems/edit/103596" managed-link="" target="_blank">Commercial Content Tracking 103596</a></td>
			<td>June 26, 2019</td>
			<td>Publish new article</td>
		</tr>
	</tbody>
</table>

<p>&nbsp;</p>
