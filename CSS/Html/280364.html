<header><h1>How to recover from Event ID 1168 and Event ID 1003 error messages</h1></header><div class='kb-symptoms-section section'>When you boot an Active Directory domain controller into normal mode following the restoration of its Active Directory database, the following error message is displayed:<div class='sbody-error'> Directory Services could not start because of the following error: The system cannot find the file specified. Error status: 0xc000000f. Please click Ok to shutdown this system and reboot into Directory Services Restore Mode, check the event log for more detail information. </div>When a domain controller that is affected by the scenario described in this article is booted into Directory Services Restore Mode (DSRM), the Directory Services event log contains the following events:</div><div class='kb-cause-section section'>The &quot;-1811&quot; strings in Events 1168 and 1003 map to the symbolic Jet error &quot;JET_errFileNotFound.&quot; This indicates that the Active Directory database file, Ntds.dit, does not exist in the folder referred to by the DSA Database File setting in the registry.<br><br><span class='text-base'>Note</span> The DSA Database File setting in the<br> <strong class='sbody-strong'>HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\NTDS\Parameters</strong>  section of the Windows registry points to the drive and directory from which a domain controller loads its Ntds.dit database.</div><div class='kb-resolution-section section'>To resolve this issue, you must investigate what operations took place prior to this error condition being reported. To do this, follow these steps: <br> <ol class='sbody-num_list'><li>Verify that the drive and path that are configured to host the Active Directory database exist. To do this, boot into Directory Services Restore Mode (DSRM) and type <span class='sbody-userinput'>Ntdsutil files info</span> at a command prompt.<br><ol class='sbody-alpha_list'><li>If the physical drive that hosts Ntds.dit has been removed from the local machine, do one of the following things:<br> <ul class='sbody-free_list'><li>Reinstall the drive, assign the appropriate drive letters, and then restore the system state.</li><li>Change the database path to an existing volume by using the <div class='indent'>NTDSUTIL  FILES SET PATH DATABASE <strong class='sbody-strong'>location</strong></div> command to define a new database path. Restore the Active Directory database to that drive and path by using an Active Directory-aware database utility. Also, change the path for the Active Directory database log files. <br><br><span> For additional information on using Ntdsutil, click the following article numbers to view the articles in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/en-us/help/315131'>315131 </a> HOW TO: Use Ntdsutil to Manage Active Directory Files from the Command Line in Windows 2000<br><br></div></span><span><div class='indent'><a id='kb-link-2' href='/en-us/help/816120'>816120 </a> How To Use Ntdsutil to Manage Active Directory Files from the Command Line in Windows Server 2003<br><br></div></span></li></ul></li><li>The logical drive letters assigned to drives and partitions on the computer may be reordered due to SCSI termination changes, updated SCSI drivers, or administrators assigning new logical drive letters to logical or physical drives.</li><li>If the logical drive letter assigned to Ntds.dit has been reordered and is assigned a different logical drive letter than the path displayed by NTDSUTIL FILES INFO, do one of the following things:<br> <ul class='sbody-free_list'><li>Reassign the original drive letter to the volume that hosts the Ntds.dit file.</li><li>Change the database path to an existing NTDS volume, and use the<div class='indent'>NTDSUTIL  FILES SET PATH DATABASE <strong class='sbody-strong'>location</strong></div> command to assign the matching database path. Also, change the path for the Active Directory database log files. Finally, restore the Active Directory database to that drive and path.</li></ul></li></ol></li><li>If an administrator attempted to restore system state by using an Active Directory-aware backup/restore utility that failed to place the Active Directory database or log files in the correct drive and path, contact the vendor of that utility.</li><li>If jet database operations such as offline defrags, integrity checks, or semantic database analysis were performed against an Active Directory database that was moved to another drive and path, ensure that the processed Ntds.dit file resides in the drive and path indicated by the DSA Database File setting in the registry. You can also discover the current database path by booting into Directory Services Restore Mode (DSRM) and typing the NTDSUTIL command <span class='text-base'>NTDSUTIL FILES INFO</span>. For example, type <span class='sbody-userinput'>Ntdsutil files info</span>.</li></ol>Any manual or automated attempt to restore the system state by using a non-Active Directory-aware backup/restore utility or by copying an Active Directory database to a domain controller&#39;s local volume is not supported and may result in forest corruption. Such improperly restored domain controllers should be restored by using a system state backup, or they should be reinstalled and promoted back into the domain prior to booting into online Active Directory mode.</div><div class='kb-status-section section'> This behavior is expected. </div><div class='kb-moreinformation-section section'> When you repair the Active Directory database with the Esentutl.exe utility, you must ensure that only the database log files are moved or deleted after the repair is complete. The Ntds.dit file must not be deleted or moved. This file must remain in the same location where it had been installed. By default, this location is the C:\Winnt\Ntds folder.<br><span><h3 class='sbody-h3'>Technical support for Windows x64 editions</h3> Your hardware manufacturer provides technical support and assistance for Microsoft Windows x64 editions. Your hardware manufacturer provides support because a Windows x64 edition was included with your hardware. Your hardware manufacturer might have customized the Windows x64 edition installation with unique components. Unique components might include specific device drivers or might include optional settings to maximize the performance of the hardware. Microsoft will provide reasonable-effort assistance if you need technical help with your Windows x64 edition. However, you might have to contact your manufacturer directly. Your manufacturer is best qualified to support the software that your manufacturer installed on the hardware.<br><br>For product information about Microsoft Windows XP Professional x64 Edition, visit the following Microsoft Web site:<div class='indent'><a id='kb-link-3' href='http://www.microsoft.com/windowsxp/64bit/default.mspx' target='_self'>http://www.microsoft.com/windowsxp/64bit/default.mspx</a></div> For product information about Microsoft Windows Server 2003 x64 editions, visit the following Microsoft Web site:<div class='indent'><a id='kb-link-4' href='http://www.microsoft.com/windowsserver2003/64bit/x64/editions.mspx' target='_self'>http://www.microsoft.com/windowsserver2003/64bit/x64/editions.mspx</a></div></span></div><div class='kb-securedata-section section'>Winx64 Windowsx64 64bit 64-bit</div><div class='kb-textlegacy-section section'>Author: JESUSD@MICROSOFT.COM (2000-11-21T11:33:00) Edit Reviewer: V-ERIHAM (2000-12-01T15:23:00) Tech Reviewer: dhook (2000-11-29T07:51:00) </div>