<header><h1>Error message when you try to connect to a file server by using an alternative NetBIOS name in Windows Server 2003: &quot;No network provider accepted the given network path&quot;</h1></header><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/80003.asp' title='Link only available for Microsoft corporate network users' target='_blank'>80003 (Content Maintenance)</a>BUG #: <a href='http://bugcheck/bugs/WindowsSE/195761.asp' title='Link only available for Microsoft corporate network users' target='_blank'>195761 (Windows SE)</a></div><div class='kb-notice-section section'><span><span class='text-base'>Important</span> This article contains information about how to modify the registry. Make sure that you back up the registry before you modify it. Make sure that you know how to restore the registry if a problem occurs. For more information about how to back up, restore, and modify the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/en-us/help/322756'>322756 </a> How to back up and restore the registry in Windows</div></span></div><div class='kb-symptoms-section section'>On a computer that is running Windows Server 2003, you receive the following error message when you try to connect to a file server by using an alternative NetBIOS name that is registered in Windows Internet Name Service (WINS):<div class='sbody-error'>No network provider accepted the given network path</div>This problem does not occur on a computer that is running Windows XP with Service Pack 2.<br><br><span class='text-base'>Note</span> You can connect to the file server by using the fully qualified domain name (FQDN) of the file server or by using the IP address of the file server.</div><div class='kb-cause-section section'>This problem occurs because the computer does not send a NetBIOS adapter status request after the computer receives a negative session response from the file server. You expect the computer to send this request to obtain the list of NetBIOS names that are registered for the adapter.</div><div class='kb-workaround-section section'>To work around this problem, use one of the following to connect to the file server:<ul class='sbody-free_list'><li>The FQDN of the file server</li><li>The IP address of the file server</li><li>The DNS alias of the file server</li></ul></div><div class='kb-status-section section'><span>Microsoft has confirmed that this is a problem in the Microsoft products that are listed in the &quot;Applies to&quot; section.</span></div><div class='kb-moreinformation-section section'>The following network trace is captured on a computer that is running Windows Server 2003:<pre class='sbody-pre'>&lt;Client&gt;&lt;File server&gt;NbtSSNbtSS: SESSION REQUEST, Length = 68<br>&lt;File server&gt;&lt;Client&gt;NbtSSNbtSS: NEGATIVE SESSION RESPONSE, Length = 1<br>&lt;Client&gt;&lt;File server&gt;TCPTCP: Flags=....A..., SrcPort=1139, DstPort=NETBIOS Session Service(139), Len=0<br>&lt;Client&gt;&lt;File server&gt;TCPTCP: Flags=F...A..., SrcPort=1139, DstPort=NETBIOS Session Service(139), Len=0<br>&lt;File server&gt;&lt;Client&gt;TCPTCP: Flags=....A..., SrcPort=NETBIOS Session Service(139), DstPort=1139, Len=0<br> </pre>This network trace indicates that the computer does not send more requests after it receives a negative session response.<br><br>The following are the details of the negative session response:<pre class='sbody-pre'>+ Ethernet: Etype = Internet IP (IPv4)<br>+ Ipv4: Next Protocol = TCP, Packet ID = 718, Total IP Length = 45<br>+ Tcp: Flags=F..PA..., SrcPort=NETBIOS Session Service(139), DstPort=1139, Len=5, Seq=&lt;number&gt; - &lt;number&gt;, Ack=&lt;number&gt;, Win=&lt;number&gt;<br>- Nbtss: NEGATIVE SESSION RESPONSE, Length = 1<br>  - NormalNbtSS: <br>     PacketType: NEGATIVE SESSION RESPONSE, 131(0x83)<br>   + Flags: Add 0 to Length<br>     Length: 1(0x1)<br>     ErrorCode: Error: Called name not present. 130(0x82)<br> </pre>The following network trace is captured on a computer that is running Windows XP with Service Pack 2:<pre class='sbody-pre'>&lt;Client&gt;&lt;File server&gt;NbtSSNbtSS: SESSION REQUEST, Length = 68<br>&lt;File server&gt;&lt;Client&gt;NbtSSNbtSS: NEGATIVE SESSION RESPONSE, Length = 1<br>&lt;Client&gt;&lt;File server&gt;TCPTCP: Flags=....A..., SrcPort=3737, DstPort=NETBIOS Session Service(139), Len=0<br>&lt;Client&gt;&lt;File server&gt;NbtNsNbtNs: Query Request for *                &lt;0x00&gt; Workstation Service<br>&lt;File server&gt;&lt;Client&gt;NbtNsNbtNs: Query Response, Success for *                &lt;0x00&gt; Workstation Service<br>...<br>&lt;Client&gt;&lt;File server&gt;NbtSSNbtSS: SESSION REQUEST, Length = 68<br>&lt;File server&gt;&lt;Client&gt;NbtSSNbtSS: POSITIVE SESSION RESPONSE, Length = 0<br>&lt;Client&gt;&lt;File server&gt;SMBSMB: C; Negotiate, Dialect = PC NETWORK PROGRAM 1.0, LANMAN1.0, Windows for Workgroups 3.1a, LM1.2X002, LANMAN2.1, NT LM 0.12<br>&lt;File server&gt;&lt;Client&gt;SMBSMB: R; Negotiate, Dialect is  (#5)<br> </pre>This network trace indicates that the computer sends a request after the computer receives a negative session response. The request is to obtain the list of NetBIOS names that are registered for the adapter. This request resembles the following:<pre class='sbody-pre'>&lt;Time&gt; 0003FF82FBCF 0003FF86FBCF NBT NS: Query req. for *&lt;00...(15)&gt; C02WXN02WKS TESTSRV IP <br>&lt;Time&gt; 0003FF86FBCF 0003FF82FBCF NBT NS: Query (Node Status) resp. for *&lt;00...(15)&gt;, Success TESTSRV C02WXN02WKS IP <br>    NBT: Question Count = 0 (0x0)<br>    NBT: Answer Count = 1 (0x1)<br>    NBT: Name Service Count = 0 (0x0)<br>    NBT: Additional Record Count = 0 (0x0)<br>    NBT: Resource Record Name =*&lt;00...(15)&gt;<br>    NBT: Resource Record Type = Node Status Request<br>    NBT: Resource Record Class = Internet Class<br>    NBT: Time To Live(Seconds) = 0 (0x0)<br>    NBT: RDATA Length = 119 (0x77)<br>    NBT: Number of Names = 4 (0x4)<br>    NBT: ASCII Name = C02E3N02SRV    00<br>    NBT: Resource Record Flags = 1024 (0x400)<br>        NBT: ......0......... = Non-Permanent<br>        NBT: .....1.......... = Active Name<br>        NBT: ....0........... = Name is not in Conflict<br>        NBT: ...0............ = Not Deregistering<br>        NBT: .00............. = B Node<br>        NBT: 0............... = Unique NetBIOS Name<br>    NBT: ASCII Name = CORP2          00<br>    NBT: Resource Record Flags = 33792 (0x8400)<br>        NBT: ......0......... = Non-Permanent<br>        NBT: .....1.......... = Active Name<br>        NBT: ....0........... = Name is not in Conflict<br>        NBT: ...0............ = Not Deregistering<br>        NBT: .00............. = B Node<br>        NBT: 1............... = Group NetBIOS Name<br>    NBT: ASCII Name = CORP2          &lt;1E&gt;<br>    NBT: Resource Record Flags = 33792 (0x8400)<br>        NBT: ......0......... = Non-Permanent<br>        NBT: .....1.......... = Active Name<br>        NBT: ....0........... = Name is not in Conflict<br>        NBT: ...0............ = Not Deregistering<br>        NBT: .00............. = B Node<br>        NBT: 1............... = Group NetBIOS Name<br>    NBT: ASCII Name = C02E3N02SRV     <br>    NBT: Resource Record Flags = 1024 (0x400)<br>        NBT: ......0......... = Non-Permanent<br>        NBT: .....1.......... = Active Name<br>        NBT: ....0........... = Name is not in Conflict<br>        NBT: ...0............ = Not Deregistering<br>        NBT: .00............. = B Node<br>        NBT: 0............... = Unique NetBIOS Name<br> </pre><h3 class='sbody-h3'>Steps to reproduce this problem</h3><span><span class='text-base'>Warning</span> Serious problems might occur if you modify the registry incorrectly by using Registry Editor or by using another method. These problems might require that you reinstall the operating system. Microsoft cannot guarantee that these problems can be solved. Modify the registry at your own risk.</span><ol class='sbody-num_list'><li>Disable direct Server Message Block (SMB) hosting on the file server. This step makes sure that you connect to the file server only over the 139 port. To do this, set the SMBDeviceEnabled registry entry to 0 (zero). The SMBDeviceEnabled entry is in the following registry subkey:<div class='indent'><strong class='sbody-strong'>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBT\Parameters</strong></div></li><li>Create a static unique record in WINS that has an alternative name that points to the IP address of the file server. Make sure that the DNS system has no entry that has the same name.</li><li>Try to connect to file server by using the following path:<div class='indent'>\\<strong class='sbody-strong'>AlternateName</strong></div></li></ol></div><div class='kb-moreinformation-section section'><h3 class='sbody-h3'>Call stack output</h3>This problem generates stack output that resembles the following:<pre class='sbody-pre'>kd&gt; kv<br>ChildEBP RetAddr Args to Child <br>80550410 fc08fa84 ffb6e7c8 ffb7a480 00000e20 netbt!Outbound<br>8055044c fc0d0b54 ffb6e7c8 ffb7a402 00000e20 netbt!TdiReceiveHandler<br>805504b0 fc0c033c ffb7a480 00001950 811c90f0 tcpip!IndicateData<br>80550538 fc0b7ef9 ffbaa868 19c8a8c0 02c8a8c0 tcpip!TCPRcv<br>80550598 fc0b7b19 00000020 ffbaa868 fc0ba076 tcpip!DeliverToUser<br>80550614 fc0b7836 fc0f7210 ffbaa868 fc153c8e tcpip!DeliverToUserEx<br>805506cc fc0b6922 ffbaa868 fc153ca2 0000001a tcpip!IPRcvPacket<br>8055070c fc0b684d 00000000 81262698 fc153c80 tcpip!ARPRcvIndicationNew<br>80550748 fc31ff45 ffb48cd8 00000000 fc218b40 tcpip!ARPRcvPacket<br>8055079c fc21301d 000d9660 8125bbd8 00000002 NDIS!ethFilterDprIndicateReceivePacket<br>805507b0 fc2131b4 810c6ad0 8125bbd8 00000002 psched!PsFlushReceiveQueue<br>805507d4 fc2135f9 ffb861c8 00000000 810c6ad0 psched!PsEnqueueReceivePacket<br>805507ec fc31fd40 ffb861c0 81246740 8125d000 psched!ClReceiveComplete<br>8055083c fc59d95e 000d9660 8125df30 00000002 NDIS!ethFilterDprIndicateReceivePacket<br>80550870 fc59d17b 8125df38 804e4fd5 8112dad0 dc21x4!ProcessReceiveDescRing<br>80550890 fc319712 00010040 80559580 80559320 dc21x4!DC21X4HandleInterrupt<br>805508ac 804dc179 8125d01c 8125d008 00000000 NDIS!ndisMDpc<br>805508d0 804dc0ed 00000000 0000000e 00000000 nt!KiRetireDpcList<br>805508d4 00000000 0000000e 00000000 00000000 nt!KiIdleLoop<br> </pre>The following stack output  is generated on a computer that is running Windows XP with Service Pack 2:<pre class='sbody-pre'>ChildEBP RetAddr Args to Child <br>fc903cfc fc0a4b8e ffb6e7c8 ffbbf578 fc903d2c netbt!NbtSendNodeStatus <br>fc903d3c fc0a4e4e 02b835b0 00000000 811756d8 netbt!NbtReConnect<br>fc903d58 fc08ec34 ffb835b0 00000000 00000000 netbt!DelayedReConnect<br>\\ The netbt!DelayedReConnect function is not called on a Windows Server 2003-based client computer. Therefore, the problem occurs.<br><br>fc903d74 804e47fe 811756d8 00000000 8128d8b8 netbt!NTExecuteWorker<br>fc903dac 8057dfed 811756d8 00000000 00000000 nt!ExpWorkerThread<br>fc903ddc 804fa477 804e4729 00000001 00000000 nt!PspSystemThreadStartup<br>00000000 00000000 00000000 00000000 00000000 nt!KiThreadStartup<br> </pre></div><div class='kb-securedata-section section'><span class='text-base'>Author: stevenxu</span><br><span class='text-base'>Writer: v-zhaoq</span><br><span class='text-base'>Tech reviewers: amanjain; stevenxu</span><br><span class='text-base'>Editor: v-jocoop</span></div>