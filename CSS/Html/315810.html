<header><h1>Browser Is Slow to Respond When You Use an Automatic Configuration Script</h1></header><div class='kb-symptoms-section section'> When you configure your Web browser to use either the<br> <strong class='uiterm'>Automatically detect settings</strong> setting or the <strong class='uiterm'>Use automatic configuration script</strong> setting in the browser&#39;s Web proxy settings, you may experience a long delay before Web pages start to load (the delay is usually between 5 to 40 seconds). <br><br> These symptoms only occur when you use the following configuration: <br> <ul class='sbody-free_list'><li>The Web proxy server is running either Proxy 2.0, Internet Security and Acceleration (ISA) Server, Microsoft Threat Management Gateway Medium Business Edition, or Windows Essential Business Server 2008.</li><li>You use the default automatic configuration script that is included in Proxy 2.0, ISA Server, Microsoft Threat Management Gateway Medium Business Edition, or Windows Essential Business Server 2008 (Array.dll?Get.Routing.Script or Wpad.dat).</li><li>You configure the default automatic configuration script to use the range of IP addresses that you specify in either the <strong class='uiterm'>Allow clients to directly access IP addresses within this range</strong> setting in ISA Server, Windows Essential Business Server 2008,  or the <strong class='uiterm'>Do not use proxy for the following IP Addresses</strong> setting in Proxy 2.0. </li></ul></div><div class='kb-cause-section section'> When you add either one Internet Protocol (IP) address or a range of IP addresses that are listed in ISA Server, Proxy 2.0, Microsoft Threat Management Gateway Medium Business Edition, or Windows Essential Business Server 2008 to the default automatic configuration script that you want the browser clients to gain access to directly, you allow browsers to bypass the Web proxy server for that particular IP address range. In this scenario, the <span class='text-base'>isInNet</span> function is used. <br><br> The <span class='text-base'>isInNet</span> function queries a DNS server. When you either try to gain access to a DNS name or type the DNS name in the <span class='text-base'>Address</span> box in the browser, the browser queries either its locally configured DNS server or its locally configured WINS server to try to resolve the DNS name to an IP address. If the browser is successful, it tries to match the IP address that is returned by DNS or WINS with the IP addresses that are used in the automatic configuration script. If these addresses match, the browser gains access to that Web site directly. If these addresses do not match, the request is sent to the Web proxy server as an ordinary Web proxy request. However, if your organization does not allow browser client computers to directly resolve DNS names on the Internet, when the browser client that uses the <span class='text-base'>IsInNet</span> function initiates a local name resolution query, the query may be unsuccessful. <br><br> The length of delay that occurs when the name resolution query is unsuccessful depends on the name resolution mechanisms that your organization uses. When the name resolution query is unsuccessful, the browser skips the procedure in which the IP address that is retrieved by <span class='text-base'>isInNet</span> is matched. Instead, the browser sends an ordinary Web proxy request, which causes the Web pages to load but with a long delay.<br><br>  The delay occurs only when the name resolution query is unsuccessful. If the clients are locally configured with a DNS server that can resolve all DNS names on the Internet, you do not experience a delay when the Web pages load.<br> </div><div class='kb-resolution-section section'> To resolve this problem, use one of the following methods: <br> <ul class='sbody-free_list'><li>Remove the IP addresses that are used in the automatic configuration script. To verify that a list of IP addresses is used in the automatic configuration script, review the client configuration settings in either the ISA Server, Proxy 2.0, Microsoft Threat Management Gateway Medium Business Edition, or Windows Essential Business Server 2008 administration tool.</li><li>Make sure that all Web Proxy browser clients can resolve all DNS names on the Internet by using its locally configured DNS server.</li></ul></div><div class='kb-status-section section'><span>Microsoft has confirmed that this is a problem in the Microsoft products that are listed at the beginning of this article. <br> </span></div><div class='kb-moreinformation-section section'><span> For additional information about automatic configuration scripts, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/EN-US/help/271719'>271719 </a> Support boundaries for Autoproxy Configuration Files<br></div></span><div class='kb-securedata-section section'> If you are a support engineer, and you want to confirm that a client computer is using the <span class='text-base'>isInNet</span> function, request the client&#39;s automatic configuration script. You can confirm that the client is using the <span class='text-base'>isInNet</span> function if you look at the <span class='text-base'>MakeIPs()</span> function and the <span class='text-base'>cDirectIPs=</span> function. If the number listed in the <span class='text-base'>cDirectIPs=</span> function is a number that is different from 0, <span class='text-base'>isInNet</span> is used when the script is run. If <span class='text-base'>cDirectIPs=0</span> is displayed in the script, the client does not use the <span class='text-base'>isInNet</span> function. The script looks similar in both Proxy 2.0 and ISA Server. <span class='text-base'>cDirectIPs</span> is located at the top of the script, and the <span class='text-base'>isInNet</span> test is located in the middle of the script.<br><br><span class='text-base'>Note</span> Even if the client uses <span class='text-base'>isInNet</span>, it may not be the cause of the delay that the customer experiences if the browser is configured with a DNS server that can resolve names on the Internet. In this scenario, it is recommended that you request a Network Monitor trace. </div></div><div class='kb-securedata-section section'>array</div><div class='kb-textlegacy-section section'>Cometbugs:14300 Author: STEVEFN (2002-01-04T06:13:00) Edit Reviewer: V-JANHAL (2002-01-31T08:53:00) Tech Reviewer: MASOUDH (2002-01-30T09:09:00) </div>