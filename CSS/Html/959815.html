<header><h1>DCOM Error 10021 is logged when you run a WinRM command against a remote computer that has update 936059 applied</h1></header><div class='kb-notice-section section'>Template: zGeneric Problem Article</div><div class='kb-notice-section section'><span class='text-base'>This article is a Fix it for me article.  Please do not make any technical changes to this article without contacting the <a id='kb-link-1' href='mailto:fixitsol' target='_self'>Fix it Solutions Team</a>.</span></div><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/97183.asp' title='Link only available for Microsoft corporate network users' target='_blank'>97183 (Content Maintenance)</a></div><div class='kb-symptoms-section section'>When you run a Windows Remote Management  (WinRM) command against a remote computer that has update 936059 applied, some errors may be logged in the System log. These errors may resemble the following:</div><div class='kb-cause-section section'>This problem occurs because the update for Windows Remote Management (WinRM) that is included with Microsoft Knowledge Base article 936059 incorrectly sets the security descriptor for the COM Application under the following subkey: <div class='indent'><strong class='sbody-strong'>HKEY_CLASSES_ROOT\AppID\{3e5ca495-8d6a-4d1f-ad99-177b426c8b8e}\LaunchPermission</strong></div></div><div class='kb-resolution-section section'><h3 class='sbody-h3'>Method 1</h3>You can use the Component Services MMC snap-in to set the correct access control entries. To do this, follow these steps:<ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>DCOMCNFG</span>, and then click <strong class='uiterm'>OK</strong>.</li><li>Expand <strong class='uiterm'>Component Services</strong>, expand <strong class='uiterm'>Computers</strong>, expand <strong class='uiterm'>My Computer</strong>, and then click <strong class='uiterm'>DCOM Config</strong>.</li><li>Right-click <strong class='uiterm'>Microsoft Windows Remote Shell Host</strong>, and then <strong class='uiterm'>Properties</strong>.</li><li>On the <strong class='uiterm'>Security</strong> tab, under <strong class='uiterm'>Launch and Activation Permissions</strong>, select <strong class='uiterm'>Customize</strong>.</li><li>Click <strong class='uiterm'>Edit</strong>.</li><li>Assign the following permissions:<ul class='sbody-free_list'><li>Everyone - Local Launch and Local Activation</li><li>Network Service, System, Administrators Group, Interactive - Local Launch, Remote Launch, Local Activation and Remote Activation (all check boxes)<br></li></ul></li></ol><h3 class='sbody-h3'>Method 2</h3>If you must deploy this change to multiple computers, you can update the registry value by using a script. To have us create and run this script  for you,  go to the <a managed-link="" href='#fixit4me' target="" bookmark-id='fixit4me'>"Fix it for me"</a> section. If you would rather do this yourself, go to the <a managed-link="" href='#letmefixit' target="" bookmark-id='letmefixit'>"Let me fix it myself"</a> section. <br><a class='bookmark' id='fixit4me'></a><h3 class='sbody-h3'>Fix it for me</h3> To create and run this script  automatically, click the <strong class='uiterm'>Fix this problem</strong> link, click <strong class='uiterm'>Run</strong> in the <strong class='uiterm'>File Download</strong> dialog box, and then follow the steps in this wizard. <br><br><br><br><span><div fix-it="" link='http://go.microsoft.com/?linkid=9646674' caption='Microsoft Fix it' text='Download'></div></span><br><br><span class='text-base'>Note</span> this wizard may be in English only; however, the automatic fix also works for other language versions of Windows.<br><br><span class='text-base'>Note</span> If you are not on the computer that has the problem, you can save the automatic fix to a flash drive or to a CD, and then you can run it on the computer that has the problem. <br><br>Now go to the <a managed-link="" href='#diditfix' target="" bookmark-id='diditfix'>"Did this fix the problem?"</a> section.<br><a class='bookmark' id='letmefixit'></a><h3 class='sbody-h3'>Let me fix it myself</h3><span><span class='text-base'>Important</span> This section, method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-2' href='/en-us/help/322756'>322756 </a> How to back up and restore the registry in Windows</div></span>To deploy this change to multiple computers, update the registry value by using the following script:<pre class='sbody-pre'><br>reg add HKEY_CLASSES_ROOT\AppID\{3e5ca495-8d6a-4d1f-ad99-177b426c8b8e} /v LaunchPermission /t REG_BINARY /d 0100048098000000A400000000000000140000000200840006000000000014000B000000010100000000000100000000000314001F000000010100000000000512000000000314001F000000010100000000000513000000000314001F000000010100000000000514000000000318001F00000001020000000000052000000020020000000314001F00000001010000000000050400000001010000000000051200000001020000000000052000000020020000 /f<br><br> </pre><a class='bookmark' id='diditfix'></a></div><div class='kb-resolution-section section'>Check whether the problem is fixed. If it is fixed, you are finished with this article.  If it is not fixed, you can contact support.</div><div class='kb-moreinformation-section section'><h3 class='sbody-h3'>Steps to reproduce this problem</h3><ol class='sbody-num_list'><li>Install update 936059.</li><li>Run the following command:<div class='indent'><span class='text-base'>C:\&gt;winrs -r:targetmachine ipconfig</span></div></li></ol></div><div class='kb-moreinformation-section section'>MICROSOFT AND/OR ITS RESPECTIVE SUPPLIERS MAKE NO REPRESENTATIONS ABOUT THE SUITABILITY OF THE INFORMATION CONTAINED IN THE DOCUMENTS AND RELATED GRAPHICS PUBLISHED ON THIS WEBSITE FOR ANY PURPOSE. THE DOCUMENTS AND RELATED GRAPHICS PUBLISHED ON THIS WEBSITE COULD INCLUDE TECHNICAL INACCURACIES OR TYPOGRAPHICAL ERRORS. CHANGES ARE PERIODICALLY ADDED TO THE INFORMATION HEREIN. MICROSOFT AND/OR ITS RESPECTIVE SUPPLIERS MAY MAKE IMPROVEMENTS AND/OR CHANGES IN THE PRODUCT(S) AND/OR THE PROGRAM(S) DESCRIBED HEREIN AT ANY TIME.<br><br>For more information about the terms of use, visit the following Microsoft Web site:<div class='indent'><a id='kb-link-3' href='/tou/' target='_self'>http://support.microsoft.com/tou/</a></div></div><div class='kb-securedata-section section'>fixit fix it</div><div class='kb-securedata-section section'><span class='text-base'>Author: anwill</span><br><span class='text-base'>Writer: v-zhaoq</span><br><span class='text-base'>Tech Reviewer: anwill</span><br><span class='text-base'>Editor: v-tcarey</span></div>