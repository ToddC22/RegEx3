<header><h1>Servicing: Tools: TSS TroubleShootingScript/toolset for rapid flexible data collection for CritSit and standard cases</h1></header><span asset="4476087" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4476087]</span><ul><li><strong>Content Idea (CI): </strong><a managed-link="" href="https://aka.ms/CIEdit?id=75911" target="" data-content-type="" data-content-id="" bookmark-id="">75911</a></li></ul><div><p><font color="#000000" face="Times New Roman" size="3"></font></p><div style="box-sizing:border-box;color:rgba(0, 0, 0, 1);font-size:14px;"><font color="#000000" face="Times New Roman" size="3"><font face="Times New Roman" size="3" style="box-sizing:border-box;"></font></font></div><p style="box-sizing:border-box;color:rgba(0, 0, 0, 1);font-size:14px;margin-bottom:8pt;margin-left:0in;margin-right:0in;margin-top:0in;"><font color="#000000" face="Times New Roman" size="3"><span style="box-sizing:border-box;color:rgba(0, 0, 0, 1);font-size:9pt;margin-bottom:0px;margin-top:0px;"><font color="#000000" face="calibri" style="box-sizing:border-box;"><p style="box-sizing:border-box;margin-bottom:10.66px;margin-top:0px;">Info from public: &nbsp;<span style="box-sizing:border-box;color:rgb(36, 41, 46);display:inline-block;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:14px;max-width:100%;overflow:hidden;vertical-align:top;"><a title="README.md" style="box-sizing:border-box;color:rgb(3, 102, 214);cursor:pointer;text-decoration:underline;" href="https://github.com/walter-1/TSS/blob/master/README.md">README.md</a></span>&nbsp;- for most recent updates please always refer to latest .zip from <a href="https://aka.ms/getTSS">https://aka.ms/getTSS</a>&nbsp; or on GitHub <a href="https://aka.ms/TssTools">https://aka.ms/TssTools</a>&nbsp;=&nbsp;&nbsp;<a style="box-sizing:border-box;cursor:pointer;text-decoration:underline;" href="https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/TSS">https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/TSS&nbsp;</a></p><h2 style="box-sizing:border-box;margin-bottom:10.66px;margin-top:0px;"><span asset="4561118" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4561118]</span>&nbsp; <a href="https://msit.microsoftstream.com/channel/7655a1ff-0400-96d1-5c86-f1ea8e441723"><span style="color:rgb(243, 144, 29);">#</span>Inshorts<span style="color:rgb(200, 38, 19);">4</span>TSS&nbsp;</a></h2><div style="box-sizing:border-box;margin-bottom:10.66px;margin-top:0px;"><h1 style="margin:0px;font-size:16px;font-weight:600;display:table-cell;vertical-align:middle;color:rgb(33, 33, 33);width:754px;font-family:SegoeUI, &quot;Stream Segoe UI&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;background-color:rgb(250, 249, 248);"><p style="margin:0cm 0cm 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;background:#FAF9F8;vertical-align:middle;"><b><span style="color:#212121;">44.</span><span style="color:#ED7D31;">#</span><span style="color:#212121;">InShorts</span><span style="color:#ED7D31;">4</span><span style="color:#212121;">TSS with Walter - <a href="https://nam06.safelinks.protection.outlook.com/?url=https://msit.microsoftstream.com/video/12d8a3ff-0400-96d1-4a8f-f1ea8e3158b1?list%3Dstudio&amp;data=02%7c01%7cWalter.Eder%40microsoft.com%7cc8897d255f51469f74b608d803d9a0dc%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637263580611180946&amp;sdata=ZVyDFWWC5tmgi1igt41Q3MZcqTuIedxvunISAQ8V7bw%3D&amp;reserved=0">TSS-Introduction</a></span></b></p></h1><h1 style="margin-right:0cm;margin-left:0cm;font-size:24pt;font-family:Calibri, sans-serif;margin:0cm;margin-bottom:.0001pt;background:#FAF9F8;vertical-align:middle;"><span style="font-size:11.0pt;color:#212121;">54.</span><span style="font-size:11.0pt;color:#ED7D31;">#</span><span style="font-size:11.0pt;color:#212121;">InShorts</span><span style="font-size:11.0pt;color:#ED7D31;">4</span><span style="font-size:11.0pt;color:#212121;">NET
with Walter E - <a href="https://nam06.safelinks.protection.outlook.com/?url=https://msit.microsoftstream.com/video/4e3aa1ff-0400-96d0-993c-f1ea9ad973b8?channelId%3D7655a1ff-0400-96d1-5c86-f1ea8e441723&amp;data=02%7c01%7cWalter.Eder%40microsoft.com%7cc8897d255f51469f74b608d803d9a0dc%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637263580611190943&amp;sdata=R8uQ0R/bwvqnIpIHJczx/wpin4aqgNUcHcjsw1IgytM%3D&amp;reserved=0">TSS
Stop Triggers</a></span></h1><h1 style="margin-right:0cm;margin-left:0cm;font-size:24pt;font-family:Calibri, sans-serif;margin:0cm;margin-bottom:.0001pt;background:#FAF9F8;vertical-align:middle;"><span style="font-size:11.0pt;color:#212121;">55.</span><span style="font-size:11.0pt;color:#ED7D31;">#</span><span style="font-size:11.0pt;color:#212121;">InShorts</span><span style="font-size:11.0pt;color:#ED7D31;">4</span><span style="font-size:11.0pt;color:#212121;">TSS
with Murat K - <a href="https://nam06.safelinks.protection.outlook.com/?url=https://msit.microsoftstream.com/video/d14da1ff-0400-a936-ac3d-f1eaa19ded75&amp;data=02%7c01%7cWalter.Eder%40microsoft.com%7cc8897d255f51469f74b608d803d9a0dc%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637263580611190943&amp;sdata=/4RYaqSk80hefUvWgPSerQ6b8wMCuKuTr7IHKXL42YQ%3D&amp;reserved=0">TSS
Log Collection Quick Tour</a></span></h1><h1 style="margin-right:0cm;margin-left:0cm;font-size:24pt;font-family:Calibri, sans-serif;margin:0cm;margin-bottom:.0001pt;background:#FAF9F8;vertical-align:middle;"><span style="font-size:11.0pt;color:#ED7D31;">&nbsp; &nbsp; &nbsp;#</span><span style="font-size:11.0pt;color:#212121;">InShorts</span><span style="font-size:11.0pt;color:#ED7D31;">T</span><span style="font-size:11.0pt;color:#212121;">NT
with Tansu - <a href="https://nam06.safelinks.protection.outlook.com/?url=https://msit.microsoftstream.com/video/7655a1ff-0400-96d1-edf2-f1ea8fb8f42e&amp;data=02%7c01%7cWalter.Eder%40microsoft.com%7cc8897d255f51469f74b608d803d9a0dc%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637263580611200935&amp;sdata=bjIqgGfrvpkreQX8f4IS/%2BA2Aa3/DR4wWi0DcnsNcZY%3D&amp;reserved=0">tss-xray
- details</a></span></h1><div><h1 style="margin-right:0cm;margin-left:0cm;font-size:24pt;font-family:Calibri, sans-serif;margin:0cm;margin-bottom:.0001pt;background:#FAF9F8;vertical-align:middle;"><span style="font-size:11.0pt;color:#212121;">80.</span><span style="font-size:11.0pt;color:#ED7D31;">#</span><span style="font-size:11.0pt;color:#212121;">InShorts</span><span style="font-size:11.0pt;color:#ED7D31;">4</span><span style="font-size:11.0pt;color:#212121;">SHA
with Suraj- Gathering TSS trace for Clustering issues</span><span style="font-size:11.0pt;color:#212121;"></span></h1><br></div><br><h2><span asset="4561119" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4561119]</span>&nbsp;<a href="https://teams.microsoft.com/l/entity/com.microsoft.teamspace.tab.wiki/tab::84862bb6-ef46-4dc1-97bf-6c918e40e410?context=%7b%22subEntityId%22:%22%7b%5c%22pageId%5c%22:2%2c%5c%22sectionId%5c%22:3%2c%5c%22origin%5c%22:2%7d%22%2c%22channelId%22:%2219:ab7dea29874747bd8bfff4a1bc51a530%40thread.skype%22%7d&amp;tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47">Tss Windows Troubleshooting</a>&nbsp; TEAMS Channel</h2></div><h1 style="border-bottom-color:rgb(234, 236, 239);border-bottom-style:solid;border-bottom-width:1px;box-sizing:border-box;color:rgb(36, 41, 46);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:2em;font-weight:600;margin-bottom:16px;margin-top:0px;padding-bottom:0.3em;"><a style="box-sizing:border-box;color:rgb(3, 102, 214);cursor:pointer;float:left;margin-left:-20px;padding-right:4px;text-decoration:underline;" href="https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/TSS#tss"><br style="box-sizing:border-box;"></a></h1><p style="box-sizing:border-box;margin-bottom:16px;margin-top:16px;"><font color="#000000" face="calibri" style="box-sizing:border-box;"><font face="Times New Roman" size="3" style="box-sizing:border-box;"></font></font></p><h1 style="border-bottom-color:rgb(234, 236, 239);border-bottom-style:solid;border-bottom-width:1px;box-sizing:border-box;color:rgb(36, 41, 46);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:2em;font-weight:600;margin-bottom:16px;margin-top:0px;padding-bottom:0.3em;"><font color="#000000" face="calibri" style="box-sizing:border-box;"><font face="Times New Roman" size="3" style="box-sizing:border-box;"><h1 style="box-sizing:border-box;margin-top:0px !important;margin-bottom:16px;padding-bottom:0.3em;border-bottom:1px solid rgb(234, 236, 239);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;"></h1><h2 style="box-sizing:border-box;margin-top:0px !important;margin-bottom:16px;font-size:1.5em;padding-bottom:0.3em;border-bottom:1px solid rgb(234, 236, 239);color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;">DISCLAIMER:</h2><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">TSS is a collection of cmd/powershell scripts that mainly utilize the built-in Windows OS logging mechanisms or other Microsoft tools (like process monitor, procdump, ...) to collect static (like event logs, registry outputs, configuration outputs and similar) or dynamic repro logs (like network traces, user/kernel mode memory dumps, perfmon logs, Process monitor logs, ETL traces from various Windows OS components and similar) to troubleshoot various Windows OS or other Microsoft product related problems dispatched to Microsoft Support. TSS has been developed and maintained by Microsoft Support Platform Escalation Team. For more details on TSS please visit https://aka.ms/TssTools</code></p><h1 style="box-sizing:border-box;font-size:2em;margin:24px 0px 16px;padding-bottom:0.3em;border-bottom:1px solid rgb(234, 236, 239);color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;"><a href="https://github.com/CSS-Windows/WindowsDiag/blob/master/ALL/TSS/ReadMe.md#tss" style="box-sizing:border-box;color:rgb(3, 102, 214);float:left;padding-right:4px;margin-left:-20px;"></a>TSS</h1><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">TSS Windows CMD based universal TroubleShooting Script toolset v<code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">2020.07.05.1</code></p><h2 style="box-sizing:border-box;margin-top:24px;margin-bottom:16px;font-size:1.5em;padding-bottom:0.3em;border-bottom:1px solid rgb(234, 236, 239);color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;"><a href="https://github.com/CSS-Windows/WindowsDiag/blob/master/ALL/TSS/ReadMe.md#tss-and-tss-ttt-toolset" style="box-sizing:border-box;color:rgb(3, 102, 214);float:left;padding-right:4px;margin-left:-20px;"></a>TSS and TSS ttt toolset</h2><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">To download the zip<span>&nbsp;</span><strong style="box-sizing:border-box;font-weight:600;">tss_tools.zip</strong>. (just click on the .zip file and then on<span>&nbsp;</span><strong style="box-sizing:border-box;font-weight:600;">[Download]</strong>)</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">If you need a package including the TTT/TTD/iDNA time travel tracing for a specific support case, please ask your Support Engineer for custom zip<span>&nbsp;</span><strong style="box-sizing:border-box;font-weight:600;">tss_tools_ttt.zip</strong><span>&nbsp;</span>(redistribution of TTT is not allowed).</p><h3 style="box-sizing:border-box;margin-top:24px;margin-bottom:16px;font-size:1.25em;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;"><a href="https://github.com/CSS-Windows/WindowsDiag/blob/master/ALL/TSS/ReadMe.md#1quick-overview-of-troubleshooting-script-tsscmd" style="box-sizing:border-box;color:rgb(3, 102, 214);float:left;padding-right:4px;margin-left:-20px;"></a>1. Quick Overview of Troubleshooting script tss.cmd</h3><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">Purpose: Multi-purpose Troubleshooting tool to simplify just-in-time rapid data collection for standard and sporadic issues in complex environments - or is to be considered as a convenient method for submitting and following quick&amp;easy action plans. Copy the relevant<span>&nbsp;</span><em style="box-sizing:border-box;">tss_tools.zip</em><span>&nbsp;</span>file and expand it to local disk, i.e. into<span>&nbsp;</span><em style="box-sizing:border-box;">C:\tools</em><span>&nbsp;</span>folder.</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">Please start the script in the C:\tools folder in<span>&nbsp;</span><strong style="box-sizing:border-box;font-weight:600;">elevated CMD window</strong>. For help, just run:<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">TSS</code><span>&nbsp;</span>or<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">TSS help yourKeyword</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss [parameter list]</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">Please invoke the tss command with necessary/appropriate parameters from here.</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">If troubleshooting intermittent/long-term issues, please invoke the script and stop it later in elevated CMD with same Admin User account (because parameters are stored in user’s registry hive<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">[HKCU\Software\Microsoft\tss.cmd-state\*]</code><span>&nbsp;</span>)</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">• Tss.cmd is built on t.cmd and fully down-level compatible (accepts same parameters as t.cmd), and provides a '<code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">Persistent</code>' switch to capture debug ETL, network sniff, WPR and ProcMon data at boot time. (Example:<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">tss.cmd CliOn Trace ProcMon Persistent</code>)</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">• For overview of possible command switches, run tss.cmd without any parameter<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">tss</code>; for full help, run<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">tss /help</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">• The tss*.zip file contains additional binaries (*.exe, *.dll) and helper.cmd scripts needed for correct usage of some parameters, like WPR tracing, Procmon tracing, or purging older trace files.</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">• You can use *On paramaters [cliOn][srvOn][rOn] individually or in combination, but at least one of cliOn, srvOn, rOn or any predefined scenario parameter must be specified.</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">• In typical reproduction scenarios you would start tracing, reproduce the problem, then stop tracing, Example:</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">o Start tracing:<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">Tss General Procmon Video</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">o ..Now reproduce problem scenario</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">o Stop tracing:<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">Tss off</code><span>&nbsp;</span>- or hit<span>&nbsp;</span><em style="box-sizing:border-box;">ANY</em><span>&nbsp;</span>key in TSS CMD window for stopping predefined scenarios</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">o Predefined -+scenarios don’t require the ‘tss off’, just hit any key when your good case/failure scenario is finished.</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">Less frequent customizable parameters are read in from configuration file<span>&nbsp;</span><em style="box-sizing:border-box;">tss_config.cfg</em>, and editing this file is the preferred option when you need to change default parameters like _DirWork, which is the default location (<code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\MS_DATA\</code>) for resulting data set.</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">• You can adjust additional scripts to run at start or stop time</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">I. Start of repro: tss_extra_repro_steps_AtStart.cmd</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">II. Before stopping repro: tss_extra_repro_steps_AtStop.cmd</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">III. As a condition to stop tracing:<span>&nbsp;</span><em style="box-sizing:border-box;">tss_stop_condition_script.cmd</em><span>&nbsp;</span>to be leveraged by TSS switch<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">stop:Cmd</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">If you start the script without any parameters, you will see available options in the help menu:<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss</code></p><pre style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;margin-top:0px;margin-bottom:16px;padding:16px;overflow:auto;background-color:rgb(246, 248, 250);border-radius:6px;color:rgb(36, 41, 46);font-weight:400;"><code style="box-sizing:border-box;margin:0px;border-radius:6px;display:inline;">&nbsp;TSS v2020.07.05.1 (c) Microsoft CSS
&nbsp;DISCLAIMER:
&nbsp;TSS is a collection of cmd/powershell scripts that mainly utilize the built-in Windows OS logging mechanisms or other Microsoft tools (like process monitor, procdump, ...) to collect static (like event logs, registry outputs, configuration outputs and similar) or dynamic repro logs (like network traces, user/kernel mode memory dumps, perfmon logs, Process monitor logs, ETL traces from various Windows OS components and similar) to troubleshoot various Windows OS or other Microsoft product related problems dispatched to Microsoft Support. TSS has been developed and maintained by Microsoft Support Platform Escalation Team. For more details on TSS please visit https://aka.ms/TssTools

&nbsp; Syntax: Tss Param[:&lt;argument&gt;] argument in [brackets] for Param is optional, defaults will be used if argument is missing, the order of sub-args is mandatory, '|' means 'OR', ':' is a delimiter between params and/or args, 'def: val' stands for Default value, '&lt;name&gt;' is placeholder

&nbsp;Usage example: TSS General &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - enables general purpose logs, DNScli, Network sniff, PSR, SDP, wait for user input w/ ANY-key
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TSS rOn cliOn Trace Video - enables SMB-client ETL-logs, Network sniff=Trace, Problem-Step-Recorder, Video and SDP report

&nbsp; &nbsp; Help [&lt;keyword&gt;] - or -? /? -help /help = this help screen, + optional &lt;keyword&gt; to search for
&nbsp; &nbsp; Query &nbsp; &nbsp; &nbsp;- query active ETW tss ms_* Data Collector Sets (LOGMAN QUERY, LOGMAN QUERY -ets)
&nbsp; &nbsp; Update &nbsp; &nbsp; - update current tss version from latest GitHub release
&nbsp; &nbsp; Version &nbsp; &nbsp;- shows current tss version: v2020.07.05.1
&nbsp; &nbsp; Remove &nbsp; &nbsp; - removes/cleans-up all persistent network and ETL component tracing; clean up Registry settings; stop running PSR,ProcMon,Trace,Video; recommended to use after forced crash

&nbsp;Enabling Tracing:
&nbsp; usage: TSS [&lt;ScenarioName&gt;|cliOn|srvOn|rOn] + see below sections '[rOn] Additional module options:' -and 'Predefined Tss scenarios:'
&nbsp; &nbsp;At least one of *on: cliOn, srvOn, rOn (= ReproOn) or any predefined &lt;ScenarioName&gt; must be specified. 
&nbsp; &nbsp; cliOn &nbsp; &nbsp; &nbsp;- generate SMB/NFS client component ETL-logs
&nbsp; &nbsp; srvOn &nbsp; &nbsp; &nbsp;- generate SMB/NFS/DFS server component ETL-logs
&nbsp; &nbsp; rOn &nbsp; &nbsp; &nbsp; &nbsp;- collecting Repro-On data / logs, required for below options unless -+&lt;ScenarioName&gt; is present.
&nbsp; &nbsp; &nbsp; you can choose any combination of available [rOn] options and/or -+scenarios below, i.e: TSS rOn DCOM General Trace:N:scenario

&nbsp; [rOn / &lt;ScenarioName&gt;] Additional module options:
&nbsp; &nbsp; AccessChk &nbsp; &nbsp; &nbsp; - collect Sysinternals AccessChk logs, may need adjustments in tss_config.cfg
&nbsp; &nbsp; AdSAM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect ActiveDirectory SAM client logs (on Win10)
&nbsp; &nbsp; AfdTcp[:Basic|Full] - collect Afd,TcpIp,NetIO ETL-log, if :Basic is specified do Basic logging; default:Full
&nbsp; &nbsp; AppV &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect Application Virtualization (App-V) ETL-log and Registry settings
&nbsp; &nbsp; ATA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect ATAPort ETL-log
&nbsp; &nbsp; BadPwd &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect User's bad password attempts info from all DCs
&nbsp; &nbsp; BGP &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect Border Gateway Protocol (BGP) ETL-log
&nbsp; &nbsp; Bluetooth &nbsp; &nbsp; &nbsp; - collect Bluetooth logs
&nbsp; &nbsp; CDROM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect CD/DVD ETL-log
&nbsp; &nbsp; certCA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- Certification Authority Service Tracing
&nbsp; &nbsp; certEnroll &nbsp; &nbsp; &nbsp;- Client Certificate Enrollment Tracing
&nbsp; &nbsp; Coreinfo &nbsp; &nbsp; &nbsp; &nbsp;- collect Sysinternals Coreinfo log
&nbsp; &nbsp; Crash &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - to be used at stop, or together with Stop trigger, Caution: this switch will force a memory.dump, open files won't save. Run 'tss off noCrash' after reboot, see KB969028
&nbsp; &nbsp; CSVspace &nbsp; &nbsp; &nbsp; &nbsp;- collect cluster CSV_space ETL-log
&nbsp; &nbsp; customETL:&lt;Provider1&gt;/&lt;Provider2&gt; - collect ETL-log with list of custom providers, example: customETL:&quot;Microsoft-Windows-DNS-Client&quot;/{1540FF4C-3FD7-4BBA-9938-1D1BF31573A7}
&nbsp; &nbsp; DataDisk:&lt;letter&gt; - to specify Disk drive letter for resulting data, default is disk C; example: DataDisk:E
&nbsp; &nbsp; DCOM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect COM,COM+,COMSVCS,COMADMIN,DCOM,DCOMSCM ETL-log, Reg-settings and SecurityDescriptor info, consider also OLE32
&nbsp; &nbsp; Dedup &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect Data Deduplication and Filter ETL-log
&nbsp; &nbsp; Defender &nbsp; &nbsp; &nbsp; &nbsp;- collect Defender/Operational Eventlogs and ATP Reg.keys
&nbsp; &nbsp; DfsR &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect DFS replication ETL-log, Eventlog, DFSR logs
&nbsp; &nbsp; DsR[:&lt;Drive&gt;:&lt;BlockSize&gt;:&lt;Sec&gt;:&lt;FS&gt;] - DriveLetter [D], BlockSize(K) [1024], Duration(Sec) [300], FileSize [10G] for DiskSpeed Repro
&nbsp; &nbsp; EFS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect encryped FS ETL-log
&nbsp; &nbsp; ETLmax:&lt;N&gt;[:&lt;NrKeep&gt;] - set limit of ETL file size to &lt;N&gt; MB, &lt;NrKeep&gt; will force chained logs, Range &lt;N&gt;:100-4096, Circ:&lt;N&gt; has precedence for cliOn/srvOn, [def: N=1024 (MB), NrKeep=1]
&nbsp; &nbsp; Evt[:Sec|Days:&lt;N&gt;] - collect Security Eventlog, default is Sys+App Eventlogs; [def. days back for TXT/CSV convert: Days:10]
&nbsp; &nbsp; Fiddler &nbsp; &nbsp; &nbsp; &nbsp; - collect Fiddler trace, to decrypt https, see https://fiddlerbook.com/fiddler/help/httpsdecryption.asp
&nbsp; &nbsp; FSLogix &nbsp; &nbsp; &nbsp; &nbsp; - collect FSLogix log and registry outputs
&nbsp; &nbsp; FSRM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect FSRM drivers ETL-log
&nbsp; &nbsp; FWmgr &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect Firewall Manager ETL log, consider also collecting WFP
&nbsp; &nbsp; GPresult &nbsp; &nbsp; &nbsp; &nbsp;- collect GPresult, Auditing and Security logs
&nbsp; &nbsp; GPsvc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect client Group Policy GPsvc.log, netlogon.log
&nbsp; &nbsp; Handle[:start|stop|both] - collect handle.exe output at stage Start or Stop [def: Stop]
&nbsp; &nbsp; HttpSys &nbsp; &nbsp; &nbsp; &nbsp; - collect HTTP.SYS ETL logging, i.e. on IIS server
&nbsp; &nbsp; ICS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect ICS SharedAccess ETL-log and SharedAccess Reg key
&nbsp; &nbsp; iDNA:&lt;PID&gt;|name[:&lt;maxF&gt;:Full|ring|onLaunch] - collect iDNA/TTD dump for PID, service name or unique ProcessName (requires tss_tools_ttt.zip) [defaults: maxF=2048 mode=Full], separate multiple PIDs/names by '/'
&nbsp; &nbsp; IPsec &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect IPsec ETL-log
&nbsp; &nbsp; iSCSI &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect iSCSI ETL-log
&nbsp; &nbsp; LBFO &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect LBFO teaming ETL-log (included in HypHost / WNV) 
&nbsp; &nbsp; LDAPcli[:&lt;ProcName&gt;] - collect LDAP client process ETL-log, requires 'REG ADD HKLM\System\CurrentControlSet\Services\ldap\Tracing\processName.exe /f' [def: svchost.exe]
&nbsp; &nbsp; LiveKd[:start|stop|both] - Execute kd/windbg memory dump on a live system at stage Start or Stop [def: Stop]
&nbsp; &nbsp; LockOut &nbsp; &nbsp; &nbsp; &nbsp; - find User Account Lockout info from all DCs (EventIDs 4625,4771,4776), requires Domain Admin account
&nbsp; &nbsp; Mini &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect only minimal data, no supporting information data like Sysinfo, Tasklist, Services, Registry hives/files, Evt-logs, skip ClearCaches, noPSR,noSDP,noVideo,noUpdate
&nbsp; &nbsp; MPIO &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect MPIO, MsDSM, Storport, ClassPnP ETL-logs
&nbsp; &nbsp; MsDSM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect MsDSM ETL-log
&nbsp; &nbsp; MUX &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect NetworkController MUX Microsoft-Windows-SlbMux ETL-log (in SDN)
&nbsp; &nbsp; NCHA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect NetworkController.HostAgent ETL-log (in SDN / WNV)
&nbsp; &nbsp; NDIS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect NDIS ETL-log
&nbsp; &nbsp; NdisWan &nbsp; &nbsp; &nbsp; &nbsp; - collect NdisWan ETL-log
&nbsp; &nbsp; Netlogon &nbsp; &nbsp; &nbsp; &nbsp;- collect Netlogon debug log 
&nbsp; &nbsp; NetView &nbsp; &nbsp; &nbsp; &nbsp; - collect Get-NetView infos for diagnosing Microsoft Networking
&nbsp; &nbsp; NFC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect Near-field communication ETL-log
&nbsp; &nbsp; NetworkUX &nbsp; &nbsp; &nbsp; - collect Network UI User Interface ETL-log
&nbsp; &nbsp; NLA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - obsolete, -&gt; plz use NCSI scenario
&nbsp; &nbsp; NTFS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect NTFS driver ETL-log
&nbsp; &nbsp; Outlook &nbsp; &nbsp; &nbsp; &nbsp; - collect Outlook ETL-log, see kb2862843, start tss - restart Outlook - repro - stop tss
&nbsp; &nbsp; OpsMgr &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect OpsMgr ETL and Eventlogs
&nbsp; &nbsp; OLE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect OLE32 ETL-log, consider also DCOM
&nbsp; &nbsp; PCI &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect PCI, setupapi and msinfo32 infos
&nbsp; &nbsp; Perfmon[:&lt;spec&gt;:&lt;int&gt;] - collect Perfmon logs, &lt;spec&gt;: choose CORE|DISK|SQL|BC|DC|Biz [def: CORE], Interval: 1-59 sec [def: 30]
&nbsp; &nbsp; PerfmonLong[:&lt;spec&gt;:&lt;int&gt;] - collect Perfmon logs, &lt;spec&gt;: choose CORE|DISK|SQL|BC|DC|Biz [def: CORE], Interval: 1-59 min [def: 05]
&nbsp; &nbsp; persistent &nbsp; &nbsp; &nbsp;- Boot-scenarios: choosen ETL logs, NETSH traces, ProcMon, WPR or Xperf will be activated, requires a reboot, then settings will be active
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; after restart, stop tracing using command: TSS OFF; Note: persistent will not work in combi with Stop:*, PSR, Video 
&nbsp; &nbsp; PktMon[:Drop] &nbsp; - collect Packet Monitoring data (on RS5+ / Srv2019), PktMon:Drop will collect only dropped packets
&nbsp; &nbsp; PNP &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect PlugAndPlay PnP ETL-log and info
&nbsp; &nbsp; PoolMon &nbsp; &nbsp; &nbsp; &nbsp; - collect PoolMon snap at start and stop
&nbsp; &nbsp; PortProxy &nbsp; &nbsp; &nbsp; - collect PortProxy IP Helper Service ETL-log, can be used i.e. in combination with Test:psTelnet:Both:IPaddr/TCPportNr
&nbsp; &nbsp; Print &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect Print Service ETL- and Event-Logs
&nbsp; &nbsp; ProcDump:&lt;PID&gt;|&lt;name&gt;[:&lt;N&gt;:&lt;Int&gt;:Start|Stop|Both] - collect N user dumps with ProcDump.exe for process ID or service name or unique ProcessName [defaults: N=3, Int=10 sec, Stop]
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to combine multiple processes or service names, use '/' separator, i.e. &nbsp;ProcDump:Notepad.exe/dnscache/WinHttpAutoProxySvc:2
&nbsp; &nbsp; ProcMon[:Boot|Purge:&lt;N&gt;[:&lt;Filter&gt;]] - collect ProcMon [Bootlog] trace, [Purge:N]: purge older *.pml files, keep number N [def: 9], Filter=name-of-FilterConfig.pmc
&nbsp; &nbsp; ProcTrack[:module|thread] - collect process tracking ETL, [Module: with Module load activity | Thread: with Thread+Module load activity]
&nbsp; &nbsp; Profile &nbsp; &nbsp; &nbsp; &nbsp; - Client Profile, WinLogon, GroupPolicy, DClocator ETL tracing
&nbsp; &nbsp; PSR[:&lt;maxsc&gt;] &nbsp; - default: collect Problem Step Recorder (PSR) screenshots, [def: maxsc=99], starting timedate.cpl, to deactivate use noPSR
&nbsp; &nbsp; Radar:&lt;PID&gt;|&lt;name&gt; - collect heap RADAR Leak diag for &lt;process ID&gt; or &lt;service name&gt; or unique &lt;ProcessName&gt;.exe
&nbsp; &nbsp; RAmgmt &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect RemoteAccess Management ETL-log
&nbsp; &nbsp; RasMan &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect RasMan service ETL-log
&nbsp; &nbsp; REG[:&lt;spec&gt;] &nbsp; &nbsp;- collect Registry output, &lt;spec&gt;: choose Hives|802Dot1x|ATP|Auth|BITS|Bluetooth|Branchcache|Cluster|CSC|DAcli|DAsrv|DFS|DCOM|DHCP|DNS|Firewall|GPsvc|Http|HyperV|ICS|LBFO|LDAPcli|MBN|MFAext|NLA|NPS|NTDS|PCI|Proxy|RAS|Rpc|SNMP|Tcp|TLS|UNChard|USB|Webclient|VPN|webClient|WLBS [def: Hives]
&nbsp; &nbsp; Rpc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect RPC, RpcSs services and DCOM ETL-logs
&nbsp; &nbsp; SCM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect Service Control Manager ETL-log of process services.exe
&nbsp; &nbsp; SCCM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect SCCM System Center Configuration Manager debug ETL-log
&nbsp; &nbsp; Sddc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect HA/Cluster PrivateCloud.DiagnosticInfo infos
&nbsp; &nbsp; SignPs1 &nbsp; &nbsp; &nbsp; &nbsp; - used to selfSign PowerShell .ps1 files at first run, so that they run with any ExecutionPolicy requiring script signing
&nbsp; &nbsp; SmartCard &nbsp; &nbsp; &nbsp; - collect SmartCard/Windows Hello for Business (WHfB) ETL-log, this is only a subset of Auth; prefer using Auth switch for authentiction issues
&nbsp; &nbsp; SNMP &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect Simple Network Management Protocol (SNMP) ETL-log
&nbsp; &nbsp; Stop:Evt:&lt;ID&gt;[:Sys|App|Sec|Other:&lt;EventlogName&gt;[:&lt;EventData&gt;[:Partial]]] - stop data collection on trigger classic (Sys, App, Sec) Eventlog &lt;EventID&gt; and/or 'Other' for non-classic EventlogNames (or _EventlogName in tss_config.cfg)
&nbsp; &nbsp; Stop:Log[:&lt;pollInt&gt;] - stop data collection on trigger Logfile: optional PollInterval-in-sec (def pollInt=10); edit criteria in tss_config.cfg
&nbsp; &nbsp; Stop:Cmd[:DFS|Smb|Svc|custom[:&lt;pollInt&gt;]] - stop data collection on trigger tss_stop_condition_script.cmd, optional PollInterval-in-sec [def: Stop:Cmd:custom:8]
&nbsp; &nbsp; Stop:ps1[:Dfs|HTTP|PortDest|PortLoc|Process|RDP|Smb|Svc|WinRM|Share|custom[:&lt;pollInt&gt;]] - stop data collection based on trigger condition defined in (adjusted) PoSh tss_stop_condition_script.ps1 [def: Port=135] and/or tss_config.cfg
&nbsp; &nbsp; Stop:Time[:&lt;min&gt;] - stop data collection after &lt;min&gt; minutes, [def: Stop:Time:10]
&nbsp; &nbsp; &nbsp; Example: stop:Evt:999:App &nbsp; &nbsp;=Stop on Event ID# 999 in Application Event log
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;stop:Evt:40962/40961:Other:Microsoft-Windows-PowerShell/Operational:3221226599 =Stop on Event ID# 40962 or 40961 in Microsoft-Windows-PowerShell/Operational EventLog with STATUS_FILE_NOT_AVAILABLE
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Stop:Evt:31010:Other:Microsoft-Windows-SMBClient/Security:Access/Denied:Partial =Stop on Event ID# 31010 in Microsoft-Windows-SMBClient/Security EventLog with Partial Message 'Access' or 'Denied'
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;stop:Log:5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=Stop on Search-string entry in specific Log file, PollInt: 5-sec, all to be defined within tss_config.cfg
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;stop:Cmd:Svc:4 &nbsp; &nbsp; &nbsp;=Stop based on service stop condition given in (adjusted) tss_stop_condition_script.cmd, PollInt: 4-sec 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;stop:ps1:PortDest:5 =Stop based on dest. TCP port 135 fail condition given in tss_config.cfg or (adjusted) tss_stop_condition_script.ps1, PollInt: 5-sec 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;stop:ps1:Share:3 &nbsp; &nbsp;=Stop based on \\server\share availability condition; see &nbsp;'Stop:PS1' trigger in (adjusted) tss_stop_condition_script.ps1, PollInt: 3-sec 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;stop:Time:3 &nbsp; &nbsp; &nbsp; &nbsp; =Stop data-collection after 3 minutes elapsed
&nbsp; &nbsp; Storage &nbsp; &nbsp; &nbsp; &nbsp; - collect Storage drivers ETL-log
&nbsp; &nbsp; StorageReplica &nbsp;- collect Storage Replica ETL-log
&nbsp; &nbsp; StorageSpace &nbsp; &nbsp;- collect Storage Space ETL-log
&nbsp; &nbsp; StorPort &nbsp; &nbsp; &nbsp; &nbsp;- collect disk/StorPort ETL-log
&nbsp; &nbsp; SysInfo &nbsp; &nbsp; &nbsp; &nbsp; - collect SystemInfo (txt based msinfo32)
&nbsp; &nbsp; SysMon[:&lt;config.xml&gt;] - collect System Monitor (Sysmon) log [def: sysmonConfig.xml]
&nbsp; &nbsp; TaskSch &nbsp; &nbsp; &nbsp; &nbsp; - collect Task Scheduler ETL-log
&nbsp; &nbsp; Test[:psPing|TraceRt|NsLookup|Http|Ldap|Smb|Wmi|publicIP|psTelnet[:Start|Stop|Both[:&lt;TestDestName&gt;[:&lt;Nr&gt;:&lt;Int&gt;] | &lt;IPaddr&gt;/&lt;Port&gt;]]] - connectivity info, separate multiple Test-scenarios names with '/', [def: psPing, TestPhase: Stop, TestDestName:www.microsoft.com|UserDomain, Nr=5, Int=2]
&nbsp; &nbsp; TLS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect Schannel TLS/SSL ETL-log, CAPI2 Evt-Log
&nbsp; &nbsp; Trace[:&lt;N&gt;[:&lt;scenario&gt;[:&lt;fileMode&gt;:&lt;Byte&gt;]]] - capture circular NETSH trace, N: bufferSize MB, separate multiple scenario names with '/' [defaults: bufferSize=500, Scenario=InternetClient, fileMode=circular, truncate Byte=1514 for Ethernet]
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for available tracing scenarios, type: 'netsh trace show scenarios', [for SrvCORE def: InternetServer], scenario 'Capture' will only sniff
&nbsp; &nbsp; &nbsp; i.e.: Trace:2048 -or- &nbsp;Trace:1024:NetConnection -or- Trace:4096:Capture -or- Trace:1024:InternetClient:Circular:128
&nbsp; &nbsp; TraceChn[:&lt;N&gt;:&lt;scenario&gt;:&lt;NrKeep&gt;] - capture chained NETSH trace, chunk bufferSize MB [def: 500, Scenario=InternetClient, NrKeep=10]
&nbsp; &nbsp; TraceNM[:&lt;N&gt;:&lt;Byte&gt;] - capture requires Netmon NMcap.exe, N: bufferSize MB [def: 500, truncate Byte=1514]
&nbsp; &nbsp; TraceNMchn[:&lt;N&gt;:&lt;NrKeep&gt;:&lt;Byte&gt;] - chained capture requires Netmon NMcap.exe, N: bufferSize MB [def: 500, NrKeep=10, truncate Byte=1514]
&nbsp; &nbsp; UEV &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect User Experience Virtualization ETL-log
&nbsp; &nbsp; USB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect Universal Serial Bus (USB) ETL-log
&nbsp; &nbsp; VDS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect VDS services ETL-log
&nbsp; &nbsp; Video &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect ScreenRecorder Video ~6 MB/min, plz use max 1920x1080 (requires .NET 3.5, Feature 'Desktop Experience' on server edition; needs DeCoder or VLC for viewing)
&nbsp; &nbsp; VirtualFC &nbsp; &nbsp; &nbsp; - collect Virtual FC info logs
&nbsp; &nbsp; VML[:verbose] &nbsp; - collect Hyper-V host VmlTrace ETL-log [def: Standard, Verbose will restart the Hyper-V service] + FRuti.exe log
&nbsp; &nbsp; VMQ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - validate Hyper-V VMQ and RSS settings (USB)
&nbsp; &nbsp; VmSwitch &nbsp; &nbsp; &nbsp; &nbsp;- collect VmSwitch ETL-log (included in HypHost and SDN)
&nbsp; &nbsp; VSS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect VolSnap, Volume Shadow Copy Service (VSS) reports
&nbsp; &nbsp; WCM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect Windows Connection Manager (WCM) ETL-log
&nbsp; &nbsp; WebIO &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect WinInet, WinHTTP, WebIO ETL-logs, i.e. for WebClient or Outlook
&nbsp; &nbsp; WfpDiag &nbsp; &nbsp; &nbsp; &nbsp; - collect WFP diag trace: netsh wfp capture
&nbsp; &nbsp; WinNAT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect WindowsNAT ETL-log
&nbsp; &nbsp; WinRM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect Windows Remote Management (WinRM) ETL-log
&nbsp; &nbsp; WinUpd &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect PS Get-WindowsUpdateLog, Merges Windows Update .etl files, (included in psSDP)
&nbsp; &nbsp; WmbClass &nbsp; &nbsp; &nbsp; &nbsp;- collect WmbClass,NDISuIO,PnP ETL-logs
&nbsp; &nbsp; WMI &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect WMI services ETL-log
&nbsp; &nbsp; WPR[:&lt;spec&gt;] &nbsp; &nbsp;- collect WPR trace on Win8.0+ , &lt;spec&gt;: choose CPU|General|Network|Storage|Wait [def: General], TSS will use Xperf for Win2008-R2
&nbsp; &nbsp; WSB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - collect Windows Server Backup modules ETL-log
&nbsp; &nbsp; WWAN &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect WWAN Wireless mobile Broadband MBN ETL-log (see also MBN)
&nbsp; &nbsp; Xperf[:&lt;spec&gt;] &nbsp;- collect circular Xperf trace, &lt;spec&gt;: choose CPU|Disk|General|Memory|Pool|SMB2|SBSL [def: General / Delay], alternatively: you may put your specific Xperf command into tss_extra_repro_steps_AtStart.cmd

&nbsp; [for cliOn/srvOn &nbsp;-only] Collection options:
&nbsp; usage on original t.cmd: T [cliOn|srvOn] [persistent][capture][core][verbose] [csv][cluster][hyperv] [circ:N] [driver:flags:level]
&nbsp; &nbsp; capture &nbsp; &nbsp; &nbsp; &nbsp; - [downlevel t.cmd] in combination with cliOn, srvOn: enable packet capture (Windows 7 / 2008 R2 or newer)
&nbsp; &nbsp; circ:N &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- generate circular logs of size N megabytes (default circular buffer size is 250 MB per log)
&nbsp; &nbsp; cluster &nbsp; &nbsp; &nbsp; &nbsp; - collect Cluster event logs
&nbsp; &nbsp; csv &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - generate cluster CSV component traces
&nbsp; &nbsp; hyperv &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- collect Hyper-V event logs
&nbsp; &nbsp; verbose &nbsp; &nbsp; &nbsp; &nbsp; - verbose mode tracing flags (defined for fskm/mup srv)
&nbsp; &nbsp; driver:flags:level - specify trace flags and level for this driver (support rdbss, mrxsmb, smb20 only)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;flags and level must be in hex
&nbsp; &nbsp; &nbsp; &nbsp; rdbss: &nbsp;0x0001 error &nbsp; &nbsp; 0x0002 misc &nbsp; &nbsp; 0x0004 io &nbsp; &nbsp; &nbsp; &nbsp;0x0008 openclose
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0010 readwrite 0x0020 fileinfo 0x0040 oplock &nbsp; &nbsp;0x0080 connectionobject
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0100 fcb &nbsp; &nbsp; &nbsp; 0x0200 caching &nbsp;0x0400 migration 0x0800 namecache
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x1000 security
&nbsp; &nbsp; &nbsp; &nbsp; mrxsmb: 0x0001 error &nbsp; &nbsp; 0x0002 misc &nbsp; &nbsp; &nbsp; &nbsp;0x0004 network &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x0008 security
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0010 exchange &nbsp;0x0020 compounding 0x0040 connectionobject 0x0080 midwindow
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0100 multichannel
&nbsp; &nbsp; &nbsp; &nbsp; smb20: &nbsp;0x0001 error &nbsp; &nbsp;0x0002 misc &nbsp; 0x0004 network 0x0008 security
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0010 exchange 0x0020 io &nbsp; &nbsp; 0x0040 handle &nbsp;0x0080 infocache
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0100 dircache 0x0200 oplock
&nbsp; &nbsp; &nbsp; &nbsp; level: &nbsp;0x1 error 0x2 brief 0x4 verbose

&nbsp;Disabling and ReEnabling Tracing:
&nbsp; usage: TSS snapshot [nocab] [nobin]

	[rOn] more No* options:
&nbsp; &nbsp; noAsk &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - do not ask about good/failing scenario text input before compressing data
&nbsp; &nbsp; noClearCache &nbsp; &nbsp;- do not clear DNS,NetBios,Kerberos,DFS chaches at start
&nbsp; &nbsp; noCluster_GetLogs - don't collect cluster infos / validation reports
&nbsp; &nbsp; noCrash &nbsp; &nbsp; &nbsp; &nbsp; - do not run Crash after reboot again when using 'tss off noCrash'
&nbsp; &nbsp; noGPresult &nbsp; &nbsp; &nbsp;- do not run GPresult, used to override setting in preconfigured TS scenarios
&nbsp; &nbsp; noSDP &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - do not gather SDP report, i.e. when using script in scheduled tasks
&nbsp; &nbsp; noPersistent &nbsp; &nbsp;- do not use predefined Persistent in scenarios
&nbsp; &nbsp; noPoolMon &nbsp; &nbsp; &nbsp; - do not run PoolMon at start and stop
&nbsp; &nbsp; noProcMon &nbsp; &nbsp; &nbsp; - do not run ProcMon, used to override setting in preconfigured TS scenarios
&nbsp; &nbsp; noPSR &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - do not run PSR, used to override setting in preconfigured TS scenarios
&nbsp; &nbsp; noRestart &nbsp; &nbsp; &nbsp; - do not restart associated service
&nbsp; &nbsp; noSound &nbsp; &nbsp; &nbsp; &nbsp; - do not play attention sound
&nbsp; &nbsp; noUpdate &nbsp; &nbsp; &nbsp; &nbsp;- do not check online for latest TSS version on Github, no AutoUpdate
&nbsp; &nbsp; noWait &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- do not wait at stage: Press ANY-Key to stop, use 'TSS OFF'
&nbsp; &nbsp; noVideo &nbsp; &nbsp; &nbsp; &nbsp; - do not run Video, used to override setting in preconfigured TS scenarios
&nbsp; &nbsp; noXray &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- do not start Xray troubleshooter

&nbsp; You can lookup netsh trace scenarios here: dbg/wpp : HKLM\System\CurrentControlSet\Control\NetDiagFx\Microsoft\HostDLLs\WPPTrace\HelperClasses
&nbsp;	 - and normal scenarios here: HKLM\System\CurrentControlSet\Control\NetTrace\Scenarios	
&nbsp; All network traces *packetcapture|NetTrace|capture|sniff*.etl files can be converted into the corresponding .pcap files using RFLcheck Etl2Pcap
&nbsp; Short link to tss download: https://aka.ms/getTSS
&nbsp;
&nbsp; Predefined Tss scenarios: (no 'Tss Off' is required, use ANY-key to stop, run: tss &lt;ScenarioName&gt;), all scenarios include network trace, PSR and SDP
&nbsp; &nbsp; 802Dot1x &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: wired LAN 802.1x,Afd,TcpIp,NDIS,RadioMgr,TLS,WCM ETL-logs, Video; for WiFi wireless please choose WLAN
&nbsp; &nbsp; Auth &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: Authentication logs (NGC BIO LSA Ntlm_CredSSP Kerberos Kdc Sam Ssl CryptNcryptDpapi WebAuth Smartcard CredprovAuthui), Security.evt, Http WFP TLS GPresult DCLocator NetLogon WinLogon Procmon Video
&nbsp; &nbsp; BITS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: Background Intelligent Transfer Service (BITS) client logs
&nbsp; &nbsp; Branchcache &nbsp; &nbsp; -+ scenario: Branchcache+BITS logs, Perfmon:BC
&nbsp; &nbsp; Container &nbsp; &nbsp; &nbsp; -+ scenario: Afd,TcpIp,WFP,HNS,Vfp,WinNAT ETL-Logs, Docker/Containers 
&nbsp; &nbsp; CSC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: OfflineFiles infos, CSC database dump, Procmon
&nbsp; &nbsp; DAcli &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: DirectAccess client info, scenario=DirectAccess,Netconnection, DA client config, WFPdiag, TLS, tss_DAclient-collector.ps1 at TSS OFF
&nbsp; &nbsp; DAsrv[:Restart] -+ scenario: DirectAccess server ETL-logs, trace scenario=DirectAcces,WFP-IPsec, get netlogon.log, TLS, 1-GB network trace, RAmgmt, Restart= RaMgmtSvc service, WfpDiag
&nbsp; &nbsp; DFScli &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: DFS client logs, RDR, GPresult, Procmon
&nbsp; &nbsp; DFSsrv &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: DFS server ETL-logs and Eventlog, [consider also DfsR]
&nbsp; &nbsp; DHCPcli &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: Boot/persistent DHCP client ETL-log and DHCP Reg info, DNScli, Procmon, persistent; after Reboot run 'TSS OFF'; add noPersistent for instant logging
&nbsp; &nbsp; DHCPsrv &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: DHCP server Eventlog ETL-logs PsCmdlets 'netsh dhcp server' info, includes DNScli
&nbsp; &nbsp; DNScli &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: DNS client ETL-logs, Eventlog
&nbsp; &nbsp; DNSsrv[:verbose] -+ scenario: DNS server DNScmd PsCmdlets, ETL-logs and Eventlog, [if verbose: Flags=FFFFFFFF]
&nbsp; &nbsp; Firewall &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: Firewall ETL-log, Firewall REG settings and Eventlog
&nbsp; &nbsp; General &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: General purpose logs, DNScli, wait for user input ANY-key
&nbsp; &nbsp; HypHost &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: LBFO, HyperV-Host, HyperV-VMbus, Vmms ETL-logs, VmWp,VmConfig, VMM-debug, 1-GB network trace
&nbsp; &nbsp; HypVM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: HyperV-VirtualMachine ETL-logs
&nbsp; &nbsp; IIS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: IIS server logs, HttpSys ETL-logs
&nbsp; &nbsp; IPAM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: IPAM ETL-log and IPAM specific Event-Logs
&nbsp; &nbsp; MBAM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: Microsoft Bitlocker Administration and Monitoring ETL-logs
&nbsp; &nbsp; MBN[:verbose] &nbsp; -+ scenario: Mobile Broadband Network/LTE: Afd,TcpIp,DNScli,GPresult,RasMan,RadioManager,VPN,WFP,WCM ETL-logs, Firewall info, Netsh Ras diag, 1-GB Trace wwan_dbg [if verbose: +,wireless_dbg], Video
&nbsp; &nbsp; Miracast &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: Miracast, Video
&nbsp; &nbsp; MsCluster &nbsp; &nbsp; &nbsp; -+ scenario: MsCluster related logs: CSV,NetFt,LBFO,Storport, Perfmon:CORE, ClusterLog, SDP:cluster
&nbsp; &nbsp; NCSI &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: includes NLA, wireless_dbg,internetclient_dbg, Microsoft-Windows-PrimaryNetworkIcon, GPresult, Procmon, Video, you may run tss_NCSI_detect script
&nbsp; &nbsp; NetIO &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: Afd,TcpIp,NetIO,WFP ETL-logs
&nbsp; &nbsp; NFScli &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: NFS client logs, GPresult, Procmon, Video
&nbsp; &nbsp; NFSsrv[:perm] &nbsp; -+ scenario: NFS server cmds PsCmdlets, ETL-logs and Eventlogs, 'perm' will ask for NFS Folder/File path
&nbsp; &nbsp; NLB &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: Afd,TcpIp,NetIO,NLB ETL-logs, NLB/Diagnostic Events, WLBS display, msinfo32
&nbsp; &nbsp; NPS[:MFAext] &nbsp; &nbsp;-+ scenario: NPS ETL-logs, Netsh Ras diag, netsh nps tracing, TLS, 1-GB network trace, Securtiy EvtLog, [optional :MFAext]
&nbsp; &nbsp; Proxy &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: NCSI,WebIO,WinInet,WinHTTP,Winsock ETL-logs, Proxy settings and related Registry settings, 1-GB trace, Procmon, Video
&nbsp; &nbsp; RAS[:Hang] &nbsp; &nbsp; &nbsp;-+ scenario: Remote Access Server ETL-logs, TLS, WFP diag trace, trace scenario=VpnServer; [:Hang will collect at stop Procdumps of Rasman/RemoteAccess/RaMgmtSvc/IKEEXT/BFE/RaMgmtui.exe]
&nbsp; &nbsp; RDScli &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: Remote Desktop (RDP) client ETL-logs, QWinSta, REG settings, Env-var, GPresult, event logs, Video; add Evt:Sec to collect Security Eventlog
&nbsp; &nbsp; RDMA[:Basic|Full] -+ scenario: RDMA ETL-log, Event-Logs, SMB client [default=Basic]
&nbsp; &nbsp; RDSsrv &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: Remote Desktop (RDP) server ETL-logs, QWinSta, REG settings, Env-var, GPresult, event logs incl Sec.EvtLog
&nbsp; &nbsp; SBSL &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: Slow Boot/Slow Logon: boot/persistent logs, Profile,Netlogon,WinLogon,GroupPolicy,DCLocator,GPresult,GPsvc,Auth,WPR:Wait,Procmon:Boot, 1-GB trace; after Reboot run 'TSS OFF'
&nbsp; &nbsp; SDN &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: SDN Infra Logs, see SDN\SDNLogCollect.ps1, Specify one of the NC VM and collect Logs from NC, MUX and Gateway VMs
&nbsp; &nbsp; SdnNC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: SDN NetworkController,HttpSys,MUX,LBFo,NCHA,TLS,VmSwitch ETL-logs, consider to add WFP for GW
&nbsp; &nbsp; SDP[:&lt;spec&gt;[:noNetadapters|skipBPA|skipHang|skipNetview|skipSddc|skipTS|skipHVreplica]] - collect SDP report, choose SDP &lt;spec&gt;ialty Apps|CTS|Cluster|DA|Dom|HyperV|Net|Perf|Print|S2D|Setup|SQLbase|SQLconn|SQLmsdtc|SQLsetup|VSS|Mini|Nano|All [def: Net]; to combine more specs or skip-parameters, use '/' as separator i.e.: SDP:Net/HyperV:skipBPA
&nbsp; &nbsp; SMBcli &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: SMB,DFS client logs, RDR, GPresult, Procmon
&nbsp; &nbsp; SQLtrace &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: SQL server related logs and TraceChn, Perfmon:SQL, SDP:SQLbase
&nbsp; &nbsp; UNChard &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: UNC-hardening: boot/persistent logs, Profile,Netlogon,WinLogon,GroupPolicy,DCLocator,GPresult,GPsvc,Auth,Procmon:Boot, 1-GB trace; after Reboot run 'TSS OFF'
&nbsp; &nbsp; VPN &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: Afd,TcpIp,NetIO,VPN ETL-logs, WFP diag trace, 1-GB network trace VpnClient, Netsh Ras diag, Video
&nbsp; &nbsp; WebClient[:Adv|Restart] -+ scenario: WebClient logs, WebIO ETL, Proxy, TLS, [def: Basic, Restart= ~ service, Adv= incl. iDNA, requires TTD]
&nbsp; &nbsp; WFP &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: Afd,TcpIp,NetIO,WFP Windows Filtering Platform, BFE (Base Filtering Engine), includes WfpDiag: netsh wfp capture, Procmon, Video
&nbsp; &nbsp; Winsock &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: Afd,TcpIp,NetIO,NDIS,Winsock ETL-logs
&nbsp; &nbsp; WIP &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -+ scenario: Windows Information Protection diagnostic, Procmon, Video
&nbsp; &nbsp; WLAN &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-+ scenario: wireless 802.1x,Afd,TcpIp,NDIS,NetworkUX,RadioMgr,TLS,WCM ETL-logs, Video for WiFi wireless connection
&nbsp; &nbsp; WNV[:capML] &nbsp; &nbsp; -+ scenario: Network Virtualization (WNV) ETL-log, Afd,TcpIp,LBFo,NCHA,VmSwitch, network trace Virtualization,InternetClient; if capML captureMultilayer=yes
&nbsp; &nbsp; WorkFolders[:Adv] -+ scenario: WorkFolders infos on Srv and Client, Perfmon, Video, if :Adv collect Advanced-Mode with restart of service
&nbsp; &nbsp; &nbsp;- more options for controlling predefined scenarios: noSDP,noPSR,noCab,noPersistent,noProcmon,noPoolMon,noGPresult,noRestart,noSound,noCrash,noClearCache,noAsk,noUpdate,noWait,noVideo see also tss_config.cfg

&nbsp;Disabling Tracing:
&nbsp; usage: TSS off [nocab] [nobin] [noSDP]
&nbsp; &nbsp; off &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- turn off tracing
&nbsp; &nbsp; noCab &nbsp; &nbsp; &nbsp; &nbsp;- do not compress/zip trace data
&nbsp; &nbsp; nobin &nbsp; &nbsp; &nbsp; &nbsp;- do not gather system binaries matching the captured traces on downlevel OS
&nbsp; &nbsp; noSDP &nbsp; &nbsp; &nbsp; &nbsp;- do not gather SDP report, i.e. when using script in scheduled tasks

&nbsp;TSS v2020.07.05.1. Check for updates on: http://aka.ms/TssTools - Download: http://aka.ms/getTss
&nbsp; &nbsp; &nbsp; or run 'TSS update'
&nbsp; -&gt; see 'TSS /help' for more detailed help info
&nbsp; -&gt; Looking for help on specific keywords? Try e.g.: tss help &lt;my_keyword&gt;

</code></pre><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">Predefined parameters in<span>&nbsp;</span><em style="box-sizing:border-box;">tss_config.cfg</em></p><pre style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;margin-top:0px;margin-bottom:16px;padding:16px;overflow:auto;background-color:rgb(246, 248, 250);border-radius:6px;color:rgb(36, 41, 46);font-weight:400;"><code style="box-sizing:border-box;margin:0px;border-radius:6px;display:inline;">@rem tss_config.cfg v05.27: CONFIGURE below variables for granular controlling TSS behaviour - be sure that modified lines have no trailing space character
@rem Disk and folder path of data collection results, i.e. D:\MS_DATA - only use local disk, NOT a Onedrive or redirected Folder!
_DataDisk=C
@_DirWork=!_DataDisk!:\MS_DATA
@
@rem For using 'Stop:Log' trigger specify path of monitored Logfile, optional Pollinterval-in-sec (def: Log-pollInt=8 sec), be sure the SearchString is not already found in curent logFile at start of TSS
_StopSearchString=Access Denied
_LogFilePath=&quot;C:\tss_Tools\tss_StopLog_EntryFound.tmp&quot;
_PollIntervalInSec=8
@
@rem For using 'Stop:PS1' trigger in tss_stop_condition_script.ps1
_PortLoc=135
_PortDest=&quot;135/445&quot;
_SvcName=&quot;LanmanWorkstation&quot;
_ServerName=&quot;LocalHost&quot;
_ShareName=&quot;Contoso-Share&quot;
_ProcessName=&quot;Notepad&quot;
_ErrorLimit=1
@
@rem next 3 variables control the frequency of purging chained Network Traces or Procmon logs
_PurgeNrFilesToKeep=10
_PurgePollIntervalSec=10
_PurgeTraceChn=1
@
_ProcMonSpec=Purge
_EtlBuf=1024
_TraceBufferSize=500
_TracefileMode=circular
@
@rem next 3 variables are for 'AccessChk', please verify if disk, folder and file names exist
_ShareNames=C$ D$ E$
_FolderPaths=C:\ C:\DFSroots D:\ E:\
_FilePaths=C:\bootmgr
@
@rem ex: _EventlogName=Microsoft-Windows-PowerShell/Operational and _Stop_EventID=40962/40961 are used by &nbsp;'stop:Evt:ID:Other:&lt;EvtLogname&gt;:&lt;EventData&gt;[:Partial]' to stop i.e. on multiple eventIDs and EventData strings. Note: Eventlog names with space/blank character need to be specified in this config file with quotes, ex: &quot;DNS Server&quot;; 
@ &nbsp; &nbsp; &nbsp; &nbsp;_Stop_EventData must match a complete string within XMLview &lt;Data&gt; &lt;/Data&gt;, put whole multi-word string within quotes / or append :Partial
_EventlogName=
_Stop_EventID=
_Stop_WaitTimeInSec=0
_Stop_EventData=0
@
@rem write an EventID 999 into remote hosts eventlog to stop TSS at remote host, if started with 'stop:Evt:999' or any other ID; comma separated list like =host1,host2
_WriteEventToHosts=
_Remote_Stop_EventID=999
@
@rem TSS tasks/parameters that will be skipped on local PC at 'tss OFF' or using 'stop:Evt' when EventID created by source 'TSS' is found; comma separated list
_SkipExecutionList=LiveKd,_Cluster_GetLogs
@
@rem set _ClusterLog=0 to skip collect cluster log; per default we collect already cluster info via PS script tss_Cluster_GetLogs.ps1
_ClusterLog=0
_Cluster_WriteEventToHosts=1
_LiveDmp_analytic=0
@
@rem to suppress acoustic sound output at some stages that need attention, set _noSound=1
_noSound=0 &nbsp;
@
@rem To turn off waiting for ANY/key in TS_Scenarios, set _noWait=1
_noWait=0
@
@rem To turn off TSS version check, set _noVerCheck=1
_noVerCheck=0
@
@rem To turn off SDP,Procmon,PSR,GPresult,Video,Persistent logging in TS_Scenarios, set _no&lt;Variable&gt;=1
_noSDP=0
_noProcmon=0
_noPSR=0
_noGPresult=0
_noVideo=0
_noPersistent=0
@
@rem &nbsp;To automatically restart a new run after Stop condition was hit
_Autorestart=0
@
@rem &nbsp;To check for Get-SpeculationControlSettings, set _SpeculationControl=1
_SpeculationControl=0
@
@rem SCCM enable debug logging when using 'Branchcache' scenario, set _SCCMdebug=1, alternate method: use TSS switch SCCM
_SCCMdebug=0
@
@rem VmlTrace start parameters, i.e. for VmlTrace.exe /m a /f all all /i
_VmlTraceCmd=/m all /f all all /u /z 600 /i
@
@rem custom ETL tracing. Add a '/' separated list of Providernames or GUIDs, i.e. _customETL=&quot;Microsoft-Windows-DNS-Client&quot;/{1540FF4C-3FD7-4BBA-9938-1D1BF31573A7}
_customETL=
@
@rem Connectivity Test[:psPing|TraceRt|NsLookup|Http|Ldap|Smb|Wmi|publicIP|psTelnet[:Start|Stop|Both[:TestDestName[:Nr:Int]]]]
_TestPhase=Stop
_TestURL=www.microsoft.com
_TestDestName=
_psPingNr=5
_psPingInt=2
@
@rem define NetLogon DbgFlag, i.e. less verbose: 2080FFFF
_NetLogonFlag=2FFFFFFF
@
@ controlling Branchcache/BITS
_RunPS_BCstatus=1
_BC_RESTART=0
_BITSLOG_RESET=0
_BITSLOG_RESTART=1
@
@rem &nbsp;To perform no RunDown in AfdTcpIp ( netsh int TCP rundown ) on Win10-RS5+, set _RunDown=0
_RunDown=1
@
@rem &nbsp;Specify Xperf Pool Tag
_XperfTag=NDnd
@
</code></pre><h3 style="box-sizing:border-box;margin-top:24px;margin-bottom:16px;font-size:1.25em;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;"><a href="https://github.com/CSS-Windows/WindowsDiag/blob/master/ALL/TSS/ReadMe.md#2examples-of-frequently-helpful-built-in-ts-troubleshooting-scenarios" style="box-sizing:border-box;color:rgb(3, 102, 214);float:left;padding-right:4px;margin-left:-20px;"></a>2.<span>&nbsp;</span><strong style="box-sizing:border-box;">Examples of frequently helpful built-in TS (troubleshooting) scenarios</strong></h3><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">TSS scenarios are predefined data collection sets, which include all necessary data like PSR, ProcMon, Perfmon or ETL tracing logs. All these predefined scenarios include network tracing/sniffing, PSR and SDP report:</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">#1 Collect logs for UNC hardening issues, log on as local Admin, open elevated CMD window and run: (Scenario includes persistent Client SMB ETL-logs, Network Trace, Gpresult, GPsvc, Auth, Registry, Procmon, SDP)</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss UNChard</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">#2 Collect Branchcache logs (Scenario includes Network Trace, PSR, Gpresult, Registry, Perfmon, SDP)</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss Branchcache</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">#3 Collect DFS client or SMB client logs (Scenario includes Network Trace, PSR, Gpresult, Procmon, SDP)</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss DFScli</code><span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss SMBcli</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">#4 Collect DNS client logs (Scenario includes Network Trace, PSR, SDP)</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss DNScli</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">#5 Collect logs for SQLtracing (Scenario includes Network Trace, Perfmon)<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss SQLtrace</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">#6 Collect logs for CSC Offline Files (Scenario includes Client SMB ETL-logs, Network Trace, Gpresult, Registry, PSR, Procmon, SDP)</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss CSC</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">#7 Collect logs for Authentication provider (Scenario includes Client SMB, SSL,HTTPsys ETL-logs, Network Trace, Gpresult, Registry, PSR, Procmon, SDP)</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss Auth</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">#8 Collect logs for MS-cluster (Scenario includes Network Trace, NetFT+LBFO+Cluster ETL, Storport, Perfmon, SDP)</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss MsCluster</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">sample for 1135 issues:</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">TSS srvOn cliOn MsCluster Perfmon:CORE:1 CSVspace Stop:evt:1135:Sys</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">#9 Collect logs for WebClient (similar to interactive WebClient SDP) (Scenario includes Network Trace, WebIO ETL, Proxy, PSR, Procmon, SDP, Advanced includes TTT/iDNA)<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss Webclient[:Adv]</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">#10 DiskSpeed tests, for more info see 'tss /help'</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss Ron DsR:D:1024:300:10G</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">Above commands will start the data collection and most will stop on predefined scenarios after hitting ANY-key. To stop data collection logging for non-predefined scenarios, run:<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss off</code><span>&nbsp;</span>( if you use ‘tss off nocab’ the data in C:\MS_DATA&lt;date-time folder&gt; will not be compressed; using noSDP will not ask for SDP report.)</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">Most of the scenarios will automatically collect the SDP report at the end of the data collection; the default SDP report is the Network Diagnostic.</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">Note: The SDP tool Portable_Diagnostic.exe from<span>&nbsp;</span><a href="https://home.diagnostics.support.microsoft.com/selfhelp" rel="nofollow" style="box-sizing:border-box;color:rgb(3, 102, 214);">https://home.diagnostics.support.microsoft.com/selfhelp</a><span>&nbsp;</span>can also be downloaded separately from same GitHub location, but be aware:</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">For this SDP report, at the end of SDP data collection please uncheck ‘[ ] Send results to Microsoft’ click [Save a copy], then click [Next]. Please upload the saved report manually onto MS workspace.</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">TSS will invoke the already included PowerShell script based psSDP report, which runs on all OS versions, including Server core 2016/2019. To start the psSDP report separately, open an elevated PowerShell window and enter for EXAMPLE 1:</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">.\Get-psSDP.ps1 Net -savePath C:\temp</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">for collecting SDP NETworking Diagnostic data, saving data to folder C:\temp</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">EXAMPLE 2:<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">.\Get-psSDP.ps1 Mini</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">for SDP Basic minimal data collection, saving data to current folder</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">EXAMPLE 3:<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">.\Get-psSDP.ps1 Net NoCab</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">for SDP Net without zipping results</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><strong style="box-sizing:border-box;font-weight:600;">More Examples:</strong></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">A) You want to stop tracing based on a trigger Eventlog ID (stop:Evt:Id) or some specific error entry in a log file for issues, which occur sporadically: use the Stop feature:</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">Example:<span>&nbsp;</span><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; tss Ron traceChn:1 stop:Log</code></p><pre lang="stop:Evt:ID:Eventlog" style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;margin-top:0px;margin-bottom:16px;padding:16px;overflow:auto;background-color:rgb(246, 248, 250);border-radius:6px;color:rgb(36, 41, 46);font-weight:400;"><code style="box-sizing:border-box;margin:0px;border-radius:6px;display:inline;">stop:Log[:pollInt] - stop data collection on trigger Logfile: optional PollIntervall-in-sec (def pollInt=10)
&nbsp; &nbsp; &nbsp; Examples: stop:Evt:999:App =Stop on Event in Application Event log with Event ID# 999 &nbsp;(def: App:999 )
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;stop:Log:5 =Stop on Search-string entry in specific Log file, both to be defined within tss_TestLogFile.cfg
</code></pre><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">regarding second example, if you want to stop tracing based on a specific Windows Log entry, you can adjust the two parameters _StopSearchString and _LogFilePath in the configuration file tss_config.cfg, and optionally adjust 3rd parameter _LogPollIntervalSec:</p><pre style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;margin-top:0px;margin-bottom:16px;padding:16px;overflow:auto;background-color:rgb(246, 248, 250);border-radius:6px;color:rgb(36, 41, 46);font-weight:400;"><code style="box-sizing:border-box;margin:0px;border-radius:6px;display:inline;">_StopSearchString=Access Denied
_LogFilePath=&quot;C:\tss_Tools\tss_StopLog_EntryFound.tmp&quot;
_PollIntervalInSec=8
</code></pre><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">Read the file tss_StopTokenFile._tmp for testing your config.</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">B) You want to run extra commands right after the script begins to start running? No problem, just edit the included batch file tss_extra_repro_steps_AtStart.cmd and modify it for your own needs. This batch file will be executed at each start of 'tss Ron' =ReproOn.</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">C) You want to run extra commands before the script ends repro? No problem, just edit the included batch file tss_extra_repro_steps_AtStop.cmd and modify it for your own needs. This batch file will be executed at end of repro and before 'tss OFF' =ReproOFF.</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">D) You want to stop tracing based on specific conditions? No problem, just edit the included batch file tss_stop_condition_script.cmd and modify it for your own needs (i.e. by default: check if File share is available).</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">When using the<span>&nbsp;</span><strong style="box-sizing:border-box;font-weight:600;">Persistent</strong><span>&nbsp;</span>switch, the settings will be active after each reboot, and you will stop data collection using 'Tss Off', unless you decide to Stop and Remove it by running following command, when you are finished with all of your troubleshooting:</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><code style="box-sizing:border-box;font-family:SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, monospace;font-size:13.6px;padding:0.2em 0.4em;margin:0px;background-color:rgba(27, 31, 35, 0.05);border-radius:6px;">C:\tools&gt; Tss Remove</code></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><strong style="box-sizing:border-box;font-weight:600;">Notes/hints:</strong></p><ul style="box-sizing:border-box;padding-left:2em;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><li style="box-sizing:border-box;"><p style="box-sizing:border-box;margin-top:16px;margin-bottom:16px;">Some parameters are mutually exclusive: don’t combine [capture], [trace] or [traceChn]</p></li><li style="box-sizing:border-box;margin-top:0.25em;"><p style="box-sizing:border-box;margin-top:16px;margin-bottom:16px;">If you want to use the SDP switch with a specialty switch, just supply your SDP sceciality: default SDP category= NET, choose [Apps|Cluster|S2D|CTS|Dom|HyperV|Net|Perf|Print|Setup|SQLbase|SQLconn|SQLmsdtc|SQLsetup|VSS|Mini|Nano|Remote|RFL|All]</p></li><li style="box-sizing:border-box;margin-top:0.25em;"><p style="box-sizing:border-box;margin-top:16px;margin-bottom:16px;">In case of unforeseen errors, please be sure to stop tracing<span>&nbsp;</span><strong style="box-sizing:border-box;font-weight:600;">“tss off”</strong><span>&nbsp;</span>before starting a new trace session. Also try<span>&nbsp;</span><strong style="box-sizing:border-box;font-weight:600;">“tss remove”</strong><span>&nbsp;</span>if you can’t recover (new start of tss .. fails, stop command tss off also fails)</p></li></ul><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><strong style="box-sizing:border-box;font-weight:600;">Revision History</strong></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">See<span>&nbsp;</span><a href="https://github.com/CSS-Windows/WindowsDiag/blob/master/ALL/TSS/revision-history.txt" style="box-sizing:border-box;color:rgb(3, 102, 214);">https://github.com/CSS-Windows/WindowsDiag/blob/master/ALL/TSS/revision-history.txt</a></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;"><strong style="box-sizing:border-box;font-weight:600;">Additional Infos</strong></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:16px;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">For customers: To download files from MS workspace, see KB article 4012140:</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:0px !important;color:rgb(36, 41, 46);font-family:-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;;font-size:16px;font-weight:400;">How to use Secure File Exchange to exchange files with Microsoft Support<span>&nbsp;</span><a href="https://support.microsoft.com/en-US/help/4012140" rel="nofollow" style="box-sizing:border-box;color:rgb(3, 102, 214);">https://support.microsoft.com/en-US/help/4012140</a></p></font></font></h1></font></span><br></font><p></div><div><div><span style="margin:0px;font-size:9pt;"><font color="#000000" face="calibri"><font color="#000000" face="calibri"><font face="Times New Roman" size="3"><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;"><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;"><div style="box-sizing:border-box;color:rgb(37, 36, 35);font-family:&quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;"><span style="box-sizing:border-box;font-size:1.4rem;"><strong style="box-sizing:border-box;font-weight:700;">TSS<span>&nbsp;</span></strong>public<span>&nbsp;</span></span><strong style="box-sizing:border-box;font-weight:700;"><a href="https://github.com/CSS-Windows/WindowsDiag/blob/master/ALL/TSS/tss_tools.zip" rel="noreferrer noopener" target="_blank" title="https://github.com/css-windows/windowsdiag/blob/master/all/tss/tss_tools.zip" tabindex="-1" style="box-sizing:border-box;color:rgb(98, 100, 167);">download</a>&nbsp;zip</strong><span style="box-sizing:border-box;font-size:1.4rem;">:<span>&nbsp;</span><a href="https://aka.ms/TssTools" rel="noreferrer noopener" target="_blank" title="https://aka.ms/tsstools" tabindex="-1" style="box-sizing:border-box;color:rgb(98, 100, 167);">https://aka.ms/TssTools</a><span>&nbsp;</span>=&nbsp;</span><a href="https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/TSS" rel="noreferrer noopener" target="_blank" title="https://github.com/css-windows/windowsdiag/tree/master/all/tss" tabindex="-1" style="box-sizing:border-box;color:rgb(98, 100, 167);font-size:1.4rem;">https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/TSS</a></div><div style="box-sizing:border-box;">direct short link for download:<span>&nbsp;</span><a href="https://aka.ms/getTSS" rel="noreferrer noopener" target="_blank" title="https://aka.ms/gettss" tabindex="-1" style="box-sizing:border-box;color:rgb(98, 100, 167);">https://aka.ms/getTSS</a>&nbsp;<span style="box-sizing:border-box;font-size:11pt;"><span style="box-sizing:border-box;font-family:Calibri, sans-serif;"></span></span></div></div></div><div style="box-sizing:border-box;color:rgb(37, 36, 35);font-family:&quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif;"><strong style="box-sizing:border-box;font-weight:700;">Purpose</strong>: Rapid &amp; flexible data collection (includes psSDP)</div><div style="box-sizing:border-box;color:rgb(37, 36, 35);font-family:&quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif;">internal<span>&nbsp;</span><strong style="box-sizing:border-box;font-weight:700;">KB</strong>:<span>&nbsp;</span><a href="https://internal.support.services.microsoft.com/en-US/help/4089531" rel="noreferrer noopener" target="_blank" title="https://internal.support.services.microsoft.com/en-us/help/4089531" tabindex="-1" style="box-sizing:border-box;color:rgb(98, 100, 167);">4089531<span>&nbsp;</span></a>Servicing: Tools: TSS TroubleShootingScript/toolset for rapid flexible data collection for CritSit and standard cases</div><div style="box-sizing:border-box;color:rgb(37, 36, 35);font-family:&quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif;"><p style="box-sizing:border-box;margin:0px 0px 10px;"><span style="box-sizing:border-box;font-size:11pt;"><span style="box-sizing:border-box;font-family:Calibri, sans-serif;"><b style="box-sizing:border-box;font-weight:700;"><span style="box-sizing:border-box;font-size:9pt;">email DistributionList&nbsp;</span></b><span style="box-sizing:border-box;font-size:9pt;">for discussion/questions on TSS&nbsp;tools</span></span></span><span style="box-sizing:border-box;font-size:11pt;"><span style="box-sizing:border-box;font-family:Calibri, sans-serif;"><span style="box-sizing:border-box;font-size:9pt;"><span style="box-sizing:border-box;">: -&gt;<span>&nbsp;</span><span style="box-sizing:border-box;background-color:rgb(158, 210, 103);"><u style="box-sizing:border-box;"><a href="https://idwebelements/GroupManagement.aspx?Group=ww-css-tss&amp;Operation=join" rel="noreferrer noopener" target="_blank" title="https://idwebelements/groupmanagement.aspx?group=ww-css-tss&amp;operation=join" tabindex="-1" style="box-sizing:border-box;color:rgb(104, 136, 201);"><span style="box-sizing:border-box;">Join</span></a></u></span><span>&nbsp;</span><b style="box-sizing:border-box;font-weight:700;">TSS</b>&nbsp;</span></span></span></span></p><p style="box-sizing:border-box;margin:0px 0px 10px;">Internal download including iDNA<span>&nbsp;</span><strong style="box-sizing:border-box;font-weight:700;"><span style="box-sizing:border-box;background-color:rgb(252, 209, 22);">tss_tools_ttt.zip</span></strong>: \\emeaCssDfs\Netpod\Tools-Scripts\Troubleshooting-Script\tss_tools_ttt.zip&nbsp;</p><p style="box-sizing:border-box;margin:0px 0px 10px;">TSS<span>&nbsp;</span><span style="box-sizing:border-box;font-size:15px;">is a service, which means it gets better through periodic software updates.</span></p></div><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;"><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;"><br></span></p>Many
engineers already know about and leverage <b>RFL-Check</b>
for quick SDP report <strong style="box-sizing:border-box;"><span>data analysis</span></strong>
(KB3070416 / Download/install share: <a style="box-sizing:border-box;cursor:pointer;" href="file://emeacssdfs/netpod/RFL/">\\emeaCssDfs\netpod\RFL\</a>)</span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><b><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;">Other
scripts:</span></b><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;"> PowerShell based <b>SDP
reports</b> - to be used if standard GUI based SDP reports fail, or on
ServerCORE machines. This PowerShell based psSDP report in now included in TSS
toolset.</span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;">Public downloads: <a href="https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/psSDP">https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/psSDP</a>&nbsp;
- psSDP reports for&nbsp; [<strong style="box-sizing:border-box;"><span>Net | Dom |
CTS | Print | HyperV | Setup | Cluster | Perf | SQLbase | Mini | Nano</span></strong>]</span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;"><a style="box-sizing:border-box;cursor:pointer;" href="https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/TSS">https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/TSS</a>
&nbsp; &nbsp; - this TSS toolset </span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;">This TSS TroubleShootingScript/toolset aims for rapid <strong style="box-sizing:border-box;"><span>data collection</span></strong> for CritSit and standard cases.</span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;"><br style="box-sizing:border-box;"><strong style="box-sizing:border-box;"><span>TSS Goal:</span></strong> helping you to collect data and solve
incidents in the shortest timeframe<br style="box-sizing:border-box;">
Internal + external tss_tools.zip-integrated documentation: <b style="box-sizing:border-box;">tss.cmd_ReadMe_Help.docx; </b></span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;"><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;">Most
current help info is always in built-in help: <b>TSS</b> &lt;enter&gt;, or <b>TSS
help &lt;keyword&gt;</b></span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;"><br style="box-sizing:border-box;"><b>Benefits</b> of using TSS for break-fix
cases/customer incidents<br style="box-sizing:border-box;">
- for all involved parties: huge time saver working on SRs<br style="box-sizing:border-box;">
- for customer, no complicated manual action plans<br style="box-sizing:border-box;">
- for engineer, no need for writing long action plans, discussing plan on phone<br style="box-sizing:border-box;">
- for Backline SEE/EE no lengthy handover discussion on available/or missing
data<br style="box-sizing:border-box;">
- TSS ensures consistent data sets with timestamps in log file and PSR<br style="box-sizing:border-box;">
- automatic stop trigger when investigating intermittent issues (no repro at
will)</span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;margin:0in;margin-bottom:.0001pt;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><b><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;">GitHub
</span></b><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;">Location / info + public download of latest version of tss
toolset: </span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;margin:0in;margin-bottom:.0001pt;"><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;">&nbsp;&nbsp; <a href="https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/TSS">https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/TSS</a>
tss_tools.zip</span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;margin:0in;margin-bottom:.0001pt;"><b><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;">TEAMS channel</span></b><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;">: <a href="https://teams.microsoft.com/l/team/19:ab7dea29874747bd8bfff4a1bc51a530%40thread.skype/conversations?groupId=107ce661-276a-4ab0-869e-dc0a1f7feee1&amp;tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47">TSS
Windows Troubleshooting</a> (see also <a href="https://teams.microsoft.com/l/channel/19:ab7dea29874747bd8bfff4a1bc51a530%40thread.skype/tab::84862bb6-ef46-4dc1-97bf-6c918e40e410?groupId=107ce661-276a-4ab0-869e-dc0a1f7feee1&amp;tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47">Wiki+Info</a><a href="https://teams.microsoft.com/l/channel/19:ab7dea29874747bd8bfff4a1bc51a530%40thread.skype/tab::84862bb6-ef46-4dc1-97bf-6c918e40e410?groupId=107ce661-276a-4ab0-869e-dc0a1f7feee1&amp;tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47"></a>tab )</span><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;"></span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;margin:0in;margin-bottom:.0001pt;"><b><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;">KB: <a href="https://internal.support.services.microsoft.com/en-US/help/4089531">4089531</a></span></b><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;">Servicing: Tools: TSS
TroubleShootingScript/toolset for rapid flexible data collection for CritSit
and standard cases</span><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;"></span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;margin:0in;margin-bottom:.0001pt;"><b><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;">Email DL: </span></b><u><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;"><a href="https://idwebelements/GroupManagement.aspx?Group=ww-css-tss&amp;Operation=join">Join
TSS DL</a><a href="https://idwebelements/GroupManagement.aspx?Group=ww-css-tss&amp;Operation=join"></a></span></u><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;">ww-css-tss</span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;margin:0in;margin-bottom:.0001pt;"><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;">Internal
+ external tss_tools_*.zip-integrated documentation<b>: </b></span><span style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;">tss.cmd_ReadMe_Help.docx</span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;"><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;"><br><br></span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><b><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;">Obsolete</span></b><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;">:
If the customer struggles to access his workspace for downloading files, please
remind them to login with work or school or personal Microsoft accounts.<br style="box-sizing:border-box;">
(see KB article 4012140: How to use Secure File Exchange to exchange files with
Microsoft Support <a style="box-sizing:border-box;cursor:pointer;" href="https://support.microsoft.com/en-US/help/4012140">https://support.microsoft.com/en-US/help/4012140</a>), and if
download still is not offered, you can create a temporary MS account, see
Appendix DTM.</span></p><div style="border:none;border-bottom:solid windowtext 1.5pt;padding:0in 0in 1.0pt 0in;"><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;border:none;padding:0in;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;">The&nbsp;public&nbsp;<strong style="box-sizing:border-box;"><span>GitHub</span></strong> download option overcomes such hurdles.</span></p></div><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;margin:0in;margin-bottom:.0001pt;"><b><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;color:black;">Appendix</span></b><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;color:black;"><span style="box-sizing:border-box;">
for DTM</span> - FileTransfer</span><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;"></span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;margin:0in;margin-bottom:.0001pt;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;color:black;">For downloading files from MS workspace, you need to login on the
workspace page with your credentials, see KB article <b>4012140</b></span><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;">&nbsp;How to use Secure File Exchange to exchange files with
Microsoft Support </span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;box-sizing:border-box;"><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">&nbsp; </span><a style="box-sizing:border-box;cursor:pointer;" href="https://support.microsoft.com/en-US/help/4012140">https://support.microsoft.com/en-US/help/4012140</a></span></span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;">&nbsp;</span></span>E<span style="color:black;">xcerpt of &quot; <b style="box-sizing:border-box;">DTMv2 Support Engineer Guide</b>&quot;</span></span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><b><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;color:#4472C4;">Sharing a DTMv2 Workspace with 1) a customer </span></b><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;"></span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;margin:0in;margin-bottom:.0001pt;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;color:black;">If the user needs to View, Delete, or Download files, in addition
to Adding files, then the user needs to sign in to the Secure File Exchange
with a “work or school, or personal Microsoft account”. </span><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;"></span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;margin:0in;margin-bottom:.0001pt;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;color:black;">In the above example, both of Darin’s emails are indeed “</span><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;color:#4472C4;"><span style="box-sizing:border-box;">work or school, or personal
Microsoft accounts</span></span><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;color:black;">” (designated with 'x' icon), so Darin can signin to
the Secure File Exchange workspace using either daring@microsoft.com or
darin.green@hotmaill.com to View, Delete, Download (in addition to Add) files.</span><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;"></span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;margin:0in;margin-bottom:.0001pt;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;color:black;">..<span style="box-sizing:border-box;">&nbsp; </span>you can
create a temporary one .. by clicking on the Create Account button</span><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;"></span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;margin:0in;margin-bottom:.0001pt;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;color:black;">then <b style="box-sizing:border-box;">add</b> the temp <b style="box-sizing:border-box;">account</b> as new <b style="box-sizing:border-box;">contact</b>
in MsSolve</span><span style="font-size:11.0pt;font-family:&quot;Calibri Light&quot;,sans-serif;"></span></p><p style="font-family:&quot;Times New Roman&quot;,serif;font-size:12pt;margin-right:0in;margin-left:0in;box-sizing:border-box;color:rgba(0, 0, 0, 1);"><span style="font-family:&quot;Calibri&quot;,sans-serif;color:black;"></span><span style="font-family:&quot;Calibri&quot;,sans-serif;color:black;"><span asset="4537414" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4537414]</span><br>
&nbsp;</span><span style="font-size:10.5pt;font-family:&quot;Calibri&quot;,sans-serif;"></span></p><br></font></font></font></span></div><font face="Times New Roman" size="3"></font></div>