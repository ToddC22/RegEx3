<header><h1>How to find pool tags that are used by third-party drivers</h1></header><div class='kb-summary-section section'> This article describes how to find the source of a pool tag that is used by a third-party driver. This may be useful because when you troubleshoot an issue, you may encounter a pool tag that cannot be tied to a Microsoft component, and finding the source of these tags can be complicated and is often impossible without the use of a kernel-mode debugger.<br> </div><div> To find files that (potentially) use a given pool tag, use the Search tool in Windows 2000: <br> <ol class='sbody-num_list'><li>Click <span class='text-base'>Start</span>, point to <span class='text-base'>Search</span>, and then click <span class='text-base'>For Files or Folders</span>.</li><li>In the <span class='text-base'>Search for files or folders named</span> box, type <span class='sbody-userinput'>*.sys</span>.</li><li>In the <span class='text-base'>Containing text</span> box, type the pool tag you want to search for.</li><li>In the <span class='text-base'>Look in</span> box, type the path to the system root drivers, for example,<br><span class='sbody-userinput'>C:\WINNT\system32\drivers</span>, and then click <span class='text-base'>Search Now</span>.</li></ol> You should receive a list of drivers that contain the tag. Although there may be some false hits here (as the text string may naturally occur in other files), this method should allow you to narrow the scope of your search.<br><br> You can use the <span class='sbody-userinput'>findstr</span> command (in all versions of Windows) instead of Windows Explorer. To minimize the occurrence of false hits, change to the system root\drivers folder at a command prompt. If needed, use Windows Explorer to find this folder. Run the<br> <span class='sbody-userinput'>findstr /m /l tag *.sys</span> command, where the /m switch is used to list only the file name. If you receive multiple files, try to reduce the amount of files returns by adding the letter &quot;h&quot; to the tag before you run the search. This is mainly useful when the tag is comprised of three letters.<br> <br><br><span class='text-base'>Note</span> You may find that this query may not find the appropriate driver because the driver is not loaded from %SYSTEMROOT%\drivers. In this case, run more global searches such as<br> <span class='sbody-userinput'>findstr /m /l tag *.sys</span> that start from %SystemRoot%, %ProgramFiles%, %SystemDrive%, %ProgramData%.</div><div class='kb-securedata-section section'> For more information in Windows XP, view the &quot;Command-line reference A-Z&quot; topic in the Help and Support Center tool.<br></div><div class='kb-securedata-section section'><span> For more information about using Poolmon and finding kernel memory leaks, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-4' href='/en-us/help/115280'>115280 </a> Finding Windows NT kernel mode memory leaks<br><br></div></span></div><div class='kb-moreinformation-section section'> For examples, use the <span class='sbody-userinput'>findstr /m /l hTCPt *.sys</span> command to return Tcpip.sys and <span class='sbody-userinput'>findstr /m /l hCPnp *.sys</span> to return Classpnp.sys or Acpiec.sys depending on which operating system you are running.<br><br><span> For more information, click the following article numbers to view the articles in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/en-us/help/250453'>250453 </a> Determining special pool tagging options when debugging<br><br></div></span><span><div class='indent'><a id='kb-link-2' href='/en-us/help/177415'>177415 </a> How to use Memory Pool Monitor (Poolmon.exe) to troubleshoot kernel mode memory leaks<br><br></div></span></div><div class='kb-securedata-section section'><h3 class='sbody-h3'>How to use the Microsoft Windows Debugger (Windbg)  to find the driver that uses a pool tag </h3>Suppose that the pool tag is &quot;UtlM&quot; 0: kd&gt; s -a bf087000 L?0x000134A0 &quot;UtlM&quot; <br><br>In this tag, bf087000 is the suspicious driver’s start address and 0x000134A0 is the suspicious driver’s ImageSize. <br><br>At first, you should pick up the suspicious drivers from the &#39;lmvm *&#39; command. This command includes HEX value of ImageSize. <h4 class='sbody-h4'>Example</h4>Finding the top consumer of Paged Pool: 0: kd&gt; !poolused 0x4 Sorting by Paged Pool Consumed Pool Used: NonPaged Paged Tag Allocs Used Allocs Used SAEX 1 592 1076992 232630272 UNKNOWN pooltag &#39;SAEX&#39;, please update pooltag.txt SavE 3 168 476 15842216 UNKNOWN pooltag &#39;SavE&#39;, please update pooltag.txt <br><br>You suspect one of the Symantec kernel driver, Sav*.sys, is using the pool tag &#39;SAEX&#39; 0: kd&gt; lmvm sav* start end module name b6d9f000 b6db3000 Savrtpel (deferred) Image path: \??\C:\Program Files\Symantec AntiVirus\Savrtpel.sys Image name: Savrtpel.sys Timestamp: Tue Dec 20 05:24:50 2005 (43A78792) CheckSum: 0001CF76 ImageSize: 00014000 Translations: 0000.04b0 0000.04e0 0409.04b0 0409.04e0 b6dd5000 b6e2d000 savrt (deferred) Image path: \??\C:\Program Files\Symantec AntiVirus\savrt.sys Image name: savrt.sys Timestamp: Tue Dec 20 05:24:48 2005 (43A78790) CheckSum: 00054FE6 ImageSize: 00058000 Translations: 0000.04b0 0000.04e0 0409.04b0 0409.04e0 Annotation: Trying to find the pool tag &quot;SAEX&quot; in the driver Savrtpel.sys 0: kd&gt; s -a b6d9f000 L?0x00014000 &quot;SAEX&quot; Annotation: Trying to find the pool tag in the driver savrt.sys 0: kd&gt; s -a b6dd5000 L?0x00058000 &quot;SAEX&quot; b6ddc5d8 53 41 45 58 cc 00 00 00-2a b7 89 80 13 c6 89 80 SAEX....*....... b6de9a03 53 41 45 58 68 cc 00 00-00 6a 00 6a 00 6a 00 68 SAEXh....j.j.j.h b6de9a2a 53 41 45 58 c1 e0 07 6a-00 83 c0 40 50 6a 00 c7 SAEX...j...@Pj.. b6de9a81 53 41 45 58 68 cc 00 00-00 6a 00 68 f0 93 de b6 SAEXh....j.h.... <br><br>In this example, the third party driver, Savrt.sys, uses the pool tag &quot;SAEX.&quot; </div><div class='kb-securedata-section section'>pooltag</div><div class='kb-textlegacy-section section'>Author: JBROXSON (2001-05-04T13:29:00) Edit Reviewer: cgolden (2001-09-04T10:49:00) Tech Reviewer: benchri (2001-08-30T09:25:00)<br> </div>