<header><h1>You may experience various problems when you work with files over the network on a Windows Server 2003-based or Windows 2000 Server-based computer</h1></header><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/49093.asp' title='Link only available for Microsoft corporate network users' target='_blank'>49093 (Content Maintenance)</a></div><div class='kb-symptoms-section section'>On a Microsoft Windows Server 2003-based or Microsoft Windows 2000 Server-based computer, you may experience one or more of the following symptoms when you work with files over the network: <br> <ul class='sbody-free_list'><li>A Windows-based file server that is configured as a file and print server stops responding. Then, the file and print server functionality temporarily stops.</li><li>You experience a long delay when you open, save, close, delete, or print files that are located on a shared resource.</li><li>You experience a temporary decrease in performance when you use a program over the network. Typically, performance is slow for approximately 40 to 45 seconds. However, some delays may last up to 5 minutes.</li><li>You experience a delay when you copy a file copy or when you perform backup operations.</li><li>When you connect to a shared resource, Windows Explorer either stops responding or you see a red X on the connected network drive.</li><li>A program stops responding that either uses remote procedure call (RPC) or that uses named pipes to connect to a file server.</li><li>The server temporarily stops responding and one or more event ID messages that resemble the following messages appear in the System log on the file server: <pre class='sbody-pre'>Event ID: 2022 Source: Srv Type: Error Description: Server was unable to find a free connection &lt;number&gt; times in the last &lt;number&gt; seconds. </pre><pre class='sbody-pre'>Event ID: 2021 Source: Srv Type: Error Description: Server was unable to create a work item &lt;number&gt; times in the last &lt;number&gt; seconds. </pre><pre class='sbody-pre'>Event ID: 2020 Source: Srv Type: Error Description: The server was unable to allocate from the system paged pool because the pool was empty. </pre><pre class='sbody-pre'>Event ID: 2019 Source: Srv Type: Error Description: The server was unable to allocate from the system nonpaged pool because the pool was empty.  </pre><pre class='sbody-pre'>Event ID: 2510 Source: Server Event Type: Error Description: The server service was unable to map error code 1722. </pre>Additionally, the following event may appear in the System log on the client computer:<pre class='sbody-pre'>Event ID: 3013 Event Type: Error Event Source: MrxSmb /Rdr Description: The redirector has timed out a request to &lt;ComputerName&gt;. </pre></li><li>You receive one  of the following error messages when you try to connect to a shared resource: <br><div class='sbody-error'>System error 53. The network path was not found. (ERROR_BAD_NETPATH)</div><div class='sbody-error'>System error 64. The specified network name is no longer available. (ERROR_NETNAME_DELETED)</div></li><li>You are intermittently disconnected from network resources, and you cannot reconnect to the network resources on the file server. However, you can ping the server, and you can use a Terminal Services session to connect to the server.</li><li>If multiple users try to access Microsoft Office documents on the server, the <strong class='uiterm'>File is locked for editing</strong> dialog box does not always appear when the second user opens the file.</li><li>A network trace indicates that there is a 30 to 40 second delay between a server message block (SMB) Service client command and a response from the file server.</li><li>In Windows Server 2003 and Windows 2000 Service Pack 4 (SP4), the server may stop responding arbitrarily. </li><li>When you try to open a Microsoft Access 2.0 database file (.mdb) in Microsoft Access 97, Access 2000, or Access 2002, you may receive an error message that resembles the following:<div class='sbody-error'>Disk or network error.</div></li><li>When you open Microsoft Excel, you may receive the following error message: <div class='sbody-error'>file has not been saved.</div></li><li>When you open Windows Explorer, you may receive the following error message: <div class='sbody-error'>Cannot access &lt;path and file name&gt; .The session was canceled.</div></li><li>When you open a Microsoft Word file, Word may fail. Then, you may receive the following error message:<div class='sbody-error'>Word failed reading from this file &lt;file name&gt;. Please restore the network connection or replace the floppy disk and retry.</div>Additionally, after you restore the network connection and you click <strong class='uiterm'>OK</strong>, you receive the following error message:<div class='sbody-error'>Word has lost data because of a bad network connection or missing floppy. Documents relying on this data will be saved and then closed. </div></li></ul></div><div class='kb-cause-section section'>These problems may occur when one of the following conditions is true: <br> <ul class='sbody-free_list'><li>The version of Symantec Event Handler driver (Symevent.sys) is outdated. Therefore, two or more threads are deadlocked in the Symevent.sys driver in the <span class='text-base'>Symevent_GetSubTask</span> function. </li><li>There is a Computer Associates (CA) INO_FLTR.SYS OpLock interoperability problem with the Srv.sys file.</li></ul></div><div class='kb-resolution-section section'>To resolve these problems, update the third-party antivirus file system filter driver. For example, if you have the Symantec Event Handler driver (SymEvent.sys) installed on the computer, update to version 11.6.4.1 or a later version. To obtain an updated version of the Symevent.sys file or to find help with the reconfiguration, visit the following Symantec Web site:<div class='indent'><a id='kb-link-1' href='http://www.symantec.com' target='_self'>http://www.symantec.com</a></div><br><br><span class='text-base'>Note </span>The SymEvent.sys file version 11.6.4.2 has a bug that can make some servers restart arbitrarily. For information about your hardware manufacturer, visit the following Web site:<div class='indent'><a id='kb-link-2' href='/gp/vendors/en-us' target='_self'>http://support.microsoft.com/gp/vendors/en-us</a></div></div><div class="kb-moreinformation-section section">All the error messages that are mentioned in the &quot;Symptoms&quot; section point to failing SMB connections. These failing connections can be network related. Or the failing connections can occur when the server stops responding arbitrarily.<br>
<br>
The following antivirus driver versions can also cause servers to stop responding:
<ul class="sbody-free_list">
	<li>The problem is known to occur when the following driver versions are installed on the file server.
	<div class="table-responsive">
	<table class="table">
		<tbody>
			<tr class="sbody-tr">
				<th class="sbody-th">Name</th>
				<th class="sbody-th">Company</th>
				<th class="sbody-th">Version</th>
				<th class="sbody-th">Date</th>
				<th class="sbody-th">Description</th>
			</tr>
			<tr class="sbody-tr">
				<td class="sbody-td">Symevent.sys</td>
				<td class="sbody-td">Symantec Corporation</td>
				<td class="sbody-td">11.4:0.6</td>
				<td class="sbody-td">05-Mar-2004</td>
				<td class="sbody-td">Symantec Event Library</td>
			</tr>
			<tr class="sbody-tr">
				<td class="sbody-td">Symtdi.sys</td>
				<td class="sbody-td">Symantec Corporation</td>
				<td class="sbody-td">5.3:6.13</td>
				<td class="sbody-td">23-Dec-2004</td>
				<td class="sbody-td">Network Dispatch Driver</td>
			</tr>
		</tbody>
	</table>
	</div>
	These versions that are installed with Symantec Antivirus 9.0.</li>
	<li>The problem is known to occur when the following CA eTrust Antivirus/InoculateIT File System Filter Driver versions are installed on the file server.
	<div class="table-responsive">
	<table class="table">
		<tbody>
			<tr class="sbody-tr">
				<th class="sbody-th">Name</th>
				<th class="sbody-th">Company</th>
				<th class="sbody-th">Version</th>
				<th class="sbody-th">Date</th>
				<th class="sbody-th">Description</th>
			</tr>
			<tr class="sbody-tr">
				<td class="sbody-td">Ino_flpy.sys</td>
				<td class="sbody-td">Computer Associates</td>
				<td class="sbody-td">5.0:6100.106</td>
				<td class="sbody-td">19-Jun-2003</td>
				<td class="sbody-td">CA eTrust Antivirus/InoculateIT File System Mounting Filter Driver for Windows 2000/XP/.Net</td>
			</tr>
			<tr class="sbody-tr">
				<td class="sbody-td">Ino_fltr.sys</td>
				<td class="sbody-td">Computer Associates</td>
				<td class="sbody-td">5.0:6100.136</td>
				<td class="sbody-td">08-Aug-2004</td>
				<td class="sbody-td">CA eTrust Antivirus/InoculateIT File System Filter Driver for Windows 2000/XP/2003</td>
			</tr>
		</tbody>
	</table>
	</div>
	</li>
</ul>
If you investigate network traces, you may find that the file server does not answer SMB requests. For example, after you perform a network track operation, you receive the following code:

<div class="sbody-code">
<pre>
<code>15:28:14  client -&gt; server SMB Read AndX Request, FID 0x0002
15:28:14   server -&gt; client  TCP [ACK]</code></pre>
</div>
After approximately 45 seconds, the client computer ends the TCP Session (FIN), and then the server sends a &quot;[FIN ACK].&quot; After you perform the network track operation, you receive the following code:

<div class="sbody-code">
<pre>
<code>15:29:05  client  -&gt; server TCP [FIN ACK]
15:29:05   server -&gt; client  TCP [FIN ACK]</code></pre>
</div>
In such traces, you can see that the server does not answer to the SMB request. However, the server still sends a TCP acknowledgement for the client computer request. This means that the server service on the Windows-based file server is unresponsive to SMB requests. This also means that network connectivity is not the cause of the problem.</div>
<div class='kb-references-section section'><span> For more information, click the following article numbers to view the articles in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-5' href='/en-us/help/816071'>816071 </a> How to temporarily deactivate the kernel mode filter driver in Windows<br><br></div></span><span><div class='indent'><a id='kb-link-6' href='/en-us/help/240309'>240309 </a> How to fully disable antivirus software from filtering files<br><br></div></span><span><div class='indent'><a id='kb-link-7' href='/en-us/help/822219'>822219 </a> You experience slow file server performance and delays occur when you work with files that are located on a file server<br><br></div></span><span> The third-party products that this article discusses are manufactured by companies that are independent of Microsoft. Microsoft makes no warranty, implied or otherwise, regarding the performance or reliability of these products. <br> </span></div><div class='kb-securedata-section section'>version 11.4.0.6 Anti-Virus 8x or Symantec Anti-Virus 9.0 randomly intermittently sporadically pool tag sevI slow file system filter driver</div><div class='kb-securedata-section section'>Author: waltere<br>Writer: v-rezhou<br>Tech Reviewer: v-davyu<br>Editor: v-valedo</div>