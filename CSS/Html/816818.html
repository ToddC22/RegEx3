<header><h1>&quot;Picker cannot open because it cannot determine whether &lt;Network Name Resource&gt; is joined to a domain&quot; error message</h1></header><div class='kb-notice-section section'><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/WinSERaid2/24243.asp' title='Link only available for Microsoft corporate network users' target='_blank'>24243 (WinSERaid2)</a></p></div></div></div></div><br><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/6464.asp' title='Link only available for Microsoft corporate network users' target='_blank'>6464 (Content Maintenance)</a></p></div></div></div></div></div><div class='kb-notice-section section'><span><span class='text-base'>IMPORTANT</span>: This article contains information about modifying the registry. Before you modify the registry, make sure to back it up and make sure that you understand how to restore the registry if a problem occurs. For information about how to back up, restore, and edit the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/EN-US/help/256986'>256986 </a> Description of the Microsoft Windows Registry</div></span></div><div class='kb-symptoms-section section'> If you are using a Windows 2000-based computer and you try to modify the NTFS file system permissions on a file or folder on a network share, you may receive one of the following error messages:<br> <div class='sbody-error'>Object Picker cannot open because it cannot determine whether <strong class='sbody-strong'>Network Name Resource</strong> is joined to a domain.<br> </div>In this error message, <strong class='sbody-strong'>Network Name Resource</strong> is the NetBIOS name (or fully qualified domain name [FQDN]) of the computer you are trying to access. When you click<br> <strong class='uiterm'>Close</strong>, you receive the following error message:<br> <div class='sbody-error'>Unable to display the user selection dialog. <br>Access is denied. </div>If you are using a Windows NT 4.0-based computer, you may receive the following error message when you try to add entries to the Access Control List (ACL): <div class='sbody-error'>Access Denied </div>You receive this error message if the environment includes a Windows NT 4.0 domain that has a Windows NT 4.0-based server and a Windows 2000 Professional-based client computer. You may receive the error message when you change permissions on a member server only, but you may not receive the error message on a domain controller (primary domain controller [PDC] or backup domain controller [BDC]).<br><br>You may also experience the following problems: <br> <ul class='sbody-free_list'><li>Users or groups that have Full Control access cannot delegate permissions.</li><li>Users who have Full Control access cannot make permission changes on a DFS share.</li><li>If you give the non-privileged user the right to log on locally and you log on locally to the file server where the error message occurs, you can successfully edit the ACL.</li></ul>If you are using a Windows 2003-based computer and if you try to modify the NTFS file system permissions on a file or on a folder on a network share, you may receive  the following error message: <div class='sbody-error'>The program cannot open the required dialog box because it cannot determine whether the computer named &quot;Network Name Resource&quot; is joined to a domain. Close this message, and try again.</div> In this error message, <strong class='sbody-strong'>Network Name Resource</strong> is the NetBIOS name or the fully qualified domain name (FQDN) of the computer that you are trying to access. When you click <strong class='uiterm'>Close</strong>, you receive the following error message: <div class='sbody-error'>Unable to display the user selection dialog. The RPC server is unavailable.</div></div><div class='kb-symptoms-section section'>The following text is the error code mapping in Admin\Select\Src\Select.rc:<br> <ul class='sbody-free_list'><li>IDS_INIT_FAILED_MACHINE_CONFIG <br>Object Picker cannot open because it cannot determine whether %1 is joined to a domain. </li><li>IDS_INIT_FAILED_NO_SCOPES <br>Object Picker cannot open because no locations from which to choose objects could be found.</li></ul> The error text translates in German as the following errors: <br> <ul class='sbody-free_list'><li>Window title: Eigenschaften von &lt;computer_name&gt;<br><br>Die Objektauswahl kann nicht ge&#246;ffnet werden, da nicht bestimmt werden kann, ob &lt;computer_name&gt; einer Dom&#228;ne zugeordnet ist. </li><li>Window title: Sicherheitseinstellungen<br>Der Dialog zur Benutzerauswahl konnte nicht angezeigt werden. Zugriff verweigert. </li></ul></div><div class='kb-resolution-section section'><span><span class='text-base'>WARNING</span>: If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk. <br> </span>To troubleshoot this problem, perform each of the following troubleshooting steps. After you complete each step, see if you can delegate permissions. If you still cannot delegate permissions, continue to the next step. <h3 class='sbody-h3'>Step 1: Confirm the TCP/IP NetBIOS Settings</h3><ol class='sbody-num_list'><li>Verify that <strong class='uiterm'>Netbios over TCP</strong> is selected in the Advanced TCP settings on the Windows 2000-based computer. </li><li>Verify that the TCP/IP NetBIOS Helper (LmHosts) service is enabled and started on the domain controllers and on all member servers.<br></li></ol><h3 class='sbody-h3'>Step 2: Confirm That There Are No Access Restrictions  to the Registry</h3><ul class='sbody-free_list'><li>Verify that &#39;System\CurrentControlSet\Control\ProductOptions&#39; is listed in the<br><strong class='sbody-strong'>Machine</strong> value:<br><ol class='sbody-num_list'><li>Start Registry Editor. </li><li>Locate and then click the following registry key: <div class='indent'><strong class='sbody-strong'>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg\AllowedPaths <br><br></strong></div></li><li>Confirm the following settings: <div class='indent'>Value:        Machine<br><br>Type:   REG_MULTI_SZ - Multi string<br><br>Default Data: <br>System\CurrentControlSet\Control\ProductOptions<br> <br>System\CurrentControlSet\Control\Print\Printers<br> <br>System\CurrentControlSet\Control\Server Applications<br> <br>System\CurrentControlSet\Services\Eventlog<br> <br>Software\Microsoft\Windows NT\CurrentVersion<br><br></div></li></ol> The valid range for the<br><strong class='sbody-strong'>Machine</strong> value is a valid path to a location in the registry. The purpose of the<br><strong class='sbody-strong'>Machine</strong> value is to allow computer access to listed locations in the registry, provided that no explicit access restriction exists for that location. </li><li>Verify that the <strong class='sbody-strong'>winreg</strong> registry key has Read permissions for the System account:<br><ol class='sbody-num_list'><li>Start Registry Editor. </li><li>Locate and then click the following registry key: <div class='indent'><strong class='sbody-strong'>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg<br>                 <br> <br><br></strong></div></li><li>In the <strong class='uiterm'>Edit</strong> menu, click<br> <strong class='uiterm'>Permissions</strong>, and then make sure that the System account has Read permissions for key.</li></ol>If the <strong class='sbody-strong'>winreg</strong> registry key does not have the correct permissions, you can export the registry key from a server that works to the server you are trying to access. <br><br><span> For additional information, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-2' href='/en-us/help/314837'>314837 </a> How to manage remote access to the registry<br><br></div></span></li></ul><h3 class='sbody-h3'>Step 3: Confirm that Anonymous Connections Can Perform Enumeration Functions<br><br></h3>Confirm the following registry settings on the member servers that you are trying to access: <div class='indent'><strong class='sbody-strong'>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\LSA</strong><br><br>Value Name: RestrictAnonymous<br> <br>Data Type:  REG_DWORD<br> <br>Value:      0<br></div> The purpose of the registry value is to configure local system policy to determine whether authentication is required to perform common enumeration functions. You can configure the account name list to require authentication. This authentication requirement is an optional feature.<br> <br><br>When the <strong class='sbody-strong'>RestrictAnonymous</strong> value is set to 1, anonymous connections that are generated from the Graphical User Interface (GUI) tools for security management receive an &quot;access denied&quot; error message when these connections try to obtain the list of account names.<br> <br><br><span> For additional information about the &quot;RestrictAnonymous&quot; registry value, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-3' href='/en-us/help/178640'>178640 </a> Could not find domain controller when establishing a trust<br><br></div></span><h3 class='sbody-h3'>Step 4: Confirm SMB Signing Settings</h3>You may receive the error message that is described in the &quot;Symptoms&quot; section of this article if SMB Signing is turned on and if it is required. To confirm that SMB Signing is not turned on and that it is not required: <br> <ol class='sbody-num_list'><li>Start Registry Editor. </li><li>Locate and then click the following registry key: <div class='indent'><strong class='sbody-strong'>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters<br><br> </strong></div>This key contains the following values: <div class='indent'>Value Name:  EnableSecuritySignature<br> <br>Data Type:   REG_DWORD<br> <br>Data:        0 (disable), 1 (enable)<br><br>Value Name: RequireSecuritySignature<br> <br>Type: REG_DWORD<br> <br>Value: 0 (disable), 1 (enable)<br> <br>Default: 0</div></li><li>Set the <strong class='sbody-strong'>EnableSecuritySignature </strong> value and the<br><strong class='sbody-strong'>RequireSecuritySignature</strong>value to 0 (zero).</li></ol><span> For additional information about this registry key, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-4' href='/en-us/help/161372'>161372 </a> How to enable SMB signing in Windows NT<br><br></div></span><h3 class='sbody-h3'>Step 5: Confirm that the domain controller is reachable </h3>If you cannot view or make permission changes on a Distributed File System (DFS) share, verify that you can reach the domain controller by testing name resolution. If your DNS server returns a list of IP addresses for domain controllers, your computer pings the first IP address to check connectivity. After a successful ping reply, the client tries to connect to the domain controller by using the SMB protocol. If this step fails, you receive the &quot;Object Picker&quot; error message. </div><div class='kb-moreinformation-section section'><ul class='sbody-free_list'><li>You can use the Windows NT Cacls.exe utility to verify correct permission settings.</li><li>When you view a network trace that was captured with Network Monitor, you may see SMB STATUS_ACCESS_DENIED and RPC &#39;Return Value = 5 (0x5)&#39;. This return value corresponds to the &#39;Access Denied&#39; error in remote procedure calls (RPC) when a named pipe to<br><strong class='sbody-strong'>winreg</strong> is opened.<br></li></ul><h3 class='sbody-h3'>Additional Scenarios Where This Problem May Occur</h3><h4 class='sbody-h4'>In a Clustered File Share </h4>The error messages that are described in the &quot;Symptoms&quot; section may occur if the share is located on a cluster server as a file share resource, and if all of the following conditions exist: <br> <ul class='sbody-free_list'><li>Microsoft SQL 7.0 is installed on the cluster server, and this cluster server was configured as a cluster resource in an active/passive configuration by using the SQL Failover Wizard.</li><li>The file share that you are connecting to is hosted by a cluster server as a file share resource.</li><li> The file share source is located on the same hard disk as SQL 7.0 on the cluster server, and it is located in the same resource group as SQL 7.0. </li><li>You are trying to modify NTFS permissions on a file that is located on the cluster server by using a user account that does not have administrator credentials on the cluster server. </li></ul>If these conditions exist, create the File Share resource in a different cluster resource group and on a different hard disk than the hard disk where SQL 7.0 is installed.<br><br><span> For additional information about this procedure, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-5' href='/en-us/help/267833'>267833 </a> Cannot set NTFS permissions on files located on clustered file share resource<br><br></div></span><h4 class='sbody-h4'>In Microsoft SharePoint Portal Server</h4>If you use Web folders to gain access to a workspace, user accounts may not appear on the <strong class='uiterm'>Security</strong> tab in the properties of a folder. If you try to add an account, you may receive the error message described in the &quot;Symptoms&quot; section. <br><br><span> For additional information, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-6' href='/en-us/help/309353'>309353 </a> You cannot view security information when you are connected with virtual hosting or the server<br><br></div></span></div><div class='kb-references-section section'><span> For additional information, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-7' href='/en-us/help/157475'>157475 </a> Access denied when trying to add ACL entries<br><br></div></span><span><div class='indent'><a id='kb-link-8' href='/en-us/help/153183'>153183 </a> How to restrict access to the registry from a remote computer<br><br></div></span><span><div class='indent'><a id='kb-link-9' href='/en-us/help/143474'>143474 </a> Restricting information available to anonymous logon users<br><br></div></span><span><div class='indent'><a id='kb-link-10' href='/en-us/help/263231'>263231 </a> Error Message: Object Picker cannot open because no locations from which to choose objects could be found<br><br></div></span><span><div class='indent'><a id='kb-link-11' href='/en-us/help/284914'>284914 </a> Error Message: Object Picker Cannot Open Because No Locations from Which to Choose Objects Could Be Found<br><br></div></span><span><div class='indent'><a id='kb-link-12' href='/en-us/help/323170'>323170 </a> How to backup, edit, and restore the registry in Windows NT 4.0<br><br></div></span><span><div class='indent'><a id='kb-link-13' href='/en-us/help/322755'>322755 </a> How to backup, edit, and restore the Registry in Windows 2000<br><br></div></span></div><div class='kb-moreinformation-section section'>If you capture a Netmon trace, you may see the following typical frames and errors:<pre class='sbody-pre'><br><br>1. &#39;Access Denied&#39; (0xC0000022) error on opening files or folders:<br>------------------------------------------------------------------<br>W2K-&gt;NT4 SMB: C NT create &amp; X, File = \ks004<br>with SMB: Desired Access = 0x010E0000 (or Access Mask: 0x01000000 )<br><br>        Access Mask: 0x010e0000<br>            0... .... .... .... .... .... .... .... = Generic Read: Generic read is NOT set<br>            .0.. .... .... .... .... .... .... .... = Generic Write: Generic write is NOT set<br>            ..0. .... .... .... .... .... .... .... = Generic Execute: Generic execute is NOT set<br>            ...0 .... .... .... .... .... .... .... = Generic All: Generic all is NOT set<br>            .... ..0. .... .... .... .... .... .... = Maximum Allowed: Maximum allowed is NOT set<br>            .... ...1 .... .... .... .... .... .... = System Security: SYSTEM SECURITY is set<br>            .... .... ...0 .... .... .... .... .... = Synchronize: Can NOT wait on handle to synchronize on completion of I/O<br>            .... .... .... 1... .... .... .... .... = Write Owner: Can WRITE OWNER (take ownership)<br>            .... .... .... .1.. .... .... .... .... = Write DAC: OWNER may WRITE the DAC<br>            .... .... .... ..1. .... .... .... .... = Read Control: READ ACCESS to owner, group and ACL of the SID<br>            .... .... .... ...0 .... .... .... .... = Delete: NO delete access<br>            .... .... .... .... .... ...0 .... .... = Write Attributes: NO write attributes access<br>            .... .... .... .... .... .... 0... .... = Read Attributes: NO read attributes access<br>            .... .... .... .... .... .... .0.. .... = Delete Child: NO delete child access<br>            .... .... .... .... .... .... ..0. .... = Execute: NO execute access<br>            .... .... .... .... .... .... ...0 .... = Write EA: NO write extended attributes access<br>            .... .... .... .... .... .... .... 0... = Read EA: NO read extended attributes access<br>            .... .... .... .... .... .... .... .0.. = Append: NO append access<br>            .... .... .... .... .... .... .... ..0. = Write: NO write access<br>            .... .... .... .... .... .... .... ...0 = Read: NO read access<br><br><br>NT4-&gt;W2K SMB: R NT create &amp; X - NT error, System, Error, Code = (34) STATUS_ACCESS_DENIED<br><br><br>2. &#39;Access Denied&#39; error in Remote Procedure Call (RPC):<br>-------------------------------------------------------<br>MSRPC traffic to \srvsvc UUID 4b324fc8_1670_01d3_1278_5a47bf6ee188 <br>  OpNum   API  <br>  0X10    NetrShareGetInfo<br>  <br>#W2K-&gt;NT4 R_SRVSVC: RPC Client call srvsvc:NetrShareGetInfo(..)<br>#NT4-&gt;W2K R_SRVSVC: RPC Server response srvsvc:NetrShareGetInfo(..)<br>             R_SRVSVC: Return Value = 5 (0x5)<br>The Return Value of 5 corresponds to the &#39;Access Denied&#39; error<br><br>calls to NetrServerGetInfo succeed<br>#468 R_SRVSVC: RPC Client call srvsvc:NetrServerGetInfo(..) <br>#469 R_SRVSVC: RPC Server response srvsvc:NetrServerGetInfo(..)<br> R_SRVSVC: Return Value = 0 (0x0)<br><br>  <br><br>3. &#39;Access Denied&#39; error in RPC calls (opening a named pipe) to winreg<br>-----------------------------------------------------------------------<br>MSRPC traffic to \winreg UUID 338cd001_2244_31f1_aaaa_900038001003<br>  OpNum API    <br>  0X2   OpenLocalMachine   <br>  0XF   BaseRegOpenKey <br>  <br>#916 SMB: C NT create &amp; X, File = \winreg<br><br>#922 MSRPC: c/o RPC Request:      call 0x2  opnum 0xF  context 0x0  hint 0x90<br>#923 MSRPC: c/o RPC Response:     call 0x2  context 0x0  hint 0x18  cancels 0x0  (= OpenEntry Reply)<br>      Return Value = 5 (0x5)<br>The Return Value of 5 corresponds to the &#39;Access Denied&#39; error<br><br><br>--- The Ethereal tool from www.Ethereal.com shows more details ---<br><br>Frame #922/#923 Open Registry Entry Request/Response<br><br>Frame 922 (310 bytes on wire, 310 bytes captured)<br>Ethernet II, Src: 00:30:05:22:03:cd, Dst: 00:20:48:64:4d:5b<br>Internet Protocol, Src Addr: 167.228.64.156 (167.228.64.156), Dst Addr: 167.228.64.4 (167.228.64.4)<br>Transmission Control Protocol, Src Port: 1086 (1086), Dst Port: netbios-ssn (139), Seq: 2561576088, Ack: 3184184460, Len: 256<br>NetBIOS Session Service<br>SMB (Server Message Block Protocol)<br>    SMB Header<br>    Transaction Request (0x25)<br>SMB Pipe Protocol<br>DCE RPC<br>Microsoft Registry<br>    Operation: OpenEntry (15)<br>    Reply in frame 923<br>    Policy Handle: HKLM handle<br>        Context handle: 00000000A63866776C60124AB3010219...<br>        Opened in frame 921<br>        Closed in frame 924<br>    Class: system\currentcontrolset\control\productoptions<br>        Length: 96<br>        Size: 96<br>        Class: system\currentcontrolset\control\productoptions<br>            Referent ID: 0x750f3698<br>            Max Length: 48<br>            Offset: 0<br>            Length: 48<br>            Class: system\currentcontrolset\control\productoptions<br>    Unknown 1: 0x00000000<br>    Access mask: 0x00020019<br><br>Frame 923 (162 bytes on wire, 162 bytes captured)<br>Ethernet II, Src: 00:20:48:64:4d:5b, Dst: 00:30:05:22:03:cd<br>Internet Protocol, Src Addr: 167.228.64.4 (167.228.64.4), Dst Addr: 167.228.64.156 (167.228.64.156)<br>Transmission Control Protocol, Src Port: netbios-ssn (139), Dst Port: 1086 (1086), Seq: 3184184460, Ack: 2561576344, Len: 108<br>NetBIOS Session Service<br>SMB (Server Message Block Protocol)<br>    SMB Header<br>    Transaction Response (0x25)<br>SMB Pipe Protocol<br>DCE RPC<br>Microsoft Registry<br>    Operation: OpenEntry (15)<br>    Request in frame 922<br>    Policy Handle<br>        Context handle: 00000000000000000000000000000000...<br>    Return code: Unknown (0x00000005)<br><br><br>Frame #1054/#1055 Open Registry Entry Request/Response<br><br>Frame 1054 (306 bytes on wire, 306 bytes captured)<br>Ethernet II, Src: 00:30:05:22:03:cd, Dst: 00:20:48:64:4d:5b<br>Internet Protocol, Src Addr: 167.228.64.156 (167.228.64.156), Dst Addr: 167.228.64.4 (167.228.64.4)<br>Transmission Control Protocol, Src Port: 1086 (1086), Dst Port: netbios-ssn (139), Seq: 2561583902, Ack: 3184191040, Len: 252<br>NetBIOS Session Service<br>SMB (Server Message Block Protocol)<br>    SMB Header<br>    Transaction Request (0x25)<br>SMB Pipe Protocol<br>DCE RPC<br>Microsoft Registry<br>    Operation: OpenEntry (15)<br>    Reply in frame 1055<br>    Policy Handle: HKLM handle<br>        Context handle: 000000004BF0FF519BC16349A141E474...<br>        Opened in frame 1053<br>        Closed in frame 1056<br>    Class: SOFTWARE\Microsoft\Windows NT\CurrentVersion<br>        Length: 90<br>        Size: 90<br>        Class: SOFTWARE\Microsoft\Windows NT\CurrentVersion<br>            Referent ID: 0x74c71d38<br>            Max Length: 45<br>            Offset: 0<br>            Length: 45<br>            Class: SOFTWARE\Microsoft\Windows NT\CurrentVersion<br>    Unknown 1: 0x00000000<br>    Access mask: 0x00020019<br><br>Frame 1055 (162 bytes on wire, 162 bytes captured)<br>Ethernet II, Src: 00:20:48:64:4d:5b, Dst: 00:30:05:22:03:cd<br>Internet Protocol, Src Addr: 167.228.64.4 (167.228.64.4), Dst Addr: 167.228.64.156 (167.228.64.156)<br>Transmission Control Protocol, Src Port: netbios-ssn (139), Dst Port: 1086 (1086), Seq: 3184191040, Ack: 2561584154, Len: 108<br>NetBIOS Session Service<br>SMB (Server Message Block Protocol)<br>    SMB Header<br>    Transaction Response (0x25)<br>SMB Pipe Protocol<br>DCE RPC<br>Microsoft Registry<br>    Operation: OpenEntry (15)<br>    Request in frame 1054<br>    Policy Handle<br>        Context handle: 00000000000000000000000000000000...<br>    Return code: Unknown (0x00000005)<br><br>---End ----<br><br><br>RPC calls (opening a named pipe) to lsarpc and samr<br>----------------------------------------------------<br> Before the client can actually use RPC he has to bind to an RPC interface first<br> before starting the actual RPC traffic.<br><br> The UUID 12345678-1234-ABCD-EF00-0123456789AB is the UUID related to LSARPC traffic.<br> UUID 12345778_1234_abcd_ef00_0123456789ac corresponds to SAM<br><br> You may also see some RPC faults in response packets of the NT4 based<br> server which are expected errors, i.e.<br> <br> Calls to Lsarpc:LsarOpenPolicy2 (Opnum : 0x2C)<br>  or<br> Calls to Lsarpc: LsarQueryInformationPolicy2 (Opnum : 0x2E)<br> The response from an NT4 based server is:<br> MSRPC: c/o RPC Fault: call 0x2 context 0x0 status 0x1C010002 cancels 0x0<br> <br> Status code 1C010002 means that the RPC opnum command is not implemented at NT4<br><br> </pre></div><div class='kb-securedata-section section'>Objectpicker, STATUS_ACCESS_DENIED 0xC0000022, remote registry, Remote Procedure Call (RPC) </div><div class='kb-securedata-section section'>Author: WalterE <br>Writer: WalterE<br>Tech Reviewer: v-raddis<br>Editor: v-janhal</div>