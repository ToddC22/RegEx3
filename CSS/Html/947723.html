<header><h1>Changes to remote administration in Windows Server 2008</h1></header><div class='kb-notice-section section'>Template: zGeneric Info Article</div><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/84706.asp' title='Link only available for Microsoft corporate network users' target='_blank'>84706 (Content Maintenance)</a></div><div class='kb-summary-section section'>This article describes the differences between Windows Server 2003 and Windows Server 2008 or Windows Server 2008 R2 when you use the Remote Desktop Connection (RDC) client to remotely connect to the server for administrative purposes.<br> </div><div class='kb-moreinformation-section section'><h3 class='sbody-h3'>Changes to remote administration in Windows Server 2008 and Windows Server 2008 R2</h3>In Windows Server 2003, you can start the RDC client (Mstsc.exe) by using the <span class='text-base'>/console</span> switch to remotely connect to the physical console session on the server (also known as session 0). In Windows Server 2008 or Windows Server 2008 R2, the <span class='text-base'>/console</span> switch has been deprecated. For more information, see the “Why the /console switch is no longer needed” section. In Windows Server 2008 and Windows Server 2008 R2, session 0 is a noninteractive session that is reserved for services. <br><br>You can use the new <span class='text-base'>/admin</span> switch to remotely connect to a Windows Server 2008-based server for administrative purposes. The <span class='text-base'>/admin</span> switch is introduced in RDC 6.1. RDC 6.1 is included in the following operating systems:<br> <ul class='sbody-free_list'><li>Windows Server 2008<br></li><li>Windows Server 2008 R2</li><li>Windows Vista Service Pack 1 (SP1)</li><li>Windows XP Service Pack 3 (SP3)</li></ul></div><div class='kb-moreinformation-section section'><span class='text-base'>Note</span>   RDC 6.1 (6.0.6001) supports Remote Desktop Protocol (RDP) 6.1. <br><br>RDC 6.1 does not support the <span class='text-base'>/console</span> switch. However, for backward compatibility, you can use the <span class='text-base'>/admin</span> switch to connect to the physical console session on a Windows Server 2003-based server. For example, to connect from a Windows Vista SP1-based client to the physical console session of a Windows Server 2003-based server, run the <span class='text-base'>mstsc.exe /admin</span> command. <br><br>If you try to use the <span class='text-base'>/console</span> switch together with the RDC 6.1 client, the behavior is as follows. <br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>Scenario</span></td><td class='sbody-td'><span class='text-base'>Behavior</span></td></tr><tr class='sbody-tr'><td class='sbody-td'>You type <span class='sbody-userinput'>mstsc.exe /console</span> at the command prompt, and then you connect to a remote server that does not have Terminal Server installed.</td><td class='sbody-td'>The <strong class='uiterm'>/console</strong> switch is silently ignored. You will be connected to a session to remotely administer the server.</td></tr><tr class='sbody-tr'><td class='sbody-td'></td><td class='sbody-td'></td></tr><tr class='sbody-tr'><td class='sbody-td'></td><td class='sbody-td'>For more information about the Windows Server&#160;2008 or Windows Server 2008 R2 behavior, see the &quot;When you connect to a server that does not have Terminal Server installed&quot; section.</td></tr><tr class='sbody-tr'><td class='sbody-td'>You type <span class='sbody-userinput'>mstsc.exe /console</span> at the command prompt, and then you connect to a remote server that has Terminal Server installed.</td><td class='sbody-td'>The <strong class='uiterm'>/console</strong> switch is silently ignored. You will be connected to a standard Remote Desktop session that requires a Terminal Services client access license (TS&#160;CAL).</td></tr><tr class='sbody-tr'><td class='sbody-td'>In the RDC client UI, you specify <strong class='uiterm'><strong class='sbody-strong'>Computer_name</strong> /console</strong> in the <strong class='uiterm'>Computer</strong> box, and then you click <strong class='uiterm'>Connect</strong>. <br><br><span class='text-base'>Note </span><strong class='sbody-strong'>Computer_name</strong> represents the name of the remote computer to which you want to connect.</td><td class='sbody-td'>You receive an “An unknown parameter was specified in computer name field&quot; error message.</td></tr><tr class='sbody-tr'><td class='sbody-td'>In the .rdp file, you specify <strong class='uiterm'>/console</strong> in the <strong class='uiterm'>full address</strong> property, and then you try to start the Remote Desktop connection.</td><td class='sbody-td'>You receive an &quot;An unknown parameter was specified in computer name field&quot; error message.</td></tr><tr class='sbody-tr'><td class='sbody-td'>In the .rdp file, you specify the <strong class='uiterm'>connect to console</strong> property, and then you start the Remote Desktop connection.</td><td class='sbody-td'>The property is silently ignored. You will be connected to a session that requires a TS&#160;CAL.</td></tr><tr class='sbody-tr'><td class='sbody-td'>You programmatically call the <span class='text-base'>put_ConnectToServerConsole</span> function or the <span class='text-base'>get_ConnectToServerConsole</span> function of the IMsRdpClientAdvancedSettings interface.</td><td class='sbody-td'>The function fails, and it returns an S_FALSE value.</td></tr></table></div><h3 class='sbody-h3'>Why the /console switch is no longer needed</h3> <br><br>In Windows Server 2003,  you use  the <span class='text-base'>Mstsc.exe /console</span> command  to start a Remote Desktop session for the following reasons:<br> <ul class='sbody-free_list'><li>To connect to session 0 <br>Some applications are installed and run only in session 0. This is because the applications have to communicate with services that run in session 0  or because the applications have to display user interface (UI) elements that are displayed in session 0. <br></li><li>To connect back to an existing session on the physical console <br>Because the physical console session in Windows Server 2003 is always session 0, the only way that you can reconnect to this session is by using the <span class='text-base'>/console</span> switch. </li></ul>  <br><br>In Windows Server 2008 and Windows Server 2008 R2, the <span class='text-base'>/console</span> switch functionality is no longer needed for the following reasons:<br> <ul class='sbody-free_list'><li>Improved application compatibility guarantees that legacy applications that have to communicate with services in session 0 will be installed and run in sessions other than session 0. Additionally, if the service that is associated with an application tries to display UI elements in session 0, a built-in capability in Windows Server 2008, Windows Server 2008 R2 and in Windows Vista enables you to view and to interact with the session 0 UI from your session. Windows Server 2008/Windows Server 2008 R2 session 0 is a noninteractive session that is reserved for services. Therefore, there is no need for you to explicitly connect to this session. <br><br><span class='text-base'>Note</span>   For more information about session 0 isolation in Windows Vista, view the &quot;Impact of Session 0 Isolation on Services and Drivers in Windows Vista&quot; topic on the following Microsoft Web site:<div class='indent'><a id='kb-link-1' href='http://go.microsoft.com/fwlink/?linkid=106201' target='_self'>http://go.microsoft.com/fwlink/?LinkId=106201</a></div></li><li>Because the physical console session is never session 0, you can always reconnect to your existing session on the physical console.  The <span class='text-base'>Restrict Terminal Services users to a single remote session</span>  Group Policy setting determines whether you can connect to your existing physical console session. This setting is available in the <strong class='uiterm'>Computer Configuration\Administrative Templates\Windows Components\Terminal Services\Terminal Server\Connections</strong> node of the Local Group Policy Editor. You can also configure this setting in <strong class='uiterm'>Terminal Services Configuration</strong>. The <strong class='uiterm'>Restrict each user to a single session</strong> setting appears in <strong class='uiterm'>Edit settings</strong> in the <strong class='uiterm'>General</strong> section. </li></ul><h3 class='sbody-h3'>How the /admin switch behaves</h3> <br><br>You can run the RDC 6.1 client (Mstsc.exe) together with the <span class='text-base'>/admin </span>switch to remotely administer a Windows Server 2008-based server that has or does not have Terminal Server installed. However, if you are trying to remotely administer a Windows Server 2008-based server that does not have the Terminal Server role service installed, you do not have to use the <strong class='uiterm'>/admin</strong> switch.  In this case, the same connection behavior occurs with or without the <span class='text-base'>/admin</span> switch.  At any point in time, there can be two active remote administration sessions. To start a remote administration session, you must be a member of the Administrators group on the server to which you are connecting. <h3 class='sbody-h3'>When you connect to a server that does not have Terminal Server installed</h3>If  a member of the Administrators group starts a Remote Desktop session to a Windows Server 2008-based server that does not have the Terminal Server role service installed, the following conditions are true for the remote administration session: <br><ul class='sbody-free_list'><li>Time zone redirection is disabled.<br></li><li>Terminal Services Session Broker (TS Session Broker) redirection is disabled.<br></li><li>Plug and Play device redirection is disabled.<br></li><li>The remote session theme is changed to Windows Classic.<br></li><li>Terminal Services Easy Print is disabled. </li></ul><h3 class='sbody-h3'>When you connect to a server that has Terminal Server installed </h3>If a member of the Administrators group starts a Remote Desktop session to a Windows Server 2008-based server that has the Terminal Server role service installed, they must use the <span class='text-base'>/admin</span> switch to connect to a session to remotely administer the server. The following conditions are true for the session: <br><ul class='sbody-free_list'><li>You do not have to have a TS CAL  to   remotely administer a terminal server.<br></li><li>Time zone redirection is disabled.<br></li><li>Terminal Services Session Broker  redirection is disabled.<br></li><li>Plug and Play device redirection is disabled.<br></li><li>The remote session theme is changed to Windows Classic.<br></li><li>Terminal Services Easy Print is disabled. </li></ul><h3 class='sbody-h3'>Changes to APIs </h3>  <br>If you are using RDC 6.1, you can no longer use the <span class='text-base'>ConnectToServerConsole</span> property of the <span class='text-base'>IMsRdpClientAdvancedSettings</span> interface to specify whether the Remote Desktop ActiveX control should try to connect to the server for administrative purposes. Instead, you must use the <span class='text-base'>ConnectToAdministerServer</span> property of the <span class='text-base'>IMsRdpClientAdvancedSettings6</span> interface to connect to one of the following sessions:<ul class='sbody-free_list'><li>The physical console session on a Windows Server 2003-based computer</li><li>The session that is used for administrative purposes on a Windows Server 2008-based computer</li></ul> <br>For more information about the <span class='text-base'>ConnectToServerConsole</span> property, visit the following Web site: <div class='indent'><a id='kb-link-2' href='http://go.microsoft.com/fwlink/?linkid=106203' target='_self'>http://go.microsoft.com/fwlink/?LinkId=106203</a></div>   <br>For more information about the <span class='text-base'>ConnectToAdministerServer</span> property, visit the following Web site: <div class='indent'><a id='kb-link-3' href='http://go.microsoft.com/fwlink/?linkid=106204' target='_self'>http://go.microsoft.com/fwlink/?LinkId=106204</a></div></div><div class='kb-securedata-section section'><span class='text-base'>Author: ayesham</span><br><span class='text-base'>Writer: v-dehaas</span><br><span class='text-base'>Tech Reviewer: v-jomcc</span><br><span class='text-base'>Editor:v-crweb</span></div>