<header><h1>Minimum permissions are needed for a delegated administrator to force password change at next logon procedure</h1></header><div class='kb-symptoms-section section'> By default, when you, as the administrator, delegate the ability to reset passwords to a user or group by using the Delegation of Control Wizard, that user or group does not have the permission to force a user, for whom the password has been reset, to change their password the next time that the user logs on. If the user to whom you give the permission to reset passwords right-clicks a user account, clicks <span class='text-base'>Reset Password</span>, and then clicks to select the <strong class='uiterm'>User must change password at next logon</strong> check box, the latter user&#39;s password is reset, however, this user is not forced to change their password the next time that this user logs on. </div><div class='kb-cause-section section'> This behavior occurs because the user does not have the required minimum permission that is necessary to set the <strong class='uiterm'>User must change password at next logon</strong> option, which is the Write Account Restrictions permission on user objects. When you delegate the ability to reset passwords, the only permission that is granted over the delegated container is the Reset Password permission on user objects. </div><div class='kb-resolution-section section'>You can use the Delegation of Control Wizard to delegate the<br> <span class='text-base'>Reset Password</span>  permission to the delegated user. Whereas, in order to change the &quot;User must change password on next logon&quot; flag, the delegated user must have write permission to the user containers. However, the write permission provides the delegated user with additional permissions. In other words, the <span class='text-base'>Write Account Restrictions</span>  permission is a super permission that provides access to some other user properties. The pwdLastSet property can be used to force the user to change their password at next logon. By default, the individual permissions are not visible. The filtering of the permissions is controlled by values in the Dssec.dat file. To resolve this issue, you can use the following steps to delegate permissions for only the <strong class='uiterm'>Reset Password</strong> and pwdLastSet property to a user-defined group named <span class='text-base'>Help Desk</span>.<br> <ol class='sbody-num_list'><li> Disable the filter for the user permissions:<br><ol class='sbody-alpha_list'><li>Click<br> <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type<br> <span class='sbody-userinput'>Dssec.dat</span> in the <strong class='uiterm'>Open</strong> box, and then click<br> <strong class='uiterm'>OK</strong>.</li><li>Click <strong class='uiterm'>Open With</strong>, click <br> <strong class='uiterm'>Notepad</strong>, and then click <strong class='uiterm'>OK</strong>.</li><li> In the <span class='text-base'>[User]</span> section, edit the <span class='text-base'>pwdLastSet</span> value by changing <span class='text-base'>pwdLastSet=7</span> to <span class='text-base'>pwdLastSet=0</span>. </li><li>Quit Notepad.</li></ol><span class='text-base'>Note</span> Do not change the value of <span class='text-base'>pwdLastSet</span> in the <span class='text-base'>[Computer]</span> section.   By default, the <span class='text-base'> pwdLastSet</span> value does not exist in the <span class='text-base'>[User]</span> section of the Dssec.dat file on Windows  Server 2003. Therefore, if you are running Windows  Server 2003, you  need to  add it manually.</li><li>Delegate the permissions to the Help Desk group:<br><ol class='sbody-alpha_list'><li>Click<br> <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type<br> <span class='sbody-userinput'>dsa.msc</span> in the <strong class='uiterm'>Open</strong> box, and then click <strong class='uiterm'>OK</strong>.</li><li>Right-click the organizational unit to which  you want to delegate permissions, and then click <strong class='uiterm'>Delegate Control</strong>.<br> </li><li>Click <strong class='uiterm'>Next</strong>, and then click<br> <strong class='uiterm'>Add</strong>.</li><li>Click <strong class='uiterm'>Help Desk</strong>, click <strong class='uiterm'>Add</strong>, and then click<br> <strong class='uiterm'>OK</strong>.</li><li>Click <strong class='uiterm'>Next</strong>, check  <br> <strong class='uiterm'>Create a custom task to delegate</strong>, and then click<br> <strong class='uiterm'>Next</strong>.</li><li>Click <strong class='uiterm'>Only the following objects in the folder</strong>, click to select the <strong class='uiterm'>User objects</strong> check box, and then click <strong class='uiterm'>Next</strong>.</li><li>Click to select the <strong class='uiterm'>General</strong> and the <strong class='uiterm'>Property-specific</strong> check boxes.</li><li>Click to  select the <strong class='uiterm'>Reset Password</strong>, <strong class='uiterm'>Read pwdLastSet</strong>, and <strong class='uiterm'>Write pwdLastSet</strong> check boxes in the <strong class='uiterm'>Permission</strong> box.</li><li>Click <strong class='uiterm'>Next</strong>, and then click<br> <strong class='uiterm'>Finish</strong>.</li></ol></li><li>Enable the filter for the user permissions:<ol class='sbody-alpha_list'><li>Click<br> <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type<br> <span class='sbody-userinput'>dssec.dat</span> in the <strong class='uiterm'>Open</strong> box, and then click<br> <strong class='uiterm'>OK</strong>.</li><li>Click <strong class='uiterm'>Open With</strong>, click<br> <strong class='uiterm'>Notepad</strong>, and then click <strong class='uiterm'>OK</strong>.</li><li> In the <span class='text-base'>[User]</span> section, edit the <span class='text-base'>pwdLastSet</span> value by changing <span class='text-base'>pwdLastSet=0</span> to<span class='text-base'> pwdLastSet=7</span>. </li><li>Quit Notepad.</li></ol></li></ol>Additionally, if you want to verify the security changes, you can follow these steps:<br> <ol class='sbody-alpha_list'><li>Click<br><strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type<br><span class='sbody-userinput'>dsa.msc</span>, and then click <strong class='uiterm'>OK</strong>.</li><li>On the <strong class='uiterm'>View</strong> menu, select <strong class='uiterm'>Advanced Features</strong>.</li><li>Right-click the organizational unit that you delegated permissions to and then click <strong class='uiterm'>Properties</strong>.</li><li> Click on the <strong class='uiterm'>Security</strong> tab, click the <span class='text-base'>Help Desk</span> group, and then click <strong class='uiterm'>Advanced</strong>.</li><li>Click <strong class='uiterm'>Read/Write Property</strong> on the<br><strong class='uiterm'>Permission Entries</strong>, and then click<br><strong class='uiterm'>View/Edit.</strong></li><li>You can see that only the <strong class='uiterm'>Read pwdLastSet</strong>and the <strong class='uiterm'>Write pwdLastSet</strong> properties are set to<br><strong class='uiterm'>Allow</strong>, but the <span class='text-base'>Help Desk</span> does not have access to any other properties. </li></ol></div><div class='kb-moreinformation-section section'><span>For additional information about delegating permissions, click the article numbers below to view the articles in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/EN-US/help/235531'>235531 </a> Default Security Concerns in Active Directory Delegation<br></div></span><span><div class='indent'><a id='kb-link-2' href='/EN-US/help/229873'>229873 </a> Delegate Control Wizard Cannot Be Used to Remove Groups or Users<br></div></span><span><div class='indent'><a id='kb-link-3' href='/en-us/help/296490'>296490 </a> How to modify the filtered properties of an object <br><br></div></span></div><div class='kb-securedata-section section'>Author: ROBINGER <br>Edit Reviewer: V-RROYER <br>Tech Reviewer: ROGERBEL <br> </div>