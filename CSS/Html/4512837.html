<header><h1>NPS extension workflow</h1></header><span asset="4476087" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4476087]</span><ul><li><strong>Content Idea (CI): </strong><a managed-link="" href="https://aka.ms/CIEdit?id=104190" target="" data-content-type="" data-content-id="" bookmark-id="">104190</a></li></ul><p><strong>Support Topic: </strong><ul><li>Windows Servers\Windows Server 2012 R2\Windows Server 2012 R2 Datacenter\Network Connectivity and File Sharing\RADIUS - Network Policy Server (NPS) or Internet Authentication Service (IAS)</li><li>Windows Servers\Windows Server 2016\Windows Server 2016\Network Connectivity and File Sharing\RADIUS - Network Policy Server (NPS) or Internet Authentication Service (IAS)</li><li>Windows Servers\Windows Server 2019\Windows Server 2019 Datacenter\Network Connectivity and File Sharing\RADIUS - Network Policy Server (NPS) or Internet Authentication Service (IAS)</li></ul></p><div><div>
  </div><div><h1 style="font-family:'Calibri Light', 'sans-serif';font-size:16pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:12pt;" dir="ltr">
    <span style="color:#2E74B5;font-style:normal;font-weight:normal;margin:0;padding:0;">&lt;NPS extension&gt; Workflow</span>
  </h1>
  <h2 style="font-family:'Calibri Light', 'sans-serif';font-size:13pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:2pt;" dir="ltr">
    <span style="color:#2E74B5;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </h2>
  <h2 style="font-family:'Calibri Light', 'sans-serif';font-size:13pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:2pt;" dir="ltr">
    <span style="color:#2E74B5;font-style:normal;font-weight:normal;margin:0;padding:0;">Overview</span>
  </h2>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">This workflow introduces NPS extension and describes NPS extension authentication flow as well as troubleshooting approaches.</span>
  </p>
  <h2 style="font-family:'Calibri Light', 'sans-serif';font-size:13pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:2pt;" dir="ltr">
    <span style="color:#2E74B5;font-style:normal;font-weight:normal;margin:0;padding:0;">Scenarios</span>
  </h2>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">NPS extension has been added to networking support topic recently. This requires that networking engineers to be familiar with its setup and troubleshooting logic. We may need to collaborate with AAD team if the issue lies in MFA(secondary) auth.</span>
  </p>
  <h2 style="font-family:'Calibri Light', 'sans-serif';font-size:13pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:2pt;" dir="ltr">
    <span style="color:#2E74B5;font-style:normal;font-weight:normal;margin:0;padding:0;">Background Reading</span>
  </h2>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="color:#000000;font-style:normal;font-weight:bold;margin:0;padding:0;">Reference material for NPS extension: </span>
  </p>
  <div align="left">
    <table style="border:none;border-collapse:collapse;margin-bottom:.001pt;width:100%;" dir="ltr">
      <tbody><tr>
        <td style="background:#F2F2F2;border-bottom:solid #BFBFBF 1.0pt;border-left:solid #BFBFBF 1.0pt;border-right:solid #BFBFBF 1.0pt;border-top:solid #BFBFBF 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:251.15pt;">
          <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Title with link </span>
          </p>
        </td>
        <td style="border-bottom:solid #BFBFBF 1.0pt;border-left:solid #BFBFBF 1.0pt;border-right:solid #BFBFBF 1.0pt;border-top:solid #BFBFBF 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:215.85pt;">
          <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Description </span>
          </p>
        </td>
      </tr>
      <tr>
        <td style="background:#F2F2F2;border-bottom:solid #BFBFBF 1.0pt;border-left:solid #BFBFBF 1.0pt;border-right:solid #BFBFBF 1.0pt;border-top:solid #BFBFBF 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:251.15pt;">
          <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">About NPS Extensions</span>
          </p>
          <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <a href="https://docs.microsoft.com/en-us/windows/win32/nps/ias-about-internet-authentication-service">
              <span style="color:#0563C1;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">https://docs.microsoft.com/en-us/windows/win32/nps/ias-about-internet-authentication-service</span>
            </a>
          </p>
          <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
          </p>
        </td>
        <td style="background:#F2F2F2;border-bottom:solid #BFBFBF 1.0pt;border-left:solid #BFBFBF 1.0pt;border-right:solid #BFBFBF 1.0pt;border-top:solid #BFBFBF 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:215.85pt;">
          <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Overview of what NPS extension is all about </span>
          </p>
        </td>
      </tr>
      <tr>
        <td style="background:#F2F2F2;border-bottom:solid #BFBFBF 1.0pt;border-left:solid #BFBFBF 1.0pt;border-right:solid #BFBFBF 1.0pt;border-top:solid #BFBFBF 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:251.15pt;">
          <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <span lang="bs-Latn-BA" style="font-style:normal;font-weight:bold;margin:0;padding:0;">Integrate your existing NPS infrastructure with Azure Multi-Factor Authentication</span>
          </p>
          <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <a href="https://docs.microsoft.com/bs-latn-ba/azure/active-directory/authentication/howto-mfa-nps-extension">
              <span lang="bs-Latn-BA" style="color:#0563C1;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">https://docs.microsoft.com/bs-latn-ba/azure/active-directory/authentication/howto-mfa-nps-extension</span>
            </a>
          </p>
          <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
          </p>
        </td>
        <td style="border-bottom:solid #BFBFBF 1.0pt;border-left:solid #BFBFBF 1.0pt;border-right:solid #BFBFBF 1.0pt;border-top:solid #BFBFBF 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:215.85pt;">
          <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">How NPS extension works with azure MFA and how to configure the whole solution</span>
          </p>
        </td>
      </tr>
      <tr>
        <td style="background:#F2F2F2;border-bottom:solid #BFBFBF 1.0pt;border-left:solid #BFBFBF 1.0pt;border-right:solid #BFBFBF 1.0pt;border-top:solid #BFBFBF 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:251.15pt;">
          <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">Resolve error messages from the NPS extension for Azure Multi-Factor Authentication</span>
          </p>
          <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <a href="https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-nps-extension-errors">
              <span style="color:#0563C1;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-nps-extension-errors</span>
            </a>
          </p>
          <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
          </p>
        </td>
        <td style="background:#F2F2F2;border-bottom:solid #BFBFBF 1.0pt;border-left:solid #BFBFBF 1.0pt;border-right:solid #BFBFBF 1.0pt;border-top:solid #BFBFBF 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:215.85pt;">
          <p style="font-family:Calibri;font-size:12pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
            <span style="font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">If you encounter errors with the NPS extension for Azure Multi-Factor Authentication, use this article to reach a resolution faster</span>
            <span style="font-family:'Segoe UI', 'sans-serif';font-style:normal;font-weight:normal;margin:0;padding:0;">.</span>
          </p>
        </td>
      </tr>
    </tbody></table>
  </div>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">NPS Extension authentication flow (take VPN as example):</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.40in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="color:#000000;display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;">The </span>
    <span style="color:#000000;font-style:normal;font-weight:bold;margin:0;padding:0;">VPN server</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;"> receives an authentication request from a VPN user that includes the username and password for connecting to a resource, such as a Remote Desktop session.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.40in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="color:#000000;display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;">Acting as a </span>
    <span style="color:#000000;font-style:normal;font-weight:bold;margin:0;padding:0;">RADIUS client</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;">, the </span>
    <span style="color:#000000;font-style:normal;font-weight:bold;margin:0;padding:0;">VPN server</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;"> converts the request to a </span>
    <span style="color:#000000;font-style:normal;font-weight:bold;margin:0;padding:0;">RADIUS </span>
    <span style="color:#000000;font-style:italic;font-weight:bold;margin:0;padding:0;">Access-Request</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;"> message and sends it (with an encrypted password) to the </span>
    <span style="color:#000000;font-style:normal;font-weight:bold;margin:0;padding:0;">RADIUS server</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;"> where the NPS extension is installed.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.40in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="color:#000000;display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3.</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;">The username and password combination is verified in Active Directory. If either the username or password is incorrect, the </span>
    <span style="color:#000000;font-style:normal;font-weight:bold;margin:0;padding:0;">RADIUS Server</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;"> sends an </span>
    <span style="color:#000000;font-style:italic;font-weight:normal;margin:0;padding:0;">Access-Reject</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;"> message.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.40in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="color:#000000;display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">4.</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;">If all conditions, as specified in the NPS Connection Request and Network Policies, are met (for example, time of day or group membership restrictions), the </span>
    <span style="color:#000000;font-style:normal;font-weight:bold;margin:0;padding:0;">NPS extension</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;"> triggers a request for secondary authentication with Azure Multi-Factor Authentication.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.40in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="color:#000000;display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">5.</span>
    <span style="color:#000000;font-style:normal;font-weight:bold;margin:0;padding:0;">Azure Multi-Factor Authentication</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;"> communicates with Azure Active Directory, retrieves the user’s details, and performs the secondary authentication by using the method that's configured by the user (cell phone call, text message, or mobile app).</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.40in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="color:#000000;display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">6.</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;">When the MFA challenge is successful, </span>
    <span style="color:#000000;font-style:normal;font-weight:bold;margin:0;padding:0;">Azure Multi-Factor Authentication</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;"> communicates the result to the </span>
    <span style="color:#000000;font-style:normal;font-weight:bold;margin:0;padding:0;">NPS extension</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;">.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.40in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="color:#000000;display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">7.</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;">After the connection attempt is both authenticated and authorized, the NPS where the extension is installed sends a </span>
    <span style="color:#000000;font-style:normal;font-weight:bold;margin:0;padding:0;">RADIUS </span>
    <span style="color:#000000;font-style:italic;font-weight:bold;margin:0;padding:0;">Access-Accept</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;"> message to the VPN server (RADIUS client).</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.40in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="color:#000000;display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">8.</span>
    <span style="color:#000000;font-style:normal;font-weight:normal;margin:0;padding:0;">The user is granted access to the virtual port on the VPN server and establishes an encrypted VPN tunnel.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">Key components flow on NPS:</span>
  </p>
  <p style="font-family:'Arial', 'sans-serif';font-size:11pt;margin-bottom:8pt;margin-left:0.25in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:bold;margin:0;padding:0;text-indent:0;width:0.250in;">•</span>
    <span style="font-family:Calibri;font-style:normal;font-weight:normal;margin:0;padding:0;">Authentication Extension DLL</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">a.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Incoming packet first handled by Authentication Extension DLL before perform</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">ing</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> the NPS </span>
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">primary authentication. </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">b.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">The authentication can be </span>
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">accepted</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> or </span>
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">rejected</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> by the authentication extension DLL directly with NPS Authentication bypassed.</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">c.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">NPS authentication only begins after authentication extension DLL returns </span>
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">Continue. </span>
  </p>
  <p style="font-family:'Arial', 'sans-serif';font-size:11pt;margin-bottom:8pt;margin-left:0.25in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">•</span>
    <span style="font-family:Calibri;font-style:normal;font-weight:normal;margin:0;padding:0;">Authorization Extension DLL</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">a.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">The authorization extension DLL is invoked by NPS after primary authentication done. </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">b.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Where </span>
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">secondary authentication </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">happened. </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">c.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">NPS authorization done before </span>
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">secondary authentication</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">. </span>
  </p>
  <p style="font-family:'Arial', 'sans-serif';font-size:11pt;margin-bottom:8pt;margin-left:0.25in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">•</span>
    <span style="font-family:Calibri;font-style:normal;font-weight:normal;margin:0;padding:0;">NPS extension registry</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.25in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">HKEY_LOCAL_MACHINE\system\currentcontrolset\services\authsrv\parameters</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.25in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">    </span>
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">AuthorizationDLLs</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">    REG_MULTI_SZ    C:\Program Files\Microsoft\AzureMfa\Extensions\MfaNpsAuthzExt.dll</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.25in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">    </span>
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">ExtensionDLLs</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">    REG_MULTI_SZ    C:\Program Files\Microsoft\AzureMfa\Extensions\MfaNpsAuthnExt.dll</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.25in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">The extension can be bypassed by remove the registry key and restart NPS Service </span>
  </p>
  <h2 style="font-family:'Calibri Light', 'sans-serif';font-size:13pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:2pt;" dir="ltr">
    <span style="color:#2E74B5;font-style:normal;font-weight:normal;margin:0;padding:0;">Known Issues</span>
  </h2>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.25in;margin-right:0;margin-top:5pt;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">The NPS extension for Azure MFA does not include tools to migrate users and settings from MFA Server to the cloud. For this reason, we suggest using the extension for new deployments, rather than existing deployment. If you use the extension on an existing deployment, your users have to perform proof-up again to populate their MFA details in the cloud.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.25in;margin-right:0;margin-top:5pt;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">The NPS extension uses the UPN from the on-premises Active directory to identify the user on Azure MFA for performing the Secondary Auth. The extension can be configured to use a different identifier like alternate login ID or custom Active Directory field other than UPN. For more information, see the article, </span>
    <a href="https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-nps-extension-advanced">
      <span style="color:#0563C1;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Advanced configuration options for the NPS extension for Multi-Factor Authentication</span>
    </a>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:5pt;margin-left:0.25in;margin-right:0;margin-top:5pt;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Not all encryption protocols support all verification methods. </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:5pt;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">a.</span>
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">PAP</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> supports phone call, one-way text message, mobile app notification, and mobile app verification code</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:5pt;margin-left:0.75in;margin-right:0;margin-top:5pt;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">b.</span>
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">CHAPV2</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> and </span>
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">EAP</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> support phone call and mobile app notification</span>
  </p>
  <h2 style="font-family:'Calibri Light', 'sans-serif';font-size:13pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:2pt;" dir="ltr">
    <span style="color:#2E74B5;font-style:normal;font-weight:normal;margin:0;padding:0;">Scoping</span>
  </h2>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">We need to be very clear about customer’s environment. General questions need to be asked: </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">What is the OS version? How many NPS servers do they have?</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">How is the radius request handled?</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">What’s the authentication is for? VPN? Wireless?</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">4.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">What’s the client and radius client?</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">5.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">What’s the primary (NPS) and secondary (MFA) authentication method?</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">6.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Does the end user input the password and MFA code together? Or the end user will input password for primary auth first, then input the pin code for secondary auth</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">?</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">7.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Since when did the issue happen? Any changes were made before that?</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">8.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Collect screenshot of the settings and let the customer show you the problem. What exactly is the issue? </span>
  </p>
  <h2 style="font-family:'Calibri Light', 'sans-serif';font-size:13pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:2pt;" dir="ltr">
    <span style="color:#2E74B5;font-style:normal;font-weight:normal;margin:0;padding:0;">Data Collection</span>
  </h2>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">Client</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">: if it is windows client, capture below logs.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Netmon trace.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Rastracing. If it is for wlan/lan connection.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Vpn etl. If it is for VPN connection.</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman create trace &quot;net_mobility&quot; -ow -o c:\VPNTrace\net_mobility.etl -p {E6DEC100-4E0F-4927-92BE-E69D7C15C821} 0xffffffffffffffff 0xff -nb 16 16 -bs 1024 -mode Circular -f bincirc -max 4096 -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM RASL2TP,PPTP</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_mobility&quot; -p {d58c126e-b309-11d1-969e-0000f875a5bc} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM IPSEC</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_mobility&quot; -p {6537b295-83c9-4811-b7fe-e7dbf2f22cec} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM SSTP</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_mobility&quot; -p {FF5E7768-8EF5-48b1-9998-61FC841D124F} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM VPNIKE</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_mobility&quot; -p {aefaa562-ebc7-4ca1-b2de-f88462c448ec} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM RASGRE</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_mobility&quot; -p {06d47faa-d591-450d-9805-2fa47d380b41} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM RASMobility</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_mobility&quot; -p {a98f61af-55a4-4d99-8ede-217642bd02b8} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM RASCustom</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_mobility&quot; -p {114c0ac9-df95-450f-b769-e9d85e783a64} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM RASMAN</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_mobility&quot; -p {b9f181e1-e221-43c6-9ee4-7f561315472f} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM VPNPlugin</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_mobility&quot; -p {39c9f48f,d244,45a8,842f,dc9fbc9b6e92} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM RASEAP</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_mobility&quot; -p {6eb8db94,fe96,443f,a366,5fe0cee7fb1c} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM RASETW</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_mobility&quot; -p {24989972-0967-4e21-a926-93854033638e} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM AgileVPN</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_mobility&quot; -p {B5325CD6-438E-4EC1-AA46-14F46F2570E4} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman create trace &quot;minio_netio&quot; -ow -o c:\VPNTrace\minio_netio.etl -p {EB004A05-9B1A-11D4-9123-0050047759BC} 0xffffffffffffffff 0xff -nb 16 16 -bs 1024 -mode Circular -f bincirc -max 2048 -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;minio_netio&quot; -p &quot;Microsoft-Windows-TCPIP&quot; 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;minio_netio&quot; -p &quot;Microsoft-Windows-Winsock-AFD&quot; 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;minio_netio&quot; -p {B40AEF77-892A-46F9-9109-438E399BB894} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman create trace &quot;vpnplug&quot; -ow -o c:\VPNTrace\vpnplug.etl -p {8A40BA3E-4ECE-4DF5-9BBB-B26B60AC983D} 0xffffffffffffffff 0xff -nb 16 16 -bs 1024 -mode Circular -f bincirc -max 4096 -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;vpnplug&quot; -p &quot;Microsoft-Windows Networking VPN Plugin Platform&quot; 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;vpnplug&quot; -p {B9F181E1-E221-43C6-9EE4-7F561315472F} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;vpnplug&quot; -p {B80A3EE8-4ECE-4DF5-9BBB-B26B60AC983D} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;vpnplug&quot; -p {8FC438F1-00EF-4F07-B68E-08A9A9B55ADB} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;vpnplug&quot; -p {A487F25A-2C11-43B7-9050-527F0D6117F2} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;vpnplug&quot; -p {39C9F48F-D244-45A8-842F-DC9FBC9B6E92} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;vpnplug&quot; -p {8FC438F1-00EF-4F07-B68E-08A9A9B55ADB} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;vpnplug&quot; -p {EFD89D89-6B12-4467-BBFA-8122C589E066} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;vpnplug&quot; -p {A487F25A-2C11-43B7-9050-527F0D6117F2} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;vpnplug&quot; -p {7C970FC8-DAE6-4B89-8BBF-294EE1C4A79D} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;vpnplug&quot; -p {2E060A13-A848-4B3F-B437-4E21F8AEE32F} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;vpnplug&quot; -p {542F2110-2C0F-40D7-AA35-3309FE74B8AE} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;vpnplug&quot; -p {45902DE3-6D95-4A35-A37E-862215252640} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman stop &quot;net_mobility&quot; -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman stop &quot;minio_netio&quot; -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman stop &quot;vpnplug&quot; -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">Radius client</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">: should be third party. Unless it is for VPN connection and it is windows VPN server. In that case, the radius client should be our VPN server and we can capture netmon trace and VPN etl(as above).</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">NPS server:</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Netmon trace.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">NPS etl for primary auth.</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman create trace &quot;net_common&quot; -ow -o C:\NPSTrace\net_common.etl -p {B2CBF6DC-392A-43AE-98D2-1AA66DFCB2C3} 0xffffffffffffffff 0xff -nb 16 16 -bs 1024 -mode Circular -f bincirc -max 4096 -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_common&quot; -p {344EB4B5-5B35-48D7-B116-28E3E3976B49} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_common&quot; -p {997590EF-d144-4d41-b7fb-7028ae295b04} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_common&quot; -p {EA500216-dc45-4f41-a1dc-e37ea5df188e} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_common&quot; -p {BAE49237-f9d2-4eea-b660-1aa0f1f5637f} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;net_common&quot; -p {C2300092-f475-42ae-9ea9-66c268bef2c6} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman stop &quot;net_common&quot; -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">NPS extension etl for secondary auth.</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM From Azure MFA Wiki, enable Azure MFA Verbose Logging and restart NPS Service. enable ondemand</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM REG ADD HKLM\SOFTWARE\Microsoft\AzureMfa /v VERBOSE_LOG /d TRUE /f</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">REM net stop ias &amp; net start ias</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman create trace &quot;NPSExtension&quot; -ow -o C:\NPSTrace\NPSExtension.etl -p {7237ED00-E119-430B-AB0F-C63360C8EE81} 0xffffffffffffffff 0xff -nb 16 16 -bs 1024 -mode Circular -f bincirc -max 4096 -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman update trace &quot;NPSExtension&quot; -p {EC2E6D3A-C958-4C76-8EA4-0262520886FF} 0xffffffffffffffff 0xff -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">logman stop &quot;NPSExtension&quot; -ets</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">4.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Event logs.</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.75in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">a.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">NPS audit log in security log.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Enable NPS server logging (Success or failure) by using the command below:</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.75in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">&quot;auditpol /set /subcategory:&quot;Network Policy Server&quot; /success:enable /failure:enable&quot;</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">b.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">AuthN -&gt; Authentication Extension</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.75in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">c.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">AuthZ -&gt; Authorization Extension</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span asset="4512830" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4512830]</span>
    </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <h2 style="font-family:'Calibri Light', 'sans-serif';font-size:13pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:2pt;" dir="ltr">
    <span style="color:#2E74B5;font-style:normal;font-weight:normal;margin:0;padding:0;">Troubleshooting</span>
  </h2>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">Radius client:</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Confirm from netmon, whether it has sent the radius request to NPS server. </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">a.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">We can use Radius ID to match the request/response.</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.500in;">3 (0x3)</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">11:01:07.3659908</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">80</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">11:01:07 AM 7/4/2019</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">14.9145479</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> (0)</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">192.168.2.56</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">192.168.2.57</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">RADIUS</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">RADIUS:Access Request</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">, </span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">Id = 3,</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> Length = 364</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">b.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">We can also check the more detailed info by extending Radius in this packet.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span asset="4512831" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4512831]</span>
    </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">NPS server:</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Confirm from netmon whether it has received the radius request and what’s the result.</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.500in;">3 (0x3)</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">11:01:07.3659908</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">80</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">11:01:07 AM 7/4/2019</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">14.9145479</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> (0)</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">192.168.2.56</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">192.168.2.57</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">RADIUS</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">RADIUS:Access Request, Id = 3</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">, Length = 364</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.500in;">3 (0x3)</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">11:01:07.4523997</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">85</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">11:01:07 AM 7/4/2019</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">15.0009568</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> (784)</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">192.168.2.57</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">192.168.2.56</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">RADIUS</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="margin:0 0 0 0.50in;padding:0 0 0 0;">&nbsp;</span>
    </span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">RADIUS:Access Accept, Id = 3</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">, Length = 248</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">0.0000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9:06:35 AM 12/12/2018 420&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6:06:35 AM 12/12/2018 11.8431972&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.37.198&nbsp; 172.24.29.202&nbsp;&nbsp;&nbsp;&nbsp; RADIUS </span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">RADIUS:Access Request, Id = 147,</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> Length = 74&nbsp;&nbsp;&nbsp;&nbsp; {RADIUS:21, UDP:20, IPv4:19}</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">0.0606508&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9:06:35 AM 12/12/2018 519&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6:06:35 AM 12/12/2018 11.9038480&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 172.24.29.202&nbsp;&nbsp;&nbsp;&nbsp; 192.168.37.198&nbsp; RADIUS </span>
    <span style="background:yellow;font-style:normal;font-weight:bold;margin:0;padding:0;">RADIUS:Access Reject</span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">, Id = 147</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">, Length = 20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {RADIUS:21, UDP:20, IPv4:19}</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Check security log for NPS event. Filter ID range 6272-6278. 6272 means granted access, 6273 means denied access. The event may not be able to tell us the failure lies in primary or secondary auth, but from the event, we can see more details, eg. which connection request policy it matched and which network policy it matched..</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Check </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Authentication Extension and Authorization Extension event logs for more details about MFA auth.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">4.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Check NPS connection request policy to confirm whether the request should be handled by this NPS server.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">5.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Check NPS network policy to confirm which authentication method is used.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">6.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Check </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">net</span><span style="font-style:normal;font-weight:normal;margin:0;padding:0;">_com</span><span style="font-style:normal;font-weight:normal;margin:0;padding:0;">mon etl for primary auth process. </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">1411 [1] 0388.0F70::[1]388.f70 07/02/19-17:54:46.7445609 [NPSSVC TRL_INFO eap CRPBasedEAP::onSyncRequest eap.cpp@229]Successfully retrieved session (1511) </span>
    <span style="background:yellow;font-style:normal;font-weight:bold;margin:0;padding:0;">for user XXX</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">.</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">1416 [1] 17B0.2DD0::[1]17b0.2dd0 07/02/19-17:54:46.7448289 [NPSSVC TRL_INFO basecamp RadiusExtension::Process extension.cpp@157]</span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">Invoking extension MfaNpsAuthnExt.dll</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">1431 [0] 0388.0F70::[0]388.f70 07/02/19-17:54:46.7457758 [NPSSVC TRL_INFO eap EAPSession::doAction eapsession.cpp@1373]</span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">EAP authentication succeeded</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">.</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">1437 [0] 17B0.2DD0::[0]17b0.2dd0 07/02/19-17:54:46.7459761 [NPSSVC TRL_INFO basecamp RadiusExtension::Process extension.cpp@157]</span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">Invoking extension MfaNpsAuthzExt.dll</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">7.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Check nps_extension etl for secondary auth process.</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">384 [2] 1D8C.0418::06/11/18-14:44:19.4343937 [AuthnExt] AuthnExt_cpp48 RadiusExtensionProcess2() - Starting Authentication Ext for User luyao@edenli.msftonlinelab.com</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">385 [2] 1D8C.0418::06/11/18-14:44:19.4343943 [AuthnExt] AuthnExt_cpp69 RadiusExtensionProcess2() - Authentication Ext:: User luyao@edenli.msftonlinelab.com </span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">continues to primary Auth</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">386 [2] 1D8C.0418::06/11/18-14:44:19.4343948 [AuthnExt] AuthnExt_cpp86 RadiusExtensionProcess2() - Ending Authentication Ext for User luyao@edenli.msftonlinelab.com</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">389 [0] 1D8C.0418::06/11/18-14:44:19.4412891 [AuthzExt] AuthzExt_cpp72 RadiusExtensionProcess2() -  </span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">Request Received For Secondary Authentication 13</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">397 [0] 1D8C.0418::06/11/18-14:44:19.4416916 [AuthzExt] AuthzExt_cpp104 RadiusExtensionProcess2() -  Received Secondary Authentication Ext for User::[luyao@edenli.msftonlinelab.com] RadiusId::[13] NasId::[192.168.2.71] NasPort::[129]</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">403 [2] 1D8C.0418::06/11/18-14:44:19.4512141 [AuthzExt] AuthzExt_cpp151 RadiusExtensionProcess2() - CID: 33eb60fb-6827-4431-b39b-5821652e6236 : Started Processing request for User::[luyao@edenli.msftonlinelab.com] RadiusId::[13] NasId::[192.168.2.71] NasPort::[129]</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">404 [2] 1D8C.0418::06/11/18-14:44:19.4512153 [AuthzExt] AuthzExt_cpp159 RadiusExtensionProcess2() -  CID: 33eb60fb-6827-4431-b39b-5821652e6236 : Access request to be processed for further authentication</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">407 [2] 1D8C.0418::06/11/18-14:44:19.4512302 [AuthzExt] AuthzExt_cpp170 RadiusExtensionProcess2() -  CID: 33eb60fb-6827-4431-b39b-5821652e6236 : </span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">Starting interaction with SAS</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">554 [2] 1D8C.0418::06/11/18-14:44:34.1174269 [AuthzExt] AuthzExt_cpp192 RadiusExtensionProcess2() -  CID: 33eb60fb-6827-4431-b39b-5821652e6236 : </span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">Completed interaction with SAS</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">568 [2] 1D8C.0418::06/11/18-14:44:34.1181603 [AuthzExt] AuthzExt_cpp275 RadiusExtensionProcess2() -  CID: 33eb60fb-6827-4431-b39b-5821652e6236 : Access Accepted for user luyao@edenli.msftonlinelab.com with Azure MFA response: Success and message:  session 971ecc24-88ad-47bb-85e1-b7eefe81cb03</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">570 [2] 1D8C.0418::06/11/18-14:44:34.1181797 [AuthzExt] AuthzExt_cpp318 RadiusExtensionProcess2() - CID: 33eb60fb-6827-4431-b39b-5821652e6236 : </span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">Completed Secondary Authentication Ext for</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> User::[luyao@edenli.msftonlinelab.com] RadiusId::[13] NasId::[192.168.2.71] NasPort::[129]</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <h2 style="font-family:'Calibri Light', 'sans-serif';font-size:13pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:2pt;" dir="ltr">
    <span style="color:#2E74B5;font-style:normal;font-weight:normal;margin:0;padding:0;">Case Study</span>
  </h2>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">Example 1:</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Issue:</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">NPS rejected user’s request.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Troubleshooting:</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">From the netmon trace, we can see that the NPS indeed reject the radius request.</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">0.0000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9:06:35 AM 12/12/2018 420&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6:06:35 AM 12/12/2018 11.8431972&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.37.198&nbsp; 172.24.29.202&nbsp;&nbsp;&nbsp;&nbsp; RADIUS RADIUS:Access Request, Id = 147, Length = 74&nbsp;&nbsp;&nbsp;&nbsp; {RADIUS:21, UDP:20, IPv4:19}</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">0.0606508&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9:06:35 AM 12/12/2018 519&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6:06:35 AM 12/12/2018 11.9038480&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 172.24.29.202&nbsp;&nbsp;&nbsp;&nbsp; 192.168.37.198&nbsp; RADIUS </span>
    <span style="background:yellow;font-style:normal;font-weight:bold;margin:0;padding:0;">RADIUS:Access Reject</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">, Id = 147, Length = 20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {RADIUS:21, UDP:20, IPv4:19}</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;" dir="ltr">
    <span style="display:inline-block;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">From the NPS etl, we can see below error message. </span>
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">The issue lied in primary auth.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">[</span>
    <span style="font-size:9pt;font-style:normal;font-weight:normal;margin:0;padding:0;">1] 03E0.1334::[1]3e0.1334 12/12/18-06:06:35.8511414 [NPSSVC TRL_INFO peruser NTSamPerUser::onSyncRequest </span>
    <a href="http://support.microsoft.com/">
      <span style="color:black;font-size:9pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">ntsamperuser.cpp@106]NT-SAM</span>
    </a>
    <span style="font-size:9pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> User Authorization handler received request for </span>
    <span style="background:yellow;font-size:9pt;font-style:normal;font-weight:bold;margin:0;padding:0;">xxx</span>
    <span style="font-size:9pt;font-style:normal;font-weight:normal;margin:0;padding:0;">.</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">[0] 03E0.1334::[0]3e0.1334 12/12/18-06:06:35.8825058 [NPSSVC TRL_ERROR dll UserRestrictions::checkAuthenticationType </span>
    <a href="http://support.microsoft.com/">
      <span style="color:black;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">userr.cpp@195]UserRestriction</span>
    </a>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">:: </span>
    <span style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">the authentication type from client is not permitted</span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">[0] 03E0.1334::[0]3e0.1334 12/12/18-06:06:35.8825109 [NPSSVC TRL_ERROR dll UserRestrictions::onSyncRequest </span>
    <a href="http://support.microsoft.com/">
      <span style="color:black;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">userr.cpp@69]UserRestrictions</span>
    </a>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> not passed :0x42</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-size:9pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Then we went back to check the radius request packet, we can see that the request used username and password. </span>
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">It should be PAP</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">. (</span>
    <span lang="en-AU" style="font-style:normal;font-weight:normal;margin:0;padding:0;">Password Authentication Protocol (PAP) is a simple, plaintext authentication scheme. The username and password are requested by the remote access server and returned by the remote access client in plaintext.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">)</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span asset="4512832" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4512832]</span>
    </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;" dir="ltr">
    <span style="display:inline-block;font-size:9pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">4.</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">However, in NPS network policy, the authentication method configured at server side is MS-CHAPv1 OR MS-CHAPv2.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span asset="4512834" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4512834]</span>
    </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Action plan:</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;vertical-align:middle;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Please add PAP at server side as well.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;vertical-align:middle;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:bold;margin:0;padding:0;">Example 2:</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Issue:</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="font-style:normal;font-weight:normal;margin:0;padding:0;">Login authentication failed due to timeout waiting for response</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Troubleshooting:</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="font-style:normal;font-weight:normal;margin:0;padding:0;">1. From the trace I can see that NPS has performed primary authentication successfully.</span>
  </p>
  <p style="background:#FFFFFF;font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="background:#FFB6C1;font-style:normal;font-weight:normal;margin:0;padding:0;">[2] 03DC.146C::[2]3dc.146c 12/20/18-15:17:40.6405073 [NPSSVC TRL_INFO auth NTSamAuthentication::onSyncRequest </span>
    <a href="http://support.microsoft.com/">
      <span lang="en-AU" style="background:#FFB6C1;color:black;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">ntsamauth.cpp@262]NT-SAM</span>
    </a>
    <span lang="en-AU" style="background:#FFB6C1;font-style:normal;font-weight:normal;margin:0;padding:0;"> Authentication handler received request for </span>
    <span lang="en-AU" style="background:#FFB6C1;font-style:normal;font-weight:bold;margin:0;padding:0;">xxx</span>
    <span lang="en-AU" style="background:#FFB6C1;font-style:normal;font-weight:normal;margin:0;padding:0;">.</span>
  </p>
  <p style="background:#FFFFFF;font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;">[2] 03DC.146C::[2]3dc.146c 12/20/18-15:17:40.6405270 [NPSSVC TRL_INFO auth NTSamAuthentication::tryPap </span>
    <a href="http://support.microsoft.com/">
      <span lang="en-AU" style="background:#FFFFFF;color:black;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">ntsamauth.cpp@861]Processing</span>
    </a>
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;"> PAP authentication.</span>
  </p>
  <p style="background:#FFFFFF;font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;">[3] 03DC.146C::[3]3dc.146c 12/20/18-15:17:40.6686760 [NPSSVC TRL_INFO auth NTSamAuthentication::storeLogonResult </span>
    <a href="http://support.microsoft.com/">
      <span lang="en-AU" style="background:#FFFFFF;color:black;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">ntsamauth.cpp@376]</span>
      <span lang="en-AU" style="background:yellow;color:black;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">LogonUser</span>
    </a>
    <span lang="en-AU" style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;"> succeeded</span>
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;">.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="font-style:normal;font-weight:normal;margin:0;padding:0;">2. From the extension.etl trace, we can see that secondary authentication has already been triggered. But we did not see it complete.</span>
  </p>
  <p style="background:#FFFFFF;font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="background:#FFFFFF;font-family:'Courier New';font-style:normal;font-weight:normal;margin:0;padding:0;">[</span>
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;">2] 0368.0470::12/20/18-15:17:40.6479206 [AuthnExt] AuthnExt_cpp48 RadiusExtensionProcess2() - Starting Authentication Ext for User </span>
    <span lang="en-AU" style="background:yellow;color:#000000;font-style:normal;font-weight:bold;margin:0;padding:0;">xxx</span>
  </p>
  <p style="background:#FFFFFF;font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;">[2] 0368.0470::12/20/18-15:17:40.6479212 [AuthnExt] AuthnExt_cpp69 RadiusExtensionProcess2() - Authentication Ext:: </span>
    <span lang="en-AU" style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">User </span>
    <span lang="en-AU" style="background:yellow;font-style:normal;font-weight:bold;margin:0;padding:0;">xxx</span>
    <span lang="en-AU" style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;"> continues to primary Auth</span>
  </p>
  <p style="background:#FFFFFF;font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;">[2] 0368.0470::12/20/18-15:17:40.6479215 [AuthnExt] AuthnExt_cpp86 RadiusExtensionProcess2() - Ending Authentication Ext for User </span>
    <span lang="en-AU" style="background:yellow;font-style:normal;font-weight:bold;margin:0;padding:0;">xxx</span>
  </p>
  <p style="background:#FFFFFF;font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;">[1] 0368.0470::12/20/18-15:17:41.2682914 [AuthzExt] AuthzExt_cpp104 RadiusExtensionProcess2() -&nbsp; </span>
    <span lang="en-AU" style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">Received Secondary Authentication</span>
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;"> Ext for User::[</span>
    <span lang="en-AU" style="background:yellow;font-style:normal;font-weight:bold;margin:0;padding:0;">xxx</span>
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;">] RadiusId::[0] NasId::[10.240.120.182] NasPort::[&lt;NULL&gt;]</span>
  </p>
  <p style="background:#FFFFFF;font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;">[3] 0368.0470::12/20/18-15:17:41.6900297 [AuthzExt] AuthzExt_cpp151 RadiusExtensionProcess2() - CID: a04911d8-7773-4196-bf80-4a9124f2ac9d : </span>
    <span lang="en-AU" style="background:yellow;font-style:normal;font-weight:normal;margin:0;padding:0;">Started Processing request for User</span>
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;">::[</span>
    <span lang="en-AU" style="background:yellow;font-style:normal;font-weight:bold;margin:0;padding:0;">xxx</span>
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;">] RadiusId::[0] NasId::[10.240.120.182] NasPort::[&lt;NULL&gt;]</span>
  </p>
  <p style="background:#FFFFFF;font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;">[3] 0368.0470::12/20/18-15:17:41.6900303 [AuthzExt] AuthzExt_cpp159 RadiusExtensionProcess2() -&nbsp; CID: a04911d8-7773-4196-bf80-4a9124f2ac9d : Access request to be processed for further authentication</span>
  </p>
  <p style="background:#FFFFFF;font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="background:#FFFFFF;font-style:normal;font-weight:normal;margin:0;padding:0;">[3] 0368.0470::12/20/18-15:17:41.6900402 [AuthzExt] AuthzExt_cpp170 RadiusExtensionProcess2() -&nbsp; CID: a04911d8-7773-4196-bf80-4a9124f2ac9d : Starting interaction with SAS</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span lang="en-AU" style="font-style:normal;font-weight:normal;margin:0;padding:0;">3. We involved AAD engineer to further check. </span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">From the NPS extension ETL trace, we find many ‘request timed out’ error when trying to access </span>
    <a href="https://nam06.safelinks.protection.outlook.com/?url=https://adnotifications.windowsazure.com/StrongAuthenticationService.svc/Connector&amp;data=02%7c01%7cjanju%40microsoft.com%7cb14f75473e9e4bf2af8908d704dcebfd%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c636983219250253079&amp;sdata=PUq84P06lsaSbnBwCCsELkdxxAM600//VeB1yxlEQGg%3D&amp;reserved=0">
      <span style="color:black;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">https://adnotifications.windowsazure.com/StrongAuthenticationService.svc/Connector</span>
    </a>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Also in Network trace, there are many TCP retransmission to ‘gwmigprda.aadg.windows.net.nsatc.net’:</span>
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <br>‎</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span asset="4512835" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4512835]</span>
    </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">‘gwmigprda.aadg.windows.net.nsatc.net’ is the full name of ‘adnotifications.windowsazure.com’:</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span asset="4512836" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4512836]</span>
    </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Action plan:</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">To use NPS extension, the NPS server needs to be able to communicate with the following URLs over ports 80 and 443.</span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <a href="https://nam06.safelinks.protection.outlook.com/?url=https://adnotifications.windowsazure.com&amp;data=02%7c01%7cjanju%40microsoft.com%7cb14f75473e9e4bf2af8908d704dcebfd%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c636983219250263075&amp;sdata=mKQ/MrspGYg3JSi4pz5DgOezbsPDX/0Aup%2BDzPvRUQY%3D&amp;reserved=0">
      <span style="color:#0563C1;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">https://adnotifications.windowsazure.com</span>
    </a>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <a href="https://nam06.safelinks.protection.outlook.com/?url=https://login.microsoftonline.com&amp;data=02%7c01%7cjanju%40microsoft.com%7cb14f75473e9e4bf2af8908d704dcebfd%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c636983219250263075&amp;sdata=7ayWZfj8hb9mGdn/nJqTx1a8n96k7UpWiLN7LJVH01I%3D&amp;reserved=0">
      <span style="color:#0563C1;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">https://login.microsoftonline.com</span>
    </a>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;">Please adjust your network settings and make sure NPS server can communication with </span>
    <a href="https://nam06.safelinks.protection.outlook.com/?url=https://adnotifications.windowsazure.com&amp;data=02%7c01%7cjanju%40microsoft.com%7cb14f75473e9e4bf2af8908d704dcebfd%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c636983219250273076&amp;sdata=/mypbg3xIeaHtWGoK0JtKjDxuzIv74tgT1se7oSF/PA%3D&amp;reserved=0">
      <span style="color:#0563C1;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">https://adnotifications.windowsazure.com</span>
    </a>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p style="font-family:Calibri;font-size:9pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;" dir="ltr">
    <span style="font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p></div></div><div><div><span><span style="box-sizing:border-box;color:rgb(0, 0, 0);font-size:10.5pt;outline-color:invert;outline-width:medium;">Contributing engineer: Jane Ju (Janju@microsoft.com)<br style="box-sizing:border-box;">Feedback/ suggestions:<u><font color="#000012"> <a href="mailto:networkflowdevs@microsoft.com;janju@microsoft.com">Email</a></font></u><br style="box-sizing:border-box;">For more Windows Networking Workflows, go to:&nbsp;</span><span style="box-sizing:border-box;color:rgb(0, 0, 0);font-size:10.5pt;outline-color:invert;outline-width:medium;"><a style="box-sizing:border-box;color:rgb(0, 103, 184);cursor:pointer;text-decoration:underline;" href="https://aka.ms/networkflows">https://aka.ms/networkflows</a></span><br></span></div></div>