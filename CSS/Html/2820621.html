<header><h1>Azure Support– Management Portal and Accounts Portal Authentication (eSTS - Org ID and Live ID)</h1></header><div class="kb-generic-section section">&nbsp;</div>

<p class="kb-generic-section section"><strong><u><span>Definition &amp; Overview:</span></u></strong></p>

<p class="kb-generic-section section">This document outlines who to engage for Authentication failures and Portal Login issues.&nbsp; ASMS is front-line support for customers facing login issues, and we have to engage one of a few different teams for assistance: the CTS Identity team, the Org ID team, and the MSODS team.</p>

<p class="kb-generic-section section"><span>Please note:</span> Whenever searching for an MSA account in CMAT it is extremely important to verify every character you&#39;ve entered is 100% accurate to the one listed by the customer. Being inaccurate when looking up an account can result in unnecessary back and forth with a customer and can negatively affect the customer experience.</p>

<p class="kb-generic-section section"><strong>Organizational account (ORG ID)</strong><span>: ORG ID is the account that is created by an organization&#39;s admin and the account is based on the company&#39;s Active Directory (AD) either on-premise or on cloud. An ORG ID once created would look like </span><a target="_blank">username@companydomain.com</a><span> (on a verified domain either on-premise AD or directory on cloud) or </span><a target="_blank">username@userdomain.onmicrosoft.com</a><span> (AD based on O365). Org ID can only be created on a company domain and can only be created by an admin of the organization. for eg: A regular user cannot create his account on @microsoft.com as this is only reserved for Microsoft employees. The PUID for the Org ID starts with a 100. </span></p>

<p class="kb-generic-section section"><strong>Microsoft Account (Live IDs/MSA/Personal account)</strong>: Live IDs are free accounts that can be created by any user on any of the domains like outlook.com, live.com, hotmail.com etc. PUID for a Live ID starts with 000.</p>

<p class="kb-generic-section section"><strong><span>Note</span>: </strong>School Accounts (Organizational Accounts) can no longer be signed-up as Microsoft Accounts (Live Accounts). Ref: <a href="https://blogs.technet.microsoft.com/enterprisemobility/2016/09/15/cleaning-up-the-azure-ad-and-microsoft-account-overlap/">https://blogs.technet.microsoft.com/enterprisemobility/2016/09/15/cleaning-up-the-azure-ad-and-microsoft-account-overlap/</a>&nbsp;for more details.</p>

<div class="kb-generic-section section">Work account can be registered as MSA from the following link :</div>

<div class="kb-generic-section section">
<ul>
	<li>MSN Portal (<a href="http://www.msn.microsoft.com/">www.msn.microsoft.com</a>) - Click &#39;Sign-in&#39; and select &#39;Create one!&#39; option</li>
</ul>
</div>

<p>&nbsp;<strong><u><span>Process:</span></u></strong></p>

<p>There are several scenarios that can be reviewed in the troubleshooting section.&nbsp; If a user can&#39;t log in or add a co-admin, follow the steps here first:</p>

<p>If a user is not able to log in (they get an error), or are unable to add co-admins, we need the customer to follow these steps:</p>

<p>If the user is using a&nbsp;Microsoft Account (Live ID) have the user try to log in at <a href="http://account.live.com/">http://account.live.com</a> and if the user can log in, than the issue isn&#39;t with the Microsoft Account itself.&nbsp; If the user hasn&#39;t completed their Microsoft Account they will be requested to do so once they have logged in.&nbsp; If after completing the&nbsp;MA, if&nbsp;they still can&#39;t add the MA/Live ID as a co-admin or log in&nbsp;you will need to work with the appropriate team depending on the error.</p>

<p>If the user is trying to log in or add a Org ID and it fails, have the user try to log in at <a href="http://portal.microsoftonline.com/">http://portal.microsoftonline.com</a> and if the user can log in, than the issue isn&#39;t with Org ID itself.&nbsp;&nbsp;Be sure to note if the user can or can&#39;t log in at the microsoftonline.com site.</p>

<p>When escalating an issue around login, you will need to work with either the <strong>Identity team</strong> or the <strong>OrgID team</strong>.&nbsp;</p>

<p>&nbsp;Some <strong>mandatory </strong>pieces of information include:</p>

<ul>
	<li>Org ID and&nbsp;the PUID (get from&nbsp;Jarvis and from CMAT)</li>
	<li>Live ID and&nbsp;the PUID (get from&nbsp;Jarvis and from CMAT)</li>
	<li>Repro steps (errors)</li>
	<li>HTTP trace of the session (Fiddler or HTTPWatch) if applicable</li>
	<li>Any additional information you can clearly provide to help triage and troubleshoot the issue as soon as possible</li>
</ul>

<p>&nbsp;Note: need BOTH Org ID and Live ID puids and specify whether RDFE or CP puids.</p>

<p>&nbsp;</p>

<p><strong>eSTS (OrgID) Team Engagement</strong></p>

<p>If the issue is with a <strong>renamed MSA/shadow account issue</strong>, or if you first engage the Identity team and the Identity team then asks you to engage the&nbsp;eSTS team (formerly known as OrdID)&nbsp;for next steps, the engagement process for&nbsp;eSTS is:</p>

<p><span><strong>Engagement:</strong></span><span><strong> Ticket with the summary of the issue through ICM using the&nbsp;eSTS template and instructions&nbsp;found in our </strong><a bookmark-id="" data-content-id="" data-content-type="" href="https://internal.support.services.microsoft.com/en-us/help/3085056" managed-link="" target="_blank">﻿﻿﻿﻿Opening an Incident with eSTS</a><span>﻿</span><span>﻿</span><span>﻿</span><span>﻿</span><strong> TSG</strong></span>.&nbsp;&nbsp;<u>Must include&nbsp;relevant account PUIDs </u>in the submission.&nbsp;(For full details on OrgID escalation see <a bookmark-id="" class="btn btn-primary" data-content-id="" data-content-type="" href="https://microsoft.sharepoint.com/teams/orgid/Org%20ID%20Wiki/Escalations,%20Operations,%20and%20Support.aspx" managed-link="" target="_blank">Escalations, Operations, and Support</a></p>

<p><span><strong>Escalation:</strong></span><span><strong> Engage your TA. </strong></span></p>

<p>&nbsp;</p>

<p><strong>IMPORTANT</strong>: The OrgID team will document bug updates&nbsp;on the <strong>Linked Bug Updates</strong> tab in Product Studio.&nbsp;&nbsp;WASMS engineers need to&nbsp;check the Linked Bug Updates&nbsp;section to see instructions/answers given by the OrgID team.&nbsp;</p>

<p>&nbsp;</p>

<p>OrgID team resolution SLA: Three business days for Sev 3 issues; much faster for Sev 2 and higher.</p>

<p>&nbsp;</p>

<p>Following is a real&nbsp;example of a perfect OrgID partner submission from the ASMS team that the OrgID team commended the ASMS engineer on (customer PII obfuscated for privacy):</p>

<p>&nbsp;</p>

<div class="table-responsive">
<table class="table">
	<tbody>
		<tr>
			<td width="737">
			<p>Hello OrgID Team,<br>
			<br>
			Customer is unable to login to the account portal with his Live ID: customerLiveID@outlook.com and gets a screen showing a broken heart and message</p>

			<p>=========================================================<br>
			Correlation ID: 5c55ecb5-55ca-5e55-a5b5-5554b5b0a555<br>
			Timestamp: 2014-08-26 21:54:37Z<br>
			AADSTS20012: An error occurred when we tried to process a WS-Federation message. The message was invalid.<br>
			=========================================================</p>

			<p>&nbsp;</p>

			<p>WHEN WE CHECK Jarvis:&nbsp;</p>

			<p>&nbsp;</p>

			<p>From Email ID customerLiveID@outlook.com @outlook.com to subscription list:</p>

			<p>1a111111-c010-1100-ab11-bd1111111111</p>

			<p>&nbsp;</p>

			<p>Get Subscription with Details:</p>

			<p>2a222222-c020-2200-ab22-bd2222222222</p>

			<p>&nbsp;</p>

			<p>ID:3a333333-c030-3300-ab33-bd3333333333, Name:Pay-As-You-Go<br>
			Description:Pay-As-You-Go<br>
			Puid:00010000111111E1, OfferType:wa062512,<br>
			AccountAdminLiveEmailId: <a href="mailto:customerLiveID2@customerdomain.com">customerLiveID2@customerdomain.com</a><br>
			AccountAdminLivePuid:00020000221211E2<br>
			ServiceAdminLiveEmailId: customerLiveID2@ customerdomain.com<br>
			<br>
			customerLiveID@outlook.com : PUID - 00020000221211E2&nbsp;<span>&nbsp;</span><br>
			<a href="mailto:customerLiveID2@customerdomain.com">customerLiveID2@customerdomain.com</a>: PUID - bd3333333333<br>
			<br>
			<br>
			Customer needs to login with customerLiveID@outlook.com, please assist.</p>

			<p>Regards,<br>
			ASMS Engineer_name</p>

			<p><span>&nbsp;</span></p>
			</td>
		</tr>
	</tbody>
</table>
</div>

<p>&nbsp;</p>

<p>&nbsp;</p>

<h4>&nbsp;</h4>

<h4><strong>Identity Team Engagement</strong>&nbsp;</h4>

<p><strong>For all other account/portal login&nbsp;issues</strong> except for MSA rename/shadow account issues, and for many other authentication/identity/role-based issues we engage the <strong>Identity Team</strong>.&nbsp; Before engaging one of the Identity team queues it is critical that the ASMS engineer verifies the following <u>first</u>:</p>

<ol>
	<li>The customer is logging in with the correct user. This means checking that the customer is using the correct email address (<a href="mailto:joe@microsoft.com">joe@microsoft.com</a> vs <a href="mailto:joe@outlook.com">joe@outlook.com</a>) <strong>and</strong> making sure that they are logging in as MSA vs OrgID (or vice versa) as appropriate.</li>
	<li><span>That user is in fact configured as a Co-Admin or a Service Admin on the subscription, is the Account Admin, or has the appropriate RBAC permissions to see&nbsp;the subscription. Use&nbsp;Jarvis to determine if the user is a Co-Admin or Service Admin, CMAT or&nbsp;Jarvis to determine if they user is the Account Admin, and engage your TA to have them check the RBAC role/permissions of that user on the desired subscription.</span></li>
</ol>

<p>&nbsp;</p>

<p>If the case&#39;s scope is one that the ASMS team owns then send a <span asset="4498193" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4498193]</span><strong> </strong>to the Identity team via <span asset="4497459" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4497459]</span>, and if the case&#39;s scope is one&nbsp;that the Identity team&nbsp;owns the whole scope then you can send the entire case (after verifying the above two points). Following are the most common types of&nbsp;issues that we&#39;d need to work together with the Identity team on, and the associated <span asset="4497459" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4497459]</span> routing topic to set:&nbsp;</p>

<ul>
	<li><span>I can&rsquo;t login to Azure Management Portal (AMP) with an OrgID</span>

	<ul>
		<li><span>Routing Azure Active Directory\Password Managment</span></li>
	</ul>
	</li>
	<li><span>I can&rsquo;t associate the user with the desired directory</span>
	<ul>
		<li><span>Routing Azure Active Directory\Azure AD Domain Services\Configuration and managment of Azure AD Domain Services</span></li>
	</ul>
	</li>
	<li><span>I can&rsquo;t see the directory I expect to see in Azure Management Portal (AMP)</span>
	<ul>
		<li><span>Routing Azure Active Directory\Azure AD Domain Services\Configuration and managment of Azure AD Domain Services</span></li>
	</ul>
	</li>
	<li><span>I can&rsquo;t manage my directory</span>
	<ul>
		<li><span>Routing Azure Active Directory\Domain Name Management\(sub topic)</span></li>
	</ul>
	</li>
	<li><span>BAM issues</span>
	<ul>
		<li><span><span>Routing Azure Active Directory\Password Managment\Self-service password change/reset</span></span></li>
	</ul>
	</li>
</ul>

<p>&nbsp;</p>

<p>&nbsp;</p>

<div class="alert-band">
<div class="alert alert-info" role="alert">
<div class="alert-title">Note</div>

<div class="row">
<div class="col-xs-24">
<p><strong>IMPORTANT:</strong> Before engaging the Identity team, use&nbsp;Jarvis to check in AzureRT / Subscription Management / Get Subscription With Details to see if the user reporting the problem is a Co-Admin or Service Admin on the subscription in question. If they are not a CA or SA then having the AA add them as an SA or CA may resolve the issue, and eliminate the need to engage the Identity team.</p>
</div>
</div>
</div>
</div>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>If your issue is with a Live ID (MSA) only, (not an MSA rename, or anything Org ID related) you can file a ticket with Live ID Tier 4 at -&nbsp;&nbsp; <span><a href="https://support.microsoft.com/en-us/getsupport?oaspworkflow=start_1.0.0.0&amp;wfname=capsub&amp;productkey=wlidother&amp;locale=en-us">https://support.microsoft.com/en-us/getsupport?oaspworkflow=start_1.0.0.0&amp;wfname=capsub&amp;productkey=wlidother&amp;locale=en-us</a></span></p>

<blockquote dir="ltr">
<p><span>If the issue is high priority, after filing the ticket, you can also email the OSGSIDT DL and the yw ill handle it at a higher priority. </span></p>
</blockquote>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p><strong><u>How to Look Up and Update a Tenant ID</u></strong></p>

<p><em>Why would you need to do this?</em></p>

<blockquote dir="ltr">
<p><em><strong><u>Example:</u></strong></em>&nbsp; <span>In order to perform SQL DB migration, the Service Administrator on both&nbsp;subscriptions must be same.&nbsp; If you follow the process, this will put both&nbsp;SQL DB subscriptions&nbsp;in same directory so the SA can do the SQL DB migration.</span></p>

<p><span><span>Source: 613449f9-2b9f-4a7c-a873-99999999999 (Tenant ID: ca33733f-a186-413a-931e-9999999999)</span></span></p>

<p>&nbsp;</p>

<ul>
	<li><span>AA : <a href="mailto:inayathali@outlook.com">fakeemail@contoso.com</a></span></li>
	<li><span>SA: <a href="mailto:chaitali2608@outlook.com">fakeemail2@contoso.com</a> </span></li>
</ul>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p><span>Destination: ef0c97b2-bb96-4c37-a10e-999999999 (Tenant ID: 487e4ca0-ebb3-45eb-ae56-9999999999)</span></p>

<ul>
	<li><span>AA: <a href="mailto:chaitali2608@outlook.com">fakeemail@outlook.com</a> </span></li>
	<li><span>SA: <a href="mailto:chaitali2608@outlook.com">fakeemail2@outlook.com</a>&nbsp;</span></li>
</ul>

<p><span>When <a href="mailto:chaitali2608@outlook.com">fakeemail2@outlook.com</a> logs in to the&nbsp;management portal there will be two directories.&nbsp;&nbsp;If there is a SQL DB then the source subscription has to be moved over to destination directory. We&nbsp;can assist the customer by performing a Tenant ID update in Jarvis, then the user will have both SQL DB&#39;s under the same tenant (directory) and they can&nbsp;migrate the SQL DB. </span></p>

<p><span>Once the user has migrated the SQL DB,&nbsp;</span><span> we can reset the Tenant ID for the source subscription back to&nbsp;the original source tenant ID, so it will be back to&nbsp;correct directory.&nbsp;</span></p>

<p><strong><u><span>Advantage</span></u></strong><span>s: The above steps avoids the need for the customer to create a new directory. Additionally, it does not require the customer moving the subscription between directories. The only action for the customer in this case would be to reset the service admins on the respective subscriptions post migration if necessary. </span></p>
</blockquote>

<p>&nbsp;</p>

<p><span><em>Why else would you need to do this? - </em>When submitting a Backfill request it is Required to include the TenantID of the Account Admin email.&nbsp; Sometimes the TenantID of a subscription will be different than the TenantID of the Account, for example when performing a subscription ownership transfer from one account into another account, the subscription&#39;s TenantID may be different after the ownership transfer and would need updating.</span></p>

<p>&nbsp;</p>

<h4><span><u>Process to Find and Update the AA&#39;s Tenant ID:</u></span></h4>

<p>&nbsp;</p>

<p><span><strong>Process to follow when the AA is OrgID:</strong></span></p>

<ol>
	<li><span><span lang="EN-IN">Lets assume the AA&rsquo;s ORG ID,&nbsp;is under the domain &ldquo;contoso.com&rdquo; e.g. <a href="mailto:email@contoso.org">email@contoso.org</a></span></span></li>
	<li><span><span lang="EN-IN">Open the following link in IE:</span></span>
	<ol>
		<li><span lang="EN-IN"><a href="https://login.windows.net/contoso.com/federationmetadata/2007-06/federationmetadata.xml">https://login.windows.net/<span>contoso.com</span>/federationmetadata/2007-06/federationmetadata.xml</a></span></li>
	</ol>
	</li>
	<li><span lang="EN-IN">In the above link the field between &ldquo;<a href="https://login.windows.net/-%20and%20-/federationmetadata/2007-06/federationmetadata.xml">https://login.windows.net/- and -/federationmetadata/2007-06/federationmetadata.xml</a>&rdquo; is where you will modify the domain. </span>
	<ol>
		<li><span lang="EN-IN"></span><span lang="EN-IN">e.g. If the customer&rsquo;s Account ID is : <a href="mailto:accountid@somecompany.com">accountid@somecompany.com</a> then you will modify the link as : <a href="https://login.windows.net/somecompany.com/federationmetadata/2007-06/federationmetadata.xml">https://login.windows.net/<span>somecompany.com</span>/federationmetadata/2007-06/federationmetadata.xml</a></span></li>
	</ol>
	</li>
	<li><span lang="EN-IN">Once you modify the same, reload the page once again to refresh the data and you will get results which will look like this:</span>
	<ul>
		<li><img border="0" src=" https://internalasset.blob.core.windows.net/asset/kbgraphics/outsourcer/en-us/azure/2820621/7.jpg"></li>
	</ul>
	</li>
	<li><span lang="EN-IN">Scroll all the way to the bottom of this window, and you will see something like:</span>
	<ul>
		<li><span lang="EN-IN">&lt;<span>SingleLogoutService</span> <span>Location</span>=&quot;<strong><span><a href="https://login.windows.net/6babcaad-604b-40ac-a9d7-9fd97c0b779f/saml2">https://login.windows.net/6babcaad-604b-40ac-a9d7-xxxxxxxxxx/xxxxx</a></span></strong>&quot; <span>Binding</span>=&quot;<strong><span>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect</span></strong>&quot;/&gt;</span></li>
		<li><span lang="EN-IN">&lt;<span>SingleSignOnService</span> <span>Location</span>=&quot;<strong><span><a href="https://login.windows.net/6babcaad-604b-40ac-a9d7-9fd97c0b779f/saml2">https://login.windows.net/6babcaad-604b-40ac-a9d7-xxxxxxxxxx/xxxxx</a></span></strong>&quot; <span>Binding</span>=&quot;<strong><span>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect</span></strong>&quot;/&gt;</span></li>
	</ul>
	</li>
	<li><span lang="EN-IN"></span><span lang="EN-IN">Here the data : <strong><span>6babcaad-604b-40ac-a9d7-xxxxxxxxxx </span></strong><span>is the <strong>Tenant ID </strong>we are looking for.</span></span></li>
	<li><span lang="EN-IN"></span><span lang="EN-IN">Once obtained, visit Jarvis. Go to&nbsp;AzureRT / Subscription Management /&nbsp;Update Subscription Tenant ID and proceed.</span></li>
</ol>

<p>&nbsp;</p>

<p><strong>Process to follow&nbsp;when the AA is a Microsoft Account:</strong></p>

<ol>
	<li>
	<ol>
		<li><span><span lang="EN-IN">Lets assume the AA&rsquo;s Microsoft Account,&nbsp;is&nbsp;<a href="mailto:testaccount@outlook.com">testaccount@outlook.com</a></span></span></li>
		<li><span><span lang="EN-IN">You would need to first format the account in the following way: <strong>testaccountoutlook.onmicrosoft.com </strong>(if the email was <a href="mailto:test.account@outlook.com">test.account@outlook.com</a>, the result would still be testaccountoutlook.onmicrosoft.com )</span></span></li>
		<li><span><span lang="EN-IN">Open the following link in IE:</span></span>
		<ol>
			<li><span lang="EN-IN"><a href="https://login.windows.net/contoso.com/federationmetadata/2007-06/federationmetadata.xml">https://login.windows.net/<span>contoso.com</span>/federationmetadata/2007-06/federationmetadata.xml</a></span></li>
		</ol>
		</li>
		<li><span lang="EN-IN">In the above link the field between &ldquo;<a href="https://login.windows.net/-%20and%20-/federationmetadata/2007-06/federationmetadata.xml">https://login.windows.net/- and -/federationmetadata/2007-06/federationmetadata.xml</a>&rdquo; is where you will modify the domain.</span>
		<ol>
			<li><span lang="EN-IN"></span><span lang="EN-IN">e.g. If the customer&rsquo;s Account ID is :&nbsp;<a href="mailto:testaccount@outlook.com">testaccount@outlook.com</a> then you will modify the link as : <a href="https://login.windows.net/somecompany.com/federationmetadata/2007-06/federationmetadata.xml">https://login.windows.net/testaccountoutlook.onmicrosoft.com/federationmetadata/2007-06/federationmetadata.xml</a></span></li>
		</ol>
		</li>
		<li><span lang="EN-IN">Once you modify the same, reload the page once again to refresh the data and you will get results which will look like this:</span>
		<ul>
			<li><img border="0" src=" https://internalasset.blob.core.windows.net/asset/kbgraphics/outsourcer/en-us/azure/2820621/7.jpg"></li>
		</ul>
		</li>
		<li><span lang="EN-IN">Scroll all the way to the bottom of this window, and you will see something like:</span>
		<ul>
			<li><span lang="EN-IN">&lt;<span>SingleLogoutService</span> <span>Location</span>=&quot;<strong><span><a href="https://login.windows.net/6babcaad-604b-40ac-a9d7-9fd97c0b779f/saml2">https://login.windows.net/6babcaad-604b-40ac-a9d7-xxxxxxxxxx/saml2</a></span></strong>&quot; <span>Binding</span>=&quot;<strong><span>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect</span></strong>&quot;/&gt;</span></li>
			<li><span lang="EN-IN">&lt;<span>SingleSignOnService</span> <span>Location</span>=&quot;<strong><span><a href="https://login.windows.net/6babcaad-604b-40ac-a9d7-9fd97c0b779f/saml2">https://login.windows.net/6babcaad-604b-40ac-a9d7-xxxxxxxxxx/saml2</a></span></strong>&quot; <span>Binding</span>=&quot;<strong><span>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect</span></strong>&quot;/&gt;</span></li>
		</ul>
		</li>
		<li><span lang="EN-IN"></span><span lang="EN-IN">Here the data : <strong><span>6babcaad-604b-40ac-a9d7-xxxxxxxxxx </span></strong><span>is the <strong>Tenant ID </strong>we are looking for.</span></span></li>
		<li><span lang="EN-IN"></span><span lang="EN-IN">Once obtained, visit Jarvis. Go to AzureRT /&nbsp;Subscription Management /&nbsp;Update Subscription Tenant ID and proceed.</span></li>
	</ol>
	</li>
</ol>

<p><span>&nbsp;</span></p>

<p><span><strong><u>Troubleshooting tip</u></strong></span></p>

<p><span>Although a user may log in using a single email address, it can be associated to both a Live ID puid and an Org ID puid.<span>&nbsp; </span>A live ID puid starts with 0003 and an Org ID puid starts with 1003.<span>&nbsp; </span>This can cause many different authentication issues as noted here.</span></p>

<p>&nbsp;</p>

<p>&nbsp;The key to understanding the issue is knowing there are 2 different authentication systems.</p>

<p>The problem is they will both allow you to use the same friendly name (email address).<span>&nbsp; </span>So the authentication systems will look for a puid stored on the users&rsquo; machine first.<span>&nbsp; </span>After that it will move to Live ID for authentication, if the user name and password match it will try that puid against the account, if none match it will move to Org ID for authentication and try that puid against the account.<span>&nbsp; </span>A browsing session can have only one active puid at a time.</p>

<p>Below are some scenarios you may run into.</p>

<ul>
	<li>
	<div>Able to login to management portal and locate subscriptions, however receives an error while trying to login to billing portal separately (not switching the portals). Error like, &ldquo;There is no billing account associated to..&rdquo;</div>
	</li>
</ul>

<p>This is due to billing account (AA) and management (SA) not being under the same puid.<span>&nbsp; </span>You should pull up the subscriptions in&nbsp;Jarvis and check the puids of the AA and SA.<span>&nbsp; </span>The issue is the user may be using the same email address (friendly name) but it&rsquo;s tied to both an Org ID and a Live ID.</p>

<p>&nbsp;</p>

<p><u><strong>ISSUES/SCENARIOS</strong></u></p>

<p>&nbsp;</p>

<p><strong>=== A user can log in, but only sees some of their subscriptions, not all.</strong></p>

<p>This is due to CTP having some subscriptions tied to the Live ID puid vs. the Org ID puid.</p>

<p>You will need to use&nbsp;Jarvis to move all subscriptions under one PUID.</p>

<p>You should be able to pull the proper Org ID or Live ID&nbsp;puid in ACSI.<span>&nbsp; Org ID puids&nbsp;</span>will start with 1003.</p>

<p>&nbsp;</p>

<p><span><span>=== </span></span><strong>A user wants to use their O365 ID to log into Azure, without having to re-log in if they were already in O365.</strong></p>

<p>This is due to the fact that their O365 is using the Org ID puid, while their Azure subscription is using the Live ID puid.<span>&nbsp; </span>It can look like the same log on as it may be under the same email account and password, but there are 2 different authentication systems working.</p>

<p>When the user switches from O365 they are using the Org ID puid (starts with 1003), this puid is stored on the machine in the cookies.<span>&nbsp; </span>When they switch to Azure, because the session is already active with a puid, Azure will try to use that puid to authenticate.<span>&nbsp; </span>If their Azure subscription is under a Live ID puid, the system will say no Azure subscription associated.<span>&nbsp; </span>The user can either run an InPrivate browser session to test this, as that will separate them from the stored cookies on the machine, or they can clear the cookies and try again.<span>&nbsp; </span></p>

<p>&nbsp;Note: If you require O365 assistance, you can email the&nbsp;ASMSCM alias for assistance.&nbsp;</p>

<p><em><span><span>&middot;<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>A user gets access denied error</em></p>

<p><em><span><span>&middot;<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>&nbsp;Clearly gives password error issue. Makes the user feel as if the login id/password is incorrect.</em></p>

<p><em>This should be sent to the Identity team for review.<span>&nbsp; </span>This is most likely nothing we can fix.</em></p>

<p><em>(Use the process already outlined&nbsp;at the top of the&nbsp;TSG)</em></p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p><strong>=== ORG ID customer is unable to log-in the management and the billing portal -&nbsp; when trying to locate the customer in CMAT you get an error.&nbsp; </strong><strong>You can however locate the customer in CMAT if you are searching by the subscription GUID.</strong></p>

<blockquote>
<p>&nbsp;If you encounter this scenario please run the following queries in the&nbsp;Jarvis portal under:</p>

<ul>
	<li>Azure RT / Subscription Management / From PUID to SubscriptionID</li>
	<li>RDFE / Subscription Managment / From emailID to puid list</li>
	<li>RDFE / Subscription&nbsp;Management / From emailID to subscriptionID</li>
</ul>

<p>If all three queries fail (returning &ldquo;No subscription found for PUID XXXXXX&rdquo; or &ldquo;No PUIDs were found for emailID <a href="mailto:example@example.com">example@example.com</a> )</p>

<p>This is most likely to be due the emailID the customer is using no longer being an ORGID.</p>

<p>&nbsp;An ORGID is created when an email address&nbsp;is added to an Organization&nbsp;by their admin in the AAD.</p>

<p>If the customer&rsquo;s ORGID is removed from the AAD, then the email ceases to be an ORGID and the customer loses access to both the billing and management portal and consequently to his subscription.</p>

<p>There are two main solutions for this scenario:</p>

<ol>
	<li>Have the customer re-add his email to the AAD and it will become again an ORGID, PUID to ORGID mapping might be required from the CP team. This will solve the problem, however if the customer&rsquo;s ORGID is removed again from the AAD in the future, he will experience this issue again.</li>
	<li>Perform an ORGID to WLID transfer, this will enable the customer to access&nbsp;the subscription immediately and will not be dependent&nbsp;on the ORGID being part of an AAD or not. (not valid in OMS)</li>
</ol>
</blockquote>

<p>&nbsp;</p>

<p><span>Azure Active Directory (AAD) Premium issues (outside of normal issues we have already covered) can be reviewed by the MSODS team escalations - follow this process -&nbsp;&nbsp; </span></p>

<p>&nbsp;</p>

<p><a href="http://sharepoint/sites/office365icm/SitePages/MSODS.aspx">http://sharepoint/sites/office365icm/SitePages/MSODS.aspx</a></p>

<p>&nbsp;MSODS can also handle issues like increasing Directory Sync objects. (aka DirSync)</p>

<p>&nbsp;</p>

<p><strong>&nbsp;=== Users wants to add an ORGID as a SA or CA to a sub that is under an MSA.</strong></p>

<blockquote dir="ltr">
<p>&nbsp;</p>

<p><span><span>1.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>Sign-In to Microsoft Azure Administration Portal with your Service Administrator account.</p>

<p><span><span>2.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>Once you are signed in you then need to go <strong>New &gt; App Services &gt; Active Directory &gt; Directory &gt; Custom Create.</strong></p>

<p><span><span>&middot;<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>on the wizard you need to select &ldquo;<strong>use existing directory</strong>&rdquo; and then select the check box saying &lsquo;<strong>I am ready to be signed out now.</strong>&rsquo;</p>

<p><span><span>&middot;<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>when you are signed out, you will then be re-directed to the <a href="https://login.microsoftonline.com/">https://login.microsoftonline.com</a> at this point you then need to sign in with a Global Administrator account for the Directory/Office 365 service.</p>

<p><span><span>&middot;<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>once signed in, you will then get a prompt saying &ldquo;<strong>Use &lt;insert company&gt; directory with Windows Azure</strong>&rdquo; and you would then click continue.</p>

<p><span><span>&Oslash;<span>&nbsp; </span></span></span>This will then create a Global Administrator Account for your Microsoft Account (Live ID) in the alternative Directory/Office 365</p>

<p><span><span>&middot;<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>When this has been completed, you will then click &lsquo;<strong>sign out now&rsquo;</strong> which will then re-direct you to the Azure Management portal, Login with your Microsoft Account (Live ID)</p>

<p><span><span>3.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>You will now find that your alternative directory/Office 365 appears in the Microsoft Azure Management Portal under the Active Directory node.</p>

<p><span><span>4.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>Now need to make this directory your Default Directory for the Microsoft Azure Subscription.</p>

<p><span><span>&middot;<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>in the Microsoft Azure Management Portal, Go to <strong>Settings &gt; Subscriptions &gt; Select Subscription &gt; Select Edit Directory</strong></p>

<p><span><span>&Oslash;<span>&nbsp; </span></span></span>Follow the wizard, and this will warn you of any administrative account changes i.e. if you added a co-administrator from&nbsp; your default directory which azure built when you created the subscription, this account will be removed as a co-administrator.</p>

<p><span><span>&Oslash;<span>&nbsp; </span></span></span>When this has been completed, the portal will then re-load and you will find the URL at the top will change to <a href="https://manage.windowsazure.com/alternatedirectory.onmicrosoft.com">https://portal.azure.com/alternatedirectory.onmicrosoft.com</a>.</p>

<p><span><span>5.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>You will now be able to go ahead and ADD your alternate directory/office 365 organizational accounts as Co-Administrators or Replace the Service Administrator for the subscription.</p>
</blockquote>

<p><span>&nbsp;</span></p>

<p>&nbsp;</p>

<h2><span>&nbsp; </span></h2>

<h3><strong><span>=== User receives MSPPError=2147217320 </span></strong></h3>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p><span><span><strong>User receives MSPPError=2147217320 </strong></span>in the URL of the error page returned when attempting to log into the EA portal, the Azure Management Portal, or the Azure Billing Portal.<span>&nbsp; </span>For example, the friendly error message on the page itself may say &quot;Sorry, but we are having trouble signing you in&rdquo; or &ldquo;We are having trouble logging you into the portal&rdquo; or &ldquo;HTTP 500 Error&rdquo; depending on the portal being logged into, but the URL in the browser address bar will include MSPPError=2147217320 somewhere in the URL of the error page.</span></p>

<p><span><strong>Action: </strong>Escalate to the OrgID team directly, including all of the required and needed information outlined at the beginning of this article, as well as the full URL of the portal being logged into AND the full error URL including the MSPP error.</span></p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p><strong>=== User receives any other MSPPError</strong></p>

<p>For any other MSPPErrors returned in the URL when attempting to log in to one of the Azure portals, engage the Identity team using the instructions at the top of this TSG.&nbsp; For example:</p>

<div id="imcontent"><span><a href="https://ea.windowsazure.com//signin?whr=azure.com&amp;returnurl=/&amp;f=255&amp;MSPPError=-2147190612" title="https://ea.windowsazure.com/signin?whr=azure.com&amp;returnurl=/&amp;f=255&amp;MSPPError=-2147190612"><span>https://ea.windowsazure.com//signin?whr=azure.com&amp;returnurl=/&amp;f=255&amp;MSPPError=-2147190612</span></a>&nbsp;&nbsp;</span></div>

<div>
<div id="imcontent"><span><span><a href="https://account.azure.com//signin?whr=azure.com&amp;returnurl=/&amp;f=255&amp;MSPPError=-1234567890">https://account.azure.com//signin?whr=azure.com&amp;returnurl=/&amp;f=255&amp;MSPPError=-1234567890</a></span></span></div>
</div>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p><strong>=== Users getting the error message &quot;We are having trouble logging you into the portal&quot; and/or the URL </strong><a href="https://account.windowsazure.com/Error/Login"><strong>https://account.azure.com/Error/Login</strong></a></p>

<p><span>This issue can occur regardless of what the customer is trying to do. For example, a customer may contact support saying that they are trying to purchase an MPN subscription but that they are getting this error.</span></p>

<p>&nbsp;</p>

<p><span>The issue is that the login through OrgId is failing. The URL will most likely be in a format like this:</span></p>

<p><a href="https://account.windowsazure.com/Error/Login/%3cnumber"><span>https://account.azure.com/Error/Login/&lt;number</span></a><span>&gt; (e.g. </span><a href="https://account.windowsazure.com/Error/Login/-2147217320"><span>https://account.azure.com/Error/Login/</span><span>-</span><span>2147217320</span></a><span>). The number here is called an MSPPError. This will need to be given to the OrgId team when escalating to them </span></p>

<p>&nbsp;</p>

<p><span>NOTE: this issue may also be occurring on </span><a href="https://manage.windowsazure.com/"><span>https://portal.azure.com</span></a><span> &ndash; if you see a similar error on the&nbsp;ibiza portal which also has a MSPPError in the url please follow the same escalation path</span></p>

<p><span>These issues need to be escalated to the OrgId even if the user is a LiveId/MSA user. The following information should be provided to them</span></p>

<ol>
	<li><span>User&rsquo;s email addres</span></li>
	<li><span>Users puid</span></li>
	<li><span>MSPPError if available (The URL will most likely be in a format like this: </span><span><a href="https://account.azure.com/Error/Login/&lt;number">https://account.azure.com/Error/Login/&lt;number</a>&gt; (e.g. <a href="https://account.azure.com/Error/Login/-2147217320">https://account.azure.com/Error/Login/-2147217320</a>). The number here is called an MSPPError.</span></li>
</ol>

<p>&nbsp;</p>

<p><span>NOTE: The OrgId team may respond saying that the email address is a LiveID and not an OrgId. However, the&nbsp;<a href="https://account.azure.com/Subscriptions">https://account.azure.com/Subscriptions</a> </span><span>portal does all authentication through OrgId, even LiveId users. If there is an issue it needs to be escalated through ORGID as there may be a shadow account due to an account rename.</span></p>

<p>&nbsp;<strong><u>IMPORTANT:</u></strong> This scenario is specific to MA/WLID --&gt; MA/WLID renames.&nbsp; If the customer also uses O365 with OrgID account(s), deleting of the shadow account may break their O365 functionality.&nbsp; BE SURE to ask the customer whether the accounts are associated with O365, and include that info in the SDE to OrgID.&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p><strong>=== Customers may have problems adding co-administrators.<span>&nbsp; </span>These customers are either Office365 or internal Microsoft employees.</strong></p>

<p>&nbsp;When Office365 or internal Microsoft employee attempts to add co-administrator, they see the following error</p>

<p>&nbsp;</p>

<p>&quot;<strong>The email address is not a valid Microsoft account or organizational account. Enter a valid email address to continue.</strong>&quot;</p>

<p>&nbsp;</p>

<p>&nbsp;You will need to use&nbsp;Jarvis to look up the OrgID and determine what the corresponding PUID you should be using is, for Org ID it will start with <strong>1003</strong>.<span>&nbsp; </span>Once this is found, you can add this PUID to the subscription.<span>&nbsp; </span>Typically what you will see here is the desired account is added but is not the Org ID PUID, instead the PUID that begins with <strong>0003</strong> is seen (Live ID puid).<span>&nbsp; </span>Once the correct Org ID PUID is associated, you can remove the Live ID PUID that begins with 0003 to prevent duplicates seen from portal.<span>&nbsp; </span></p>

<p>&nbsp;&nbsp;</p>

<p><strong>Another Option: Link your Microsoft Account / Password to your subscription&nbsp;</strong></p>

<p>Another possible solution is to link your Microsoft Account (Windows Live ID) to your subscription by making it a service co-administrator.&nbsp; The Windows Azure management portal allows the creation of multiple service co-administrators to manage Azure features / services.</p>

<p><span>Some users may get the error around no billing associated as noted earlier in the document.<span>&nbsp; </span>Follow the steps to determine the puid for the AA and add that same puid for the SA. (Assuming they are the same email address)</span></p>

<p><span>&nbsp;</span></p>

<p><strong><span>Adding Co-Admin: (This option has been removed.&nbsp; The adding of a Co-Admin should only be done by the customer, never by support)</span></strong></p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p><span>&nbsp;Although we should NOT add a co-admin via Jarvis, it&#39;s important to troubleshoot the issue with the customer.&nbsp; If a user has their email address as both a Live ID and Org ID, and can&#39;t add the second account as a co-admin, escalate to your TA.</span></p>

<p>&nbsp;</p>

<p><strong><span>Removing Co-Admin:</span></strong></p>

<ul>
	<li><span>In Jarvis: AzureRT /&nbsp;Subscription Management / </span><span>Remove Principal</span></li>
	<li><span><span>PUID: &lt;PUID of the person whom you want to remove as co-admin&gt; </span></span></li>
	<li><span>Subscription: &lt;Subscription Id from which you want to remove as co-admin&gt;</span></li>
</ul>

<p>&nbsp;</p>

<p><span>[Note: Use &quot;From EmailID TO PUID List&quot; operation&quot; in&nbsp;Jarvis Portal under &quot;RDFE / Subscription Management / From OrgID to PUID&quot;]</span></p>

<p><span>Note: For internal Live-Ids like &quot;@microsoft.com&quot; use Org ID (Starts with 1. e.g. 1xxxxxx) instead of PUID obtained &quot;From EmailID TO PUID List&quot;.</span></p>

<p><span>5. Approver, Reviewer: &lt;Approver and Reviewer Names/Aliases&gt;</span></p>

<p><span>6. Approver Link: &lt;TFSId link which is approved and tracking this effort&gt;</span></p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p><strong><span><span>=== Support Scenario for incorrect email address being shown:</span></span></strong></p>

<p>&nbsp;</p>

<ul style="list-style-type:disc" type="disc">
	<li><span>Customer logs in to the Azure Portal using </span><span><span>abc@hotmail.com</span></span><span>.</span></li>
	<li><span>Login was successful.</span></li>
	<li><span>However, he notices that there another email address </span><span><span>xyz@live.com</span></span><span> displayed at the top right corner instead of his account.</span></li>
</ul>

<p>&nbsp;</p>

<p><span>How to escalate:</span></p>

<p>Escalate to the <a bookmark-id="" data-content-id="" data-content-type="" href="http://sharepoint/sites/office365icm/SitePages/MSODS.aspx" managed-link="" target="_blank">﻿MSODS</a><span>﻿</span> \ Customer Escalations team. It is an issue with Mail Property and needs to be fixed from their end. You can use <a href="https://icm.ad.msft.net/imp/IncidentDetails.aspx?id=20830813"><span>ICM Ticket # 20830813</span></a> as a reference. Be sure to include Network Traces &amp; Screenshots.</p>

<p><span>&nbsp;</span></p>

<p>&nbsp;</p>

<p><strong>=== Associate an Office 365 tenant to an Azure Subscription</strong></p>

<p>See <a href="https://docs.microsoft.com/en-us/azure/billing/billing-add-office-365-tenant-to-azure-subscription">https://docs.microsoft.com/en-us/azure/billing/billing-add-office-365-tenant-to-azure-subscription</a></p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p><span>Keywords: orgid liveid msa tenant tenantid update login log in authenticate authentication shadow account identity</span></p>

<p><span><strong><u>TSG Change Log</u></strong></span></p>

<p>&nbsp;</p>

<div class="table-responsive">
<table class="table">
	<tbody>
		<tr>
			<th>&nbsp;<strong>Date</strong></th>
			<th><strong>&nbsp;Updated By</strong></th>
			<th><strong>&nbsp;Content Updated</strong></th>
		</tr>
		<tr>
			<td>1/24/2018</td>
			<td>v-navkha</td>
			<td>replaced manage.windowsazure.com with Ibiza</td>
		</tr>
		<tr>
			<td>3/9/18</td>
			<td>kuharr</td>
			<td>Removed PII</td>
		</tr>
		<tr>
			<td>04/24/2019</td>
			<td>v-brgosn</td>
			<td>Added definitions for&nbsp;Organizational account&nbsp; and&nbsp;Microsoft Account.</td>
		</tr>
	</tbody>
</table>
</div>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>
