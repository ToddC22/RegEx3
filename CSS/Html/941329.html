<header><h1>How to point to a custom 404 error Web page in SharePoint</h1></header><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/78235.asp' title='Link only available for Microsoft corporate network users' target='_blank'>78235 (Content Maintenance)</a></div><div class='kb-summary-section section'>This article describes how to point to a custom 404 error Web page in Windows SharePoint Services 3.0, in Microsoft Office SharePoint Server 2007,&#160;or in Microsoft SharePoint Server 2010.</div><div class='kb-moreinformation-section section'><h4 class='sbody-h4'>Windows SharePoint Services 3.0 or SharePoint Server 2007</h4>To configure Windows SharePoint Services 3.0 or SharePoint Server 2007 to point to a custom 404 error Web page, follow these steps.<br><br><span class='text-base'>Note</span>  Because of a design limitation, the custom 404 error Web page does not work when you access invalid site collections. <ol class='sbody-num_list'><li>Log on to the computer that is running SharePoint Server 2007 by using an account that has administrative permissions.</li><li>In Windows Explorer, locate the following folder:<div class='indent'><strong class='sbody-strong'>%systemdrive%</strong>\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\TEMPLATE\LAYOUTS\<strong class='sbody-strong'>LangID</strong></div><span class='text-base'>Notes</span><ul class='sbody-free_list'><li>In this path, <strong class='sbody-strong'>%systemdrive%</strong> represents the actual drive name of the drive on which the operating system is installed.</li><li>In this path, <strong class='sbody-strong'>LangID</strong> represents the actual language ID of the language that you use. For example, 1033 is the language ID for U.S. English.</li></ul></li><li>Create the custom HTML file. To do this, use the appropriate method. Refer to the examples below for each version of SharePoint:<h4 class='sbody-h4'>Microsoft Office SharePoint Server 2007</h4><ol class='sbody-num_list'><li>On the computer that is running SharePoint Server 2007, copy the Sps404.html file to a temporary folder.</li><li>Rename the Sps404.html file. For example, give the file the following name:<div class='indent'>Custom404.html</div></li><li>Modify the Custom404.html file to suit your needs for a custom 404 error message using an HTML editor.</li><li>Copy the Custom404.html file to the <strong class='sbody-strong'>%systemdrive%</strong>\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\TEMPLATE\LAYOUTS\<strong class='sbody-strong'>LangID</strong> folder.</li></ol><h4 class='sbody-h4'>Windows SharePoint Services 3.0</h4><ol class='sbody-num_list'><li>On the computer that is running Windows SharePoint Services 3.0, locate the existing Error.htm file in the following folder:<div class='indent'><strong class='sbody-strong'>%systemdrive%</strong>\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\TEMPLATE\LAYOUTS\<strong class='sbody-strong'>LangID</strong></div><span class='text-base'>Notes</span><ul class='sbody-free_list'><li>In this path, <strong class='sbody-strong'>%systemdrive%</strong> represents the actual drive name of the drive on which the operating system is installed.</li><li>In this path, <strong class='sbody-strong'>LangID</strong> represents the actual language ID of the language that you use. For example, 1033 is the language ID for U.S. English.</li></ul></li><li>Copy the Error.htm file to a temporary folder.</li><li>Rename the Error.htm file. For example, give the file the following name:<div class='indent'>Custom404.htm</div></li><li>Modify the Custom404.htm file to suit your needs for a custom 404 error message using an HTML editor.</li><li>Copy the Custom404.htm file to the <strong class='sbody-strong'>%systemdrive%</strong>\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\TEMPLATE\LAYOUTS\<strong class='sbody-strong'>LangID</strong> folder.</li></ol></li><li>Create a custom console application by using Microsoft Visual Studio 2005 Professional Edition or  Microsoft Visual Studio 2005 Standard Edition. Then, add the following code to the custom console application.<div class='sbody-code'><pre><code>// The following code assumes that a reference is made to Microsoft.SharePoint.<br><br>Microsoft.SharePoint.Administration.SPWebApplication webapp = <br>Microsoft.SharePoint.Administration.SPWebApplication.Lookup(new Uri(&quot;http://&lt;serverurl&gt;&quot;));<br>            webapp.FileNotFoundPage = &quot;&lt;Custom404.htm&gt;&quot;;<br>            webapp.Update();<br></code></pre></div><span class='text-base'>Notes</span><ul class='sbody-free_list'><li>In this code, <strong class='sbody-strong'>&lt;serverurl&gt;</strong> represents the actual URL of the computer that is running SharePoint Server 2007.</li><li>In this code, <strong class='sbody-strong'>&lt;Custom404.htm&gt;</strong> represents the actual name that you created for the custom HTML file.</li></ul>For more information about how to create a custom console application by using Visual Studio 2005, visit the following Microsoft Web site:<div class='indent'><a id='kb-link-1' href='http://msdn2.microsoft.com/en-us/library/ms438026.aspx' target='_self'>http://msdn2.microsoft.com/en-us/library/ms438026.aspx</a></div><span class='text-base'>Note</span> By default in Windows SharePoint Services 3.0 and in SharePoint Server 2007, the <strong class='uiterm'>FileNotFoundPage</strong> property is set to the &quot;null&quot; setting.</li><li>Run the custom console application on the computer that is running SharePoint Server 2007.</li></ol><span class='text-base'>Note</span> By default in Windows Internet Explorer, the <strong class='uiterm'>Show friendly HTTP error messages</strong> setting is turned on. In this case, the custom error page may not appear. <span>For more information about this setting, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-2' href='/en-us/help/218155'>218155 </a> Description of Hypertext Transport Protocol Error Messages<br><br></div></span><h4 class='sbody-h4'>SharePoint Server 2010</h4>To configure SharePoint Foundation server or SharePoint Server 2010 to point to a custom 404 error Web page, follow these steps.&#160; &#160; <ol class='sbody-num_list'><li>Log on to the computer that is running SharePoint Server 2010 by using an account that has administrative permissions.&#160;</li><li>In Windows Explorer, locate the following folder:&#160;<br><br>%systemdrive% \Program Files\Common Files\Microsoft Shared\Web Server Extensions\14\TEMPLATE\LAYOUTS\LangID&#160;<br><br><span class='text-base'>Notes </span><br><br>• In this path, %systemdrive% represents the actual drive name of the drive on which the operating system is installed.&#160;&#160;<br><br>• In this path, LangID represents the actual language ID of the language that you use. For example, 1033 is the language ID for U.S. English.&#160;</li><li>Create the custom HTML file:<br><ol class='sbody-alpha_list'><li>On the computer that is running SharePoint Server 2010, copy the Sps404.html file to a temporary folder.&#160;</li><li>Rename the Sps404.html file. For example, give the file the following name:&#160;<br><br>Custom404.html</li><li>Modify&#160;the Custom404.html file&#160;to suit your needs for a custom 404 error message&#160;using an HTML editor.</li></ol>&#160;</li><li>Copy the Custom404.html file to the %systemdrive% \Program Files\Common Files\Microsoft Shared\Web Server Extensions\14\TEMPLATE\LAYOUTS\LangID folder.</li><li>Run the following PowerShell commands from the SharePoint 2010 Management Shell:<br><span class='text-base'>$webapp =</span><span class='text-base'>Get-SPWebApplication http://&lt;serverUrl&gt;:&lt;port&gt;<br>$webapp.<span class='text-base'>FileNotFoundPage = &quot;Custom404.html&quot;</span><br>$webapp.update()</span><br><br>Verify that the property is set by running&#160;the following command:<br><br>(Get-SPWebApplication http://&lt;serverUrl&gt;:&lt;port&gt;).FileNotFoundPage <br><br><br><br><span class='text-base'>Notes </span><br><br>• In this code, &lt;serverUrl&gt; represents the actual URL of the Web application where you are setting the custom 404 error page.&#160;<br><br>• In this code, &lt;port&gt; represents the nonstandard port number, if any, that is assigned to the Web application.&#160;<br><br>• In this code, Custom404.html represents the actual name that you created for the custom HTML file.&#160;&#160;<br><br>For more information about how to use PowerShell scripts against SharePoint 2010, visit the following Microsoft Web site:&#160;<br><br><a id='kb-link-3' href='http://msdn.microsoft.com/en-us/library/ee536539(office.14).aspx' target='_self'>Windows PowerShell for SharePoint Foundation 2010</a><br><br><span class='text-base'>Note </span>By default in SharePoint Server 2010, the <span class='text-base'>FileNotFoundPage </span>property is set to the &quot;null&quot; setting.</li></ol>&#160;<br></div><div class='kb-securedata-section section'>SPS</div><div class='kb-securedata-section section'><span class='text-base'>Author: gbratton</span><br><span class='text-base'>Writer: v-lgomm</span><br><span class='text-base'>Tech Reviewer:</span>      spskbpre, ctrshrpt<br><span class='text-base'>Editor: v-jesits</span></div>