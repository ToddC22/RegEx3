<header><h1>Servicing: 7B.20: Guidance for remote code execution vulnerability in Microsoft DNS Server tracked by CVE-2020-1350</h1></header><span asset="4476087" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4476087]</span><ul><li><strong>Content Idea (CI): </strong><a managed-link="" href="https://aka.ms/CIEdit?id=120810" target="" data-content-type="" data-content-id="" bookmark-id="">120810</a></li></ul><div><div style="margin-top:14px;margin-bottom:14px;"><div style="box-sizing:border-box;"><p style="box-sizing:border-box;">Note:</p></div><blockquote style="box-sizing:border-box;margin:0px 0px 0px 40px;border:none;"><div style="box-sizing:border-box;"><p style="box-sizing:border-box;"><span style="box-sizing:border-box;background-color:rgb(255, 255, 0);color:rgb(200, 38, 19);">This article contains MSINTERNAL information that should should not be shared outside of Microsoft</span>. When providing information, on this issue to partners, OEM and enterprise customers, lead with public facing content listed in the resolution section of this article.&nbsp;</p></div></blockquote><div style="box-sizing:border-box;"><p style="box-sizing:border-box;">Abstract</p></div><blockquote style="box-sizing:border-box;margin:0px 0px 0px 40px;border:none;"><div style="box-sizing:border-box;margin-top:14px;margin-bottom:14px;">On July 14, 2020, Microsoft released a security update for the issue described in<span>&nbsp;</span><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">CVE-2020-1350 | Windows DNS Server Remote Code Execution Vulnerability</a>. This advisory describes a Critical Remote Code Execution (RCE) vulnerability that affects the Microsoft DNS Server role when configured as recursive resolvers:&nbsp;<br style="box-sizing:border-box;"></div><div style="box-sizing:border-box;margin-top:14px;margin-bottom:14px;"><ul style="box-sizing:border-box;padding:0px 0px 0px 40px;"><li style="box-sizing:border-box;"><span style="box-sizing:border-box;">This exploit does NOT require authentication&nbsp;</span><br style="box-sizing:border-box;"></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;display:inline !important;">This exploit is classified as a ‘wormable’ vulnerability with a CVSS base score of 10.0 (highest possible rating).&nbsp;</span><br style="box-sizing:border-box;"></span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;">The DNS role is commonly deployed on Active Directory Domain Controllers where exploitation may result in the compromise of critical accounts.</span><br style="box-sizing:border-box;"></li></ul></div><div style="box-sizing:border-box;margin-top:14px;margin-bottom:14px;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;color:rgb(200, 38, 19);background-color:rgb(255, 255, 0);display:inline !important;">Microsoft strongly recommends that server administrators immediately apply security updates otherwise registry workarounds as follows:</span></span></div><div style="box-sizing:border-box;margin-top:14px;margin-bottom:14px;"><ol style="box-sizing:border-box;padding-left:40px;"><li style="box-sizing:border-box;"><span style="box-sizing:border-box;">Install Windows Updates released July 14, 2020 on supported OS versions<br style="box-sizing:border-box;"><br style="box-sizing:border-box;">Otherwise&nbsp;</span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;">Implement registry-based workarounds on unsupported OS versions, AND supported OS versions until July 14 or newer Windows updates can be installed on supported OS versions.&nbsp;<br style="box-sizing:border-box;"></span><br style="box-sizing:border-box;">The registry-based workaround provides full protection for the Microsoft DNS Server role Windows 2000 and newer newer versions of Windows DNS without the need to restart the OS.<span>&nbsp;</span><br style="box-sizing:border-box;"><br style="box-sizing:border-box;">Due to the volatility of this vulnerability administrators may need to implement the workaround prior to the application of this security update in order to allow them to patch their systems using a standard deployment cadence.&nbsp;</li></ol></div><div style="box-sizing:border-box;margin-top:14px;margin-bottom:14px;">Microsoft's Online Services and Microsoft Corporate Network have already implemented protections prior to the public disclosure<br style="box-sizing:border-box;"></div><div style="box-sizing:border-box;margin-top:14px;margin-bottom:14px;">Non-Microsoft DNS Servers, including BIND, are NOT impacted.&nbsp;</div></blockquote><div style="box-sizing:border-box;margin-top:14px;margin-bottom:14px;"><span style="box-sizing:border-box;">Attack overview&nbsp;</span></div><blockquote style="box-sizing:border-box;margin:0px 0px 0px 40px;border:none;"><div style="box-sizing:border-box;margin-top:14px;margin-bottom:14px;"><div style="box-sizing:border-box;">An attacker can exploit this vulnerability by sending a specially crafted name request to a Microsoft DNS Server that would trigger it to send a recursive request to a malicious upstream DNS server, that would then reply with the exploit payload. The RCE vulnerability does not require authentication and is considered wormable for Microsoft DNS Servers configured as recursive resolvers.</div></div><div style="box-sizing:border-box;margin-top:14px;margin-bottom:14px;"><span style="box-sizing:border-box;">Microsoft DNS Servers that are configured as recursive resolvers present the highest risk; however, this configuration alone will not fully mitigate the vulnerability.&nbsp;</span></div></blockquote></div></div><div><div><p>Intentionally left blank</p><br></div></div><div><div><br></div><div><ol><li>Housekeeping:&nbsp;</li><ol style="list-style:lower-alpha;"><li>Add &quot;CVE-2020-1350&quot; to the title of all cases</li><li>Code cases to the ICM <a href="https://portal.microsofticm.com/imp/v3/incidents/details/196681591/home">196681591</a></li><li>DO NOT code cases to Bug # = CVE-2020-1350</li><li>DO NOT code cases to Bug # =&nbsp;<a href="https://portal.microsofticm.com/imp/v3/incidents/details/196681591/home" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">196681591</a></li></ol><li>Review ALL public and MSINTERNAL information on this issue&nbsp;<br><br><table style="border-collapse:collapse;border:none;"><tbody><tr><td width="1223" style="width:917.6pt;border:solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt;"><ul><li style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;display:inline !important;"><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;font-family:Calibri, sans-serif;font-size:14.6667px;">CVE-2020-1350</a><span style="box-sizing:border-box;font-family:Calibri, sans-serif;font-size:14.6667px;display:inline !important;"><span style="box-sizing:border-box;">&nbsp;</span>Security Bulletin&nbsp;</span><br style="box-sizing:border-box;"></span></span></span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;display:inline !important;">KB<span style="box-sizing:border-box;">&nbsp;</span></span><a href="https://support.microsoft.com/en-us/help/4569509" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">4569509</a><span style="box-sizing:border-box;display:inline !important;">:&nbsp;</span><span style="box-sizing:border-box;">Guidance for DNS Server Vulnerability CVE-2020-1350</span><br style="box-sizing:border-box;"></span></span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">MSRC Blog<span>&nbsp;</span>@&nbsp;<a href="https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server</a><span>&nbsp;</span>&nbsp;</span></span></span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;">CSS Talking Points @&nbsp;<a href="http://aka.ms/talkingpoints" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">http://aka.ms/talkingpoints</a>&nbsp;OR&nbsp;<a href="https://aka.ms/dnsblogpost" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">https://aka.ms/dnsblogpost</a></span></span></span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;"><span style="box-sizing:border-box;"><a href="https://microsoft.sharepoint.com/teams/Security/TP/Lists/Posts/Post.aspx?ID=95" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">Reactive guidance</a><span>&nbsp;</span>for customer inquiries regarding security vulnerability CVE-2020-1350 (DNS)&nbsp;&nbsp;<br style="box-sizing:border-box;"></span></span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;">Windows Release Information – Message Center:<span>&nbsp;</span></span><a href="https://aka.ms/wrimc" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">https://aka.ms/wrimc</a><br style="box-sizing:border-box;"></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;">The Security Update Guide @&nbsp;<a href="http://aka.ms/securityupdateguide" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">http://aka.ms/securityupdateguide</a></span>&nbsp;</li><li style="box-sizing:border-box;">Finder Blog<span>&nbsp;</span>@&nbsp;<a href="https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin:-exploiting-a-17-year-old-bug-in-windows-dns-servers/" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin:-exploiting-a-17-year-old-bug-in-windows-dns-servers/</a><span>&nbsp;</span>&nbsp;</li><li style="box-sizing:border-box;">Finder Webinar @&nbsp;<a href="https://nam06.safelinks.protection.outlook.com/?url=https://checkpoint.zoom.us/webinar/register/WN_4eQbqpnoQg68lvFZfKyHHg&amp;data=02%7c01%7carrenc%40microsoft.com%7c0ec8c32ba6fa4a7eed0f08d8280d9e16%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637303386600840469&amp;sdata=oLH2mE3782dLcGg8r/Zic8BwhN0ocVHfCv3ZVAurkBw%3D&amp;reserved=0" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;font-family:Calibri, sans-serif;font-size:11pt;">https://checkpoint.zoom.us/webinar/register/WN_4eQbqpnoQg68lvFZfKyHHg<br></a></li></ul><p>
  </td>
 </tr></tbody></table><br></li><li><span style="display:inline !important;">Install preventative fixes released on July 14, 2020:</span><span style="box-sizing:border-box;display:inline !important;"><br style="box-sizing:border-box;"></span><br><table width="" style="box-sizing:border-box;border-collapse:collapse;border-spacing:0px;margin:0px;border:none;"><tbody><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">OS version</p></td><td width="125" style="box-sizing:border-box;border-top:1pt solid windowtext;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Bug #</p></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:1pt solid windowtext;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">KB</p></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:1pt solid windowtext;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Release Date</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:1pt solid windowtext;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Comments</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Iron</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/26486198">26486198</a></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;">RTM</td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;">RTM</td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Windows 10 2004</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><div><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/26486197">26486197</a><br style="box-sizing:border-box;"></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">4565503</p></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">2020.07 B</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Windows 10 1903 \ 1909</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><div><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/26486196">26486196</a><br></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">4565483</p></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">2020.07 B</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Windows 10 1809 \ Windows Server 2019</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><div><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/26486195">26486195</a><br></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">4558998</p></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">2020.07 B</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Windows 10 1803</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><div><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/26486194">26486194</a><br></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">4565489</p></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">2020.07 B</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Windows 10 1709</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><div><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/26486193">26486193</a><br></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">4565508</p></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">2020.07 B</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Windows 10 1703</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><div><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/26486192">26486192</a><br></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">“won’t fix”</p></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">“won’t fix”</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Windows 10 1607 \ Windows Server 2016</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/264861960">26486190</a><br></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><div style="box-sizing:border-box;margin:0px 0in 0.000133333px;font-size:11pt;font-family:Calibri, sans-serif;">4565511<br style="box-sizing:border-box;"></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">2020.07 B</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Windows 10 RTM</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><div><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/26486189">26486189</a><br></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">“won’t fix”</p></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">“won’t fix”</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Windows 8.1 \ Windows Server 2012 R2</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><div><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/26486188">26486188</a><br></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><div style="box-sizing:border-box;margin:0px 0in 0.000133333px;font-size:11pt;font-family:Calibri, sans-serif;">4565541<br style="box-sizing:border-box;"><a href="https://support.microsoft.com/help/4565540" style="box-sizing:content-box;color:rgb(0, 116, 158);text-decoration:underline;cursor:pointer;background-color:rgb(249, 249, 249);font-family:&quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif;margin:0px;outline:0px;font-size:12.0012px;text-align:start;">4565540</a>&nbsp;(SO)<br style="box-sizing:border-box;"></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">2020.07 B</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Windows Server 2012</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><div><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/26486187">26486187</a><br style="box-sizing:border-box;"></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">4565537</p><div style="box-sizing:border-box;margin:0px 0in 0.000133333px;font-size:11pt;font-family:Calibri, sans-serif;"><a href="https://support.microsoft.com/help/4565535" style="box-sizing:content-box;color:rgb(0, 116, 158);text-decoration:underline;cursor:pointer;font-family:&quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif;margin:0px;outline:0px;font-size:12.0012px;text-align:start;">4565535</a>&nbsp;(SO)<br style="box-sizing:border-box;"></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">2020.07 B</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Windows 7.0 SP1 \ Windows Server 2008 R2</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><div><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/26486186">26486186</a><br style="box-sizing:border-box;"></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><div style="box-sizing:border-box;margin:0px 0in 0.000133333px;font-size:11pt;font-family:Calibri, sans-serif;"><a href="https://support.microsoft.com/help/4565524" style="box-sizing:content-box;color:rgb(0, 116, 158);text-decoration:underline;cursor:pointer;font-family:&quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif;margin:0px;outline:0px;font-size:12.0012px;text-align:start;">4565524</a><br style="box-sizing:border-box;">4565539 (SO)</div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">2020.07 B</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Windows Server 2008 SP2</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><div><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/26486185">26486185</a><br style="box-sizing:border-box;"></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><div style="box-sizing:border-box;margin:0px 0in 0.000133333px;font-size:11pt;font-family:Calibri, sans-serif;"><a href="https://support.microsoft.com/help/4565536" style="box-sizing:content-box;color:rgb(0, 120, 215);text-decoration:underline;cursor:pointer;font-family:&quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif;margin:0px;outline:rgb(0, 0, 0) dotted 1px;font-size:12.0012px;text-align:start;">4565536</a>&nbsp;<br style="box-sizing:border-box;">4565529 (SO)</div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">2020.07 B</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Windows Server 2003</p></td><td width="125" style="border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;"><div><a href="https://microsoft.visualstudio.com/OS/_workitems/edit/26486184">26486184</a><br style="box-sizing:border-box;"></div></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">“won’t fix”</p></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">“won’t fix”</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">Use TcpReceivePacketSize workaround&nbsp;</p></td></tr><tr style="box-sizing:border-box;"><td width="287" style="box-sizing:border-box;width:215.4pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;&lt;ph&gt;</p></td><td width="125" style="box-sizing:border-box;width:126px;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td><td width="125" style="box-sizing:border-box;width:93.5pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td><td width="556" style="box-sizing:border-box;width:417.2pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;"><p style="box-sizing:border-box;margin:0in 0in 0.0001pt;font-size:11pt;font-family:Calibri, sans-serif;">&nbsp;</p></td></tr></tbody></table><br></li><li>Workaround: Set&nbsp;<span style="display:inline !important;">TcpReceivePacketSize =&nbsp;<span style="text-align:start;display:inline !important;">0xFF00 and restart the DNS Server Service&nbsp;<br><br><table style="border-collapse:collapse;border:none;">
 <tbody><tr>
  <td width="1223" style="width:917.6pt;border:solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt;">
  <p style="margin:0in 0in 0.0001pt;"><font face="Calibri, sans-serif">If unable to install preventative fixes released July 14, 2020, OR your DNS Server is not currently supported, immediately&nbsp;implement&nbsp;the following Workaround on all Microsoft DNS Servers:&nbsp;</font></p><div style="box-sizing:border-box;font-size:14px;"><span style="box-sizing:border-box;"><br style="box-sizing:border-box;"></span></div><blockquote style="box-sizing:border-box;font-size:14px;margin:0px 0px 0px 40px;border:none;"><div style="box-sizing:border-box;"><span style="box-sizing:border-box;">The following registry modification restricts the size of the largest inbound TCP based DNS response packet allowed and has been identified as a workaround for this vulnerability.&nbsp;<br style="box-sizing:border-box;"></span></div><div style="box-sizing:border-box;"><ul style="box-sizing:border-box;padding:0px 0px 0px 40px;"><li style="box-sizing:border-box;">Registry Path: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\DNS\Parameters&nbsp;</li><li style="box-sizing:border-box;">Data Type: DWORD&nbsp;</li><li style="box-sizing:border-box;">Registry Setting: TcpReceivePacketSize&nbsp;</li><li style="box-sizing:border-box;">Value: 0xFF00 &nbsp;<br style="box-sizing:border-box;"><br style="box-sizing:border-box;"><span style="box-sizing:border-box;display:inline !important;">The Default (also max) Value = 0xFFFF<span style="box-sizing:border-box;">&nbsp;<br style="box-sizing:border-box;"></span></span><span style="box-sizing:border-box;display:inline !important;">The Recommended Value = 0xFF00 (255 bytes less than the max)<span style="box-sizing:border-box;">&nbsp;</span></span><br style="box-sizing:border-box;"></li><li style="box-sizing:border-box;">OS | Service Restart Requirements: A restart of the DNS Service is required to take effect.&nbsp;&nbsp;</li><li style="box-sizing:border-box;">Notes: When implemented, a Windows DNS server will be unable to resolve DNS names for its clients when the DNS response from the upstream server is larger than 65280 bytes.&nbsp;&nbsp;</li><li style="box-sizing:border-box;">See &quot;Workaround Concerns&quot;<br><br></li></ul></div></blockquote><div style="box-sizing:border-box;font-size:14px;"><div style="box-sizing:border-box;">Automated Deployment sample:<span>&nbsp;</span><br style="box-sizing:border-box;"></div><div style="box-sizing:border-box;"><br style="box-sizing:border-box;"></div></div><blockquote style="box-sizing:border-box;font-size:14px;margin:0px 0px 0px 40px;border:none;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;">There are a number of options that an administrator can choose from to deploy this mitigation on a large collection of computers, including direct modification of the registry, Group Policy, and PowerShell and other scripting solutions. &nbsp;<br></div><div style="box-sizing:border-box;"><br>The following scripting example leverages the “REG” command and can be used to automate protections to affected systems.</div></div><div style="box-sizing:border-box;"><div style="box-sizing:border-box;"><br style="box-sizing:border-box;"></div></div><div style="box-sizing:border-box;"><div style="box-sizing:border-box;">To add this registry key to a DNS server, you can use below command from admin prompt. &nbsp;</div></div><div style="box-sizing:border-box;"><ul style="box-sizing:border-box;padding:0px 0px 0px 40px;"><li style="box-sizing:border-box;"><span style="box-sizing:border-box;">REG ADD &quot;HKLM\SYSTEM\CurrentControlSet\Services\DNS\Parameters&quot; /f /v TcpReceivePacketSize /t REG_DWORD /d 0xff00</span><br style="box-sizing:border-box;"></li></ul></div><div style="box-sizing:border-box;"><div style="box-sizing:border-box;"><span style="box-sizing:border-box;">To shut down and restart DNS server service, you can use below command from admin prompt.</span><br style="box-sizing:border-box;"></div></div><div style="box-sizing:border-box;"><ul style="box-sizing:border-box;padding:0px 0px 0px 40px;"><li style="box-sizing:border-box;"><span style="box-sizing:border-box;">To shut down the DNS server service: &nbsp;	NET STOP DNS</span><br style="box-sizing:border-box;"></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;">To start the DNS server service: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NET START DNS</span><br style="box-sizing:border-box;"></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;">To stop and restart the DNS Service in a single command line instruction: NET STOP DNS &amp;&amp; NET START DNS</span></li></ul></div></blockquote><p>
  </td>
 </tr></tbody></table></span></span></li><li><span style="display:inline !important;"><span style="text-align:start;display:inline !important;">Escalations f<span style="text-align:left;display:inline !important;">or CVE-2020-1350-related questions NOT addressed by existing content, send email to:</span><br style="box-sizing:border-box;text-align:left;"><br style="box-sizing:border-box;text-align:left;"><span style="text-align:left;display:inline !important;">To:&nbsp;CVE-2020-1350 Windows DNS RCE Discussion</span><br style="box-sizing:border-box;text-align:left;"><span style="text-align:left;display:inline !important;">Subject: &lt;Case #&gt; is a match for KB &lt;12345&gt; / CVE-2020-1350: &lt;gist of question / issue&gt;&nbsp;</span><br style="box-sizing:border-box;text-align:left;"><br style="box-sizing:border-box;text-align:left;"><span style="text-align:left;display:inline !important;">Notes</span><span style="box-sizing:border-box;text-align:left;">&nbsp;</span><br style="box-sizing:border-box;text-align:left;"><br style="box-sizing:border-box;text-align:left;"><span style="text-align:left;display:inline !important;">Do not send emails with subject lines</span><span style="box-sizing:border-box;text-align:left;">&nbsp;</span><i style="box-sizing:border-box;text-align:left;">like<span style="box-sizing:border-box;">&nbsp;</span></i><span style="text-align:left;display:inline !important;">&lt;Bug # X, Case # Y, ICM # Z or &quot;Has anyone seen this&quot;&nbsp;</span><br style="box-sizing:border-box;text-align:left;"><span style="text-align:left;display:inline !important;">Do feel free to use IDWEB to join the&nbsp;</span><span style="box-sizing:border-box;text-align:left;display:inline !important;">CVE-2020-1350 Windows DNS RCE Discussion alias if you want to monitor related discussion&nbsp;</span><br></span></span></li></ol><div></div><div><span>Workaround Concerns&nbsp;</span><br></div></div><div><div><br></div></div><blockquote style="margin:0 0 0 40px;border:none;"><div><div>TCP-based DNS Response packets that exceed the recommended value will be dropped without error, so it is possible that some queries may not be answered, which could result in an unanticipated failure. A DNS server will only be negatively impacted by this workaround if it receives valid TCP responses that are greater than allowed in the above mitigation (over 65,280 bytes). &nbsp;</div></div><div><div><br></div></div><div><div>The reduced value is unlikely to affect standard deployments or recursive queries, but a non-standard use-case may be present in a given environment. To determine if your server implementation will be adversely affected by this workaround you should enable diagnostic logging and capture a sample set that is representative of your normal business flow, then you will need to review the log files to identify the presence of anomalously large TCP response packets </div></div><div><div><br></div></div><div><div>For more information, see the following Microsoft Docs article: <br><br></div></div></blockquote><blockquote style="margin:0 0 0 40px;border:none;"><div><blockquote style="margin:0 0 0 40px;border:none;"><div><span><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn800669%28v=ws.11%29">DNS Logging and Diagnostics</a></span><br></div></blockquote></div></blockquote><blockquote style="margin:0 0 0 40px;border:none;"><div><div><br></div></div><div><div>You can use either of below methods to sample the traffic on your DNS. </div></div></blockquote><div><div><br></div></div><blockquote style="margin:0 0 0 40px;border:none;"><div><div>Method 1:&nbsp;<span>Steps for event tracing for DNS using logman.</span></div></div><div><ol><li><span>Open Notepad and create a batch file by inserting the following command syntax:<br></span><br>logman create trace &quot;ds_dns&quot; -ow -o c:\ds_dns-tmp.etl -p &quot;Microsoft-Windows-DNSServer&quot; 0xffffffffffffffff 0xff -nb 16 16 -bs 65535 -mode Circular -f bincirc -max 4096 -ets<br><br>Save the file as:	“start-dns-server-trace-evt.bat”</li><li><span>Open Notepad and create a second batch file by inserting the following command syntax:<br></span><br>logman stop &quot;ds_dns&quot; -ets<br>Save the file as:	“stop-dns-server-trace-evt.bat”<br></li><li><span>Start the tracing by running below from admin command prompt (after navigating to C:\temp<br></span><br>&quot;start-dns-server-trace-evt.bat&quot;<br><br>Please also look at other options provided logman by opening the file in a text editor, currently the output file holds max 4GB of data and the output path is c:\ds_dns-tmp.etl in the script.&nbsp; <br><br>(For more details on logman see: https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/logman-create-trace)&nbsp;&nbsp;</li><li><span>Let the server run for the time you want to collect the logs for.<br></span><br>Note: The log sample needs to capture a duration that sufficiently represents typical behavior.</li><li><span>Stop the tracing by running below from admin command prompt as in step 2.<br></span><br>&quot;stop-dns-server-trace-evt.bat&quot;</li><li><span>You can now look at the messages (QUERY_RECEIVED ( with event id 256 ) and RECURSE_RESPONSE_IN (event id 261 )) by opening the file c:\ds_dns-tmp.etl in event viewer&nbsp;&nbsp;</span><br></li><li><span>In both of the event details, the field “PacketData” shows the packet received by DNS server the size of which would be limited by the registry described in the mitigation. Also note that “PacketData” is shown as hex so size in bytes would be half of the digits shown.<br></span><br>Please note that this method only logs information about packets which are accepted by DNS server for processing and the max size of the log is capped at 64KB ( log includes PacketData + some other fields )</li></ol></div><div><div>Method 2:&nbsp;<span>Steps for using wpp trace for DNS.</span></div></div><div><ol><li><span>Open Notepad and create a batch file by inserting the following command syntax:<br></span><br>logman create trace &quot;ds-dns&quot; -ow -o c:\ds-dns.etl -p {406F31B6-E81C-457A-B5C3-62C1BE5778C1} 0x0000000000002040 0xff -nb 16 16 -bs 1024 -mode Circular -f bincirc -max 4096 -ets<br><br>Save the file as:	“start-dns-server-trace-socket.bat”</li><li><span>Open Notepad and create a second batch file by inserting the following command syntax:<br></span><br>logman stop &quot;ds-dns&quot; -ets<br>Save the file as:	“stop-dns-server-trace-socket.bat”</li><li><span>Open command prompt in admin mode, navigate to C:\temp, then start the tracing by running this command:<br></span><br>&quot;start-dns-server-trace-socket.bat&quot;<br><br>Please also look at other options provided logman by opening the file in a text editor, currently the output file holds max 4GB of data and the output path is c:\ds-dns.etl in the script.&nbsp; <br>(For more details on logman see: https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/logman-create-trace)&nbsp;&nbsp;</li><li><span>Let the server run for the time you want to collect the logs for.&nbsp;&nbsp;<br></span><br>Note: The log sample needs to capture a duration that sufficiently represents typical behavior.</li><li><span>Open a command prompt in admin mode, navigate to C:\temp, then stop the tracing by running this command:&nbsp;&nbsp;<br></span><br>&quot;stop-dns-server-trace-socket.bat&quot;</li><li><span>You can now extract text from the etl file generated above (c:\ds-dns.etl).&nbsp;&nbsp;<br></span><br>Note: You can use insightClient for the same (http://toolbox/InsightClient)I</li><li><span>Analyze the generated text file for the pattern &quot;Received TCP message length&quot; followed by the length<br></span><br>See this file for sample output:&nbsp; <br><br>https://microsoft.sharepoint.com/:t:/t/SSIRP20024/ETy6ubWpIlREnSKGn7VcbyAB1f5376P6H-Hbqt2ma-3oyQ?e=A18Zqa &lt;- This files needs a common home for support<br><br>The length retrieved will be impacted by the registry mitigation described above.<br><br>Please note that if you do not see any line containing “Received TCP message length” as mentioned in above point and only see lines like below then it means your DNS server has only been communicating over UDP. UDP communication is unaffected by the mitigation.<br><br>Udp_RecvThread() - I/O completion: &nbsp; &nbsp;bytes recvd &nbsp; &nbsp; &nbsp;= 80 &nbsp; &nbsp;overlapped &nbsp; &nbsp; &nbsp; = 00000098E1A9B078 &nbsp; &nbsp;pcontext &nbsp; &nbsp; &nbsp; &nbsp; = 00000098E1AB73C0 &nbsp; &nbsp; &nbsp; &nbsp;pmsg &nbsp; &nbsp; &nbsp; &nbsp; = 0000000000000000 &nbsp; &nbsp; &nbsp; &nbsp;socket &nbsp; &nbsp; &nbsp; = 6388 &nbsp; &nbsp;bytes recvd &nbsp; &nbsp; &nbsp;= 0<br>Udp_DropReceive() - Drop WSARecvFrom on socket 6388 (thread=1572)</li></ol></div></blockquote></div><div><div style="margin-top:14px;margin-bottom:14px;"><p style="box-sizing:border-box;">Author</p><ul style="box-sizing:border-box;padding:0px 0px 0px 40px;"><li style="box-sizing:border-box;">Small WW army&nbsp;</li></ul><p style="box-sizing:border-box;">FAQ</p><p style="box-sizing:border-box;"><ul style="box-sizing:border-box;padding:0px 0px 0px 40px;"><li style="box-sizing:border-box;">See FAQ Questions in KB<span>&nbsp;</span><a href="https://support.microsoft.com/en-us/help/4569509" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">4569509</a>:&nbsp;<span style="box-sizing:border-box;">Guidance for DNS Server Vulnerability CVE-2020-1350</span></li></ul><ol><li>Does the exploit only work if the item being queried is in cache and if so, would disabling caching be another possible mitigation?&nbsp;<span>.. &nbsp;Looking at the packetdata below using the logging listed in the internal article how do we get the size. &nbsp;The article states: “ note that “PacketData” is shown as hex so size in bytes would be half of the digits shown.&quot; &nbsp;So do we take the number, convert to decimal and divide by 1024 to get the size? &nbsp;<br></span><div><br></div><div>QUERY_RECEIVED: TCP=0; InterfaceIP=::1; Source=::1; RD=1; QNAME=crtide.com.rtrtide.com.; QTYPE=1; XID=2; Port=58472; Flags=256; PacketData=0x0002010000010000000000000663727469646503636F6D077274727469646503636F6D0000010001<br></div><span></span><br><br>A1: From Arif Hussain:&nbsp;The exploit happens during parsing SIG/RRSIG records in dns response or dynamic updates. Disable cache should have no effect on the exploit.&nbsp;<span>The size would be the total count of hex characters you see in PacketData divided by 2, like for below:&nbsp;<br><br></span><div>PacketData=0x0002010000010000000000000663727469646503636F6D077274727469646503636F6D0000010001<br><br></div><div>There are 80 hex character ( starting from 0x ) &nbsp;so size in bytes would be 40.<br></div><span></span></li><li><div><span>What is the difference between the registry-based workaround and the security update?<br><br>Answer 2:&nbsp;</span><span style="">The vulnerability is triggered when a Microsoft DNS server processes a maliciously crafted DNS response. The workaround sufficiently prevents network based attacks by restricting the size of an allowed TCP-based DNS response, but does not address the code flaw in DNS.exe.</span><div>More Information<br><br></div><div>•	The Security Update fully addresses the way that the DNS server processes the response, so any attempts to trigger the vulnerability will fail, and there will be no impact to any other DNS response packets. <br><br></div><div>•	The workaround functions by restricting the size of an allowed TCP-based DNS response packet. Maliciously crafted DNS responses will require an abnormally large network packet <br>even if compression is used. We thoroughly scoped the minimum potential packet size of an exploit, including compression, and then considered the largest expected size of a <br>legitimate response and conservatively arrived at our 0xFF00 recommendation. <br></div><div><br>Other considerations: <br><br>We have not observed cases where the workaround blocks legitimate traffic, but there is some outside potential. &nbsp;Also worth noting is that this security update is contained within Microsoft’s July 2020 Monthly Cumulative Update and this package contains many other fixes in other components that will need to be applied to an affected server.<br></div><span></span><br></div></li></ol><p style="box-sizing:border-box;"><p style="box-sizing:border-box;">Related Bugs</p><ul style="box-sizing:border-box;padding:0px 0px 0px 40px;"><li style="box-sizing:border-box;">&lt;insert here&gt;</li></ul><p style="box-sizing:border-box;">Related Content</p><ul style="box-sizing:border-box;padding:0px 0px 0px 40px;"><li style="box-sizing:border-box;">CheckPoint:<span>&nbsp;</span><a href="https://checkpoint.zoom.us/webinar/register/WN_4eQbqpnoQg68lvFZfKyHHg" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">Webinar</a></li><ul style="box-sizing:border-box;padding:0px 0px 0px 40px;"><li style="box-sizing:border-box;">Check Point Research recently discovered a critical vulnerability in Windows DNS Server that affects Windows Server versions 2003 to 2019. Microsoft has acknowledged this vulnerability and defined it as a formable critical vulnerability (CVSS score 10.0)&nbsp;<br style="box-sizing:border-box;"><br style="box-sizing:border-box;">If successfully exploited, an attacker would be granted Domain administrator rights that may compromise your entire corporate infrastructure.&nbsp;</li></ul><li style="box-sizing:border-box;"><a href="https://research.checkpoint.com/" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">https://research.checkpoint.com/</a><br style="box-sizing:border-box;"></li><li style="box-sizing:border-box;"><a href="https://checkpoint.com/" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">https://checkpoint.com</a></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;font-size:10pt;font-family:&quot;Segoe UI&quot;, sans-serif;">CSS<span>&nbsp;</span><a href="https://msit.microsoftstream.com/video/0625a4ff-0400-a521-ae3f-f1eac69f0c10?channelId=2f9ae6a5-c0a9-4dc6-83ae-622a25a71b49" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">Insorts Video</a><span>&nbsp;</span>explaining DNS vulnerability</span><br style="box-sizing:border-box;"></li></ul><p style="box-sizing:border-box;">Related Social Media Threads</p><ul style="box-sizing:border-box;padding:0px 0px 0px 40px;"><li style="box-sizing:border-box;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">Ars Technica:&nbsp;<a href="https://arstechnica.com/information-technology/2020/07/microsoft-urges-patching-severe-impact-wormable-server-vulnerability/?comments=1">Microsoft urges patching severe-impact, wormable server vulnerability</a></span></li><ul><li style="box-sizing:border-box;">The vulnerability, dubbed SigRed by the researchers who discovered it, resides in Windows DNS, a component that automatically responds to requests to translate a domain into the IP address computers need to locate it on the Internet. By sending maliciously formed queries, attackers can execute code that gains domain administrator rights and, from there, take control of an entire network. The vulnerability, which doesn’t apply to client versions of Windows, is present in server versions from 2003 to 2019. SigRed is formally tracked as CVE-2020-1350. Microsoft issued a fix as part of this month's Update Tuesday.<br></li></ul><li style="box-sizing:border-box;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">Bleeping Computer/Lawrence Abrams:&nbsp;</span><span style="box-sizing:border-box;color:black;"><a href="https://nam06.safelinks.protection.outlook.com/?url=https://www.bleepingcomputer.com/news/microsoft/microsoft-july-2020-patch-tuesday-123-vulnerabilities-18-critical/&amp;data=02%7c01%7cdanree%40microsoft.com%7c16c65fe2fb574fd1f1d308d8283846aa%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637303569462893568&amp;sdata=LpSQPH2bzJva0zPsNSnpyMqGppb/atV5X92DNp6lRN8%3D&amp;reserved=0" target="_blank" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:blue;">Microsoft July 2020 Patch Tuesday: 123 vulnerabilities, 18 Critical</span></a></span><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">&nbsp;&nbsp;</span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">Computer Weekly/Alex Scroxton:&nbsp;</span><span style="box-sizing:border-box;color:black;"><a href="https://nam06.safelinks.protection.outlook.com/?url=https://www.computerweekly.com/news/252486110/Check-Point-unearths-critical-SIgRed-bug-in-Windows-DNS&amp;data=02%7c01%7cdanree%40microsoft.com%7c16c65fe2fb574fd1f1d308d8283846aa%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637303569462893568&amp;sdata=flpfUbyVEBF2jhw714B8FPweLSA3krLwtl3/mw%2BJnzs%3D&amp;reserved=0" target="_blank" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:blue;">Check Point unearths critical SigRed bug in Windows DNS</span></a></span><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">&nbsp;&nbsp;</span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">Engadget/Daniel&nbsp;Cooper:&nbsp;</span><span style="box-sizing:border-box;color:black;"><a href="https://nam06.safelinks.protection.outlook.com/?url=https://www.engadget.com/check-point-sigred-microsoft-dns-exploit-200027095.html&amp;data=02%7c01%7cdanree%40microsoft.com%7c16c65fe2fb574fd1f1d308d8283846aa%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637303569462853591&amp;sdata=DSl%2BzEZT075PZPzVRTTQTmx6psymqTX/LoKEuhYxAm0%3D&amp;reserved=0" target="_blank" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:blue;">Microsoft is patching a dangerous Windows DNS Server exploit</span></a></span><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">&nbsp;&nbsp;</span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">Gizmodo/Joanna&nbsp;Nelius:&nbsp;<a href="https://nam06.safelinks.protection.outlook.com/?url=https://gizmodo.com/stop-what-you-re-doing-and-patch-the-windows-bug-that-t-1844380324&amp;data=02%7c01%7cdanree%40microsoft.com%7c16c65fe2fb574fd1f1d308d8283846aa%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637303569462853591&amp;sdata=czQ9q1aPFpjgRGJG//5YkhrD3eqO8luebWutJ%2Bsc8%2Bc%3D&amp;reserved=0" target="_blank" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;"><span style="box-sizing:border-box;color:blue;">Stop What You’re Doing and Patch the Windows Bug That Took Microsoft 17 Years to Fix</span></a>&nbsp;&nbsp;</span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">PC Magazine/Michael Kan:&nbsp;</span><span style="box-sizing:border-box;color:black;"><a href="https://nam06.safelinks.protection.outlook.com/?url=https://www.pcmag.com/news/wormable-flaw-leaves-windows-dns-servers-open-to-hackers&amp;data=02%7c01%7cdanree%40microsoft.com%7c16c65fe2fb574fd1f1d308d8283846aa%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637303569462913557&amp;sdata=%2BN155SouyASGQdMwYu%2BjjqgbeOzU1ahWYGq8p7xqfmw%3D&amp;reserved=0" target="_blank" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:blue;">'Wormable' Flaw Leaves Windows DNS Servers Open to Hackers</span></a></span><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">&nbsp;&nbsp;</span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">Threatpost/Tom Spring:&nbsp;</span><span style="box-sizing:border-box;color:black;"><a href="https://nam06.safelinks.protection.outlook.com/?url=https://threatpost.com/critical-dns-bug-windows-servers-infrastructure-takeover/157427/&amp;data=02%7c01%7cdanree%40microsoft.com%7c16c65fe2fb574fd1f1d308d8283846aa%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637303569462863582&amp;sdata=NVVfltyWi0dBpTaDBXq9XGPZ2LVw0Bo7%2BtfCwZ5l14g%3D&amp;reserved=0" target="_blank" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:blue;">Critical DNS Bug Opens Windows Servers to Infrastructure Hijacking</span></a></span><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">&nbsp;&nbsp;</span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">The Verge/Tom Warren:&nbsp;<a href="https://nam06.safelinks.protection.outlook.com/?url=https://www.theverge.com/2020/7/14/21324353/microsoft-windows-dns-server-security-vulnerability-patch-critical-flaw&amp;data=02%7c01%7cdanree%40microsoft.com%7c16c65fe2fb574fd1f1d308d8283846aa%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637303569462873577&amp;sdata=b9JH1ddRbW2xbJU5LW3KWK0OSvc04fbPtgCCveOnPDw%3D&amp;reserved=0" target="_blank" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;"><span style="box-sizing:border-box;color:blue;">Microsoft warns of critical Windows DNS Server vulnerability that’s ‘wormable’</span></a>&nbsp;&nbsp;</span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;"><span style="box-sizing:border-box;">Twitter:<span style="box-sizing:border-box;">&nbsp;</span></span><a href="https://twitter.com/Don1Gibson/status/1283049062753804288?s=20" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;">Looks like a CVSS 10.0 is being announced. Windows DNS from 2003 - 2019. Checkpoint for al details</a><br style="box-sizing:border-box;"></span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">WIRED/Andy Greenberg:&nbsp;<a href="https://nam06.safelinks.protection.outlook.com/?url=https://www.wired.com/story/sigred-windows-dns-flas-wormable/&amp;data=02%7c01%7cdanree%40microsoft.com%7c16c65fe2fb574fd1f1d308d8283846aa%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637303569462873577&amp;sdata=JWtPf62gl8dzGzHljDNxdrlV1SImZg6gYxmTRdQPD1g%3D&amp;reserved=0" target="_blank" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;"><span style="box-sizing:border-box;color:blue;">Hack Brief: Microsoft Warns of a 17-Year-Old ‘Wormable’ Bug</span></a>&nbsp;&nbsp;</span></li><li style="box-sizing:border-box;"><span style="box-sizing:border-box;font-family:&quot;Segoe UI&quot;, sans-serif;color:black;">ZDNet/Charlie Osborne:&nbsp;<a href="https://nam06.safelinks.protection.outlook.com/?url=https://www.zdnet.com/article/critical-sigred-vulnerability-impacts-microsoft-windows-dns-2003-2019-patch-now/&amp;data=02%7c01%7cdanree%40microsoft.com%7c16c65fe2fb574fd1f1d308d8283846aa%7c72f988bf86f141af91ab2d7cd011db47%7c1%7c0%7c637303569462883573&amp;sdata=3FUgT3exk8KEWWjpCQ8ee3aYPtEFMO1zNr%2BHV9LMAvQ%3D&amp;reserved=0" target="_blank" style="box-sizing:border-box;text-decoration:underline;cursor:pointer;"><span style="box-sizing:border-box;color:blue;">SigRed: A 17-year-old 'wormable' vulnerability for hijacking Microsoft Windows Server</span></a>&nbsp;&nbsp;</span></li></ul><p style="box-sizing:border-box;">Related Cases</p><ul style="box-sizing:border-box;padding:0px 0px 0px 40px;"><li style="box-sizing:border-box;">120071523001777</li><ul style="box-sizing:border-box;padding:0px 0px 0px 40px;"><li style="box-sizing:border-box;">Title:&nbsp;Prem/Windows DNS svr/need details of the DNS svr remote code execution vulnerability is applicable for which OS</li><li style="box-sizing:border-box;">Problem statement:&nbsp;<span style="box-sizing:border-box;">Prem/Windows DNS svr/need details of the DNS svr remote code execution vulnerability is applicable for which OS</span></li><li style="box-sizing:border-box;">Opened for W2K3</li></ul></ul></div></div>