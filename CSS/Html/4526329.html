<header><h1>Workflow: Net: TCPIP performance</h1></header><span asset="4476087" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4476087]</span><ul><li><strong>Content Idea (CI): </strong><a managed-link="" href="https://aka.ms/CIEdit?id=109154" target="" data-content-type="" data-content-id="" bookmark-id="">109154</a></li></ul><p><strong>Support Topic: </strong><ul><li>Windows\Windows 10\Windows 10 Education, version 1909\Network Connectivity and File Sharing\TCPIP Performance (Congestion, Bandwidth, Latency, MTU, NOT SMB)</li></ul></p><div><div>
  <p dir="ltr" style="font-family:Calibri;font-size:14pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:14pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Scoping</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.13in;margin-right:0;margin-top:6pt;vertical-align:middle;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">When it comes to any application slowness caused by underline TCP/IP please validate below.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">a.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Determine how that application works i.e. all components involved in completing a network cycle.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">b.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Please note down all the components which constitute to the Network cycle. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">c.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Ex. When a client(can be a windows client or a windows server) tries to open a website hosted on the IIS server or tries to run a SQL query, it basically sends a TCP Three way handshake, followed by the application communication, now is order to display the website the IIS server would in turn access the Database server to fetch info and display it back to the client, this is called a Network cycle.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">d.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Draw/Identify customers Network like below which showcase the IP Addresses, Application Ports, Client and server networks, Switches/Routers/Firewalls/Wan Accelerators, IPS (Intrusion Protection/Prevention Systems), DPI (Deep Packet Inspection) etc. which constitutes to this Network cycle.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;">
    <span style="font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span asset="4569009" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4569009]</span>
    </span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:6pt;">
    <span style="white-space:pre-wrap;color:#000000;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">When did the issue start occurring?</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">a.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Knowing when a problem started is useful as you can investigate what changed just prior to the issue occurring?</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">b.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Is this a new setup/ existing setup?</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">c.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Do we have a Baseline/Fast performance which can be used for comparison?</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">d.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Since every operation involves a client and server, do we see any differences when we isolate networks i.e. performing the same operation from same site/subnet as the application server.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Was this working previously, or has it never worked?</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">a.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">If working previously, did anything change prior to the issue (i.e. was there a patch installed; was there a change to the infrastructure; etc.)? This is especially important.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">4.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Do we see the Slowness every time or its intermittent?</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">a.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Intermittent issues could be caused by a behavior i.e. is the performance/slowness observed during any time of day/ when some other operation is being performed (Backups) or any other activity.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">5.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Also validate if the performance impact is on a VM or Physical Machine.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">6.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Isolating the above network component wise?</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;vertical-align:middle;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Source Client:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:6pt;text-align:justify;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Are multiple clients impacted/have performance issues at the same time?</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Are multiple applications impacted from the same client?</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">How many nodes are affected?</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Do we see any local performance on the problematic client during the time of issue?</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">a.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Destination server:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Is the Application standalone or load balanced between multiple servers (Clustered).</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Do we see any local performance (CPU spike, Memory Spike) on the server during the time of issue?</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Every application has a database server, try to validate if this database is local to the box, on another server(same site/network) or connected over SAN/NAS storage, all third party database needs to be validated by Customer.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">7.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Apart from the above Source and Destination also try to validate all the intermediate devices in between like Switches, Routers, Firewalls, Wan Accelerators, IPS (Intrusion Protection/Prevention Systems), DPI (Deep Packet Inspection) etc.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">a.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Do we see any delay/changes done in the packet being?</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Received/monitored/then sent forward.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Packet Modifications done at the IP Layer (NATing performed), TCP layer (Sequence and Acknowledgement Number/ Source and Destination ports being changed) to consume the existing network bandwidth.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">8.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">You can also try uninstalling anti-virus on the OS and see if that makes any difference.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">9.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Some networking components are expected to add Performance issues with limited Server Hardware resources, so verify if one is using the below.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">a.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Enabling IPsec within environment.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">b.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Using DNSSEC.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:14pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="white-space:pre-wrap;font-size:14pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:14pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="font-family:Calibri;font-size:14pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Troubleshooting:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Based on the above information it is important to narrow the scope first which gives a better idea of where to look at.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Once the scope has been narrowed, the device (or devices) on the path between the unsuccessful and successful tests needs to be investigated. Asking the customer to assist in collecting network traces from both sides of the conversation is reasonable request given they have contacted Microsoft to assist with troubleshooting; however, infrastructure issues are not supported by Microsoft. The customer needs to engage their hardware vendor to assist with this troubleshooting.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Collect a Netmon/ETL/ Wireshark Trace simultaneously from source and Destination (if possible, ask customer to gather TCP Dump/Logs from Intermediate devices).</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;vertical-align:middle;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">4.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Network Performance issues would majorly be contributed by Packet Drops in the Underlined network. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">5.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">If there are packet drops in the network, your network capture would show a lot of </span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Packet Retransmits, Duplicate Acknowledgement, Request for Fast Retransmit</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> etc. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">6.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Single retransmits are not a problem, but if you have many that would contribute to the slow performance example:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Wingdings;font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">TCP frame - 0.3sec delay</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Wingdings;font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">TCP Retransmit#1 - 0.6sec delay</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Wingdings;font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">TCP Retransmit#2 - 1.2sec delay</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Wingdings;font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">TCP Retransmit#3 - 2.4sec delay and so on, after 5th retransmit the session would be terminated.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">7.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Below filters can be used to track the above:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">For Netmon.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Ipv4.address==10.0.0.15 and ipv4.address==192.168.1.15 and (Property.TCPRetransmit == 1 or Property.TCPDupAck == 1 or Property.TCPRequestFastRetransmit == 1)</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">The above would filter for the whole traffic which Netmon captured, you can further add Source/Destination IP, Source/ Destination Port to look at the actual data.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">For Wireshark.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Filter applied: ip.addr==10.0.0.15 &amp;&amp; tcp.port==49153 &amp;&amp; ip.addr==192.168.1.15 &amp;&amp; tcp.port==445 &amp;&amp; tcp.analysis.retransmission</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Here you can add the Source/Destination IP/Port along with the tcp.analysis</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">.retransmission</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> filter.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;text-indent:0.03in;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">8.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Packet Drops are usually caused by intermediate devices, using the above traces find out the packet which is being retransmitted repeatedly, check whether this packet was received at the destination or not.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">9.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">If it is identified to be packet drop, isolate which intermediate device is dropping the packet, post this you need to involve the intermediate device vendor to look further.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">10.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Factors which also contributes in Network Performance which one needs to be aware off.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">TCP Three-way handshake</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> negotiates factors which paly an effective role in the data transfer thereby improving performance.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Maximum Segment Size (MSS):</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">  Largest Segment that can be sent on a TCP connection, for an IP datagram sent on an Ethernet Network the MSS is 1460.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">MSS is normally decided in the TCP three-way handshake, the MSS is negotiated for the complete TCP Session.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Maximum Transferable Unit(Link MTU):</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> The maximum size of a frame for a given Network Interface Layer technology is called the MTU, Each Network Interface Layer impose a maximum-sized frame that can be sent. This frame typically consists of the framing header and trailer and a payload. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">MTU detection of a link is especially important as otherwise intermediate devices would fragment the packets, this can be avoided by following measures:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.50in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Discover the IP MTU that is supported by all the links in the path between the source and the destination (the path MTU).</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.50in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Set the DF flag to 1 on all IP datagrams sent.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.50in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">PMTU Discovery is another process used to avoid IP fragmentation.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">The default IP MTU on Ethernet is 1500 bytes.&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Manually test for the IP MTU with the command “ping –f –l 1472 serverIP”.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">If this fails with “Packet needs to be fragmented but DF set”:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Window:</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> TCP windows size is a 16bit field for a maximum receive window size of 65,535 bytes. Any sender can only have 65,535 bytes of data in transit before having to wait for an acknowledgement. This field tells the link partner how much data can be sent on the wire before an acknowledgment is received. If the receiver is not able to process the data as fast as it arrives, gradually the receive buffer will fill and the TCP window will be reduced in the acknowledgment packets. This will alert the sender that it needs to reduce the amount of data sent or allow the receiver time to clear the buffer.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Zero Window Issue:</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> When a client machine advertises a zero for its window size, this indicates that the TCP receive buffer is full and it cannot receive any more data. This can be caused by a </span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">problem within the application</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">, where the TCP buffer is not being retrieved.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Review network captures for TCP Window Size drops indicating a performance issue, If the advertised TCP Window size remains at 0, then the TCP session is torn down.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">4.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Scaling Factor(Auto-tuning) negotiated</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> : This options allows the receiver to advertise a larger window size than 65,535 bytes, So make sure that we have scaling factor negotiated in the Three way handshake for the session.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">5.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Selective Acknowledgement (SACK):</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> Make sure that SACK is enabled and negotiated in the three way handshake.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.30in;margin-right:0;margin-top:0;">
    <span style="font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span asset="4569010" contenteditable="false" unselectable="on" props="{&#34;size&#34;:&#34;full&#34;}">[Asset 4569010]</span>
    </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:8pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;text-align:center;">
    <span style="font-family:Calibri;font-size:8pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Snippet of a TCP SYN packet from source which contains all the above negotiating factors.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;Too Many </span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">TCP Resets</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> may can also indicate an issue make sure:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Verify whether the application/service normally clean up sessions gracefully or non-gracefully? Examples of protocols that use TCP resets to clean up resources: SMB, Kerberos, RDP, HTTP/web server, etc.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">The Hardware NIC (Network Interface Card) also have many features which could improve/slow down the performance: </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:'Courier New';font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">o</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Receive Side Scaling (RSS) Queues</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> - RSS enables network adapters to distribute the incoming network processing load across multiple processor cores in multi-core computers thereby increasing the performance. Another crucial factor is that the NICs should also support hardware queuing. The receive queues are associated with a CPU. RSS is by default enabled on all windows OS.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:'Courier New';font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">o</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Virtual Machine Queue (VMQ)</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> - IF we are facing Network Performance(slowness) on the VM's hosted in Hyper-V, Verify if you have VMQ configured or not, VMQ Improves network throughput by distributing processing of network traffic for multiple virtual machines (VMs) among multiple processors.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:'Courier New';font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">o</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Jumbo Frames</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> - Enabling Jumbo Frames at NIC driver level can increase a TCP segment sizes up to 9000 bytes which can</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> cause network drops if the intermediate devices between the source and destination doesn't support it</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">, in that case try disabling it, if problem resolves then work with the intermediate device vendors as why isn't this supported or don’t enable this feature.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.75in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:1.13in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">11.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">The Transit Network (WAN) between the Source and destination adds another factor. </span>
    <span style="color:#2A2A2A;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">This capacity is known as the bandwidth-delay product (BDP). The pipe (Network link) can be fat (high bandwidth) or thin (low bandwidth) or short (low RTT) or long (high RTT). Pipes that are fat and long have the highest BDP. Examples of high BDP transmission paths are those across satellites or enterprise wide area networks (WANs) that include intercontinental optical fiber links. </span>
    <span style="color:#2A2A2A;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">So, make sure that you also Consider this latency which would be there between two Physical sites </span>
    <span style="color:#2A2A2A;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">contributing to the </span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Round-Trip Time/ Latency between point A to Point B</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;text-indent:-0.25in;vertical-align:middle;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">12.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Tools like NTTCP and Iperf could also be used to isolate the network bandwidth from point A to point B since they capture pure network bandwidth all application traffic would be ignored.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">These two basic tools are used for benchmarking network performance.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:9pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;">
    <span style="color:#FF0000;font-family:Calibri;font-size:9pt;font-style:normal;font-weight:bold;margin:0;padding:0;">!!! WARNING!!!</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.38in;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">It should be noted that benchmark tools, or more accurately synthetic benchmark tools, should NOT but used for troubleshooting. When troubleshooting a network performance issue you should troubleshoot using a reproduction of the actual production issue. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#1E4E79;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">NTttcp</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">NTttcp is a Microsoft made synthetic network benchmarking tool. It is designed to work in a Windows to Windows environment and built for the way Windows networking works. This is the preferred Windows synthetic benchmarking tool.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <div align="left">
    <table dir="ltr" style="border:none;border-collapse:collapse;margin-bottom:.001pt;">
      <tr>
        <td style="background:#FFFFFF;border-bottom:solid #A3A3A3 1.0pt;border-left:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;border-top:solid #A3A3A3 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:249.6pt;">
          <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
            <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Syntax</span>
          </p>
        </td>
        <td style="background:#FFFFFF;border-bottom:solid #A3A3A3 1.0pt;border-left:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;border-top:solid #A3A3A3 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:794.75pt;">
          <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
            <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Details</span>
          </p>
        </td>
      </tr>
      <tr>
        <td style="background:#FFFFFF;border-bottom:solid #A3A3A3 1.0pt;border-left:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;border-top:solid #A3A3A3 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:249.6pt;">
          <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
            <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Example Syntax for a Sender: NTttcps –m 1,0,10.1.2.3 –a&nbsp;2</span>
          </p>
        </td>
        <td style="background:#FFFFFF;border-bottom:solid #A3A3A3 1.0pt;border-left:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;border-top:solid #A3A3A3 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:794.75pt;">
          <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
            <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Single thread; Bound to CPU 0; Connects to a computer that uses IP 10.1.2.3; Posts two send-overlapped buffers; Default buffer size: 64&nbsp;K; Default number of buffers to send:&nbsp;20&nbsp;K.</span>
          </p>
        </td>
      </tr>
      <tr>
        <td style="background:#FFFFFF;border-bottom:solid #A3A3A3 1.0pt;border-left:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;border-top:solid #A3A3A3 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:249.6pt;">
          <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
            <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Example Syntax for a&nbsp;Receiver: NTttcpr –m 1,0,10.1.2.3 –a 6 –fr</span>
          </p>
        </td>
        <td style="background:#FFFFFF;border-bottom:solid #A3A3A3 1.0pt;border-left:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;border-top:solid #A3A3A3 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:799.7pt;">
          <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
            <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Single thread; Bound to CPU 0; Binds on local computer to IP 10.1.2.3; Posts six receive-overlapped buffers; Default buffer size: 64&nbsp;KB; Default number of buffers to receive:&nbsp;20&nbsp;K; Posts full-length (64&nbsp;K) receive buffers.</span>
          </p>
        </td>
      </tr>
    </table>
  </div>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">For example, to measure the network performance between two multi-core serves running Windows Server 2012, NODE1 (192.168.0.1) and NODE2 (192.168.0.2), connected via a 10GigE connection, on NODE1 (the sender), run:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">ntttcp.exe -s -m 8,*,192.168.0.2 -l 128k -a 2 -t 15</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">More info: &nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <a href="https://gallery.technet.microsoft.com/NTttcp-Version-528-Now-f8b12769">
      <span style="color:#0000FF;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">https://gallery.technet.microsoft.com/NTttcp-Version-528-Now-f8b12769</span>
    </a>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <a href="https://msdn.microsoft.com/en-us/library/windows/hardware/dn567663%28v=vs.85%29.aspx">
      <span style="color:#0000FF;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">https://msdn.microsoft.com/en-us/library/windows/hardware/dn567663(v=vs.85).aspx</span>
    </a>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:14pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:14pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Performance at Transport layer:</span>
    <span style="font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">
      <br>‎</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Performance is a comparison rather than expectation when it comes to enhance it. Because of the multiple factors involved. While comparing too we should also ensure that we are comparing with identical endpoints in terms of hardware and network path as well as Operating System</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">We are going to find out bottleneck at various stages. We would need to ensure that we have setup our Endpoints for best configuration. Features that enhances performance and should be enabled. Please visit and read </span>
    <a href="https://docs.microsoft.com/en-us/windows-server/networking/technologies/network-subsystem/net-sub-performance-tuning-nics">
      <span style="background:#FFFFFF;color:#0563C1;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Performance Tuning Network Adapters.</span>
    </a>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Before we go any further, read </span>
    <a href="https://docs.microsoft.com/en-us/windows-server/networking/technologies/network-subsystem/net-sub-performance-tuning-nics">
      <span style="background:#FFFFFF;color:#0563C1;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">TCP receive window autotuning</span>
    </a>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Now we know that Autotuning is a must have feature if we want to scale up the connection. But do not forget, that it is the application, which defines the TCP receive Window. So if the TCP is configured to use Autotuning level to normal and the application has enough buffer defined for TCP window, the OS will scale the TCP to maximum in small amount of time. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Say if TCP has 65536 * 256 (scaling factor 8) and the latency is 10 ms. The maximum attainable speed can be 1.6 GB/s. But wait, that is the entire bandwidth of 10 Gb NIC!! Can we do that? Or should we do that? </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">OS does not allocate the entire link speed for one socket. This feature is meant for higher latency networks. If we have low latency network, the network pipe can be filled without the need of scaling the TCP Window (application must tell TCP to push data to application using Push flag). </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Thus, if the issue is with throughput across high latency network, ensure the TCP autotuning is in place. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Now particularly with high latency network the TCP window is not scaled to maximum at once. There are algorithms determining the BDP and scale the window accordingly. Few of the algorithms used by Microsoft OS are </span>
    <a href="https://tools.ietf.org/html/draft-rhee-tcpm-cubic-02">
      <span style="background:#FFFFFF;color:#0563C1;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">CUBIC</span>
    </a>
    <span style="background:#FFFFFF;color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">,&nbsp;</span>
    <a href="https://tools.ietf.org/html/rfc6582">
      <span style="font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="background:#FFFFFF;color:#0563C1;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">NewReno</span>
      <span style="background:#FFFFFF;color:#0563C1;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">
    </span></span></span></a>
    <span style="background:#FFFFFF;color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">,&nbsp;</span>
    <a href="https://tools.ietf.org/html/draft-sridharan-tcpm-ctcp-02">
      <span style="background:#FFFFFF;color:#0563C1;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Compound&nbsp;TCP</span>
    </a>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">. Windows OS assigns a congestion algorithm to each socket created. With Windows 10 we have TCP settings predefined.  </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">To get TCP settings use Powershell command: </span>
    <span style="color:#4472C4;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">
      <br>‎</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Get-NetTCPSettings </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">To get which settings are applied to which port? </span>
    <span style="font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">
      <br>‎</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Get-NetTCPConnection </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">As we understand basics of TCP now let us talk about some bottle necks which we will try to find in this article:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Underlying network congestion resulting in packet loss. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Processing bottleneck (hardware limitations) </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Storage bottleneck (Slow storage) </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">4.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Application limit. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">5.</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Added Security   </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Which tool should one use to test throughput for TCP? </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">If an enterprise wishes to test certain hardware and get highest throughput as possible. Given the performance tuning factors checked and in place, one should get best throughput unless there is an underlying network issue. One of the clear indicators to that could be packet loss. But we need to ensure that we use correct tool to check throughput. I would use </span>
    <span style="background:#FFFFFF;color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
    <a href="https://gallery.technet.microsoft.com/NTttcp-Version-528-Now-f8b12769">
      <span style="font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">
      <span style="background:#FFFFFF;color:#0563C1;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">NTttcp.exe</span>
      <span style="background:#FFFFFF;color:#0563C1;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">
    </span></span></span></a>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">and adjust its receive buffer as it takes default settings of the link speed to scale the TCP window otherwise. Refer to </span>
    <a href="https://docs.microsoft.com/en-us/windows-server/networking/technologies/network-subsystem/net-sub-performance-tools">
      <span style="background:#FFFFFF;color:#0563C1;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Performance Tools for Network Workloads</span>
    </a>
    <span style="background:#FFFFFF;color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Is it a bad idea to take network monitor or network packet level logs during tests? </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">It is, because the NDIS monitoring filters are active now to record each packet, not the count but content, which will add delay for the sender as well as receiver. Because this operation, apart from CPU, will generate a lot of storage IOs. However, if we are suspecting an issue with underlying network then we can take packet level logging to see if there is a packet loss. If that is the case, one need to ensure that underlying network is fixed as we cannot expect performance if TCP is trying to recover from loss. Refer to </span>
    <a href="https://docs.microsoft.com/en-us/windows/client-management/troubleshoot-tcpip-connectivity">
      <span style="background:#FFFFFF;color:#0563C1;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Troubleshoot TCP/IP connectivity</span>
    </a>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">to take a Network Monitor trace and quickly determine if there are packet loss. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">With Underlying network checked let us talk about obvious, i.e. Security. Adding security has its own cost and performance issues. Though we are moving towards ensuring security is must, we need to intelligently think, where is that required. Security protocols such as IPsec has overhead and additional processing requirements. On top of it, if must, one should take decision on using data protection vs. data integrity. Later has comparatively lesser overall cost of processing. IPsec’s integrity mode should be preferred wherever possible. Along this, security software too has a huge cost on packet processing. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">This is an environment design and is supposed to have slower outputs. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">If the tests are still not as per expectations, we would need to see what is wrong. Let us take some logging as defined in </span>
    <a href="https://docs.microsoft.com/en-us/windows-server/networking/technologies/network-subsystem/net-sub-performance-counters">
      <span style="background:#FFFFFF;color:#0563C1;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Network-Related Performance Counters</span>
    </a>
    <span style="background:#FFFFFF;color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">What is not acceptable or shows potential issue which can cause slowness? </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Though checking all the counters specified in the above article has their significant value and courts an investigation however we do not test just use TCP, it is a transport protocol and will have an upper layer associated such as file system protocol like SMB or NFS etc. These protocols require their time on the processor and later disk IOs. I have seen that usually the slowness (comparative) is because of high DPC Queue or/and Slow disk IOs. Finding out which component in the OS is causing high DPCs can be difficult as it requires analysis using Xperf/WPR (CPU) logging and is generally caused by a faulty driver or hardware but to find disk related slowness is easier comparatively. Please visit and follow </span>
    <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc938959%28v=technet.10%29">
      <span style="background:#FFFFFF;color:#0563C1;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Examining and Tuning Disk Performance</span>
    </a>
    <span style="background:#FFFFFF;color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Now with four of the major points covered (Processor, Storage, Security, underlying network), we must discuss a bit of application related bottleneck as well. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Client and server applications are subjected to their own buffer to keep data. These can be limited based on the programing as to how many threads and buffer each API call can utilize. In this we earlier discussed that there is no point just testing TCP in real world. If this is done, it is still for creating a baseline. While testing, the testing applications can be adjusted to use multiple threads with high buffer values to reach maximum throughput but that might not be the actual picture with the application. SMB or Server Message Block (CIFS) is an application layer protocol which is backed by a lot of stuff including its own buffer and optimization(</span>
    <span style="background:#FFFFFF;color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">(</span>
    <a href="https://docs.microsoft.com/en-us/windows-server/administration/performance-tuning/role/file-server/">
      <span style="background:#FFFFFF;color:#0563C1;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">Performance Tuning for file Servers</span>
    </a>
    <span style="background:#FFFFFF;color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;or&nbsp;</span>
    <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn659439%28v=ws.11%29">
      <span style="background:#FFFFFF;color:#0563C1;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">SMB: Troubleshooting Guide</span>
    </a>
    <span style="background:#FFFFFF;color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">)</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">). If the things for baseline are working as expected but not for your application, it is better to work with application expert as it is not TCP or underlying network anyway. It is hard to discuss the application bottleneck as various applications are designed to utilize resources differently thus an appropriate path will be to discuss this with an application specialist. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Takeaways to get best performance from TCP layer: </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">1-</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">No underlying network issues (Packet loss). </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2-</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Advanced properties of Network card for performance features should be enabled. Unless advised otherwise due to an underlying network compatibility issue or troubleshooting purpose. </span>
  </p>
  <p dir="ltr" style="font-family:Symbol;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Jumbo frames </span>
  </p>
  <p dir="ltr" style="font-family:Symbol;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">RSS/VMQ </span>
  </p>
  <p dir="ltr" style="font-family:Symbol;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Offloading features </span>
  </p>
  <p dir="ltr" style="font-family:Symbol;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Symbol;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">RSC </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3-</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">TCP Auto-Tuning should be set to normal. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">4-</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Ensure there are no CPU or Storage Bottleneck (Performance Monitor analysis). </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0.50in;margin-right:0;margin-top:0;text-indent:-0.25in;">
    <span style="display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">5-</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Try select Security features on actual measurement based on your organizations’ requirements. </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:8pt;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#1E4E79;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#1E4E79;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">iPerf</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> iPerf is primarily used to Measure Network bandwidth. It Report MSS/MTU size and observed read sizes. The results with iPerf are not always accurate given the difference in Linux and Windows networking. This is, however, a common network benchmarking tool so you can use it frequently. It is typically better to use NTttcp since it was built by Microsoft to benchmark Windows networking.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">By default, the Iperf client connects to the Iperf server on the TCP port 5001 and the bandwidth displayed by Iperf is the bandwidth from the client to the server.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">If you want to use UDP tests, use the </span>
    <a href="https://openmaniak.com/iperf.php">
      <span style="color:#0000FF;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">-u</span>
    </a>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> argument.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">The </span>
    <a href="https://openmaniak.com/iperf.php">
      <span style="color:#0000FF;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">-d</span>
    </a>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> and </span>
    <a href="https://openmaniak.com/iperf.php">
      <span style="color:#0000FF;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">-r</span>
    </a>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> Iperf client arguments measure the bi-directional bandwidths.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Client side:</span>
  </p>
  <div align="left">
    <table dir="ltr" style="border:none;border-collapse:collapse;margin-bottom:.001pt;">
      <tr>
        <td style="border-bottom:solid #A3A3A3 1.0pt;border-left:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;border-top:solid #A3A3A3 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:94.2pt;">
          <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
            <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">#iperf -c 10.1.1.1 </span>
          </p>
        </td>
      </tr>
    </table>
  </div>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Server side:</span>
  </p>
  <div align="left">
    <table dir="ltr" style="border:none;border-collapse:collapse;margin-bottom:.001pt;">
      <tr>
        <td style="border-bottom:solid #A3A3A3 1.0pt;border-left:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;border-top:solid #A3A3A3 1.0pt;padding-bottom:0;padding-left:5.4pt;padding-right:5.4pt;padding-top:0;vertical-align:top;width:56.8pt;">
          <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
            <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">#iperf -s </span>
          </p>
        </td>
      </tr>
    </table>
  </div>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:5pt;margin-left:0;margin-right:0;margin-top:5pt;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:14pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#222222;font-size:14pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:14pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:14pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Data Collection</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Simplified data collection:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#222222;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Relevant TCP/IP data collection is twofold, issue could be related to TCP/IP client or TCP/IP server, best if you collect simultaneously data on both ends at same time of 'failure', but depending on actual issue, you can start with single data set on TCP/IP client or TCP/IP server.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:5pt;margin-left:0.05in;margin-right:0;margin-top:5pt;">
    <span style="white-space:pre-wrap;color:#222222;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:5pt;margin-left:0.05in;margin-right:0;margin-top:5pt;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">D</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">ownload the latest version of&nbsp; tss_toolset*.zip from the public website:&nbsp; </span>
    <a href="https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/TSS">
      <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">https://github.com/CSS-Windows/WindowsDiag/tree/master/ALL/TSS</span>
    </a>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:5pt;margin-left:0.05in;margin-right:0;margin-top:5pt;">
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Expand zip file on local disk, i.e. in folder C:\Tools, open an elevated CMD window, CD&nbsp;</span>
    <span style="background:#FFFFFF;color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">C:\Tools, then start data collection using given TSS command line below.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:5pt;margin-left:0.05in;margin-right:0;margin-top:5pt;">
    <span lang="en-GB" style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">To automate analysis of the collected data, install the explorer extension to check for latest rollups, commonly known registry keys and a lot of other goodness:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:5pt;margin-left:0.05in;margin-right:0;margin-top:5pt;">
    <span lang="en-GB" style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp; </span>
    <a href="https://internal.support.services.microsoft.com/en-us/help/3070416">
      <span lang="en-GB" style="color:#0000FF;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">https://internal.support.services.microsoft.com/en-us/help/3070416</span>
    </a>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:5pt;margin-left:0.05in;margin-right:0;margin-top:5pt;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">The SDP is collected automatically when the script is stopped.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Run the following command on an administrative command prompt on the client and the server at the same time</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.50in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">TSS rOn General&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#222222;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">You might want to add the </span>
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">‘Video’</span>
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> switch on client OS to help understand exactly what the client did to reproduce the issue.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#222222;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">For advanced troubleshooting also consider adding ETL tracing for Afd, TCP and NetIO components by adding the switch ‘</span>
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">AfdTcp’</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#222222;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">The data collection will be stopped once you hit any key.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;color:#222222;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Note that the data collected might be exceptionally large depending on what is transferred over the network at the time. Make sure only the minimum of traffic that is necessary to reproduce the issue is transferred. Prevent all unnecessary </span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">activity on the machines and try to use commands from the command prompt rather than explorer to reduce noise where possible.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Manual data collection:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">ETL Tracing for AFD, TCP and NetIO</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">When collecting ETL/ETW Provider logging you need to be careful and understand what each provider does, </span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">what all drivers we trace</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">, </span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">why we trace</span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> and </span>
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">what GUID represents what driver</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> please refer below article for better understanding on the same:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:6pt;">
    <a href="https://internal.support.services.microsoft.com/en-us/help/4526096">
      <span style="color:#0000FF;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">https://internal.support.services.microsoft.com/en-us/help/4526096</span>
    </a>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-size:9pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#0C141F;font-size:9pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Start tracing:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">netsh trace start capture=yes overwrite=yes maxsize=4096 tracefile=c:\minio_sockets.etl provider={B40AEF77-892A-46F9-9109-438E399BB894} keywords=0xffffffffffffffff level=0xff provider={CDEAD503-17F5-4A3E-B7AE-DF8CC2902EB9} keywords=0xffffffffffffffff level=0xff provider={EB004A05-9B1A-11D4-9123-0050047759BC} keywords=0x3ffff level=0x5 provider=&quot;Microsoft-Windows-Winsock-AFD&quot; keywords=0x800000000000003f level=0x5 provider=&quot;Microsoft-Windows-TCPIP&quot; keywords=0x80007fff000000ff level=0x5</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-size:9pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="color:#0C141F;font-size:9pt;font-style:normal;font-weight:bold;margin:0;padding:0;">Stop tracing:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">netsh trace stop</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:0;">
    <span style="white-space:pre-wrap;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:italic;font-weight:normal;margin:0;padding:0;">Notes:</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">You can use Save As &gt; Export in MA to convert network packets to a CAP file.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Netmon can parse packets, but only parse events through Windows 7/2008 R2. You can install the last Connect parser to get limited Windows 8/2012 with SMB 3.0 parsing support.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">The ETL file will be compressed within the CAB file.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">ETL files larger than 2GB are extremely difficult to work with. The maximum workable ETL file size is roughly 1750 MB to 2048 MB.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Symbol;font-size:10pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;"></span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">The CAB file contains several useful details about the system. In particular, osinfo.txt, wcninfo.txt, and gpresult.txt.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:6pt;vertical-align:middle;">
    <span style="white-space:pre-wrap;color:#000000;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:6pt;">
    <span style="white-space:pre-wrap;color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:bold;margin:0;padding:0;">PowerShell</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Packet capturing in PowerShell is available in Windows 8.1+/2012 R2+. The PowerShell method will usually work when &quot;netsh trace&quot; has failed. PowerShell saves files in the ETL format. All&nbsp;</span>
    <a href="https://www.csssupportwiki.com/index.php/Networking_-_TCP/IP">
      <span style="color:#0000FF;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-decoration:underline;">ETL restrictions</span>
    </a>
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">&nbsp;apply.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.05in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Basic Packet Capture (Customer Ready)</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">1.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Open an elevated PowerShell Command Prompt (Run as administrator).</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">2.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Execute these commands to start the packet capture.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">New-NetEventSession -Name trace -LocalFilePath &quot;C:\$env:computername`_netCap.etl&quot; -MaxFileSize 1024</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Add-NetEventPacketCaptureProvider -SessionName trace -TruncationLength 1500</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Start-NetEventSession trace</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">3.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Reproduce the issue.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">4.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Run these commands to stop and clear the packet capture session. Please be aware that you cannot start a new packet capture until the existing session has been removed.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Stop-NetEventSession trace</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:0;">
    <span style="color:#222222;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Remove-NetEventSession trace</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0.43in;margin-right:0;margin-top:6pt;text-indent:-0.25in;vertical-align:middle;">
    <span style="color:#000000;display:inline-block;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;text-indent:0;width:0.250in;">5.</span>
    <span style="color:#000000;font-family:Calibri;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;">Upload&nbsp;C:\&lt;computername&gt;_netCap.etl&nbsp;to Microsoft for analysis.</span>
  </p>
  <p dir="ltr" style="font-family:Calibri;font-size:11pt;margin-bottom:0;margin-left:0;margin-right:0;margin-top:6pt;vertical-align:middle;">
    <span style="white-space:pre-wrap;color:#000000;font-size:11pt;font-style:normal;font-weight:normal;margin:0;padding:0;"> </span>
  </p>
</div></div><div><div><p style="margin:0cm 0cm 8pt;font-size:11pt;font-family:Calibri, sans-serif;margin-bottom:0cm;margin-bottom:.0001pt;"><span style="font-size:10.5pt;font-family:&quot;Segoe UI&quot;,sans-serif;color:black;">Contributing engineer: Mobin Mathew (momath@microsoft.com)<br style=""><br style=""></span></p><p style="margin:0cm 0cm 8pt;font-size:11pt;font-family:Calibri, sans-serif;"><span style="font-size:10.5pt;font-family:&quot;Segoe UI&quot;,sans-serif;color:black;">Feedback/
suggestions:&nbsp;<u><a href="mailto:networkflowdevs@microsoft.com;momath@microsoft.com?subject=TCPIP%20Performance%20Workflow%20feedback"><span style="color:blue;">EMAIL</span></a></u><br>
For more Windows Networking Workflows, go to:&nbsp;<span style="color:blue;"><a href="https://aka.ms/networkflows">https://aka.ms/networkflows</a></span></span></p></div></div>