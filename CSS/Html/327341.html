<header><h1>How To Troubleshoot the File Replication Service in Windows Server 2003</h1></header><div><span></span></div><div class='kb-securedata-section section'>DO NOT DELETE OR ARCHIVE THIS ARTICLE<br>This article is referenced by TechNet.<br>Contact the Content Business Manager for this product if you have any questions.</div><div class='kb-notice-section section'><a class='bookmark' id='toc'></a><h3 class='sbody-h3'>IN THIS TASK</h3><ul class='sbody-free_list'><li><a managed-link="" href='#1' target="" bookmark-id='1'>SUMMARY</a><ul class='sbody-free_list'><li><a managed-link="" href='#2' target="" bookmark-id='2'>Verify Disk Space</a></li><li><a managed-link="" href='#3' target="" bookmark-id='3'>Create a Test Scenario</a></li><li><a managed-link="" href='#4' target="" bookmark-id='4'>Verify That the Computers are Available on the Network</a></li><li><a managed-link="" href='#5' target="" bookmark-id='5'>Check Configurations in the Services Console</a></li><li><a managed-link="" href='#6' target="" bookmark-id='6'>Check Configuration in the Active Directory Sites and Services Console</a></li><li><a managed-link="" href='#7' target="" bookmark-id='7'>Share Access</a></li><li><a managed-link="" href='#8' target="" bookmark-id='8'>Examine the Log Files</a></li></ul></li></ul><a class='bookmark' id='1'></a></div><div class='kb-summary-section section'> This step-by-step article describes how to troubleshoot the File Replication service (FRS). The following procedures are all performed by a member of the administrators group on a computer that is running Windows Server 2003 Enterprise Edition. This article may be useful if FRS has stopped replicating content on your computer.<br><br><h3 class='sbody-h3'><a class='bookmark' id='2'></a>Verify Disk Space</h3> On computer A, look for free disk space on the source folder, the staging folder, and the database partition. On computer B, check the destination partition, the preinstall partition, and the database partition. <br> <ol class='sbody-num_list'><li>Click <span class='text-base'>Start</span>, click <span class='text-base'>Run</span>, type <span class='sbody-userinput'>Eventvwr.msc</span>, and then press ENTER.</li><li>In the console tree, double-click <span class='text-base'>File Replication Service</span>, and then look for the following two events in the display pane:<div class='sbody-error'> Event id:13511 Database is out of disk space.<br><br> Event id:13522 Staging directory is full. An outbound partner that has not connected for a while can cause this. Delete the connection and stop and restart FRS to force deletion of the staging files.<br></div></li></ol><h3 class='sbody-h3'><a class='bookmark' id='3'></a>Create a Test Scenario</h3> Create a test file on computer B, and then make sure it replicates to computer A.<br><br><h3 class='sbody-h3'><a class='bookmark' id='4'></a>Verify That the Computers are Available on the Network</h3> Verify that both computer A and computer B are available on the network. Because FRS uses the fully qualified domain name (FQDN) of the replica members, use a ping command that specifies the fully qualified name of the problem replicas: <br> <ol class='sbody-num_list'><li>On computer A, click <span class='text-base'>Start</span>, click <span class='text-base'>Run</span>, type <span class='sbody-userinput'>cmd</span>, and then click <span class='text-base'>OK</span>.</li><li>At the command prompt type, <span class='sbody-userinput'>ping<br><strong class='sbody-strong'>FQDN of computer B</strong></span>, and then press ENTER. Note the IP address for computer B.</li><li>At the command prompt type, <span class='sbody-userinput'>ping<br><strong class='sbody-strong'>FQDN of computer A</strong></span>, and then press ENTER. Note the IP address of computer A.</li><li>At the command prompt on computer A, type<br><span class='sbody-userinput'>IPCONFIG /all</span>, and then press ENTER. Make sure that all the information is correct and that the IP address matches the earlier results from the ping command.</li><li>At the command prompt on computer B, type<br><span class='sbody-userinput'>IPCONFIG /all</span>, and then press ENTER. Make sure that all the information is correct and that the IP address matches the earlier results from the ping command.</li></ol><h3 class='sbody-h3'><a class='bookmark' id='5'></a>Check Configurations in the Services Console</h3><ol class='sbody-num_list'><li>Start the Services Administrative console. To do so, click <span class='text-base'>Start</span>, click <span class='text-base'>Run</span>, type <span class='sbody-userinput'>services.msc</span>, and then click <span class='text-base'>OK</span>.</li><li>In the display pane, click <span class='text-base'>File Replication Service</span>, and then confirm that FRS is started and running.</li><li>Following this procedure on both computer A and B.</li><li>If the service is not running, review the FRS container in Event Viewer on the computer on which FRS is not running properly. To do so, click <span class='text-base'>Start</span>, click <span class='text-base'>Run</span>, type <span class='text-base'>Eventvwr.msc</span>, and then click <span class='text-base'>OK</span>. In the console tree, click <span class='text-base'>File Replication Service</span>, and then view the results in the display pane to the right.</li><li>Test the remote procedure call (RPC) connectivity between computer A and computer B. To do so, start Event Viewer on computer B from computer A (which uses RPC). Check FRS event logs on both computers. If Event ID 13508 is present, there may be a problem with the RPC service on either computer or with creating a secure connection between computer A and computer B.</li></ol><h3 class='sbody-h3'><a class='bookmark' id='6'></a>Check Configuration in the Active Directory Sites and Services Console</h3><ol class='sbody-num_list'><li>On computer A, click <span class='text-base'>Start</span>, point to <span class='text-base'>Administrative Tools</span>, and then click <span class='text-base'>Active Directory Sites and Service</span>. Make sure that the replication between computer A and computer B is turned on. Verify the replication schedule on the <span class='text-base'>Connection</span> object. The <span class='text-base'>Connection</span> object is the inbound connection under computer A&#39;s <span class='text-base'>NTFRS_MEMBER</span> object from computer B. For System Volume (SYSVOL), the <span class='text-base'>Connection</span> object is located in the Sites\<strong class='sbody-strong'>Site_name</strong>\Servers\<strong class='sbody-strong'>Server_name</strong>\Ntds Settings\<strong class='sbody-strong'>Connection_name</strong> folder.</li><li>On computer B, click <span class='text-base'>Start</span>, point to <span class='text-base'>Administrative Tools</span>, and then click <span class='text-base'>Active Directory Sites and Service</span>. Make sure that the replication between computer A and computer B is turned on.<br><br><span class='text-base'>NOTE</span>: For DFS, view the connection links in Active Directory Users and Computers. Start Active Directory Users and Computer, on the <span class='text-base'>View</span> menu, make sure that <span class='text-base'>Advanced Settings</span> are selected. View the System container. The location of the <span class='text-base'>Connection</span> objects is in the System\File Replication Service\DFS Volumes folder.</li></ol><h3 class='sbody-h3'><a class='bookmark' id='7'></a>Share Access</h3> Determine whether or not the file on the originating server is locked on either computer. If the file is locked on computer B so that FRS cannot read the file, FRS cannot generate the staging file, and this delays replication. If the file is locked on computer A so that FRS cannot update the file, FRS continues to retry the update until it succeeds. The retry interval is 30 to 60 seconds. <br><br> Determine whether or not the source file had been excluded from replication. Confirm that the file is not Encrypting File System (EFS) encrypted, an NTFS file system (NTFS) junction, or excluded by a file or folder filter on the originating replica member. If any of these situations are true, FRS does not replicate the file or folder.<br> <br><br><h3 class='sbody-h3'><a class='bookmark' id='8'></a>Examine the Log Files</h3> If the information in this article did not resolve the issue, use Windows Explorer to examine the log files that are created for FRS. The log files are located in the %Systemroot%\Debug folder. The file names are listed from NtFrs_001.log to NtFrs_005.log.<br><br></div><div class='kb-textlegacy-section section'>Author: A-RICOLI (2002-08-02T11:14:00) Edit Reviewer: V-MOVENS (2002-09-17T08:14:00) Tech Reviewer: BOBQIN (2002-09-15T22:57:00)<br> </div>