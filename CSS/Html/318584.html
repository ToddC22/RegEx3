<header><h1>You receive an &quot;Operation was attempted on something that is not a socket&quot; error message when you try to obtain an IP address</h1></header><div class='kb-symptoms-section section'> After you install a modem on your system, you may not be able to connect to the Internet. When you try to release and then renew the IP address, you may receive the following error message: <div class='sbody-error'> An operation was attempted on something that is not a socket.</div></div><div class='kb-cause-section section'> This behavior may occur if the WinSocks library or the TCP/IP stack are corrupted. </div><div class='kb-resolution-section section'> To resolve this issue, follow these steps. <br><br><span><span class='text-base'>Important</span> This section, method, or task contains steps that tell you how to modify the registry. However, serious problems might occur if you modify the registry incorrectly. Therefore, make sure that you follow these steps carefully. For added protection, back up the registry before you modify it. Then, you can restore the registry if a problem occurs. For more information about how to back up and restore the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/en-us/help/322756'>322756 </a> How to back up and restore the registry in Windows</div></span><ol class='sbody-num_list'><li>Click <span class='text-base'>Start</span>, and then click <span class='text-base'>Run</span>.</li><li>In the <span class='text-base'>Open</span> box, type <span class='sbody-userinput'>Regedit</span>, and then press ENTER.</li><li>Navigate to the following registry key:<div class='indent'><span class='text-base'>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Winsock</span></div></li><li>On the <span class='text-base'>Registry</span> menu, click <span class='text-base'>Export Registry File</span>.</li><li>In the <strong class='uiterm'>File name</strong> box, type the name of the backup file; for example, type <span class='sbody-userinput'>Winsock Registry key</span>, and then click <span class='text-base'>Save</span>. Note the name of the folder in which the registration file is saved.</li><li>Repeat steps 3 through 5 for the following registry key:<div class='indent'><span class='text-base'>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Winsock2</span></div></li><li>Delete the following keys from the registry:<div class='indent'><span class='text-base'>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Winsock</span><br><br><span class='text-base'>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Winsock2</span></div><span class='text-base'>NOTE</span>: Steps 3 through 6 backed up the two registry keys. You can use the backup files to restore the keys in the event that your computer displays unexpected behavior. For more information about how to restore registry keys from .reg files, search the Registry Editor Help files for the <strong class='uiterm'>Import or export registry keys</strong> topic.<br><br></li><li>Close the Registry Editor.</li><li>Locate the Nettcpip.inf file in %winroot%\inf, and then open the file in Notepad. </li><li>Locate the [MS_TCPIP.PrimaryInstall] section. Change the <strong class='uiterm'>Characteristics = 0xa0</strong> entry by  replacing <strong class='uiterm'>0xa0</strong> with <strong class='uiterm'>0x80</strong>. Save the file. Exit Notepad. </li><li>In Control Panel, double-click <strong class='uiterm'>Network Connections</strong>, right-click <strong class='uiterm'>Local Area Connection</strong>, and then select <strong class='uiterm'>Properties</strong>. </li><li>On the <strong class='uiterm'>General</strong> tab, click <strong class='uiterm'>Install</strong>, select <strong class='uiterm'>Protocol</strong>, and then click <strong class='uiterm'>Add</strong>. </li><li>In the Select Network Protocols window, click <strong class='uiterm'>Have Disk</strong>. </li><li>In the <strong class='uiterm'>Copy manufacturer&#39;s files from</strong> text box, type <span class='sbody-userinput'>c:\windows\inf</span>, and then click <strong class='uiterm'>OK</strong>. </li><li>Select <strong class='uiterm'>Internet Protocol (TCP/IP)</strong>, and then click <strong class='uiterm'>OK</strong>. <br><br><span class='text-base'>Note</span> This step  returns you to the Local Area Connection Properties screen. However,  the <strong class='uiterm'>Uninstall</strong> button is now available. </li><li>Select <strong class='uiterm'>Internet Protocol (TCP/IP)</strong>, click <strong class='uiterm'>Uninstall</strong>, and then click <strong class='uiterm'>Yes</strong>. </li><li>In Control Panel, double-click <strong class='uiterm'>Network Connections</strong>, right-click <strong class='uiterm'>Local Area Connection</strong>, and then select <strong class='uiterm'>Properties</strong>. </li><li>On the <strong class='uiterm'>General</strong> tab, click <strong class='uiterm'>Install</strong>, select <strong class='uiterm'>Protocol</strong>, and then click <strong class='uiterm'>Add</strong>. </li><li>In the Select Network Protocols window, click <strong class='uiterm'>Have Disk</strong>. </li><li>In the <strong class='uiterm'>Copy Manufacturer&#39;s files from</strong> text box, type <span class='sbody-userinput'>c:\windows\inf</span>, and then click <strong class='uiterm'>OK</strong>. </li><li>Select <strong class='uiterm'>Internet Protocol (TCP/IP)</strong>, and then click <strong class='uiterm'>OK</strong>. </li><li>Restart your computer.<br></li><li>Test your Internet connectivity.</li></ol></div><div class='kb-textlegacy-section section'>Author: V-1JOSB (2002-02-20T09:51:00) Edit Reviewer: V-RHOWAR (2002-04-08T14:54:00) Tech Reviewer: NATHAR (2002-03-15T11:32:00)<br></div>