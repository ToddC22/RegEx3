<header><h1>Environment variable may not expand %APPDATA% to the Application folder</h1></header><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/WinSERaid2/34647.asp' title='Link only available for Microsoft corporate network users' target='_blank'>34647 (WinSERaid2)</a></div><div class='kb-notice-section section'>This information also applies to Windows Server 2003. </div><div class='kb-symptoms-section section'> If you add %APPDATA% to any user or system environment variable by using the following method, %APPDATA% may not be resolved to the appropriate user application data folder:<ul class='sbody-free_list'><li>Right-click <strong class='uiterm'>My Computer</strong>, and then click <strong class='uiterm'>Properties</strong>. </li><li>On the <strong class='uiterm'>Advanced</strong> tab, click <strong class='uiterm'>Environment Variables</strong>.</li><li>Add a new user or system environment variable named PATH. Set the <strong class='uiterm'>Variable value</strong> entry to %APPDATA%.</li><li> Apply the settings.</li></ul> If you then start  a command session (Cmd.exe) and check the PATH environment variable by using the <span class='text-base'>set path</span> command, %APPDATA% may  not be expanded to the appropriate user application folder. Instead, you see &quot;%APPDATA%.&quot; <br><br>Problem example:<br> <pre class='sbody-pre'>   C:\ &gt;set PATH<br>   PATH=%APPDATA% </pre>Working example:<br> <pre class='sbody-pre'>   C:\ &gt;set PATH<br>   PATH=&quot;C:\Documents and Settings\&lt;UserName&gt;\Application&quot; </pre><br>If %APPDATA% is not resolved correctly, and you try to start a program that is located in the user application folder, the program does not start because the program cannot be located in the path.</div><div class='kb-cause-section section'> This behavior is caused by a problem in Shell32.dll.</div><div class='kb-workaround-section section'> To work around this problem, use the following method to set the environment variable:<ol class='sbody-num_list'><li> Right-click <strong class='uiterm'>My Computer</strong>, and then click <strong class='uiterm'>Manage</strong>.</li><li>In the left pane, right-click <strong class='uiterm'>Computer Management (Local)</strong>, and then click <strong class='uiterm'>Properties</strong>. </li><li>Click the <strong class='uiterm'>Advanced</strong> tab.</li><li>Under <strong class='uiterm'>Environment variables</strong>, click <strong class='uiterm'>Settings</strong>.</li><li> Add a new user or system environment variable named PATH, and set the Variable value entry to %APPDATA%.</li></ol>You can use this method to set any user or system environment variable.</div><div class='kb-status-section section'><span>Microsoft has confirmed that this is a problem in the Microsoft products that are listed at the beginning of this article. <br> </span></div><div class='kb-status-section section'>This problem will not be fixed in Windows 2000, Windows XP, or Windows Server 2003. It may be fixed in Windows Server 2008. </div><div class='kb-securedata-section section'>windir username</div>