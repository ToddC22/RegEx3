<header><h1>HOW TO: Create and Configure Active Server Pages (ASP) Web Applications in the Windows Server 2003</h1></header><div><span></span></div><div class='kb-securedata-section section'>DO NOT DELETE OR ARCHIVE THIS ARTICLE<br>This article is referenced by TechNet.<br>Contact the Content Business Manager for this product if you have any questions.</div><div class='kb-notice-section section'><span>For a Microsoft Windows 2000 version of this article, see<br> <a id='kb-link-1' href='/EN-US/help/308164'>308164 </a>. <br></span><a class='bookmark' id='toc'></a><h3 class='sbody-h3'>IN THIS TASK</h3><ul class='sbody-free_list'><li><a managed-link="" href='#1' target="" bookmark-id='1'>SUMMARY</a><ul class='sbody-free_list'><li><a managed-link="" href='#3' target="" bookmark-id='3'>How to Create an ASP Web Application</a></li><li><a managed-link="" href='#4' target="" bookmark-id='4'>How to Configure an ASP Web Application</a></li><li><a managed-link="" href='#5' target="" bookmark-id='5'>Example of How to Create an ASP Web Application in a New Web Site</a></li><li><ul class='sbody-free_list'><li><a managed-link="" href='#6' target="" bookmark-id='6'>Step 1: Create a Content Directory</a></li><li><a managed-link="" href='#7' target="" bookmark-id='7'>Step 2: Create an ASP Web Application</a></li><li><a managed-link="" href='#8' target="" bookmark-id='8'>Step 3: Create a Web site</a></li><li><a managed-link="" href='#9' target="" bookmark-id='9'>Step 4: Configure the ASP Web Application</a></li><li><a managed-link="" href='#10' target="" bookmark-id='10'>Step 5: Test the ASP Web Application</a></li></ul></li></ul></li><li><a managed-link="" href='#11' target="" bookmark-id='11'>REFERENCES</a></li></ul><a class='bookmark' id='1'></a></div><div class='kb-summary-section section'> This article describes how to create and configure Web applications in Internet Information Services (IIS) 6.0.<br><br> An IIS application is any file that is executed in a defined set of directories in your Web site. When you create an application, you designate the starting-point directory (also known as the <span class='sbody-italic'>application root</span>) in your Web site. Each file or folder in the starting-point directory is considered part of that application until another starting-point directory is created. You use directory boundaries to define the scope of a Web application.<br><br> In IIS 6.0, an application starting point is indicated by a <span class='sbody-italic'>package</span> icon if it is created for a virtual directory or physical directory. If it is created for a Web site, the starting point is indicated by a <span class='sbody-italic'>globe in a hand</span> icon.<br><br><h3 class='sbody-h3'><a class='bookmark' id='3'></a>How to Create an ASP Web Application</h3><ol class='sbody-num_list'><li>Start IIS Manager or open the IIS snap-in.</li><li>Expand <span class='text-base'><strong class='sbody-strong'>ServerName</strong></span>, where <span class='text-base'><strong class='sbody-strong'>ServerName</strong></span> is the name of the server, and then expand <span class='text-base'>Web Sites</span>.</li><li>Right-click the directory that you want to use as the application starting point, and then click <span class='text-base'>Properties</span>.<br><br><span class='text-base'>NOTE</span>: You can use the home directory of a Web site as the application starting point.</li><li>In the <strong class='uiterm'><strong class='sbody-strong'> DirectoryName</strong>Properties</strong> dialog box (where <strong class='sbody-strong'>DirectoryName</strong>is the name of the directory that you selected), do one of the following: <br><ul class='sbody-free_list'><li>If you selected a Web site, click the <span class='text-base'>Home Directory</span> tab.<br><br> -or-</li><li>If you selected a virtual directory, click the <span class='text-base'>Virtual Directory</span> tab.<br><br> -or-</li><li>If you selected a physical directory, click the <span class='text-base'>Directory</span> tab.</li></ul></li><li>Under <span class='text-base'>Application Settings</span>, click <span class='text-base'>Create</span>.<br><br><span class='text-base'>NOTE</span>: If the <span class='text-base'>Create</span> button is not present, a default application has already been specified. In this case, click <span class='text-base'>Remove</span> to remove the default application, and then click <span class='text-base'>Create</span>.</li><li>In the <strong class='uiterm'>Application name</strong> box, type the name of the application that you want. Note that the application starting point is displayed next to <strong class='uiterm'>Starting point</strong>.</li><li>In the <span class='text-base'>Execute Permissions</span> list, click the level of permissions that you want to give this application. For example, for ASP scripts or Internet Database Connector (IDC) scripts, click <strong class='uiterm'>Scripts only</strong>.<br><br><span class='text-base'>NOTE</span>: The <strong class='uiterm'>Scripts only</strong> option is more secure than the<br><strong class='uiterm'>Scripts and Executables</strong> option. </li><li>In the <span class='text-base'>Application Pool</span> box, click the option that you want, and then click <span class='text-base'>Apply</span>.</li><li>Click the <span class='text-base'>Documents</span> tab.</li><li>If your application uses a default document that is not displayed in the document list, click <span class='text-base'>Add</span>.</li><li>Type the name of the document in the <span class='text-base'>Default Document Name</span> box, and then click <span class='text-base'>OK</span>.</li><li>Select the newly added document, and then click<br><strong class='uiterm'>Move up</strong> until the new document is at the top of the document list.</li></ol><h3 class='sbody-h3'><a class='bookmark' id='4'></a>How to Configure an ASP Web Application</h3> Certain properties can be set for each ASP application that you have created. To configure an ASP application, follow these steps: <br> <ol class='sbody-num_list'><li>Start IIS Manager or open the IIS snap-in.</li><li>Expand <span class='text-base'><strong class='sbody-strong'>ServerName</strong></span>, where <span class='text-base'><strong class='sbody-strong'>ServerName</strong></span> is the name of the server, and then expand <span class='text-base'>Web Sites</span>.</li><li>Right-click the Web site or the starting-point directory of the application that you want, and then click <span class='text-base'>Properties</span>.</li><li>Depending on the starting-point directory that you selected, click the <span class='text-base'>Home Directory</span>, <span class='text-base'>Virtual Directory</span>, or <span class='text-base'>Directory</span> tab.</li><li>Under <span class='text-base'>Application Settings</span>, click <span class='text-base'>Configuration</span>, and then click the <span class='text-base'>Options</span> tab.</li><li>Click to select the <strong class='uiterm'>Enable session state</strong>check box if you want ASP to create a session for each user who accesses an ASP application.</li><li>Click to select the <strong class='uiterm'>Enable buffering</strong> check box if you want ASP to collect all output that is generated by the ASP page before the output is sent to the requesting Web browser.</li><li>Click to select the <strong class='uiterm'>Enable parent paths</strong>check box if you want ASP to use relative paths to the parent directory of the current directory (paths using the <span class='text-base'>..</span> syntax).<br><br><span class='text-base'>NOTE</span>: If you select this option, do not grant Execute permissions in the parent directories. This is to prevent a script in a subdirectory from running an unauthorized program in a parent directory.</li><li>In the <strong class='uiterm'>Default ASP language</strong> box, type the language that you want to use.<br><br> This box specifies the language that is used to process commands in the ASP delimiters (<span class='text-base'>&lt;%</span> and <span class='text-base'>%&gt;</span>). Note that VBScript is the default ASP language.<br><br><span class='text-base'>NOTE</span>: You can override the default language in your ASP page by using the <span class='text-base'>&lt;%@LANGUAGE%&gt;</span> directive.</li><li>In the <strong class='uiterm'>ASP Script timeout</strong> box, type the length of time that want the ASP to allow a script to run.<br><br><span class='text-base'>NOTE</span>: You can set the time-out period to a value ranging from 1 to 2147483647.</li><li>Click <span class='text-base'>OK</span> two times to save your changes and return to the Internet Information Services window.</li><li>Quit IIS Manager or close the IIS snap-in.</li></ol><h3 class='sbody-h3'><a class='bookmark' id='5'></a>Example of How to Create an ASP Web Applicationin a New Web Site</h3> The following example illustrates how to create an ASP application in a new Web site in IIS.<br><br><span class='text-base'>NOTE</span>: This example assumes the default installation of Windows Server 2003 is on drive C. <h4 class='sbody-h4'><a class='bookmark' id='6'></a>Step 1: Create a Content Directory</h4><ol class='sbody-num_list'><li>Start Windows Explorer, and then navigate to the following location:<div class='indent'><span class='text-base'>C:\Inetpub</span></div></li><li>On the <span class='text-base'>File</span> menu, point to <span class='text-base'>New</span>, and then click <span class='text-base'>Folder</span>.</li><li>In the <span class='text-base'>New Folder</span> box, type <span class='sbody-userinput'>Content</span>, and then press ENTER.</li><li>Quit Windows Explorer.</li></ol><br><h4 class='sbody-h4'><a class='bookmark' id='7'></a>Step 2: Create an ASP Web Application</h4><ol class='sbody-num_list'><li>Start Notepad.</li><li>In the Notepad window, type the following code:<div class='sbody-code'><pre><code>&lt;HTML&gt;<br>&lt;HEAD&gt;&lt;TITLE&gt;ASP Web Application&lt;/TITLE&gt;&lt;/HEAD&gt;<br>&lt;BODY BGCOLOR=white&gt;<br>&lt;H1&gt;ASP Web Application&lt;/H1&gt;<br>&lt;HR&gt;<br>Type your name<br>&lt;FORM METHOD=POST ACTION=Output.asp&gt;<br>&lt;INPUT TYPE=TEXT NAME=&quot;username&quot;&gt;<br>&lt;INPUT TYPE=SUBMIT&gt;<br>&lt;/FORM&gt;<br>&lt;/BODY&gt;<br>&lt;/HTML&gt;<br></code></pre></div></li><li>On the <span class='text-base'>File</span> menu, click <span class='text-base'>Save As</span>.</li><li>In the <span class='text-base'>Save As</span> dialog box, navigate to <span class='text-base'>Content</span> in the <strong class='uiterm'>Save in</strong> box, click <span class='text-base'>All Files</span> in the <strong class='uiterm'>Save as type</strong> box, type<br><span class='sbody-userinput'>Input.htm</span> in the <strong class='uiterm'>File name</strong> box, and then click <span class='text-base'>Save</span>.</li><li>On the <span class='text-base'>Edit</span> menu, click <span class='text-base'>Select All</span>, and then click <span class='text-base'>Delete</span> on the <span class='text-base'>Edit</span> menu.</li><li>In the Notepad window, type the following code:<div class='sbody-code'><pre><code>&lt;HTML&gt;<br>&lt;HEAD&gt;&lt;TITLE&gt;ASP Web Application&lt;/TITLE&gt;&lt;/HEAD&gt;<br>&lt;BODY BGCOLOR=white&gt;<br>&lt;P&gt;You typed:<br><br>&lt;%<br>NAME=REQUEST.FORM(&quot;username&quot;)<br>RESPONSE.WRITE(NAME)<br>%&gt;<br>&lt;/P&gt;<br>&lt;/BODY&gt;<br>&lt;/HTML&gt;<br></code></pre></div></li><li>On the <span class='text-base'>File</span> menu, click <span class='text-base'>Save As</span>.</li><li>In the <span class='text-base'>Save As</span> dialog box, click <span class='text-base'>Content</span> in the <strong class='uiterm'>Save in</strong> list, click <span class='text-base'>All Files</span> in the <strong class='uiterm'>Save as type</strong> list, type<br><span class='sbody-userinput'>Output.asp</span> in the <strong class='uiterm'>File name</strong> list, and then click <span class='text-base'>Save</span>.<br><br> The Content folder contains the Input.htm file and the Output.asp file.</li><li>Quit Notepad.</li></ol><h4 class='sbody-h4'><a class='bookmark' id='8'></a>Step 3: Create a Web Site</h4><ol class='sbody-num_list'><li>Start IIS Manager or open the IIS snap-in.</li><li>Expand <span class='text-base'><strong class='sbody-strong'>ServerName</strong></span>, where <span class='text-base'><strong class='sbody-strong'>ServerName</strong></span> is the name of the server, and then expand <span class='text-base'>Web Sites</span>.</li><li>Right-click <span class='text-base'>Default Web Site</span>, and then click <span class='text-base'>Stop</span>.</li><li>Right-click <span class='text-base'>Web Sites</span>, point to <span class='text-base'>New</span>, and then click <span class='text-base'>Web Site</span>.<br><br> The Web Site Creation Wizard starts.</li><li>Click <span class='text-base'>Next</span>.</li><li>On the Web Site Description page, type<br><span class='sbody-userinput'>Example</span> in the <span class='text-base'>Description</span> box, and then click <span class='text-base'>Next</span>.</li><li>On the IP Address and Port Settings page, click <span class='text-base'>Next</span>.</li><li>On the Web Site Home Directory page, type<br><span class='sbody-userinput'>c:\inetpub\content</span> in the <span class='text-base'>Path</span> box, and then click <span class='text-base'>Next</span>.</li><li>On the Web Site Access Permissions page, verify that only the following check boxes are selected:<div class='indent'><span class='text-base'>Read<br></span><span class='text-base'>Run scripts (such as ASP)</span></div></li><li>Click <span class='text-base'>Next</span>, and then click <span class='text-base'>Finish</span>. <br><br> The Example Web site is created and you are returned to the Internet Information Services window.</li></ol><h4 class='sbody-h4'><a class='bookmark' id='9'></a>Step 4: Configure the ASP Web Application</h4><ol class='sbody-num_list'><li>In the Internet Information Services window, right-click <span class='text-base'>Example</span>, and then click <span class='text-base'>Properties</span>.</li><li>Click the <span class='text-base'>Home Directory</span> tab.</li><li>Under <span class='text-base'>Application Settings</span>, click <span class='text-base'>Create</span>.<br><br><span class='text-base'>NOTE</span>: If the <span class='text-base'>Create</span> button is not present, a default application has already been specified. In this case, click <span class='text-base'>Remove</span> to remove the default application, and then click <span class='text-base'>Create</span>.</li><li>Clear the contents of the <strong class='uiterm'>Application name</strong>box, and then type <span class='sbody-userinput'>Example</span>.</li><li>Click the <span class='text-base'>Documents</span> tab, and then click <span class='text-base'>Add</span>.</li><li>In the <span class='text-base'>Default Document Name</span> box, type <span class='sbody-userinput'>Input.htm</span>, and then click <span class='text-base'>OK</span>.</li><li>In the document list, click <span class='text-base'>Input.htm</span>, and then click <strong class='uiterm'>Move up</strong> until Input.htm is at the top of the list.</li><li>Click <span class='text-base'>OK</span>.<br><br> You are returned to the Internet Information Services window.</li></ol><h4 class='sbody-h4'><a class='bookmark' id='10'></a>Step 5: Test the ASP Web Application</h4><ol class='sbody-num_list'><li>Right-click <span class='text-base'>Example</span>, and then click <span class='text-base'>Browse</span>.<br><br> The ASP Web Application page is displayed in the right pane of the Internet Information Services window.</li><li>In the <strong class='uiterm'>Type your name</strong> box, type your name, and then click <span class='text-base'>Submit Query</span>.<br><br> A message similar to the following is displayed in the right pane of the Internet Information Services window, where<br><strong class='sbody-strong'>name</strong> is the name that you typed:<div class='indent'>You typed: <strong class='sbody-strong'>name</strong></div></li></ol> To remove the Example Web site and restart the Default Web Site, follow these steps: <br> <ol class='sbody-num_list'><li>Remove the Example Web site: <br><br> In the Internet Information Services window, right-click <span class='text-base'>Example</span>, click <span class='text-base'>Delete</span>, and then click <span class='text-base'>Yes</span> when the following message appears:<div class='indent'>Are you sure you want to delete this item?<br></div><span class='text-base'>NOTE</span>: This procedure does not remove the Content directory or the files that it contains.<br><br></li><li>To restart the Default Web Site, right-click <span class='text-base'>Default Web Site</span>, and then click <span class='text-base'>Start</span>.<br><br> The Default Web Site is restarted.</li></ol><a class='bookmark' id='11'></a></div><div></div><div class='kb-securedata-section section'>At the time of writing, the IIS online documentation is not yet available. Please complete when this information becomes available.<br><br><br> Additional information about ASP applications is available in the IIS 6.0 documentation. If you have IIS installed, start Internet Explorer, and then browse to the following topic: <div class='indent'><a id='kb-link-3' href='http://localhost/iishelp/iis/misc/default.asp' target='_self'>http://localhost/iisHelp/iis/misc/default.asp</a></div></div><div class='kb-references-section section'> For additional information about Microsoft ASP, visit the following Microsoft Web site: <div class='indent'><a id='kb-link-4' href='http://msdn2.microsoft.com/en-us/library/ms972347.aspx' target='_self'>http://msdn2.microsoft.com/en-us/library/ms972347.aspx</a></div> For additional information about scripting, visit the following Microsoft Web site: <div class='indent'><a id='kb-link-5' href='http://msdn2.microsoft.com/en-us/library/ms950396.aspx' target='_self'>http://msdn2.microsoft.com/en-us/library/ms950396.aspx</a></div></div><div class='kb-securedata-section section'>kbappsvc</div><div class='kb-textlegacy-section section'>DOC INFO: Author is: V-DEISLE Author: V-DEISLE (2002-06-07T12:41:00) Edit Reviewer: V-RHOWAR (2002-07-15T12:43:00) Tech Reviewer: LPRETE (2002-07-09T16:04:00) </div>