<header><h1>Registry Key to Allow Session Keys to Be Sent in Kerberos Ticket-Granting-Ticket</h1></header><div></div><div class='kb-securedata-section section'>Microsoft Windows .NET Standard Server Beta <br>Microsoft Windows .NET Enterprise Server Beta<br></div><div class='kb-notice-section section'><span><span class='text-base'>IMPORTANT</span>: This article contains information about modifying the registry. Before you modify the registry, make sure to back it up and make sure that you understand how to restore the registry if a problem occurs. For information about how to back up, restore, and edit the registry, click the following article number to view the article in the Microsoft Knowledge Base:<br><div class='indent'><a id='kb-link-1' href='/EN-US/help/256986'>256986 </a> Description of the Microsoft Windows Registry<br></div></span></div><div class="kb-summary-section section">To provide better security, Microsoft has restricted an interface to retrieve ticket-granting-ticket/session key pairs from the Kerberos security package. Because some third-party programs may require this functionality to operate properly, the following information has been provided so you can re-enable this interface.</div>
<div><span><span class="text-base">WARNING</span>: If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.</span><br>
<br>
Previous to the change that is described in the &quot;Summary&quot; section of this article, programs could use the Win32 <span class="text-base">LsaCallAuthenticationPackage</span> API specifying <span class="text-base">KERB_RETRIEVE_TICKET_REQUEST</span> and either <span class="text-base">KerbRetrieveEncodedTicketMessage</span> or <span class="text-base">KerbRetrieveTicketMessage</span> message types to retrieve a Kerberos ticket-granting-ticket (TGT) and the associated session key.<br>
<br>
The registry value to include a session key in the TGT:<br>
<code><span class="text-base">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\Kerberos\Parameters</span></code></div>

<p>Value Name: <span class="text-base">allowtgtsessionkey</span><br>
Value Type: <strong>REG_SZ</strong><br>
Value Range: <span class="text-base">0</span> or <span class="text-base">1</span> (default of 0) &nbsp;</p>

<ul class="sbody-free_list">
	<li>0: The <span class="text-base">KerbRetrieveEncodedTicketMessage</span> response will not include a session key that allows this TGT to be used for logon.</li>
	<li>1: Indicates that a session key should be returned with the TGT according to current behavior.</li>
</ul>

<p><span><span lang="EN-US"><span><strong>Note</strong>&nbsp;With Windows 10 and Credential Guard, this approach is permanently disabled.</span></span></span></p>
<div class='kb-securedata-section section'>Possible wording for the text in Group policy: &quot;Network Security: Allow Kerberos TGT and session key to be exported from user&#39;s logon session.&quot;<br><br>This behavior takes affect on Windows .NET Server and Windows 2000 SP3.<br></div><div class='kb-securedata-section section'> mit ms2mit</div><div class='kb-textlegacy-section section'>WinSERaid2:20937 Author: slight (2001-09-21T10:04:00) Edit Reviewer: cgolden (2001-10-15T21:37:00) Tech Reviewer: TIMTHO (2001-10-15T13:48:00)<br></div>