<header><h1>You experience synchronization problems if you do not disable the cache option for offline files on roaming user profile shares in Windows Server 2003</h1></header><div class='kb-notice-section section'><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/9925.asp' title='Link only available for Microsoft corporate network users' target='_blank'>9925 (Content Maintenance)</a></p></div></div></div></div><span><div class='kb-notice-section section'> For a Microsoft Windows 2000 version of this article, see<br> <a id='kb-link-1' href='/en-us/help/287566'>287566 </a>. </div></span></div><div class='kb-symptoms-section section'>By using roaming user profiles in Microsoft Windows Server 2003, you may experience synchronization problems if you do not disable the cache option for offline files. The user profile may become unstable when both offline files and roaming user profiles try to synchronize the files in a user&#39;s profile. </div><div class='kb-cause-section section'> This issue occurs because the cache option for offline files is based on the Server Message Block (SMB) protocol, and the cache option is SMB share-based.<br><br> If the cache option is enabled on a shared folder, any files that are created on the remote shared folder from the local computer can be cached. However, this action may cause synchronization problems if one of the following conditions is true: <br> <ul class='sbody-free_list'><li>The cache option is enabled on a shared folder where roaming user profiles are located.</li><li>The cache option is enabled on a shared folder where roaming user profiles are accessed through a path where the cache option is enabled.</li></ul> If a roaming user profile is located inside a shared folder where the cache option is enabled, offline files are cached in the user&#39;s profile as they are copied to and from the server. This functionality is designed to handle situations where programs work with new copies of a file and then rename the original file. (In other words, all files that are created on the remote shared folder from the local computer are cached.)<br><br> Because a roaming user profile can copy the files in the user&#39;s profile to temporary files on the server share and then rename these files, the files in the user&#39;s profile are added to the cache. </div><div class='kb-workaround-section section'> To work around this issue, create a separate shared folder to store the user profiles, and then disable the cache option on that shared folder. <br><br><span class='text-base'>Notes</span><ul class='sbody-free_list'><li>You can disable the cache option only on shared folders that are hosted by computers that run Windows Server 2003 or Microsoft Windows 2000 Server.</li><li>We recommend that you store the roaming user profiles and the offline-enabled shared folders on a separate server, whenever possible.</li></ul> To disable the cache option by using the command line, follow these steps on the local computer where the shared folder resides:<br> <ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>CMD</span> in the <strong class='uiterm'>Open</strong> box, and then click <strong class='uiterm'>OK</strong>. </li><li>At the command prompt, type <span class='sbody-userinput'>net share<br><strong class='sbody-strong'>sharename</strong> /cache:no</span>, where<br><strong class='sbody-strong'>sharename</strong> is the name of the shared folder.</li></ol>To enable the cache option by using the command line, follow these steps on the local computer where the shared folder resides: <br> <ol class='sbody-num_list'><li>Click <strong class='uiterm'>Start</strong>, click <strong class='uiterm'>Run</strong>, type <span class='sbody-userinput'>CMD</span> in the <strong class='uiterm'>Open</strong> box, and then click <strong class='uiterm'>OK</strong>. </li><li>At the command prompt, type <span class='sbody-userinput'>net share<br><strong class='sbody-strong'>sharename</strong>/cache:yes</span>, where<br><strong class='sbody-strong'>sharename</strong> is the name of the shared folder.<br></li></ol><br> To disable the cache option through the user interface, follow these steps: <br> <ol class='sbody-num_list'><li>Locate the shared folder by using Windows Explorer.<br></li><li>Right-click the folder, and then click<br><strong class='uiterm'>Properties</strong>. </li><li>Click the <strong class='uiterm'>Sharing</strong> tab, click<br><strong class='uiterm'>Offline Settings</strong>, and then click <strong class='uiterm'>Files or programs from the share will not be available offline</strong>.</li></ol></div><div class='kb-status-section section'><span> This behavior is by design.</span></div><div class='kb-moreinformation-section section'>You must disable the cache option for offline files on shared folders where roaming user profiles are stored. If you want to store offline-enabled redirected folders and roaming user profiles on the same server, they must be in separate shared folders.</div><div class='kb-securedata-section section'> Author:davidgaz <br> Writer: Darryl Gittins V-DGit <br>  Tech Reviewer: v-jomcc<br> Editor: v-rhowar</div>