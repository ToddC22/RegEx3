<header><h1>How to specify regional and language settings for an unattended installation of Windows MultiLanguage Version in Windows Server 2003</h1></header><div><span></span></div><div class='kb-securedata-section section'>DO NOT DELETE OR ARCHIVE THIS ARTICLE<br>This article is referenced by TechNet.<br>Contact the Content Business Manager for this product if you have any questions.</div><div class='kb-notice-section section'><span>For a Microsoft Windows XP version of this article, see<br> <a id='kb-link-1' href='/EN-US/help/289125'>289125 </a>. <br></span><a class='bookmark' id='toc'></a><h3 class='sbody-h3'>IN THIS TASK</h3><ul class='sbody-free_list'><li><a managed-link="" href='#1' target="" bookmark-id='1'>SUMMARY</a><ul class='sbody-free_list'><li><a managed-link="" href='#2' target="" bookmark-id='2'>Unattend.txt File Settings</a></li><li><a managed-link="" href='#3' target="" bookmark-id='3'>Syntax</a></li></ul></li><li><a managed-link="" href='#4' target="" bookmark-id='4'>REFERENCES</a></li></ul><a class='bookmark' id='1'></a></div><div> This article describes the regional and language settings that you can specify for an unattended installation of Windows MultiLanguage Version.<br><br> Added support for default locale, input locale, and user interface (UI) language-related settings is included in the Unattend.txt answer file.<br><br><h3 class='sbody-h3'><a class='bookmark' id='2'></a>Unattend.txt Settings</h3> The following settings are relevant for an Unattend.txt file when you configure Windows MultiLanguage version-related settings during an unattended installation: <div class='indent'>[RegionalSettings]<br><span class='text-base'>Language</span> = <strong class='sbody-strong'>locale ID</strong><br><span class='text-base'>LanguageGroup</span> = <strong class='sbody-strong'>language group ID</strong>,<br> <strong class='sbody-strong'>language group ID</strong><br><span class='text-base'>SystemLocale</span> = <strong class='sbody-strong'>locale ID</strong><br><span class='text-base'>UserLocale</span> = <strong class='sbody-strong'>locale ID</strong><br><span class='text-base'>InputLocale</span> = <strong class='sbody-strong'>locale ID</strong>:<strong class='sbody-strong'>keyboard layout ID</strong>, <strong class='sbody-strong'>locale ID</strong>:<strong class='sbody-strong'>keyboard layout ID</strong><br><span class='text-base'>UserLocale_DefaultUser</span> = <strong class='sbody-strong'>locale ID</strong><br><span class='text-base'>InputLocale_DefaultUser</span> = <strong class='sbody-strong'>locale ID</strong>:<strong class='sbody-strong'>keyboard layout ID</strong></div> Two settings are ignored in Unattend.txt and Sysprep.inf, and are specific to computers that have the MultiLingual User Interface Packs installed. You can use these settings only by invoking the Regional and Language Options control panel applet in an unattended fashion: <div class='indent'><span class='text-base'>MUILanguage</span> = <strong class='sbody-strong'>language ID</strong><br><span class='text-base'>MUILanguage_DefaultUser</span> = <strong class='sbody-strong'>language ID</strong></div><h3 class='sbody-h3'><a class='bookmark' id='3'></a>Syntax</h3><ul class='sbody-free_list'><li><span class='text-base'>Language</span> - This setting specifies the language that is installed. If this setting is specified, the <span class='text-base'>SystemLocale</span>, <span class='text-base'>InputLocale</span>, and <span class='text-base'>UserLocale</span> settings are ignored.</li><li><span class='text-base'>LanguageGroup</span> - This setting specifies the language support that is installed on the computer. If this setting is specified, it provides the default settings for the <span class='text-base'>InputLocale</span>, <span class='text-base'>SystemLocale</span>, and <span class='text-base'>UserLocale</span> settings.</li><li><span class='text-base'>SystemLocale</span> - This setting enables programs that do not use Unicode to run and display menus and dialog boxes in the localized language. If a localized program does not display correctly on the computer, setting the system locale to match the language of the localized program may resolve the problem. However, this setting is network-wide, so it is not possible to support simultaneously the localized programs that do not use Unicode for multiple languages.</li><li><span class='text-base'>UserLocale</span> - This setting controls the settings for sorting numbers, time, currency, and dates.</li><li><span class='text-base'>InputLocale</span> - This setting specifies the input locale and keyboard layout combinations. If multiple locales are specified, the first keyboard layout that is specified becomes the computer default. The specified combinations must be supported by one of the languages that is defined by using either the <span class='text-base'>LanguageGroup</span> setting or the default language for the language version of Windows Server 2003 that is being installed. If an available language does not support the specified combination, the default combination is used. This setting is ignored if the <span class='text-base'>Language</span> setting is specified.</li><li><span class='text-base'>UserLocale_DefaultUser</span>- This setting sets the user locale for the default user. The user locale controls the settings for numbers, time, currency, and dates. The specified user locale must be supported by one of the languages that is specified by using the <span class='text-base'>LanguageGroup</span> setting, or the default language for the version of Windows Server 2003 that is being installed.</li><li><span class='text-base'>MUILanguage</span>- This setting sets the UI language for the current user on a Windows MultiLanguage Version-based computer. This setting is intended for post-Setup configuration, when the Windows MultiLanguage Version language that you want is already installed.</li><li><span class='text-base'>InputLocale_DefaultUser</span> - This setting sets the input locale and keyboard layout combinations for the default user.</li><li><span class='text-base'>MUILanguage</span>- This setting sets the UI language for the current user on a Windows MultiLanguage Version-based computer. This setting is intended for post-Setup configuration, when the Windows MultiLanguage Version language that you want is already installed.</li><li><span class='text-base'>MUILanguage_DefaultUser</span> - This setting sets the UI language for the default user profile, which includes the logon language and the default UI language that is applied to all new user accounts.</li></ul> To use an answer file to modify [RegionalSettings] items after Setup or Sysprep is complete: <br> <ol class='sbody-num_list'><li>Create an answer file that contains the [RegionalSettings] section items you want to modify, and then save it (for example, as c:\regopts.txt).</li><li>Create a batch file by using the following command line to apply the answer file settings:<div class='indent'><span class='sbody-userinput'>rundll32.exe shell32,Control_RunDLL intl.cpl,,/f:&quot;c:\regopts.txt&quot;</span></div></li></ol><span class='text-base'>NOTE</span>: You can apply any of the settings that are valid in the [RegionalSettings] section this way, but you must use this method to apply the <span class='text-base'>MuiLanguage</span> and <span class='text-base'>MuiLanguage_DefaultUser</span> settings because they are not valid in Unattend.txt and Sysprep.inf answer files. You can apply them, however, by including your batch file in the GuiRunOnce section of your Unattend.txt or Sysprep.inf file. For more information about GuiRunOnce, see the Microsoft Windows Preinstallation Reference file,  Ref.chm in the Support\Tools\Deploy.cab folder on your Windows Server 2003 installation media. <br> </div><div class='kb-securedata-section section'><h3 class='sbody-h3'>Sample Script for Using the Rundll32 Method to Change Regional and Language Options Items</h3><pre class='sbody-pre'><br>:: ------------------------------- Begin regopts.cmd -----------------------------------------<br>::This file contains both the command line and the answer file for an <br>::unattended application of Regional and Language Options settings<br><br><br>:GenAnswerFile<br>:: This section spits out the answer file we&#39;re going to use to c:\regopts.txt<br><br>echo [RegionalSettings] &gt; c:\regopts.txt<br>echo LanguageGroup = 1,7,10 &gt;&gt; c:\regopts.txt<br>echo SystemLocale = 0407 &gt;&gt; c:\regopts.txt<br>echo UserLocale = 0407 &gt;&gt; c:\regopts.txt<br>echo InputLocale = 0407:00000407 &gt;&gt; c:\regopts.txt<br>echo MUILanguage = 0407 &gt;&gt; c:\regopts.txt<br>echo UserLocale_DefaultUser = 0407 &gt;&gt; c:\regopts.txt<br>echo InputLocale_DefaultUser = 0407:00000407 &gt;&gt; c:\regopts.txt<br>echo MUILanguage_DefaultUser = 0407 &gt;&gt; c:\regopts.txt<br>::   Language = 0407 ;we&#39;re not using this one<br><br><br>:regopts<br>:: This section does the work and uses the file we created <br>:: above as our answer file for the commandline<br><br>rundll32 shell32,Control_RunDLL intl.cpl,,/f:&quot;c:\regopts.txt&quot;<br><br>:cleanup<br>:: Get rid of the answer file and exit<br><br>del c:\regopts.txt<br>:: -------------------------------- End regopts.cmd ------------------------------------------<br> </pre></div><div class='kb-securedata-section section'>MUI</div><div class='kb-textlegacy-section section'>DOC INFO: kbWinNETServSearch kbWinNETSearch kbWinNETAdvServSearch Author: jminck (2002-07-03T08:27:00) Edit Reviewer: V-DIANAG (2002-07-24T10:34:00) Tech Reviewer: WELLSLUO (2002-07-17T20:50:00)<br> </div>