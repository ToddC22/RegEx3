<header><h1>Kerberos is not used when you connect to SMB shares by using IP address</h1></header><div class='kb-symptoms-section section'>When you connect to  remote Server Message Block (SMB) services shares by using \\192.x.y.z\<strong class='sbody-strong'>share name</strong>, Kerberos is not used, and the Internet Protocol (IP) SMB file share access does not use Kerberos. A network trace shows the following Kerberos error in the KRB_ERROR:<br><br><div class='sbody-error'>Server not found in Kerberos database<br></div></div><div class='kb-cause-section section'>By default, Microsoft Windows Server 2003 and Microsoft Windows 2000 try to use Kerberos as the security provider. When a client uses Kerberos to authenticate itself to a server, the client requests a session ticket for the Service Principal Name (SPN). IP addresses are not names, so Kerberos is not used. After this occurs, the server goes through the list of the other supported security providers.<br></div><div class='kb-status-section section'><span>This behavior is by design.</span></div><div>IP addresses typically change, and it is not workable to add these addresses as SPNs. An SPN can be one of the following:<br><br><ul class='sbody-free_list'><li>The DNS name for the domain.</li><li>The DNS name of a host.</li><li>The distinguished name of a service connection point object.</li></ul></div><div class='kb-securedata-section section'>You can use the SetSPN tool from the resource kit to add the IP address as a host. With this process, you can use Kerberos. The <span class='sbody-userinput'>SetSPN -A HOST\<strong class='sbody-strong'>IP Address</strong></span> command adds the IP record as a host so that it can be found in the database. After you run this command, Kerberos is used.<br></div><div class='kb-textlegacy-section section'>Author: JERAMYJ (2002-05-13T17:44:00) Edit Reviewer: cgolden (2002-06-11T22:59:00) Tech Reviewer: BOBQIN (2002-06-11T19:05:00)<br></div>