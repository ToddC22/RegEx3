<header><h1>Shadowing an RDP session on Windows Server 2008 R2 may fail when Aero is enabled</h1></header><div class='kb-symptoms-section section'>When attempting to shadow (Remote Control) a session on Windows Server 2008 R2 that has Aero enabled, you may receive the following error:<br><br><div class='indent'>The Terminal Server security layer detected an error in the protocol stream and has disconnected the client.</div><br>When this occurs, the shadowing client disconnects.<br>In addition, you may see both of the following events listed in the System event log:<br><br>Log Name:&#160;&#160;&#160;&#160;&#160; System<br>Source:&#160;&#160;&#160;&#160;&#160;&#160;&#160; TermDD<br>Date:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 4/5/2011 1:14:24 PM<br>Event ID:&#160;&#160;&#160;&#160;&#160; 50<br>Task Category: None<br>Level:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Error<br>Keywords:&#160;&#160;&#160;&#160;&#160; Classic<br>User:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; N/A<br>Computer:&#160;&#160;&#160;&#160;&#160; computername.domain.com<br>Description:<br>The RDP protocol component WD detected an error in the protocol stream and has disconnected the client.<br><br><br>Log Name:&#160;&#160;&#160;&#160;&#160; System<br>Source:&#160;&#160;&#160;&#160;&#160;&#160;&#160; TermDD<br>Date:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 4/5/2011 1:14:24 PM<br>Event ID:&#160;&#160;&#160;&#160;&#160; 56<br>Task Category: None<br>Level:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Error<br>Keywords:&#160;&#160;&#160;&#160;&#160; Classic<br>User:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; N/A<br>Computer: computername.domain.com<br>Description:<br>The Terminal Server security layer detected an error in the protocol stream and has disconnected the client. Client IP: fe80:0000:0000:0000:e499:f014:83ea:8221.<br></div><div class='kb-workaround-section section'>This occurs because Aero is not supported within a shadowed session. To work around this issue, do not attempt to shadow a client with Aero enabled.<br><br><span class='text-base'>Note:</span>&#160;The existence of the Dwm.exe process in the user session indicates that Aero is enabled for that session.<div class='kb-moreinformation-section section'>Aero is the name for the enhanced graphics available on Windows Vista, Windows 7, Windows Server 2008 and Windows Server 2008 R2. This feature allows visual elements to implement transparency, Aero Peek, live preview of taskbar items and other features. <br><br><span class='text-base'>Note: </span>Aero is only supported during remote sessions beginning with Windows Server 2008 R2. Any instance of the errors above that does not occur on Windows Server 2008 R2 with Aero enabled cannot be due to the issue described in this article.<br><br>Remote Control, also known as shadowing, is the ability to view&#160;and interact with an existing RDP session initiated by another user. This would allow an administrator for instance to view or control a user&#39;s existing RDP session. More information on Remote Control can be found at the following links:<br><br><a id='kb-link-1' href='http://technet.microsoft.com/en-us/library/cc772355(ws.10).aspx' target='_self'>http://technet.microsoft.com/en-us/library/cc772355(WS.10).aspx</a><br></div><a id='kb-link-2' href='/help/292190' target='_self'>http://support.microsoft.com/kb/292190</a><br></div><div class='kb-securedata-section section'>Steps to reproduce: <br>Product Bug Number:<br><br>Author ID (email alias):&#160;timothyn<br>Writer ID (email alias): timothyn<br>Tech Review ID (email alias): gavinl<br>Confirm Article has been Tech Reviewed: Yes<br>Confirm Article released for Publishing: Yes/No<br></div>