<header><h1>How to use command line parameters with the Ntbackup command in Windows Server 2003</h1></header><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/4873.asp' title='Link only available for Microsoft corporate network users' target='_blank'>4873 (Content Maintenance)</a></div><div class='kb-notice-section section'><a class='bookmark' id='toc'></a><h3 class='sbody-h3'>IN THIS TASK</h3><ul class='sbody-free_list'><li><a managed-link="" href='#1' target="" bookmark-id='1'>SUMMARY</a><ul class='sbody-free_list'><li><a managed-link="" href='#2' target="" bookmark-id='2'>Ntbackup Parameters</a></li><li><a managed-link="" href='#3' target="" bookmark-id='3'>Examples</a></li></ul></li><li><a managed-link="" href='#17' target="" bookmark-id='17'>REFERENCES</a></li></ul><a class='bookmark' id='1'></a></div><div class='kb-notice-section section'>For  Microsoft Windows 2000 information about this topic, visit the following Microsoft Web site: <div class='indent'><a id='kb-link-1' href='http://technet.microsoft.com/en-us/windowsserver/2000/default.aspx' target='_self'>http://technet.microsoft.com/en-us/windowsserver/2000/default.aspx</a></div></div><div class='kb-summary-section section'>You can perform backup operations from the command prompt or from a batch file by using the <span class='text-base'>ntbackup backup</span> command followed by various parameters. You can access only the backup option from the command prompt. To restore files, use the Backup and Restore Wizard. <br><br>This article describes the parameters available with <span class='text-base'>ntbackup</span> and several examples of how to perform a backup from the command line.<br><br>The <span class='text-base'>ntbackup</span> command uses the following syntax: <br><br>ntbackup backup [systemstate] &quot;@FileName.bks&quot; /J {&quot;JobName&quot;} [/P {&quot;PoolName&quot;}] [/G {&quot;GUIDName&quot;}] [/T { &quot;TapeName&quot;}] [/N {&quot;MediaName&quot;}] [/F {&quot;FileName&quot;}] [/D {&quot;SetDescription&quot;}] [/DS {&quot;ServerName&quot;}] [/IS {&quot;ServerName&quot;}] [/A] [/FU] [/V:{yes | no}] [/R:{yes | no}] [/L:{f | s | n}] [/M {BackupType}] [/RS:{yes | no}] [/HC:{on | off}] [/SNAP:{on | off}]<br><br><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><br><a class='bookmark' id='2'></a><h3 class='sbody-h3'>Ntbackup Parameters</h3><span class='text-base'>Switch</span>: <span class='text-base'>systemstate</span><br><span class='text-base'>Description</span>: Specifies that you want to back up the System State data. When you select this option, the backup type will be forced to normal or copy.<br> <br><br><span class='text-base'>Switch</span>: <span class='text-base'>@FileName.bks </span><br><span class='text-base'>Description</span>: Specifies the name of the backup selection file (.bks file) to be used for this backup operation. The at (@) character must come before the name of the backup selection file. A backup selection file contains information about the files and folders you have selected for backup. You have to create the file using the graphical user interface (GUI) version of Backup. <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/J {&quot;JobName&quot;} </span><br><span class='text-base'>Description</span>: Specifies the job name to be used in the backup report. The job name generally describes the files and folders you are backing up in the current backup job. <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/P {&quot;PoolName&quot;} </span><br><span class='text-base'>Description</span>: Specifies the media pool where you want to use media. This is generally a subpool of the Backup media pool, such as 4mm DDS. If you select this you cannot use the /A, /G, /F, or /T command-line options. <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/G {&quot;GUIDName&quot;} </span><br><span class='text-base'>Description</span>: Overwrites or appends to this tape. Do not use this switch in conjunction with /P. <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/T {&quot;TapeName&quot;} </span><br><span class='text-base'>Description</span>: Overwrites or appends to this tape. Do not use this switch in conjunction with /P. <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/N {&quot;MediaName&quot;} </span><br><span class='text-base'>Description</span>: Specifies the new tape name. You must not use /A with this switch. <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/F {&quot;FileName&quot;} </span><br><span class='text-base'>Description</span>: Logical disk path and file name. You must not use the following switches with this <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/P /G /T</span><br><br><span class='text-base'>Switch</span>: <span class='text-base'>/D {&quot;SetDescription&quot;} </span><br><span class='text-base'>Description</span>: Specifies a label for each backup set. <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/DS {&quot;ServerName&quot;}</span><br><span class='text-base'>Description</span>: Backs up the directory service file for the specified Microsoft Exchange server.<br><span class='text-base'>Exchange version</span>: The /DS switch works only with Microsoft Exchange Server 5.5. The /DS switch does not work with Microsoft Exchange 2000 Server or Microsoft Exchange Server 2003.<br><br><span class='text-base'>Switch</span>: <span class='text-base'>/IS {&quot;ServerName&quot;}</span><br><span class='text-base'>Description</span>: Backs up the Information Store file for the specified Microsoft Exchange server.<br><span class='text-base'>Exchange version</span>: The /IS switch works only with Microsoft Exchange Server 5.5. The /IS switch does not work with Microsoft Exchange 2000 Server or Microsoft Exchange Server 2003.<br><br><span class='text-base'>Switch</span>: <span class='text-base'>/A </span><br><span class='text-base'>Description</span>: Performs an append operation. Either /G or /T must be used in conjunction with this switch. Do not use this switch in conjunction with /P.<br> <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/FU </span><br><span class='text-base'>Description</span>: Enables a &quot;file unbuffered&quot; setting to bypass the cache manager. This change provides a number of benefits during the disk-to-disk backup process:<ul class='sbody-free_list'><li>Sustainable throughput over time</li><li>Reduction in processor utilization: on average, peak utilization is reduced to 30 percent</li><li>Elimination of impacts to the system process during the backup job</li></ul><span class='text-base'>Note</span> The <span class='text-base'>/FU</span> switch is available only in the revised version of Ntbackup.exe that is included with Windows Server Service Pack 1. You can also obtain this revised version by downloading it as a hotfix. To do this, click the following article number to view the article in the Microsoft Knowledge Base: <span><div class='indent'><a id='kb-link-2' href='/en-us/help/839272'>839272 </a> System performance is negatively affected when Ntbackup.exe writes to a destination .bkf file<br><br></div></span><br><br><span class='text-base'>Switch</span>: <span class='text-base'>/V:{yes | no} </span><br><span class='text-base'>Description</span>: Verifies the data after the backup is complete. <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/R:{yes | no} </span><br><span class='text-base'>Description</span>: Restricts access to this tape to the owner or members of the Administrators group. <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/L:{f | s | n} </span><br><span class='text-base'>Description</span>: Specifies the type of log file: f=full, s=summary, n=none (no log file is created). <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/M {BackupType} </span><br><span class='text-base'>Description</span>: Specifies the backup type. It must be one of the following: normal, copy, differential, incremental, or daily. <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/RS:{yes | no} </span><br><span class='text-base'>Description</span>: Backs up the migrated data files located in Remote Storage. You do not have to use the <span class='text-base'>/RS</span> command-line option to back up the local Removable Storage database (that contains the Remote Description: Storage placeholder files. When you back up the %Systemroot% folder, Backup automatically backs up the Removable Storage database also. <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/HC:{on | off} </span><br><span class='text-base'>Description</span>: Uses hardware compression, if available, on the tape drive.<br> <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/SNAP:{on | off} </span><br><span class='text-base'>Description</span>: Specifies whether the backup must use a volume shadow copy.<br> <br><br><span class='text-base'>Note</span> The <span class='text-base'>SNAP</span> switch  is ignored in Microsoft Windows Server 2003 Service Pack 1 (SP1) and in later versions.<br><br><span class='text-base'>Switch</span>: <span class='text-base'>/M {BackupType} </span><br><span class='text-base'>Description</span>: Specifies the backup type. It must be one of the following: normal, copy, differential, incremental, or daily. <br><br><span class='text-base'>Switch</span>: <span class='text-base'>/?</span><br><span class='text-base'>Description</span>: Displays help at the command prompt. <br><br><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h3 class='sbody-h3'><a class='bookmark' id='3'></a>Examples</h3> The following examples show how to use the <span class='text-base'>ntbackup</span> command to back up files and folders from the command line or by using a batch file. Note that if you do not specify an option, it applies the settings that you set in the graphical version of the backup program. <h4 class='sbody-h4'>Example 1</h4><div class='indent'><span class='sbody-userinput'>ntbackup backup \\iggy-multi\c$ /m normal /j &quot;My Job 1&quot; /p &quot;Backup&quot; /n &quot;Command Line Backup 1&quot; /d &quot;<strong class='sbody-strong'>Command Line Functionality</strong>&quot; /v:yes /r:no /l:s /rs:no /hc:on</span></div> This example creates a normal backup of the remote share \\iggy-multi\c$ and names it &quot;My Job 1&quot;. It pulls a tape from the Backup media pool, and names the tape &quot;Command Line Backup 1.&quot; You can substitute &quot;<strong class='sbody-strong'>Command Line Functionality</strong>&quot; in the command with the actual description of your backup. This backup is verified after the backup job is complete. Access is not restricted to the owner or the administrator, and the logging level is set to &quot;summary only.&quot; Remote Storage data is not backed up, and hardware compression is enabled. <h4 class='sbody-h4'>Example 2</h4><div class='indent'><span class='sbody-userinput'>ntbackup backup d:\ /j &quot;My Job 2&quot; /a /t &quot;Command Line Backup 1&quot; /m copy</span></div> This example generates a copy backup of the local drive D:\ and names the backup &quot;My Job 2&quot;. The backed up files and folders are added to the tape that is named &quot;Command Line Backup 1.&quot; <h4 class='sbody-h4'>Example 3</h4><div class='indent'><span class='sbody-userinput'>ntbackup backup &quot;@C:\Program Files\Windows NT\ntbackup\data\commandline.bks&quot; /j &quot;My Job 3&quot; /t &quot;Command Line Backup 1&quot; /n &quot;Command Line Backup 2&quot;</span></div> This example generates the type of backup that you specified in the graphical version of the Backup program. To specify the files that are backed up, this example uses the &quot;Commandline.bks&quot; backup selection file located in the C:\Program Files\Windows NT\Ntbackup\Data folder. The backup job is named &quot;My Job 3&quot;. It overwrites the tape that is named &quot;Command Line Backup 1&quot; with the new name &quot;Command Line Backup 2.&quot; <h4 class='sbody-h4'>Example 4</h4> The following three commands perform a backup to a file from the command line: <div class='indent'><span class='sbody-userinput'>ntbackup backup \\iggy-multi\d$ /j &quot;Command Line Backup 4&quot; /f &quot;D:\backup.bkf&quot;</span></div><br><br><span class='sbody-userinput'>ntbackup backup \\iggy-multi\d$ /j &quot;Command Line Backup 5&quot; /f &quot;D:\backup.bkf&quot; /a</span><br><br><span class='sbody-userinput'>ntbackup backup \\iggy-multi\d$ /j &quot;Command Line Backup 6&quot; /f &quot;D:\backup.bkf&quot;</span> The first example shows how to backup \\iggy-multi\d$ to the file D:\Backup.bkf.<br> The second example shows how to append the same backup to the same file.<br> The third example shows how to overwrite the file with the same backup.<br> In all three examples, you can substitute a complete UNC name for the drive letter. For example, instead of d:\backup.bkf, you can use \\iggy-multi\d$\backup.bkf as the backup destination.<br>All three examples use the Backup program&#39;s default values for the backup type, verification setting, logging level, hardware compression, and any other restrictions. <br><br>To start the graphical version of the Backup program, click <strong class='uiterm'>Start</strong>, point to <strong class='uiterm'>All Programs</strong>, point to <strong class='uiterm'>Accessories</strong>, point to <strong class='uiterm'>System Tools</strong>, and then click <strong class='uiterm'>Backup</strong>.<br><br><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a></div><div class='kb-references-section section'><span>For more information about how to use the Backup and Restore Wizard, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-3' href='/en-us/help/326216'>326216 </a> How to use the backup feature to back up and restore data in Windows Server 2003<br><br></div></span><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a></div><div class='kb-securedata-section section'> Author: davidgaz<br>Writer: v-deisle<br>Tech reviewer: v-shtown<br>Edit reviewer: v-dbrsu</div>