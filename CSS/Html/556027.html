<header><h1>How to refresh the Group Policy Settings on remote computers</h1></header><div class='kb-notice-section section'>Nirmal Sharma MVP</div><div class='kb-notice-section section'><div class='kb-disclaimer-msi'>MICROSOFT CORPORATION AND/OR ITS RESPECTIVE SUPPLIERS MAKE NO REPRESENTATIONS ABOUT THE SUITABILITY, RELIABILITY, OR ACCURACY OF THE INFORMATION AND RELATED GRAPHICS CONTAINED HEREIN. ALL SUCH INFORMATION AND RELATED GRAPHICS ARE PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND. MICROSOFT AND/OR ITS RESPECTIVE SUPPLIERS HEREBY DISCLAIM ALL WARRANTIES AND CONDITIONS WITH REGARD TO THIS INFORMATION AND RELATED GRAPHICS, INCLUDING ALL IMPLIED WARRANTIES AND CONDITIONS OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, WORKMANLIKE EFFORT, TITLE AND NON-INFRINGEMENT.  YOU SPECIFICALLY AGREE THAT IN NO EVENT SHALL MICROSOFT AND/OR ITS SUPPLIERS BE LIABLE FOR ANY DIRECT, INDIRECT, PUNITIVE, INCIDENTAL, SPECIAL, CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER INCLUDING, WITHOUT LIMITATION, DAMAGES FOR LOSS OF USE, DATA OR PROFITS, ARISING OUT OF OR IN ANY WAY CONNECTED WITH THE USE OF OR INABILITY TO USE THE INFORMATION AND RELATED GRAPHICS CONTAINED HEREIN, WHETHER BASED ON CONTRACT, TORT, NEGLIGENCE, STRICT LIABILITY OR OTHERWISE, EVEN IF MICROSOFT OR ANY OF ITS SUPPLIERS HAS BEEN ADVISED OF THE POSSIBILITY OF DAMAGES.</div></div><div class='kb-summary-section section'><div class='indent'><span class='sbody-italic'>The following knowledgebase explains the scenario in which you need to refresh the Group Policy Settings on a remote computer. </span></div></div><div class='kb-moreinformation-section section'>The Group Policy Settings are refreshed as per the interval configured in the Group Policy for client computers, member servers and domain controllers. You can use the following command line tools to refresh the Group Policy Settings on remote computer. You need to log on to the computer manually and then perform the action suggested below:<br>&#160;<br>For Windows XP computers:<br>&#160;<br>Gpupdate.exe /Target:User /force<br>Gpupdate.exe /Target:Computer /force<br>&#160;<br>For Windows 2000 <br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Secedit.exe /refreshpolicy user_policy<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Secedit.exe /refreshpolicy machine_policy<br>&#160;<br>To refresh the policy on remote computer or computers you can use the following script to do so:<br>&#160;<br><ol class='sbody-num_list'><li>Create a ComputerList.txt</li><li>Put all the remote computers in the Text file.</li><li>Use the Psexec.exe tool to execute the command remotely.</li></ol>&#160;<br>For Windows XP Computers:<br>&#160;<br>Psexec.exe  Gpupdate.exe /Target:User /force<br>Psexec.exe  Gpupdate.exe /Target:Computer /force<br>&#160;<br>For Windows 2000 Computers:<br>&#160;<br>Psexec.exe  secedit.exe /refreshpolicy user_policy<br>Psexec.exe  secedit.exe /refreshpolicy machine_policy<br>&#160;<br>The above Psexec.exe command will run on all the computers specified in the ComputerList.txt.<br>&#160;<br>You can also use the following script to check the version of Operating System and then issue the command:<br>&#160;<br>@echo off<br>&#160;<br>XPGPORef1=gpupdate.exe /Target:User /force<br>XPGPORef2=gpupdate.exe /Target:Computer /force<br>&#160;<br>Win2kGPORef1=secedit.exe /refreshpolicy user_policy<br>Win2kGPORef2=secedit.exe /refreshpolicy machine_policy<br>&#160;<br>For /f “Tokens=*” %%a in (ComputerList.txt) Do (<br>&#160;<br>SET Comp_name=%%a<br>&#160;<br>Ver.exe \\%comp_name% &gt; Hostver.txt<br>&#160;<br>Find /I “XP” &lt; Hostver.txt &gt; CheckCC.txt<br>&#160;<br>IF %errorlevel% == 0 (<br>&#160;<br>Psexec.exe \\%comp_name% Gpupdate.exe /Target:User /force<br>Psexec.exe \\%comp_name% Gpupdate.exe /Target:Computer /force<br>&#160;<br>) ELSE (<br>&#160;<br>Psexec.exe \\%comp_name% secedit.exe /refreshpolicy user_policy<br>Psexec.exe \\%comp_name% secedit.exe /refreshpolicy machine_policy<br>)<br>&#160;<br>The above script will check the Operating System version by executing Ver.exe on remote computer and then run the appropriate commands to refresh the Group Policy Objects.<br>&#160;<br>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br></div>