<header><h1>Network connectivity between clients and servers may fail after you install security update MS05-019 or Windows Server 2003 Service Pack 1</h1></header><div class='kb-notice-section section'><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/37907.asp' title='Link only available for Microsoft corporate network users' target='_blank'>37907 (Content Maintenance)</a></p></div></div></div></div><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/WindowsSE/160344.asp' title='Link only available for Microsoft corporate network users' target='_blank'>160344 (Windows SE)</a></p></div></div></div></div><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/WindowsSE/160380.asp' title='Link only available for Microsoft corporate network users' target='_blank'>160380 (Windows SE)</a></p></div></div></div></div><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/WindowsSE/160388.asp' title='Link only available for Microsoft corporate network users' target='_blank'>160388 (Windows SE)</a></p></div></div></div></div><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/WindowsSE/160390.asp' title='Link only available for Microsoft corporate network users' target='_blank'>160390 (Windows SE)</a></p></div></div></div></div><div internal-content-body=""><div class="internal-content"><div class="bold internal-content-body-title spacer-12-bottom">Microsoft Internal Support Information</div><div class="row"><div class="col-xs-24 internal-content-body-content"><p>BUG #: <a href='http://bugcheck/bugs/WindowsSE/160245.asp' title='Link only available for Microsoft corporate network users' target='_blank'>160245 (Windows SE)</a></p></div></div></div></div></div><div class='kb-symptoms-section section'> Network connectivity between clients and servers may fail. This failure occurs after the installation of either security update MS05-019 or Microsoft Windows Server 2003 Service Pack 1 (SP1). Any one or more of the following symptoms may occur: <br> <ul class='sbody-free_list'><li>Inability to connect to terminal servers or to file share access.</li><li>Failure of domain controller replication across WAN links.</li><li>Inability of Microsoft Exchange servers to connect to domain controllers.</li><li>Requests to a  server that is running Microsoft Internet Information Services (IIS)  may either time out or may become very slow.<br></li></ul>These symptoms are more likely to occur in WAN and LAN scenarios. These scenarios typically exist where routers and data-link level protocols that have different Maximum Transmission Units (MTUs) are used over the network. In this scenario, the sending host can receive several Internet Control Message Protocol (ICMP) destination unreachable messages that have MTU updates for a destination. These symptoms are most likely to occur if the following conditions are true: <br> <ul class='sbody-free_list'><li>During the PathMTUDiscovery process, several routers on the route to the destination send MTU updates to the source host. One of the possible reasons for this could be that source and destination hosts are in different WAN segments. Additionally, these segments are connected through a tunnel with a small MTU. </li><li>Network load balancing, dynamic routing, or both are used. In this scenario, there are several possible routes to a destination that has MTUs that differ from the MTU of the sending subnet and that differ from each other. Therefore, changing the route of IP packets over time can produce several MTU updates for the destination address. </li></ul><span class='text-base'>Note</span> There may be some other similar scenarios where these symptoms occur. These scenarios can typically be diagnosed by sniffing the network traffic on either the source host side or on one of the intermediate network routers. If there are multiple ICMP destination unreachable messages sent over time for a destination, the source host that has the MS05-019 security update or Windows Server 2003 SP1 installed is likely to have this problem.<br> </div><div class='kb-cause-section section'>This problem occurs because the code incorrectly increments the number of host routes on the computer when the code modifies the MTU size of a host route. The maximum number of host routes is controlled by the registry value in MaxIcmpHostRoutes. The default number of host routes is 10,000. Because of the incorrect increment, the number of host routes eventually reaches the maximum value. After the maximum value is reached, the ICMP packets are ignored. <br><br><span class='text-base'>Note</span> The default number of host routes was incorrectly listed as 1,000 in the original version of this article. The change to 10,000 reflects a correction, not a code change.</div><div><h3 class='sbody-h3'>Security update information</h3>To resolve this problem, install security update 913446 (security bulletin MS06-007). For more information about how to obtain and install security update 913446, visit the following Microsoft Web site: <div class='indent'><a id='kb-link-1' href='http://www.microsoft.com/technet/security/bulletin/ms06-007.mspx' target='_self'>http://www.microsoft.com/technet/security/bulletin/MS06-007.mspx</a></div><span class='text-base'>Note</span> Security update 913446 (security bulletin MS06-007) supersedes this hotfix (898060). <span>For more information, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-2' href='/en-us/help/913446'>913446 </a> MS06-007: Vulnerability in TCP/IP could allow denial of service<br><br></div></span>Security update 913446 also supersedes  security update 893066 (security bulletin MS05-019). <span>For more information about security update 893066, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-3' href='/en-us/help/893066'>893066 </a> MS05-019: Vulnerabilities in TCP/IP could allow remote code execution and denial of service<br><br></div></span><span class='text-base'>Note</span> Security update 893066 has been updated to correct this problem for the original release version of Windows Server 2003. If you deploy  security update 913446, you do not have to deploy  hotfix 898060 or security update 893066. Security update 893066 does not apply to Windows Server 2003 with Service Pack 1. <br> </div><div class='kb-securedata-section section'><h4 class='sbody-h4'>More information about the rerelease of MS05-019 v2.0 with regard to Windows Server 2003 SP1</h4> The following information is intended to provide clarification about the rerelease of MS05-019 v2.0 with regard to Windows Server 2003 SP1: <ul class='sbody-free_list'><li>The original code from the update in MS05-019 v1.0 is already included in Windows Server 2003 SP1. </li><li>MS05-019 v2.0 corrects the regression for all platforms except Windows Server 2003 SP1 and the x64 version of XP.</li><li>898060 corrects the regression for Windows Server 2003 SP1 and the x64 versions of Windows Server 2003. All other versions must use MS05-019 v2.0. </li><li> MS05-019 was rereleased as v2.0 on June 14, 2005. MS05-019 v2.0 contains the following post-898060 fixes: <br> <ul class='sbody-free_list'><li>The default MaxIcmpHostRoutes value was changed from 1000 to 10000.</li><li>A fix was provided for an issue where the retransmission of many packets occurs when an ICMP message has a next hop value that is less than 576. <br><br><span class='text-base'>Note</span> This bug was discovered in our internal testing. A customer incident has not been reported for this bug. <br>BUG #: <a href='http://bugcheck/bugs/WindowsSE/162267.asp' title='Link only available for Microsoft corporate network users' target='_blank'>162267 (WindowsSE)</a>BUG #: <a href='http://bugcheck/bugs/WindowsSE/162268.asp' title='Link only available for Microsoft corporate network users' target='_blank'>162268 (WindowsSE)</a>BUG #: <a href='http://bugcheck/bugs/WindowsSE/162286.asp' title='Link only available for Microsoft corporate network users' target='_blank'>162286 (WindowsSE)</a></li><li>A bug check was resolved that was specific to IPsec and Internet Security and Acceleration Server (ISA) 2004 servers that have the original MS05-019.<br><br><span class='text-base'>Note</span> This bug was discovered in our internal testing. A customer incident has not been reported for this bug.<br>BUG #: <a href='http://bugcheck/bugs/WindowsSE/160709.asp' title='Link only available for Microsoft corporate network users' target='_blank'>160709 (WindowsSE)</a></li></ul></li><li>The update in MS05-019 v2.0 cannot be applied on Windows Server 2003 SP1.</li><li> 898060 is available from the download center. A link is provided later in this article.</li></ul></div><div class='kb-securedata-section section'>The &quot;Resolution&quot; section states whether this hotfix is available as a hotfix or in the latest service pack. For comparison and testing, the original hotfix is available on the <a id='kb-link-9' href='http://hotfix' target='_self'>http://hotfix</a> Web site.<br></div><div class='kb-securedata-section section'>The &quot;Resolution&quot; section states whether this hotfix is available as a hotfix or in the latest service pack. For comparison and testing, the original hotfix is available on the <a id='kb-link-11' href='http://hotfix' target='_self'>http://hotfix</a> Web site.<br></div><div class='kb-notice-section section'>Only one hotfix package exists for Windows Server 2003 SP1. The installer will install the correct hotfix for the system. <br><span></span></div><div class='kb-resolution-section section'><h3 class='sbody-h3'>Hotfix information</h3><span class='text-base'>Note</span> This hotfix information is applicable only to x86-based versions, Itanium-based versions, and x64-based versions of Windows Server 2003 with Service Pack 1 and to x64-based versions of Windows XP Professional. <br><br>A supported hotfix is now available for download from the Microsoft Download Center.<h5 class='sbody-h5 text-subtitle'>Microsoft Windows Server 2003, x86-based versions with Service Pack 1</h5><a id='kb-link-4' href='http://www.microsoft.com/download/details.aspx?familyid=a0245532-0ace-4b85-85bf-758e936173df&displaylang=en' target='_self'>http://www.microsoft.com/download/details.aspx?FamilyId=A0245532-0ACE-4B85-85BF-758E936173DF&displaylang=en</a><h5 class='sbody-h5 text-subtitle'>Microsoft Windows Server 2003, Itanium-based versions with Service Pack 1</h5><a id='kb-link-5' href='http://www.microsoft.com/download/details.aspx?familyid=538f2efc-215b-4907-af17-22851a370f8c&displaylang=en' target='_self'>http://www.microsoft.com/download/details.aspx?FamilyId=538F2EFC-215B-4907-AF17-22851A370F8C&displaylang=en</a><h5 class='sbody-h5 text-subtitle'>Microsoft Windows Server 2003, x64-based versions</h5><a id='kb-link-6' href='http://www.microsoft.com/download/details.aspx?familyid=baafe288-9bc5-479b-88e5-eb7e06ead443&displaylang=en' target='_self'>http://www.microsoft.com/download/details.aspx?FamilyId=BAAFE288-9BC5-479B-88E5-EB7E06EAD443&displaylang=en</a><h5 class='sbody-h5 text-subtitle'>Microsoft Windows XP, x64-based versions</h5><a id='kb-link-7' href='http://www.microsoft.com/download/details.aspx?familyid=e15c903d-8b6f-4b72-a8f3-bd58517ab156&displaylang=en' target='_self'>http://www.microsoft.com/download/details.aspx?FamilyId=E15C903D-8B6F-4B72-A8F3-BD58517AB156&displaylang=en</a><br><br>The hotfix corrects the network-connectivity problem that is described in this Microsoft Knowledge Base article. We recommend that you apply the hotfix to the systems that are experiencing this specific problem. You may also want to consider installing this hotfix to help prevent future connectivity problems similar to this one.<br><br>The updated hotfix for Windows Server 2003 Service Pack 1 (SP1) contains a change that addresses an issue that you experience only when you run Internet Security Systems (ISS) products.<h4 class='sbody-h4'>File information</h4><span>The English version of this hotfix has the file attributes (or later file attributes) that are listed in the following table. The dates and times for these files are listed in Coordinated Universal Time (UTC). When you view the file information, it is converted to local time. To find the difference between UTC and local time, use the <strong class='uiterm'>Time Zone</strong> tab in the Date and Time item in Control Panel.</span><h5 class='sbody-h5 text-subtitle'>Microsoft Windows Server 2003, x86-based versions with Service Pack 1</h5><pre class='sbody-pre'><br>   Date         Time   Version         Size        File name  Platform  Folder<br>   --------------------------------------------------------------------------<br>   26-May-2005  01:06  5.2.3790.2453   333,312     Tcpip.sys  x86       SP1GDR<br>   26-May-2005  01:10  5.2.3790.2453   333,312     Tcpip.sys  x86       SP1QFE </pre><h5 class='sbody-h5 text-subtitle'>Microsoft Windows Server 2003, Itanium-based versions with Service Pack 1</h5><pre class='sbody-pre'><br>   Date         Time   Version         Size       File name  Platform  Folder<br>   --------------------------------------------------------------------------<br>   26-May-2005  02:17  5.2.3790.2453   1,116,160  Tcpip.sys  IA-64     SP1GDR<br>   26-May-2005  02:17  5.2.3790.2453   1,116,160  Tcpip.sys  IA-64     SP1QFE </pre><h5 class='sbody-h5 text-subtitle'>Microsoft Windows Server 2003, x64-based versions</h5><pre class='sbody-pre'><br>   Date         Time   Version         Size        File name  Platform  Folder<br>   --------------------------------------------------------------------------<br>   26-May-2005  02:32  5.2.3790.2453   702,976     Tcpip.sys  x64       SP1GDR<br>   26-May-2005  02:32  5.2.3790.2453   702,976     Tcpip.sys  x64       SP1QFE </pre><h5 class='sbody-h5 text-subtitle'>Microsoft Windows XP, x64-based versions</h5><pre class='sbody-pre'><br>   Date         Time   Version         Size        File name  Platform  Folder<br>   --------------------------------------------------------------------------<br>   26-May-2005  02:32  5.2.3790.2453   702,976     Tcpip.sys  x64       SP1GDR<br>   26-May-2005  02:32  5.2.3790.2453   702,976     Tcpip.sys  x64       SP1QFE </pre><span class='text-base'>Note</span> The file information is the same for x64-based versions of Microsoft Windows Server 2003 and for x64-based versions of Microsoft Windows XP.</div><div class='kb-workaround-section section'> To work around this problem, set the default MTU size to the largest size that the routers can process. The actual MTU value that is required to work around this problem depends on the network configuration. However, an MTU value of 576 should help reduce the effect of the problem because routers on the Internet should be able to handle such packets without fragmentation. You must restart the computer for this registry change to take effect. <br> <span>For more information about how to change the MTU registry settings, click the following article numbers to view the articles in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-12' href='/en-us/help/120642'>120642 </a> TCP/IP and NBT configuration parameters for Windows 2000 or Windows NT<br><br></div></span><span><div class='indent'><a id='kb-link-13' href='/en-us/help/314053'>314053 </a> TCP/IP and NBT configuration parameters for Windows XP<br><br></div></span><span class='text-base'>Important</span> Depending on the network configuration and typical networking applications used, setting a low default MTU value can cause the network performance to decrease.</div><div class='kb-moreinformation-section section'>The MTU parameter overrides the default Maximum Transmission Unit (MTU) for a network interface. The MTU is the maximum packet size in bytes that the transport transmits over the underlying network. The size includes the transport header. An IP datagram can span multiple packets. Values larger than the default value for the underlying network cause the transport to use the network default MTU. Values smaller than 68 cause the transport to use an MTU of 68. <br><br> Key: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\<strong class='sbody-strong'>ID for Adapter</strong><br> Value Type: REG_DWORD Number <br>Valid Range: 68 to <strong class='sbody-strong'>the MTU of the underlying network</strong><br>  Default: 0xFFFFFFFF<br><br><span class='text-base'>Note</span><strong class='sbody-strong'> ID for Adapter</strong> is the network adapter to which TCP/IP is bound. To determine the relationship between an adapter ID and a network connection, view HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Network\{4D36E972-E325-11CE-BFC1-08002BE10318}\<strong class='sbody-strong'>ID for Adapter</strong>\Connection. The Name value in these keys provides the friendly name for a network connection that is used in the Network Connections folder. Values under these keys are specific to each adapter. Parameters that have a DHCP configured value and a statically configured value may not exist. Their existence depends on whether the computer or the adapter is DHCP configured and whether static override values are specified.<br><br>The following network trace illustrates the problem.<pre class='sbody-pre'>001  CLIENT  TRMSRV  TCP  Control Bits: ....S., len:    0, seq:1962957351-1962957352, ack:         0, win:65535, src: 1083  dst: 3389 <br>002  TRMSRV  CLIENT  TCP  Control Bits: .A..S., len:    0, seq:3814299443-3814299444, ack:1962957352, win:17520, src: 3389  dst: 1083 <br>003  TRMSRV  CLIENT  TCP  Control Bits: .A..S., len:    0, seq:3814299443-3814299444, ack:1962957352, win:17520, src: 3389  dst: 1083 <br>004  CLIENT  TRMSRV  TCP  Control Bits: .A...., len:    0, seq:1962957352-1962957352, ack:3814299444, win:65535, src: 1083  dst: 3389<br>005  CLIENT  TRMSRV  TCP  Control Bits: .AP..., len:   39, seq:1962957352-1962957391, ack:3814299444, win:65535, src: 1083  dst: 3389 <br>006  TRMSRV  CLIENT  TCP  Control Bits: .AP..., len:   11, seq:3814299444-3814299455, ack:1962957391, win:17481, src: 3389  dst: 1083 <br>007  CLIENT  TRMSRV  TCP  Control Bits: .A...., len:  280, seq:1962957391-1962957671, ack:3814299455, win:65524, src: 1083  dst: 3389 <br>008  TRMSRV  CLIENT  TCP  Control Bits: .A...., len:    0, seq:3814299455-3814299455, ack:1962957671, win:17201, src: 3389  dst: 1083 <br>009  CLIENT  TRMSRV  TCP  Control Bits: .AP..., len:  132, seq:1962957671-1962957803, ack:3814299455, win:65524, src: 1083  dst: 3389 <br>010  TRMSRV  CLIENT  TCP  Control Bits: .AP..., len:  333, seq:3814299455-3814299788, ack:1962957803, win:17069, src: 3389  dst: 1083 <br>011  ROUTER  TRMSRV  ICMP  Destination Unreachable: 10.102.45.12  (See frame 009)<br>Inside 011: Notice the Next Hop MTU being smaller,and router requesting the sender to fragment the packet 10.ICMP: Destination Unreachable: 10.102.45.12  (See frame 009)<br>    ICMP: Packet Type = Destination Unreachable<br>    ICMP: Unreachable Code = Fragmentation Needed, DF Flag Set        &lt;&lt;&lt;&lt;<br>    ICMP: Checksum = 0x6FAA<br>    ICMP: Next Hop MTU = 320 (0x140)                                  &lt;&lt;&lt;&lt;<br>    ICMP: Data: Number of data bytes remaining = 28 (0x001C)<br>        ICMP: Description of original IP frame<br>        ICMP: (IP) Version = 4 (0x4)<br>        ICMP: (IP) Header Length = 20 (0x14)<br>        ICMP: (IP) Service Type = 64 (0x40)<br>            ICMP: (IP) Precedence = 0x40<br>            ICMP: (IP) Type of Service = 0x40<br>        ICMP: (IP) Total Length = 373 (0x175)<br>        ICMP: (IP) Identification = 10838 (0x2A56)<br>        ICMP: (IP) Flags Summary = 2 (0x2)<br>            ICMP: .......0 = Last fragment in datagram<br>            ICMP: ......1. = Cannot fragment datagram<br>        ICMP: (IP) Fragment Offset = 0 (0x0) bytes<br>        ICMP: (IP) Time to Live = 127 (0x7F)<br>        ICMP: (IP) Protocol = TCP - Transmission Control<br>        ICMP: (IP) Checksum = 0x8C1D<br>        ICMP: (IP) Source Address = 10.102.1.248<br>        ICMP: (IP) Destination Address = 10.102.45.12<br>        ICMP: (IP) Data: Number of data bytes remaining = 8 (0x0008)<br>012  CLIENT  TRMSRV  TCP  Control Bits: .AP..., len:  132, seq:1962957671-1962957803, ack:3814299455, win:65524, src: 1083  dst: 3389 <br>013  TRMSRV  CLIENT  TCP  Control Bits: .A...., len:    0, seq:3814299788-3814299788, ack:1962957803, win:17069, src: 3389  dst: 1083<br>014  TRMSRV  CLIENT  TCP  Control Bits: .AP..., len:  333, seq:3814299455-3814299788, ack:1962957803, win:17069, src: 3389  dst: 1083 <br>TRMSRV ignores the ICMP packet 11, and resends the same packet 10 without fragmentation<br>015  ROUTER  TRMSRV  ICMP  Destination Unreachable: 10.102.45.12  (See frame 014)<br>016  TRMSRV  CLIENT  TCP  Control Bits: .AP..., len:  333, seq:3814299455-3814299788, ack:1962957803, win:17069, src: 3389  dst: 1083 <br>017  ROUTER  TRMSRV  ICMP  Destination Unreachable: 10.102.45.12  (See frame 016)<br>018  TRMSRV  CLIENT  TCP  Control Bits: .AP..., len:  333, seq:3814299455-3814299788, ack:1962957803, win:17069, src: 3389  dst: 1083 <br>019  ROUTER  TRMSRV  ICMP  Destination Unreachable: 10.102.45.12  (See frame 017)<br>020  CLIENT  TRMSRV  TCP  Control Bits: .AP..., len:    9, seq:1962957803-1962957812, ack:3814299455, win:65524, src: 1083  dst: 3389 <br>021  CLIENT  TRMSRV  TCP  Control Bits: .A...F, len:    0, seq:1962957812-1962957813, ack:3814299455, win:65524, src: 1083  dst: 3389 <br>022  TRMSRV  CLIENT  TCP  Control Bits: .A...., len:    0, seq:3814299788-3814299788, ack:1962957813, win:17060, src: 3389  dst: 1083 <br>023  TRMSRV  CLIENT  TCP  Control Bits: .A.R.., len:    0, seq:3814299788-3814299788, ack:1962957813, win:    0, src: 3389  dst: 1083 <br>024  CLIENT  TRMSRV  TCP  Control Bits: .A...., len:    0, seq:1962957813-1962957813, ack:3814299455, win:65524, src: 1083  dst: 3389 <br>025  TRMSRV  CLIENT  TCP  Control Bits: ...R.., len:    0, seq:3814299455-3814299455, ack:3814299455, win:    0, src: 3389  dst: 1083 <br>Frames 14, 16, 18, are re-sends, and the connection leading to termination in frame 25.<br> </pre></div><div class='kb-moreinformation-section section'>Earlier versions of this hotfix have the following three issues: <br> <ul class='sbody-free_list'><li>ISS BlackICE may fail on computers that are running Windows Server 2003 SP1.<br><br>Additional symptoms include a bugcheck and a message that the &quot;firewall cannot start.&quot;<br><br>A compatibility issue exists with ISS products, such as BlackICE, that include TCP/IP filter drivers. This issue is a build-related problem with the binaries. This problem has been fixed in the updated binaries. </li><li>The ICMP destination is unreachable when the next hop MTU size is 576. This problem is described in security bulletin MS05-019 and in Windows SE bugs 161153, 161155, and 161156. <br><br>The hotfix did not account for the IP header size (20 bytes). After the stack receives the ICMP message with an MTU of about 576 bytes, the stack can still send packets on other TCP connections to the same destination. These packets can be more than 576 bytes. </li><li>The TCP Maximum Segment Size (MSS) updates incorrectly when the maximum ICMP host count is reached in Windows Server 2003 and in Windows XP. This problem is documented in Windows SE bugs 160917 and 160918.<br><br>IP notifies TCP of the new MTU size. Therefore, even when the maximum ICMP host routes count is reached, TCP resends packets with the smaller MTU. However, the offset of the ICMP packet is not parsed correctly. Therefore, MSS is not updated correctly. This problem was fixed in the updated binaries. Windows 2000 does not have this feature. Therefore, when the maximum count is reached, TCP/IP will not fragment packets. </li></ul><h3 class='sbody-h3'>File information for the earlier version of the hotfix</h3><h5 class='sbody-h5 text-subtitle'> Microsoft Windows Server 2003</h5><pre class='sbody-pre'>   Date         Time   Version           Size     File name   Service level<br>   ------------------------------------------------------------------------<br>   22-Apr-2005  21:13  5.2.3790.316      335,360  Tcpip.sys   RTMGDR<br>   22-Apr-2005  21:18  5.2.3790.316      336,896  Tcpip.sys   RTMQFE </pre><h5 class='sbody-h5 text-subtitle'>Microsoft Windows Server 2003</h5><pre class='sbody-pre'>Date Time Version Size File name Service level <br>------------------------------------------------------------------------ <br>06-May-2005 02:55 5.2.3790.326 335,360 Tcpip.sys RTMGDR <br>06-May-2005 02:23 5.2.3790.326 336,896 Tcpip.sys RTMQFE </pre><h5 class='sbody-h5 text-subtitle'>Microsoft Windows Server 2003 with Service Pack 1</h5><pre class='sbody-pre'>   Date         Time   Version          Size     File name  Service level<br>   ----------------------------------------------------------------------<br>   22-Apr-2005  20:06  5.2.3790.2428    333,312  Tcpip.sys  SP1GDR<br>   22-Apr-2005  20:09  5.2.3790.2428    333,824  Tcpip.sys  SP1QFE </pre><h5 class='sbody-h5 text-subtitle'>Microsoft Windows Server 2003 with Service Pack 1</h5><pre class='sbody-pre'>Date Time Version Size File name Service level <br>---------------------------------------------------------------------- <br>06-May-2005 03:14 5.2.3790.2439 333,312 Tcpip.sys SP1GDR <br>06-May-2005 03:19 5.2.3790.2439 333,312 Tcpip.sys SP1QFE </pre><h5 class='sbody-h5 text-subtitle'>Windows Server 2003 with Service Pack 1, Itanium-based versions</h5><pre class='sbody-pre'><br>   File name  Version        Date         Time        Size  Platform  Folder<br>   -------------------------------------------------------------------------<br>   Tcpip.sys  5.2.3790.326   06-May-2005  15:39    973,824  IA-64     RTMGDR<br>   Tcpip.sys  5.2.3790.326   06-May-2005  15:39    977,920  IA-64     RTMQFE<br>   Tcpip.sys  5.2.3790.2439  06-May-2005  15:39  1,116,160  IA-64     SP1GDR<br>   Tcpip.sys  5.2.3790.2439  06-May-2005  15:39  1,116,160  IA-64     SP1QFE </pre><h5 class='sbody-h5 text-subtitle'>Windows Server 2003 with Service Pack 1, x64-based versions</h5><pre class='sbody-pre'><br>   File name  Version        Date         Time   Size     Platform  Folder<br>   -----------------------------------------------------------------------<br>   Tcpip.sys  5.2.3790.2439  06-May-2005  15:39  702,976  x64       SP1GDR<br>   Tcpip.sys  5.2.3790.2439  06-May-2005  15:39  702,976  x64       SP1QFE </pre><h5 class='sbody-h5 text-subtitle'>Microsoft Windows XP  with Service Pack 1</h5><pre class='sbody-pre'>   Date         Time   Version           Size     File name   Service level<br>   ------------------------------------------------------------------------<br>   22-Apr-2005  19:40  5.1.2600.1672     339,968  Tcpip.sys   SP1QFE </pre><h5 class='sbody-h5 text-subtitle'>Microsoft Windows XP with Service Pack 1</h5><pre class='sbody-pre'>Date Time Version Size File name Service level <br>------------------------------------------------------------------------ <br>05-May-2005 02:41 5.1.2600.1680 339,968 Tcpip.sys SP1QFE </pre><h5 class='sbody-h5 text-subtitle'>Microsoft Windows XP  with Service Pack 2</h5><pre class='sbody-pre'>   Date         Time   Version           Size     File name  Service level<br>   -----------------------------------------------------------------------<br>   22-Apr-2005  19:25  5.1.2600.2661     359,808  Tcpip.sys  SP2GDR<br>   22-Apr-2005  19:14  5.1.2600.2661     359,936  Tcpip.sys  SP2QFE </pre><h5 class='sbody-h5 text-subtitle'>Microsoft Windows XP with Service Pack 2</h5><pre class='sbody-pre'>Date Time Version Size File name Service level<br> ----------------------------------------------------------------------- <br>05-May-2005 01:39 5.1.2600.2670 359,808 Tcpip.sys SP2GDR <br>05-May-2005 01:57 5.1.2600.2670 359,936 Tcpip.sys SP2QFE </pre><h5 class='sbody-h5 text-subtitle'>Microsoft Windows 2000  with Service Pack 3 or with Service Pack 4</h5><pre class='sbody-pre'>   Date         Time   Version           Size     File name<br>   -----------------------------------------------------------<br>   19-Jun-2003  20:05  5.0.2195.6687     120,240  Afd.sys<br>   19-Jun-2003  20:05  5.0.2195.6602     108,816  Msafd.dll        <br>   22-Apr-2005  05:22  5.0.2195.7042     320,176  Tcpip.sys<br>   19-Jun-2003  20:05  5.0.2195.6655      16,240  Tdi.sys<br>   19-Jun-2003  20:05  5.0.2195.6601      17,680  Wshtcpip.dll </pre><h5 class='sbody-h5 text-subtitle'>Microsoft Windows 2000 with Service Pack 3 or with Service Pack 4</h5><pre class='sbody-pre'>   Date         Time   Version            Size    File name<br>   --------------------------------------------------------------<br>   19-Jun-2003  20:05  5.0.2195.6687     120,240  Afd.sys<br>   19-Jun-2003  20:05  5.0.2195.6602     108,816  Msafd.dll        <br>   05-May-2005  09:07  5.0.2195.7044     320,176  Tcpip.sys<br>   19-Jun-2003  20:05  5.0.2195.6655      16,240  Tdi.sys<br>   19-Jun-2003  20:05  5.0.2195.6601      17,680  Wshtcpip.dll      </pre></div><div class='kb-moreinformation-section section'><span>The third-party products that this article discusses are manufactured by companies that are independent of Microsoft. Microsoft makes no warranty, implied or otherwise, about the performance or reliability of these products.</span></div><div class='kb-references-section section'><span>For more information, click the following article number to view the article in the Microsoft Knowledge Base:<br><br><div class='indent'><a id='kb-link-14' href='/en-us/help/900926'>900926 </a> Recommended TCP/IP settings for WAN links with a MTU size of less than 576<br><br></div></span></div><div class='kb-securedata-section section'>Content Maintenance 37907 Windows SE 160344 160380 160388 160245 160390 </div><div class='kb-securedata-section section'>Author: mohak<br>Writer: williamm; LauraCar<br>Tech reviewer: mohak; Secure; DAnipko<br>Editor: v-cgold, v-crweb</div>