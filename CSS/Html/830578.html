<header><h1>NBLookup.exe command-line tool</h1></header><div class='kb-notice-section section'>BUG #: <a href='http://bugcheck/bugs/ContentMaintenance/14508.asp' title='Link only available for Microsoft corporate network users' target='_blank'>14508 (Content Maintenance)</a></div><div class='kb-notice-section section'><a class='bookmark' id='toc'></a><ul class='sbody-free_list'><li><a managed-link="" href='#1' target="" bookmark-id='1'>SUMMARY</a><ul class='sbody-free_list'><li><a managed-link="" href='#2' target="" bookmark-id='2'>Command-Line Mode</a><ul class='sbody-free_list'><li><a managed-link="" href='#3' target="" bookmark-id='3'>Command-Line Mode Options</a></li><li><a managed-link="" href='#4' target="" bookmark-id='4'>Command-Line Mode Examples</a></li></ul></li><li><a managed-link="" href='#5' target="" bookmark-id='5'>Interactive Mode</a><ul class='sbody-free_list'><li><a managed-link="" href='#6' target="" bookmark-id='6'>Interactive Mode Options</a></li><li><a managed-link="" href='#6a' target="" bookmark-id='6a'>Interactive Mode Examples</a></li></ul></li><li><a managed-link="" href='#7' target="" bookmark-id='7'>Query List Mode</a><ul class='sbody-free_list'><li><a managed-link="" href='#7a' target="" bookmark-id='7a'>Query List Mode Options</a></li><li><a managed-link="" href='#8' target="" bookmark-id='8'>Query List Mode Examples</a></li></ul></li><li><a managed-link="" href='#10' target="" bookmark-id='10'>Input File</a><ul class='sbody-free_list'><li><a managed-link="" href='#12' target="" bookmark-id='12'>Input File Format</a></li><li><a managed-link="" href='#13' target="" bookmark-id='13'>Query Format</a></li></ul></li><li><a managed-link="" href='#9' target="" bookmark-id='9'>NBLookup Usage Examples</a></li></ul></li><li><a managed-link="" href='#11' target="" bookmark-id='11'>REFERENCES</a></li></ul><a class='bookmark' id='1'></a></div><div class='kb-summary-section section'> NBLookup is a command line diagnostic tool that uses the User Datagram Protocol (UDP) to send NetBIOS name queries to Microsoft Windows Internet Naming Service (WINS) servers. NBLookup requires TCP/IP version 4 to run. WINS servers accept name resolution requests on UDP port 137.<br> <br><br>NBLookup runs on the following operating systems: <br> <ul class='sbody-free_list'><li>Microsoft Windows NT 4.0</li><li>Microsoft Windows 2000</li><li>Microsoft Windows XP</li><li>Microsoft Windows Server 2003</li></ul>You can obtain NBLookup from the Microsoft Download Center.<br><br><span> The following file is available for download from the Microsoft Download Center:<br></span><span><img class="graphic" src="/library/images/support/kbgraphics/public/en-us/download.gif" alt="Download " title="Download "><a id='kb-link-1' href='http://download.microsoft.com/download/f/3/a/f3adc5b4-2716-4ef3-bbb8-f4cd4446d415/nblookupv1.exe' target='_self'>Download the NBLookupV1.exe package now.</a></span><br><br><span> For additional information about how to download Microsoft Support files, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-2' href='/en-us/help/119591'>119591 </a> How to Obtain Microsoft Support Files from Online Services<br></div> Microsoft scanned this file for viruses. Microsoft used the most current virus-detection software that was available on the date that the file was posted. The file is stored on security-enhanced servers that help to prevent any unauthorized changes to the file. <br> </span><br><br>NBLookup can be run in command-line mode, in interactive mode, and in query list mode. The following table contains the correct syntax for each mode. <br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>Mode</span></td><td class='sbody-td'><span class='text-base'>Syntax</span></td></tr><tr class='sbody-tr'><td class='sbody-td'>Command-Line</td><td class='sbody-td'>nblookup [-options]<br> <strong class='sbody-strong'>NetBIOS_Name_to_Query</strong></td></tr><tr class='sbody-tr'><td class='sbody-td'>Interactive</td><td class='sbody-td'>nblookup [-options]</td></tr><tr class='sbody-tr'><td class='sbody-td'>Query List</td><td class='sbody-td'>nblookup -ql input_file [-qr report_file]</td></tr></table></div><br><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h3 class='sbody-h3'><a class='bookmark' id='2'></a>Command-Line Mode</h3>You can use Command Line mode to send a single NetBIOS name query to a single WINS server. After the response appears, the program ends. The following table contains the possible return values for this query.<br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>Return value</span></td><td class='sbody-td'><span class='text-base'>Description</span></td><td class='sbody-td'><span class='text-base'>Details</span></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>0</span></td><td class='sbody-td'>positive query response</td><td class='sbody-td'>If the name is resolved (if NBLookup returns an Internet Protocol (IP) address for the name), NBLookup returns a value of <span class='text-base'>0</span> and the exits.</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>1</span></td><td class='sbody-td'>negative name response</td><td class='sbody-td'>The name does not exist and cannot be resolved.</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>99</span></td><td class='sbody-td'>error</td><td class='sbody-td'>NBLookup experienced an error.</td></tr></table></div><br>These return values can be useful in scripts.<br><br>To exit NBLookup before it has completed in command-line mode, press CTRL+C.<br><br><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h4 class='sbody-h4'><a class='bookmark' id='3'></a>Command-Line Mode Options</h4> Command line mode uses the following syntax: <div class='indent'><span class='sbody-userinput'>nblookup [-options]<br> <strong class='sbody-strong'>NetBIOS_Name_to_Query</strong></span></div><strong class='sbody-strong'>NetBIOS_Name_to_Query</strong> must be a valid NetBIOS name that has a maximum of 15 alphanumeric characters. This NetBIOS name cannot contain period (.) characters (dots) or any special characters such as ampersands (&amp;) or percent signs (%).<br><br>The following table contains descriptions of the options that you can use with NBLookup in command-line mode.<br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>Option</span></td><td class='sbody-td'><span class='text-base'>Description</span></td><td class='sbody-td'><span class='text-base'>Details</span></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>/s</span></td><td class='sbody-td'>- Used to specify the WINS server to query</td><td class='sbody-td'>- Can be an IP address or a NetBIOS name<br>- Default value is the local system&#39;s WINS server</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>/x</span></td><td class='sbody-td'>- Used to specify the NetBIOS suffix to query</td><td class='sbody-td'>- Must be a valid NetBIOS suffix<br>- Must be in hexadecimal format<br>- Default value is <span class='text-base'>20</span> (File Server service)<br>- Examples: <span class='text-base'>00</span>, <span class='text-base'>20</span>, <span class='text-base'>1B</span>, <span class='text-base'>1C</span></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>/suffix_help</span></td><td class='sbody-td'>- Used to display a list of common NetBIOS suffixes</td><td class='sbody-td'>- Cannot be used with any other option</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>/t</span></td><td class='sbody-td'>- Used to specify the timeout period for the query</td><td class='sbody-td'>- Valid range: 1 to 20 seconds<br>- Example: <span class='text-base'>/t 5</span></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>/r</span></td><td class='sbody-td'>- Used to specify the number of queries (the number of retries that you want)</td><td class='sbody-td'>- Causes the query to retry if there is no response<br>- Valid range: 1 to 20<br>- Example: <span class='text-base'>/r 8</span></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>/nr</span></td><td class='sbody-td'>- Used to specify no recursion for the query</td><td class='sbody-td'>- Turns off recursion<br>- By default, queries use recursion</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>/i</span></td><td class='sbody-td'>- Used to specify the NetBIOS scope ID</td><td class='sbody-td'>- ID is appended to the NetBIOS name for the query<br>- ID is case sensitive<br>- Can be used only on networks that use scope IDs<br>- Example: <span class='text-base'>/i MyScopeId</span></td></tr></table></div><br><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h4 class='sbody-h4'><a class='bookmark' id='4'></a>Command-Line Mode Examples</h4>The following example queries WINS server 169.254.1.10 for the File Server service that computer1 has registered:<div class='indent'><span class='sbody-userinput'>nblookup /s 169.254.1.10 computer1</span></div>The following example queries the WINS server that is named WINS1 for the domain controllers that are registered in the domain that is named DOMAIN1:<div class='indent'><span class='sbody-userinput'>nblookup /s WINS1 /x 1C DOMAIN1</span></div><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h3 class='sbody-h3'><a class='bookmark' id='5'></a>Interactive Mode</h3> This mode is similar to the interactive mode of the NSLookup tool.<br><br>NBLookup starts a command shell that accepts a limited number of commands and parameter settings. You can use this mode to troubleshoot issues that require you to send the same queries repeatedly, although each repetition may use different parameter settings.<br><br>To exit NBLookup before it has completed in interactive mode, type <span class='sbody-userinput'>quit</span> or<br> <span class='sbody-userinput'>exit</span>, and then press ENTER. The program exits the command shell and the program ends.<br><br><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h4 class='sbody-h4'><a class='bookmark' id='6'></a>Interactive Mode Options</h4> Interactive mode uses the following syntax: <div class='indent'><span class='sbody-userinput'>nblookup [-options]</span></div>The following table lists the options that are available in interactive mode.<br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>Option</span></td><td class='sbody-td'><span class='text-base'>Description</span></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>help</span> or <span class='text-base'>?</span></td><td class='sbody-td'> - Used to display information about common commands</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>shelp</span> or <span class='text-base'>?s</span></td><td class='sbody-td'> - Used to display common NetBIOS suffixes (the 16th character)</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>NAME</span></td><td class='sbody-td'> - Used to query the default WINS server for the specified NetBIOS name</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>server NAME</span></td><td class='sbody-td'> - Used to set the default WINS server to the specified NetBIOS name or IP address</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>ipconfig</span></td><td class='sbody-td'> - Used to display the IP configuration of the local system; runs from inside the command shell</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>set<span class='sbody-italic'> OPTION=value</span></span></td><td class='sbody-td'>- Used to set specified option values</td></tr></table></div><br>You can use the <span class='text-base'>set<span class='sbody-italic'> OPTION=value</span></span> option to set specified option values for NBLookup. The following table describes the option values that you can set by using the <span class='text-base'>set</span> option.<br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>Option and value</span></td><td class='sbody-td'><span class='text-base'>Description</span></td><td class='sbody-td'><span class='text-base'>Details</span></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>set all</span></td><td class='sbody-td'> - Used to display the current option values</td><td class='sbody-td'></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>set suffix=x</span></td><td class='sbody-td'> - Used to set the query type</td><td class='sbody-td'>- Examples: <span class='text-base'>00</span>,<span class='text-base'>20</span>,<span class='text-base'>03</span>,<span class='text-base'>1B</span>,<span class='text-base'>1C</span></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>set suffix=*</span></td><td class='sbody-td'> - Used to set query types 00, 20, and 03 in one command</td><td class='sbody-td'></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>set type=x</span></td><td class='sbody-td'>- Used to set the query type</td><td class='sbody-td'> - Same as <span class='text-base'>suffix=x</span><br>- Examples: <span class='text-base'>00</span>,<span class='text-base'>20</span>,<span class='text-base'>03</span>,<span class='text-base'>1B</span>,<span class='text-base'>1C</span></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>set type=*</span></td><td class='sbody-td'> - Used to set query types 00, 20, and 03 in one command</td><td class='sbody-td'>- Same as <span class='text-base'>suffix=*</span></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>set timeout=n</span></td><td class='sbody-td'>- Used to set the query timeout period in seconds</td><td class='sbody-td'>- Valid range: 1 to 20</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>set retry=n</span></td><td class='sbody-td'> - Used to set the number of query retries</td><td class='sbody-td'>- Valid range: 1 to 20</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>set norecurse</span></td><td class='sbody-td'> - Used to turn off recursion</td><td class='sbody-td'>- By default, recursion is on</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>set recurse</span></td><td class='sbody-td'>- Used to turn on recursion</td><td class='sbody-td'>- By default, recursion is on</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>set id=x</span></td><td class='sbody-td'> - Used to set the NetBIOS scope ID for the query</td><td class='sbody-td'> - Can use any alphanumeric scope ID<br> - Required only if scope IDs are used in the environment<br> - Can be used to reset the scope ID by running <span class='sbody-userinput'>set id=</span></td></tr></table></div><br>To view a list of query types that you can use with the <span class='text-base'>set suffix=x</span> option, type <span class='sbody-userinput'>nblookup /suffix_help</span> at a command prompt, and then press ENTER, or type <strong class='uiterm'>shelp</strong> from within NBLookup.<br><br><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h4 class='sbody-h4'><a class='bookmark' id='6a'></a>Interactive Mode Examples</h4> To use NBLookup in interactive mode, type the following command at a command prompt, and then press ENTER:<div class='indent'><span class='sbody-userinput'><strong class='sbody-strong'>path</strong>\NBLookup.exe</span></div><span class='text-base'>Note</span> In this example, <strong class='sbody-strong'>path</strong> is the path of the NBLookup.exe file on your computer.<br><br> The greater-than (&gt;) sign appears in the NBLookup interface as a prompt. To run any of the following commands, type the command at the <span class='text-base'>&gt;</span> prompt, and then press ENTER:<ul class='sbody-free_list'><li>The following command lists the IP address of the default WINS server:<div class='indent'><span class='sbody-userinput'>SERVER</span></div></li><li>The following command sets the query type to <span class='text-base'>1B</span> (Master Browser):<div class='indent'><span class='sbody-userinput'>set type=1B</span></div></li><li>The following command queries the default WINS server for master browsers in the domain. In this example, the domain is named TESTDOMAIN. <div class='indent'><span class='sbody-userinput'>testdomain</span></div>When you run this command, NBLookup displays output that is  similar to the following:<pre class='sbody-pre'><br>Recursion is on<br><br>Querying WINS Server: 157.55.253.218<br>NetBIOS Name: testdomain<br>Suffix: 1B<br><br>Name returned: TESTDOMAIN<br>Record type: Unique<br>IP Address: 157.54.5.150<br> </pre><span class='text-base'>Note</span> In this example, <span class='text-base'>157.54.5.150</span> is the IP address of the master browser in the TESTDOMAIN domain.</li><li>The following command sets the query type to <span class='text-base'>Workstation Service</span> (<span class='text-base'>00</span>), to <span class='text-base'>Messenger Service</span> (<span class='text-base'>03</span>), and to <span class='text-base'>File Server Service</span> (<span class='text-base'>20</span>):<div class='indent'><span class='sbody-userinput'>set type=*</span></div></li><li>The following command displays the current option values:<div class='indent'><span class='sbody-userinput'>set all</span></div></li><li>The following command queries the default WINS server for the Workstation Service, for the Messenger Service, and for the File Server Service that are registered with the computer that is named MYSERVER:<div class='indent'><span class='sbody-userinput'>MYSERVER</span></div></li></ul><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h3 class='sbody-h3'><a class='bookmark' id='7'></a>Query List Mode</h3> Query list mode uses the following syntax:<div class='indent'><span class='sbody-userinput'>nblookup -ql input_file [-qr report_file]</span></div>Query List Mode uses an input file to specify the parameters of WINS queries. <br><br><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h4 class='sbody-h4'><a class='bookmark' id='7a'></a>Query List Mode Options</h4>The following table lists the options that are available in query list mode.<br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>Option</span></td><td class='sbody-td'><span class='text-base'>Description</span></td><td class='sbody-td'><span class='text-base'>Details</span></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>/ql</span></td><td class='sbody-td'>- Used to run NBLookup in query list mode</td><td class='sbody-td'>- Sends WINS queries that are specified in a text input file<br>- Must specify the path and the name of the input file<br>- Cannot be used with command-line mode options</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>/qr</span></td><td class='sbody-td'>- Used to specify the name of the report file to create when you use <span class='text-base'>/ql</span></td><td class='sbody-td'> - Used only with the <span class='text-base'>/ql</span> option<br>- Cannot be used with command-line mode options<br>- Must specify the path and the name of the report file<br>- Automatically appends the .htm extension to the specified file name<br>- By default, the report file name is Nblookup.htm</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>/ql</span></td><td class='sbody-td'>- Used to create a sample input file that is named In-nblookup.txt</td><td class='sbody-td'>- Cannot be used with any other options<br>- The autocreate command</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>/y</span></td><td class='sbody-td'>- Used to overwrite the existing report file without prompting</td><td class='sbody-td'>- Cannot be used with command-line mode options<br>- Useful in scripts</td></tr></table></div><br><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h4 class='sbody-h4'><a class='bookmark' id='8'></a>Query List Mode Examples</h4>The following command builds a sample input file that is named In-nblookup.txt:<div class='indent'><span class='sbody-userinput'>nblookup /ql</span></div>The following command runs queries that are specified in the input file that is named In-nblookup.txt. The command then creates a report that is named Myreport.htm:<div class='indent'><span class='sbody-userinput'>nblookup /ql in-nblookup.txt /qr myreport</span></div><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h3 class='sbody-h3'><a class='bookmark' id='10'></a>Input File</h3> After you have identified all the WINS servers and all the WINS records that are important in your environment, you can write your own customized NBLookup input files. You can then use these customized files with NBLookup and DNSLint to help you with administration, ongoing maintenance, and troubleshooting. <br><br>DNSLint is a tool for DNS troubleshooting. DNSLint also has a <span class='text-base'>/ql</span> (Query List) option. You can use NBLookup and DNSLint to quickly collect information about WINS and DNS records that are important in your environment.<br><br>NBLookup verifies the specified input file before using its contents to send WINS queries. NBLookup verifies the specified IP addresses to make sure that they are valid. NBLookup also verifies the validity of each field on each line. Comments that start with a semicolon (;) are ignored. Comments that start with a plus sign (+) are printed in the report. Typically, these comments are small (less than 500 characters).<br><br>After NBLookup has verified the input file, it starts to send the WINS queries that are listed in the input file to the WINS servers that are specified in the input file. If a destination WINS server does not respond to a query, NBLookup retries the query. If the WINS server does not respond again, NBLookup bypasses any other queries that are specified in the input file for that WINS server. This behavior avoids the delay that occurs if many WINS queries are sent to a server that is not responding. For example, if two queries to a WINS server time out two times, NBLookup does not send any other queries that are listed in the input file to that WINS server.<br><br><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h4 class='sbody-h4'><a class='bookmark' id='12'></a>Input File Format</h4> The input file has the following format: <div class='sbody-code'><pre><code>NBLookup<br>[wins~server] 192.168.138.20<br>mydomain,1b <br>mydomain,1c <br>dc1,20,nr<br>dc1,00 <br>host,*<br></code></pre></div>The following table describes the elements of this input file.<br><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>Code</span></td><td class='sbody-td'><span class='text-base'>Description</span></td><td class='sbody-td'><span class='text-base'>Details</span></td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>NBLookup</span></td><td class='sbody-td'>- Used to specify that the file is an NBLookup input file</td><td class='sbody-td'>- The first item that NBLookup tries to locate when it opens the input file<br>- Must appear at the top of the file<br>- If NBLookup is not the first word that the tool reads when it opens the file, NBLookup rejects the specified input file and generates an error</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>[wins~server] 192.168.138.20</span></td><td class='sbody-td'>- Used to specify the IP address of a WINS server to send queries to</td><td class='sbody-td'>- Must include <span class='text-base'>[wins~server]</span> and a valid IP address<br>- If either of these components is missing, NBLookup rejects the specified input file and generates an error</td></tr><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>mydomain,1b</span> and <span class='text-base'>mydomain,1c</span></td><td class='sbody-td'>- Used to specify the queries that NBLookup sends to the specified WINS server</td><td class='sbody-td'>- Details appear in the &quot;Query Format&quot; section of this article</td></tr></table></div><br><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h4 class='sbody-h4'><a class='bookmark' id='13'></a>Query Format</h4> The queries in the input file use the following syntax:<div class='indent'><span class='sbody-userinput'>mydomain,1b</span></div>The first field in the line is the NetBIOS name to query. In this example, the name is mydomain. A comma must follow the NetBIOS name. No spaces are permitted on either side of the comma.<br><br> The second field follows the comma that appears immediately after the NetBIOS name to query. The second field is the type of record or the NetBIOS suffix (the 16th character) to query for. (For more information about common valid types, see the &quot;Common Valid Record Types&quot; table that appears later in this section.)<br><br> If the suffix that is specified is the asterisk character (*), NBLookup queries for the specified name by using the 00, the 20, and the 03 records in one command.<br><br> A comma always follows the type of record. No spaces are permitted on either side of the comma.<br><br>        You may use an optional third field to turn recursion on or off. This field immediately follows the comma that appears after the second field. By default, recursion is on. To turn off recursion, append <span class='text-base'>,nr</span> after the query type.<br><br> Nothing follows the third field. The first two fields are required and no spaces are permitted in the query line.<br><br><span class='text-base'>Note</span> You can view the list of common valid record types by running one of the following commands: <br> <ul class='sbody-free_list'><li>In command-line mode: <span class='sbody-userinput'>nblookup /suffix_help</span></li><li>In interactive mode: <span class='sbody-userinput'>shelp</span> or<br> <span class='sbody-userinput'>?s</span></li></ul><h4 class='sbody-h4'>Common Valid Record Types</h4><div class='table-responsive'><table class='sbody-table table'><tr class='sbody-tr'><td class='sbody-td'><span class='text-base'>Name</span></td><td class='sbody-td'><span class='text-base'>Number(h)</span></td><td class='sbody-td'><span class='text-base'>Type</span></td><td class='sbody-td'><span class='text-base'>Usage</span></td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>00</td><td class='sbody-td'>U</td><td class='sbody-td'>Workstation service</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>01</td><td class='sbody-td'>U</td><td class='sbody-td'>Messenger service</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;\--__MSBROWSE__&gt;</td><td class='sbody-td'>01</td><td class='sbody-td'>G</td><td class='sbody-td'>Master Browser</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>03</td><td class='sbody-td'>U</td><td class='sbody-td'>Messenger service</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>06</td><td class='sbody-td'>U</td><td class='sbody-td'>Remote Access Server service</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>1F</td><td class='sbody-td'>U</td><td class='sbody-td'>NetDDE service</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>20</td><td class='sbody-td'>U</td><td class='sbody-td'>File Server service</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>21</td><td class='sbody-td'>U</td><td class='sbody-td'>Remote Access Server client service</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>22</td><td class='sbody-td'>U</td><td class='sbody-td'>Exchange Interchange (MSMail Connector)</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>23</td><td class='sbody-td'>U</td><td class='sbody-td'>Exchange Store</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>24</td><td class='sbody-td'>U</td><td class='sbody-td'>Exchange Directory</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>30</td><td class='sbody-td'>U</td><td class='sbody-td'>Modem Sharing Server service</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>31</td><td class='sbody-td'>U</td><td class='sbody-td'>Modem Sharing client service</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>43</td><td class='sbody-td'>U</td><td class='sbody-td'>SMS Clients Remote Control</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>44</td><td class='sbody-td'>U</td><td class='sbody-td'>SMS Administrators Remote Control Tool</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>45</td><td class='sbody-td'>U</td><td class='sbody-td'>SMS Clients Remote Chat</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>46</td><td class='sbody-td'>U</td><td class='sbody-td'>SMS Clients Remote Transfer</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>87</td><td class='sbody-td'>U</td><td class='sbody-td'>Microsoft Exchange MTA</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>6A</td><td class='sbody-td'>U</td><td class='sbody-td'>Microsoft Exchange IMC</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>BE</td><td class='sbody-td'>U</td><td class='sbody-td'>Network Monitor Agent</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;computername&gt;</td><td class='sbody-td'>BF</td><td class='sbody-td'>U</td><td class='sbody-td'>Network Monitor Application</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;username&gt;</td><td class='sbody-td'>03</td><td class='sbody-td'>U</td><td class='sbody-td'>Messenger service</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;domain&gt;</td><td class='sbody-td'>00</td><td class='sbody-td'>G</td><td class='sbody-td'>Domain Name</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;domain&gt;</td><td class='sbody-td'>1B</td><td class='sbody-td'>U</td><td class='sbody-td'>Domain Master Browser</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;domain&gt;</td><td class='sbody-td'>1C</td><td class='sbody-td'>G</td><td class='sbody-td'>Domain Controllers</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;domain&gt;</td><td class='sbody-td'>1D</td><td class='sbody-td'>U</td><td class='sbody-td'>Master Browser</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;domain&gt;</td><td class='sbody-td'>1E</td><td class='sbody-td'>G</td><td class='sbody-td'>Browser Service Elections</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;INet~Services&gt;</td><td class='sbody-td'>1C</td><td class='sbody-td'>G</td><td class='sbody-td'>IIS</td></tr><tr class='sbody-tr'><td class='sbody-td'>&lt;IS~computer name&gt;</td><td class='sbody-td'>00</td><td class='sbody-td'>U</td><td class='sbody-td'>IIS</td></tr></table></div><h4 class='sbody-h4'>NBLookup Comment Types</h4>NBLookup supports two types of comments that use two different symbols: <br> <ul class='sbody-free_list'><li>The semicolon symbol (;) indicates a comment that NBLookup ignores. If you want to add a comment to the input file that is only visible when the input file is edited, add this type of comment.</li><li>The plus sign (+) indicates a comment that appears in the HTML report. If you want to add extra information to the report that makes the report easier to understand, use this type of comment.</li></ul> The following sample input file contains both types of comments. This sample file is generated by running the <span class='text-base'>nblookup /ql autocreate</span> command.<div class='sbody-code'><pre><code>NBLookup<br>;This is a sample NBLookup input file.<br>;This is the type of file that NBLookup reads when you specify the /ql option.<br>;This file must be in ANSI text format (use Notepad.exe).<br><br>;The first word in all NBLookup input files must be NBLookup,<br>;as you can see at the top of this sample file.<br><br>;A semicolon (;) indicates a comment that NBLookup ignores when it processes the file.<br><br>;A plus sign (+) indicates a comment that will appear in the HTML report<br>;and in the optional text report.<br>;Use this type of comment when you want to add additional information to the report<br>;to make it easier to understand<br><br>;This file is made up of three types of data:<br>;1. WINS server (or servers) to query<br>;2. WINS queries<br>;3. Optional NetBIOS Scope ID<br><br>;[wins~server] 169.254.46.138<br>;This line specifies the IP address of a WINS server to send queries to<br>;[wins~server] must be specified, followed by a valid IP address.<br><br>;Later lines in the file indicate the queries to send to this server:<br>;server1,20<br>;host1,00,nr<br>;mydomain,1b<br>;mydomain,1c<br><br>;Format of queries:<br>;first field = NetBIOS name to query<br>;maximum of 15 valid characters<br><br>;second field = type of record to query for<br>;examples:  00, 20, 1B, 1C<br>;run /suffix_help for a list of valid query types<br><br>;These two fields are required, they are delimited by using a comma.<br>; No spaces are permitted.<br>;third field = disable recursion option<br>;By default, NBLookup uses recursion.<br>;You can send a query and request recursion.<br>;example: nr<br><br>;This field is optional. If you use it, this field must follow the second field and a comma.<br><br>;[scopeid] &#39;my_scopeid&#39;<br>;This line specifies the scope ID to use for all later queries.<br>;Replace my_scopeid with the scope ID that you want.<br>;Note: Scope IDs are case sensitive and must be between single quotation marks.<br>;[scopeid] &#39;;reset&#39;<br>;This line resets the scope ID for all later queries.<br>;Only use scope IDs in your queries if you use scope IDs in your environment.<br><br>[wins~server] 192.168.138.20<br><br>+This WINS server is named  wins1.cp.msft.net.<br><br>mydomain,1b ;identifies PDC<br>mydomain,1c ;identifies 20 PDCs<br><br>[scopeid] &#39;edmonton&#39;;set scope id to edmonton<br><br>dc1,20,nr;file server service with no recursion<br>dc1,00  ;workstation service<br><br>[scopeid] &#39;;reset&#39; ;Do not use a scope ID for the next query.<br>host,00  ;workstation service</code></pre></div>The sample input file In-nblookup.txt is generated in the local directory. If the file already exists, NBLookup prompts you for permission to overwrite it.<br><br> To process the input file, run the following command at a command prompt:<div class='indent'><span class='sbody-userinput'>nblookup /ql input.txt</span></div><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><h3 class='sbody-h3'><a class='bookmark' id='9'></a>NBLookup Usage Examples</h3> If you verify a specified set of WINS records on multiple WINS servers, this information can help you to diagnose and to fix problems that missing or incorrect WINS records may have caused.<br><br>For example, if clients are experiencing problems when they try to log on to the domain, verify that the 1C records that the clients use to find domain controllers are available and are accurate. This information can help you determine if WINS is a cause of the problem.<br><br>Also, if you receive reports that users are having problems browsing the network by using NetBIOS browsing through Windows Explorer, this tool quickly verifies all the 1B records that are involved with NetBIOS browsing on the network on all the WINS servers that are supposed to have these records. Therefore, you can quickly determine if missing or incorrect WINS records may be related to the problem.<br><br> In another case, some users may be experiencing problems when they try to gain access to shares on servers by using the servers&#39; names. However, the users can gain access to the shares by using the IP addresses. To determine whether name resolution is the problem, or to rule out name resolution as a possible cause, you must verify all the related WINS records on all the WINS servers that are used to resolve a server&#39;s name. The <span class='text-base'>/ql</span> (Query List) option that permits NBLookup to read instructions from the specified text file provides this functionality. After NBLookup has verified that the file is a valid NBLookup input file, it runs the queries that are specified in the file and then returns the results in an easy-to-read HTML report. Administrators can customize this input file to specify the WINS servers to query and to specify the WINS records to look for on each server.<br><br><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a><br><a class='bookmark' id='11'></a></div><div class='kb-references-section section'><span> For additional information about the DNSLint tool, click the following article numbers to view the articles in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-3' href='/en-us/help/321045'>321045 </a> Description of the DNSLint Utility<br><br></div></span><span><div class='indent'><a id='kb-link-4' href='/en-us/help/330105'>330105 </a> How to verify large numbers of DNS records by using DNSLint<br><br></div></span><a managed-link="" href='#toc' target="" bookmark-id='toc'>back to the top</a></div><div class='kb-securedata-section section'>nblookup, NB Lookup, nblookup.exe, 830578 Secure channel, wins, nslookup, name resolution, zone transfer, replication<br></div><div class='kb-securedata-section section'> Author: timir<br> Writer: V-WALTR<br> Tech Reviewer: v-raddis<br> Editor: v-grzebe</div>