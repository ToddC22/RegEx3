<header><h1>ASMS – Jarvis</h1></header><div class="kb-generic-section section">
<p><span lang="EN"><span><span>Submit a </span></span></span><span><span><a href="http://sharepoint/sites/fastrack/Lists/ModTrack/NewForm.aspx?RootFolder="><span lang="EN">ModTrack</span></a></span></span><span lang="EN"><span><span> request to update this TSG.</span></span></span></p>

<h3><strong><a id="Overview" name="Overview"></a>Overview </strong></h3>

<p>This TSG provides instructions for performing operations in <a href="https://jarvis-west.dc.ad.msft.net/?page=actions&amp;acisEndpoint=Public#/">Jarvis</a>, which <span>replaced</span> ACIS for back-end subscription management. <span>The two key functions you will use Jarvis for are quota increases and changes to subscription parameters. </span>You can also use Jarvis to enable preview features, change max <span>quotas and change.</span></p>

<h3><strong><a id="Policy" name="Policy"></a>Policy </strong></h3>

<p>All write actions in Jarvis require elevated Just-In-Time (<span>JIT)</span><span>&nbsp;</span> access to complete. If actions you need to take in Jarvis are locked, follow the access request instructions in the <span>JIT TSG (</span><a href="https://internal.support.services.microsoft.com/en-us/help/3004901" managed-link="" target="_blank">3004901</a>).</p>

<p>Jarvis requires multi-factor authentication, so if you get an error that you are unauthorized, you may need to log in using Remote Access Service (RAS) <span>or ensure that you have phone authentication set up</span> If you need assistance configuring your connection, consult with your Technical Advisor (TA).</p>

<p><strong>Note:</strong> If Jarvis throws an error or an exception when you attempt to execute a Jarvis<span> </span>operation after you have already verified that you have the necessary RAMWeb access permissions for Jarvis use and have followed the other instructions for ensuring access above, you can notify the Jarvis team of the error by emailing <span><a href="mailto:acisesc@microsoft.com">acisesc@microsoft.com</a> </span>and <span><a href="mailto:acishot@microsoft.com">acishot@microsoft.com</a>. </span></p>

<p><strong>Important:&nbsp;ASMS Engineers are only authorized to perform the Jarvis action which are documented and approved in our TSGs, all other actions are strictly prohibited.&nbsp;</strong></p>

<h3><strong><a id="Support Scenarios" name="Support Scenarios"></a>Support Scenarios </strong></h3>

<h4><strong><a id="Quota Increase/Decrease" name="Quota Increase/Decrease"></a>Quota Increase/Decrease</strong></h4>

<p>There are two different types of quota:</p>

<ul>
	<li><span><span><span>Classic (RDFE) &ndash; This is general quota that can be used in any region.</span></span></span></li>
	<li><span><span><span><span><span>ARM quota (V2) &ndash; This quota specific to a region and can only be used with V2 services.</span></span></span></span></span></li>
</ul>

<p><span>Be certain you know which type of quota the customer needs updated, and that you are following the correct instructions for that type of quota.</span></p>

<p>You will <span>need 2 different </span>Jarvis functions for quota increase:</p>

<ul>
	<li>
	<p><span><span><span><span>AzureRT/Subscription Management</span></span></span></span></p>
	</li>
	<li>
	<p><span><span><span><span><span>AzureRT/Service Management</span></span></span></span></span></p>
	</li>
</ul>

<p>Use the <strong>Get Subscription with Details</strong> function to review the existing subscription.</p>

<ul>
	<li>
	<p><span><span><span><span>AzureRT/Subscription Management/Get</span><span> </span>Subscription with Details</span></span></span></p>
	</li>
</ul>

<p>Note the quantity of the specific quota you will be increasing and make sure you understand the request. If the user request is to add 20 more cores, and the existing quota of compute is 20, then you will need to change the quota to 40. If you enter 20, it won&rsquo;t add to the existing quota.</p>

<p>Use <strong>Service Management</strong> and select the type of quota you will be changing.</p>

<p><span>Enter the following: </span></p>

<ul>
	<li>
	<p><span><span><span>Subscription GUID</span></span></span></p>
	</li>
	<li>
	<p><span><span><span><span><span>The new Quota (as a total)</span></span></span></span></span></p>
	</li>
	<li>
	<p><span><span><span><span><span>An Approver</span></span></span></span></span></p>
	</li>
	<li>
	<p><span><span><span><span><span>A Reviewer</span></span></span></span></span></p>
	</li>
	<li>
	<p><span><span><span><span><span>An Approver Link</span></span></span></span></span></p>
	</li>
</ul>

<p>Once you are finished, review the subscription again to confirm the <span>new quota settings.</span></p>

<p><strong><span>Increase DDOS Plan Quota</span></strong></p>

<p><span>We can increase the quota to a 100 DDOS Plan/subscription in each region. No approval or engagement with any other team is required, however, before increasing the quota, you must send notification to <span><span>Anupam.Vij@microsoft.com</span></span> with justification and the customer use case scenario. The DDOS plan costs $3K USD/month per plan.</span></p>

<h4><strong><span>How to Check the Quota of an ARM Subscription in Jarvis</span></strong><span><span><span> </span></span></span><span><span><span> </span></span></span></h4>

<ol>
	<li>Navigate to <a href="https://jarvis-west.dc.ad.msft.net/#/actions">Jarvis</a>.</li>
	<li>Navigate to the following directory: <strong>CRP/Subscription Operations/Get Subscription Quota Details</strong></li>
	<li>Select your customer&rsquo;s endpoint from the <strong>Endpoint</strong> dropdown. <span>(Default is Production.)</span><span> </span><span> </span></li>
	<li>Enter your customer&rsquo;s subscription ID in the <strong>Subscription</strong> field.</li>
	<li>Select the datacenter region that serves your customer in the <strong>CRP Region</strong> field.</li>
	<li>Click the <strong>Run </strong>button.</li>
</ol>

<div>
<div>&nbsp;</div>

<div>
<p>Leverage the table below to determine what services the customer already has:</p>

<table class="table">
	<tbody>
		<tr>
			<td nowrap="nowrap" width="180">
			<p><strong>RDQuotaSKU</strong></p>
			</td>
			<td nowrap="nowrap" width="85">
			<p><strong>CRPCode</strong></p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>A-Series (A0-A7)</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>A0_A7</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>A-Series [Basic] (A0-A4)</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>B_A0_A4</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>Av2 Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>Av2F</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>BS Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>XBF</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>DC Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>XDCF</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>DSv1 Series (XIO)</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>X</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>DSv2 Series (XIO)</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>XDV2F</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>DSv2_Promo Series (XIO)</p>
			</td>
			<td width="85">
			<p>XDV2F_Promo</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>DSv3 Series (XIO)</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>XDV3F</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>Dv1 Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>DF</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>Dv2 Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>DV2F</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>Dv2_Promo Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>DV2F_Promo</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>Dv3 Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>DV3F</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>Eiv3</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>EIV3F</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>ESiV3</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>XEIV3F</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>ESv3 Series (XIO)</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>XEV3F</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>Ev3 Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>EV3F</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>F Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>FF</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>FS Series (XIO)</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>XFF</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>FSv2 Series (XIO)</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>XFV2F</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>G Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>GF</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>GS Series (XIO)</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>XGF</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>H Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>HF</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>HPC (A8-A11)</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>A8_A11</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>LS Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>XLF</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>MS Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>XMF</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>NC Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>NCF</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>NCSv2 Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>XNCV2F</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>NDS Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>XNDF</p>
			</td>
		</tr>
		<tr>
			<td nowrap="nowrap" width="180">
			<p>NV Series</p>
			</td>
			<td nowrap="nowrap" width="85">
			<p>NVF</p>
			</td>
		</tr>
	</tbody>
</table>
</div>

<div>&nbsp;</div>
</div>

<h4><strong><a id="Increase Fault Domain (FD) Quota (Shared and Dedicated Clusters)" name="Increase Fault Domain (FD) Quota (Shared and Dedicated Clusters)"></a>Increase Fault Domain (FD) Quota (Shared and Dedicated C<span>lusters)</span></strong></h4>

<p><strong><span><a id="Shared Cluster Limitations" name="Shared Cluster Limitations"></a>Shared Cluster Limitations</span></strong></p>

<p>For external customers running in shared clusters, we <strong>do not</strong> offer the ability to configure fault domains.</p>

<p>You will need to check with internal customers if they are on a shared or dedicated cluster. If they aren&rsquo;t sure, deny the <span>FD</span><span>&nbsp;</span> quota increase.</p>

<p><strong><span><a id="Shared Cluster FD Quota Increase Process (Internal Only)" name="Shared Cluster FD Quota Increase Process (Internal Only)"></a>Shared Cluster FD Quota Increase Process (Internal Only)</span><span><span> </span></span></strong></p>

<p>Get subscription details for the subscription from Jarvis.</p>

<p>Check &quot;MaximumAllowedNumberOfFaultDomains&quot; count.</p>

<ul>
	<li>
	<p><span><span><span><span><span>AzureRT/Subscription Management/Get Subscription </span>With Details </span></span></span></span></p>

	<ul>
		<li>
		<p><span><span><span><span><span><span>Subscription: &lt;GUID&gt;</span></span></span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span>Detail Level: Full</span></span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span><span>Output: MaximumAllowedNumberOfFaultDomains<em> </em>&lt;count&gt;</span></span></span></span></span></span></p>
		</li>
	</ul>
	</li>
</ul>

<p>Shared FD quota requests up to 5 are auto-approved, but require an FYI email to <span><a href="mailto:FcFdApprove@microsoft.com">FcFdApprove@microsoft.com</a> </span>containing the following information:</p>

<ul>
	<li><span><span><span>Subscription/tenant details</span></span></span></li>
	<li><span><span><span><span>Which team is this for? </span></span></span></span>
	<ul>
		<li><span><span><span><span>(SQL Azure, SQL Reporting services, SQL Data Services, Blackbird, etc.)</span></span></span></span></li>
	</ul>
	</li>
	<li><span><span><span><span>Is this for the team&rsquo;s production <span>or internal test environment?</span></span></span></span></span></li>
	<li><span><span><span><span>Is this for one of the <span>DDC</span><span>&nbsp;</span> clusters dedicated to SQL Azure?</span></span></span></span></li>
</ul>

<p>Shared FD requests greater than 5 require approval from <span><a href="mailto:FcFdApprove@microsoft.com">FcFdApprove@microsoft.com</a> </span>and should include the same four pieces of information as the FYI email in the point above.</p>

<p>If approved, <span>perform</span> the quota change operation:</p>

<ul>
	<li><span><span><span><span><span>AzureRT/Subscription Management/Upda</span>te Subscription Settings</span></span></span></span>

	<ul>
		<li><span><span><span><span>Subscription: &lt;GUID&gt;</span></span></span></span></li>
		<li><span><span><span><span>Settings: MaximumAllowedNumberOfFaultDomains: &lt;Count&gt;</span></span></span></span></li>
	</ul>
	</li>
</ul>

<p>Once completed, you should send this note to the requesting internal team:</p>

<blockquote>
<p><span>Fault domains define the requirements for the distribution across physical racks in a given cluster, which contains a set of 20 racks of machines. The layout of a set of instances for an application across the physical racks creates allocation constraints that becoming increasingly difficult to maintain as more customers and different size deployments and VMs deploy in a single cluster. Consequently, to reduce allocation limitations that may be caused by requiring a large amount of physical distribution, we must restrict the fault domain count in production clusters that are shared with other deployments. This allocation constraint not only may impact the initial layout of the application resulting in initial allocation failures but also creates ongoing constraints as hardware fails throughout the cluster, resulting in spurious failures while running the application.</span></p>
</blockquote>

<p><strong><span><a id="Dedicated Cluster FD Quota Increase Process" name="Dedicated Cluster FD Quota Increase Process"></a>Dedicated Cluster FD Quota Increase Process</span></strong></p>

<p><span>Dedicated FD quota requests up to 5 are auto-approved, but require an FYI email to </span><span><a href="mailto:FcFdApprove@microsoft.com">FcFdApprove@microsoft.com</a> </span>containing the following information:</p>

<ul>
	<li><span><span><span><span>Subscription/tenant details</span></span></span></span></li>
	<li><span><span><span><span>Which team is this for? </span></span></span></span>
	<ul>
		<li><span><span><span><span><span>(SQL Azure, SQL Reporting services, SQL Data Services, Blackbird, etc)</span><span> </span></span></span></span></span></li>
	</ul>
	</li>
	<li><span><span><span><span>Is this for the team&rsquo;s production <span>or internal test environment?</span></span></span></span></span></li>
	<li><span><span><span><span>Is this for one of the DDC clusters dedicated to SQL Azure?</span></span></span></span></li>
</ul>

<p>Dedicated FD requests greater than 5 require approval from <span><a href="mailto:FcFdApprove@microsoft.com">FcFdApprove@microsoft.com</a> </span>and should include the same four pieces of information as the FYI email in the point above.</p>

<p>Once you have approval, follow the steps noted to change the quota in Jarvis.</p>

<p><br>
Use the <strong>Get Subscription with D<span>etails</span></strong> function to review the existing subscription.</p>

<p>Check DisablePackageValidation:</p>

<ul>
	<li>
	<p><span><span><span><span>AzureRT/Subscription Management/Get Subscription with Details</span></span></span></span></p>

	<ul>
		<li>
		<p><span><span><span><span><span><span>Subscription: &lt;GUID&gt;</span></span></span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span><span>Detail Level: Full</span></span></span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span><span>Output: DisablePackageValidation <strong>(True or False)</strong></span></span></span></span></span></span></p>
		</li>
	</ul>
	</li>
</ul>

<p><span><span><span><span><span><strong>If True: </strong></span></span></span></span></span></p>

<ul>
	<li>
	<p><span><span><span><span>AzureRT/Subscription Management/Update Subscription Settings</span></span></span></span></p>

	<ul>
		<li>
		<p><span><span><span><span><span><span>Subscription: &lt;GUID&gt;</span></span></span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span><span>Settings: MaximumAllowedNumberOfFaultDomains: &lt;Count&gt;</span></span></span></span></span></span></p>
		</li>
	</ul>
	</li>
</ul>

<p><span><span><span><span><span><strong>If False:</strong></span></span></span></span></span></p>

<ul>
	<li>
	<p><span><span><span><span>AzureRT/Subscription Management/Update Subscription Settings</span></span></span></span></p>

	<ul>
		<li>
		<p><span><span><span><span><span><span>Subscription: &lt;GUID&gt;</span></span></span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span><span>Settings: <span>DisablePackageValidation:True,MaximumAllowedNumberOfFaultDomains: &lt;Count&gt;</span></span></span></span></span></span></span></p>
		</li>
	</ul>
	</li>
</ul>

<h4><strong><span><a id="Increase HD Insight Quota (Default is 25 Cores, No Max)" name="Increase HD Insight Quota (Default is 25 Cores, No Max)"></a>Check HD Insight Quota&nbsp;</span></strong></h4>

<p>Follow the steps in <a data-content-id="" data-content-type="" href="https://internal.support.services.microsoft.com/en-US/help/2834676" managed-link="" target="_blank">TSG 2834676</a> to have the HD Insights quota increased by the respective Capacity Mangement team.</p>

<p>If you&nbsp;or the customer are unsure how much quota is needed or already exists, leverage the guidance below to obtain the information from Jarvis.&nbsp;</p>

<ul>
	<li>
	<p><span><span><strong><span><span><strong>Calculate the quota increase needed in number of cores.&nbsp;</strong></span></span></strong></span></span><span>If the customer specifies the quota increase in terms of the number of HDInsight </span><em>Nodes</em><span> they need, then you must do a simple calculation to convert nodes to cores.</span></p>

	<ul style="list-style-type:circle">
		<li><span><span><span>For A3, A6, and D3:</span></span></span> Cores = (Nodes * 4) + 8</li>
		<li><span><span><span>For A4, A7, A8, D4, and D13:</span></span></span> Cores = (Nodes * 8) + 16</li>
		<li><span><span><span>For A9 and D14:</span></span></span> Cores = (Nodes * 16) + 32</li>
	</ul>
	</li>
	<li>
	<p><span><span><strong><span><strong>Determine existing quota.</strong></span></strong></span></span></p>

	<ul style="list-style-type:circle">
		<li><span><span><span><span>HDInsight/Subscription Management/Get User Consumption Metadata (RDFE + ARM)</span></span></span></span>

		<ul>
			<li><span><span><span><span>Subscription ID: &lt;GUID&gt;</span></span></span></span></li>
		</ul>
		</li>
	</ul>
	</li>
</ul>

<p><span><span><a href="https://azure.microsoft.com/en-us/pricing/details/hdinsight/">HD Insight Customer-facing documentation and pricing</a></span></span></p>

<h4><strong><span><a id="Increase Network Security Groups (NSG)/Rules per NSG/Routes per Table (Classic/RDFE Only)" name="Increase Network Security Groups (NSG)/Rules per NSG/Routes per Table (Classic/RDFE Only)"></a>Increase Network Security Groups (NSG)/Rules per NSG/Routes per Table (Classic/RDFE Only)</span></strong></h4>

<p><span>These operations set&nbsp;</span>the maximum values for the respective parameters, so be sure you are entering the new total, not the increase, as requested by the customer.</p>

<ul>
	<li><span><span><span><span>RDFE/Network Management/Update Max Network Security Groups</span></span></span></span></li>
	<li><span><span><span><span>RDFE/Network Management/Update Max Network Security Rules Per Group</span></span></span></span></li>
	<li><span><span><span><span>RDFE/Network Management/Update Max Routes Per Table</span></span></span></span>
	<ul>
		<li><span><span><span><span>Subscription: &lt;GUID&gt;</span></span></span></span></li>
		<li><span><span><span><span>Max: &lt;number of requested NSG&#39;s/rules per NSG/Routes per table&gt;</span></span></span></span></li>
		<li><span><span><span><span>Output: Success</span></span></span></span></li>
	</ul>
	</li>
</ul>

<h4><strong><a id="Increase Network Resource Provider (NRP) (ARM/V2 Only)" name="Increase Network Resource Provider (NRP) (ARM/V2 Only)"></a>Increase Network Resource Provider (NRP) (ARM/V2 Only)</strong></h4>

<p><strong>Note</strong>: For quota limit increases, EA Dev/Test (148p) subscriptions should be treated as EA subscriptions.</p>

<p>Follow the process provided by the Networking team:&nbsp;<span><a href="https://aka.ms/NetworkLimits">https://aka.ms/NetworkLimits</a>.</span></p>

<p>This will cover:</p>

<ul>
	<li><span><span><span><span><span>VNets</span> Per Subscription</span></span></span></span></li>
	<li><span><span><span><span>Max VNetpeering Per Subscription</span></span></span></span></li>
	<li><span><span><span><span><span>DNS </span>Servers Per VNet</span></span></span></span></li>
	<li><span><span><span><span><span>NICs</span> Per Subscription</span></span></span></span></li>
	<li><span><span><span><span>Load Balancers Per Subscription</span></span></span></span></li>
	<li><span><span><span><span>Security Groups Per Subscription</span></span></span></span></li>
	<li><span><span><span><span>Security Rules Per Security Group</span></span></span></span></li>
	<li><span><span><span><span>Inbound <span>NAT</span><span>&nbsp;</span>Or <span>LB</span> Rules Per Load Balancer</span></span></span></span></li>
	<li><span><span><span><span>Route Tables Per Subscription</span></span></span></span></li>
	<li><span><span><span><span>Routes Per Route Table</span></span></span></span></li>
	<li><span><span><span><span>Frontend <span>IPs </span>Per Load Balancer</span></span></span></span></li>
	<li><span><span><span><span>Outbound NAT Rules Per Load Balancer</span></span></span></span></li>
	<li><span><span><span><span>Max Local Network Site Count</span></span></span></span></li>
	<li><span><span><span><span>Application Gateways Per Subscription</span></span></span></span></li>
	<li><span><span><span><span>Max Static Public IPs Per Subscription*</span></span></span></span></li>
	<li><span><span><span><span>Max Public IPs Per Subscription*</span></span></span></span></li>
	<li>Public IP Prefix</li>
</ul>

<p><strong>*Note:</strong><span> U</span>ser must have a network resource in the region for which they are requesting IP&#39;s, or <span>this process</span><span>&nbsp;</span> will fail. They can either create a network resource from the portal, or if they know how to use PowerShell, they can run this command:</p>

<ul>
	<li>
	<p><span><span><span><span>Select-azurermsubscription &ndash;subscriptionid &lt;GUID&gt;</span></span></span></span></p>
	</li>
	<li>
	<p><span><span><span><span><span>Register-AzureRmResourceProvider -ProviderNamespace Microsoft.Network</span></span></span></span></span></p>
	</li>
</ul>

<h4><strong><a id="Increase NRP Quotas" name="Increase NRP Quotas"></a>Increase NRP Quotas</strong></h4>

<ul>
	<li><span><span><span><span>NRP/NRP Quota Operations/Set NRP Subscription Quota</span></span></span></span>

	<ul>
		<li><span><span><span><span>Subscription: &lt;GUID&gt;</span></span></span></span></li>
		<li><span><span><span><span>NRP Region: &lt;Select the region.&gt;</span></span></span></span></li>
		<li><span><span><span><span>NRP Resource Type: &lt;Select resource to increase.&gt;</span></span></span></span></li>
		<li><span><span><span><span>NRP Resource Max Value: &lt;Number of requested NRP&#39;s&gt;</span></span></span></span></li>
		<li><span><span><span><span>Output: Success</span></span></span></span></li>
	</ul>
	</li>
</ul>

<h4><strong><a id="Increase Network Security Group/Rules per Network Security Group/Routes per Route Table Quotas for ARM Resource" name="Increase Network Security Group/Rules per Network Security Group/Routes per Route Table Quotas for ARM Resource"></a>Increase Network Security Group/Rules per Network Security Group/Routes per Route Table Quotas for <span>ARM </span>Resource</strong></h4>

<ul>
	<li><span><span><span>NRP/NRP quota Operation/Set NRP Subscription Quota </span></span></span>

	<ul style="list-style-type:circle">
		<li><span><span><span>Select the correct region and under NRP Resource type</span></span></span></li>
		<li><span><span><span>Select option - MaxSecurityGroupsPerSubscription</span></span></span></li>
	</ul>
	</li>
</ul>

<h4><strong><a id="Check the Existing Quota of Network Security Group" name="Check the Existing Quota of Network Security Group"></a>Check the Existing Quota of Network Security Group (ARM Only)</strong></h4>

<ul>
	<li><span><span><span>NRP/NRP quota Operation/Get NRP Subscription Quota Details</span></span></span>

	<ul style="list-style-type:circle">
		<li><span><span><span>Select the NRP region</span></span></span></li>
	</ul>
	</li>
</ul>

<h4><strong><a id="Increase Quota for Reserved IP or Instance Level Public IP (RDFE Only)" name="Increase Quota for Reserved IP or Instance Level Public IP (RDFE Only)"></a>Increase Quota for Reserved IP or Instance Level Public IP (RDFE Only)</strong></h4>

<p>Follow the process created by the Networking team, which can be found in Section II of the following page:&nbsp;http://aka.ms/networklimits</p>

<h4><strong><a id="Increase Quota for Reserved IP or Instance Level Public IP (ARM Only)" name="Increase Quota for Reserved IP or Instance Level Public IP (ARM Only)"></a>Increase Quota for Reserved IP or Instance Level Public IP (ARM Only)</strong></h4>

<p><span><span>Follow the process provided by the Networking team: </span><a href="https://aka.ms/NetworkLimits">https://aka.ms/NetworkLimits</a>.</span></p>

<h4><strong><a id="Increase Virtual Networks" name="Increase Virtual Networks"></a>Increase Virtual Networks </strong></h4>

<p><strong>Note:</strong> <span>Local network sites per subscription (<strong>MaxLocalNetworkSites</strong>)</span> are for Classic (ASM) and&nbsp; (<span><strong>LocalNetworkGateways</strong>)</span> is for ARM. There is NO quota limit on Local Network Gateways (ARM).</p>

<p>The Max Virtual Network Sites, Max Local Network Sites and Max DNS Servers all need to be changed at the same time and all need to have the same value.</p>

<ul>
	<li><span><span><span><span>AzureRT/Subscription Management/Update Subscription Settings</span></span></span></span>

	<ul>
		<li><span><span><span><span>Subscription: &lt;GUID&gt;</span></span></span></span></li>
		<li><span><span><span><span>Settings:</span></span></span></span>
		<ul>
			<li><span><span><span><span>MaxVirtualNetworkSites: &lt;Num&gt;</span></span></span></span></li>
			<li><span><span><span><span>MaxLocalNetworkSites: &lt;Num&gt;</span></span></span></span></li>
			<li><span><span><span><span>MaxDnsServers: &lt;Num&gt;</span></span></span></span></li>
		</ul>
		</li>
	</ul>
	</li>
</ul>

<h4><span><strong><a id="Enable AutoPilotBackendVnetConnectivity for Connecting the Autopilot and Azure Environments (Internal Only, No Approval Required)" name="Enable AutoPilotBackendVnetConnectivity for Connecting the Autopilot and Azure Environments (Internal Only, No Approval Required)"></a>Enable AutoPilotBackendVnetConnectivity for Connecting the Autopilot and Azure Environments (Internal Only, No Approval Required)</strong></span></h4>

<p><span>Use this example created by the Networking team: </span><a href="http://vstfrd:8080/Azure/RD/_workitems#_a=edit&amp;id=3489152">http://vstfrd:8080/Azure/RD/_workitems#_a=edit&amp;id=3489152</a></p>

<h4><strong><a id="Enable Preview Features" name="Enable Preview Features"></a>Enable Preview Features</strong></h4>

<p>Most of the time, a user can enable the preview feature on their own. Sometimes that action fails, and the user may need further assistance.</p>

<p>T<span>here are no preview features that you can enable for the customer directly. </span><span>&nbsp;</span>If you have a user that wants to be part of a preview or has already made the request but is presently pending (or queued), you can email <a href="mailto: ASMSCM@microsoft.com" managed-link="" target="_blank">Change Management</a>&nbsp;and we will connect you with the specific <span>Product Group (PG) </span>&nbsp;that can get the user added or enabled as soon as possible.</p>

<h4><strong><a id="Enable Scale Received" name="Enable Scale Received"></a>Enable Scale Received </strong></h4>

<p>Check if the subscription already has Scale Received:</p>

<ul>
	<li><span><span><span><span>ServiceBus/Service Bus Subscription Operations/Get Subscription Info</span></span></span></span>

	<ul>
		<li><span><span><span><span>Subscription: &lt;GUID&gt;</span></span></span></span></li>
		<li><span><span><span><span>Output: If the output shows Premium, the user has Scale Received enabled already.</span></span></span></span></li>
	</ul>
	</li>
</ul>

<p>If they don&rsquo;t have Enable Scale Received:</p>

<ul>
	<li>
	<p><span><span><span>Get approval from the SB product team through the <a href="https://icm.ad.msft.net/imp/NewIncident.aspx" target="_blank">ICM Template</a>.</span></span></span></p>
	</li>
	<li><span><span><span><span>ServiceBus/Service Bus Subscription Operations/Set White Listed Subscription</span></span></span></span>
	<ul>
		<li><span><span><span><span>Subscription: &lt;GUID&gt;</span></span></span></span></li>
		<li><span><span><span><span>Output: Premium</span></span></span></span></li>
	</ul>
	</li>
</ul>

<h4><strong><span><a id="Change CanUseVirtualNetworkID to ‘false’" name="Change CanUseVirtualNetworkID to ‘false’"></a>Change CanUseVirtualNetworkID to &#39;false&#39;</span></strong></h4>
<strong>Note:</strong> CanUseVirtualNetworkId is for internal Microsoft subscriptions only.

<p>If an internal customer contacts you with this request, you can proceed with the request without seeking additional approval for the operation.</p>

<p>No external customer should have CanUseVirtualNetworkId set to &lsquo;true&rsquo; and in such cases, the flag should be set to false immediately.</p>

<ul>
	<li>
	<p><span><span><span><span>[AzureRT/Subscription Management/Update Subscription Settings</span></span></span></span></p>

	<ul>
		<li>
		<p><span><span><span><span>Subscription: &lt;GUID&gt;</span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span>Setting: CanUseVirtualNetworkId:False</span></span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span>Approver: &lt;Approver, Reviewer&gt;</span></span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span>Approver Link: &lt;<span asset="4497459" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4497459]</span>case number&gt;</span></span></span></span></span></p>
		</li>
	</ul>
	</li>
</ul>

<h4><strong><a id="Change Default Data Centers" name="Change Default Data Centers"></a>Change Default Data Centers </strong></h4>

<p>When a user gets a new subscription, it may be limited to a specific set of Data Centers (DCs) as some DCs may be capped for deployments and removed from the list of available DCs. When doing a subscription swap, you may need to change the default deployable DCs to allow the subscription you are swapping to keep all the data and features in the original DC it started in.</p>

<ul>
	<li><span><span><span><span>RDFE/Subscription Management/Update Subscription Settings</span></span></span></span>

	<ul>
		<li><span><span><span><span>Subscription: &lt;Sub GUID&gt;</span></span></span></span></li>
		<li><span><span><span><span>Settings: OfferType: &lt;Dependent upon needed DC.&gt;</span></span></span></span>
		<ul>
			<li><span><span><span><span>For North Central US use <strong>wa2012</strong>.</span></span></span></span></li>
			<li><span><span><span><span>For South Central US or both North and South Central US use <strong>CTP</strong>.</span></span></span></span></li>
			<li><span><span><span><span>For all GFS Backend users, use <strong>GFSHostedServicesUser </strong>(No longer used, you may get requests to exit GFHhostedservicesuser, if so, change to <strong>CTP</strong>.)</span></span></span></span></li>
			<li><span><span><span><span>For internal users wanting access to the AUDCs (For Internal users ONLY) email the azureausdcesc distribution list.</span></span></span></span></li>
			<li><span><span><span><span>INDCs (EA only) - Email the azureinddcesc distribution list.</span></span></span></span></li>
			<li><span><span>For other DCs that have been blocked, you will need to engage WACAP for approval and for the code to use to open those centers.</span></span></li>
		</ul>
		</li>
	</ul>
	</li>
</ul>

<h4><span><strong><a id="Find Disable and Enable Operations for a Subscription" name="Find Disable and Enable Operations for a Subscription"></a>Find Disable and Enable Operations for a Subscription</strong></span></h4>

<ul>
	<li>
	<p><span><span><span><span>Billing/General Management/From Azure Subscription Get Subscription Revisions (TSQ) </span></span></span></span></p>

	<ul>
		<li>
		<p><span><span><span>Subscription: &lt;GUID&gt;</span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span>From Date: &lt;MM/DD/YYYY&gt;</span></span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span>To Date: &lt;MM/DD/YYYY&gt;</span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span>Detail Level Parameter: Detailed</span></span></span></span></span></p>
		</li>
	</ul>
	</li>
	<li>
	<p><span><span><span>Search in the output for the following terms:</span></span></span></p>

	<ul>
		<li>
		<p><span><span><span>MonetaryCapReachedDecision</span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span>NewState: Disabled</span></span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span>SuspensionReason: CapReached</span></span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span>EnableAndResyncSubscriptionDecision</span></span></span></span></span></p>
		</li>
		<li>
		<p><span><span><span><span><span>NewState: Active</span></span></span></span></span></p>
		</li>
	</ul>
	</li>
</ul>

<p><strong>Note:</strong> You may find it easiest to copy and paste the results into a text editor and use the search function. The following screenshots show keywords and patterns (outlined in red) that may help you find specific events.</p>

<p><strong>Deactivation by monetary cap reached:</strong></p>

<div>
<div>
<div id="_com_1" language="JavaScript"><span asset="4103593" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4103593]</span></div>
</div>
</div>

<p><strong>Reactivation recorded less than 2 hours later:</strong></p>

<div><span asset="4103595" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4103595]</span></div>

<p><strong>L<span>isting for SubscriptionRevision still shows subscription in Disabled state, but &quot;LastModifiedDate&quot; is still before the revision time when the enable operation started:</span></strong></p>

<div>
<div>
<div id="_com_1" language="JavaScript">&nbsp;</div>
</div>
</div>

<p>&nbsp;<span asset="4103598" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4103598]</span></p>

<p><span><strong>Further down, subscription status is updated to active and LastModified date changed to time of revision above:</strong></span></p>

<p>&nbsp;<span asset="4103599" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4103599]</span></p>

<p>&nbsp;<strong>&nbsp;New Disablement:</strong></p>

<p><span asset="4103613" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4103613]</span></p>

<p><strong>Re-enablement:</strong></p>

<p><span asset="4103612" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4103612]</span></p>

<p><span><strong>Confirmation subscription active:</strong></span></p>

<div>
<div>
<div id="_com_1" language="JavaScript">
<p>&nbsp;<span asset="4103616" contenteditable="false" props="{&quot;size&quot;:&quot;full&quot;}" unselectable="on">[Asset 4103616]</span></p>
</div>
</div>
</div>

<h4><strong><span><a id="Find Email ID from PUID" name="Find Email ID from PUID"></a>Find Email ID from PUID</span></strong></h4>

<p>MSODS &gt; Lookup Operations &gt; From PUID Get AAD UPN<br>
<br>
Tenant is required.</p>

<div>
<div id="_com_1" language="JavaScript">
<h4><strong><a id="Perform Billing Validation" name="Perform Billing Validation"></a>Perform Billing Validation</strong></h4>

<p>Most service and metering data is available in Jarvis. If the service or meter you need to validate is not listed, you can open a TFS ticket with <a href="http://aka.ms/asecri" target="_blank">ASE</a> for billing validation of that service.</p>

<p>To retrieve billing information:</p>

<ul>
	<li><span><span><span><span>Billing/MINT Management/From Azure Subscription Get Usage Info</span></span></span></span>

	<ul>
		<li><span><span><span><span>P<span>UID:</span></span></span></span></span></li>
		<li><span><span><span><span>Subscription ID: &lt;Sub GUID&gt;</span></span></span></span></li>
		<li><span><span><span><span>From Billing Period ID <span>&lt;See Note below.*&gt;</span></span></span></span></span></li>
		<li><span><span><span><span>Detail Level Parameter: Detailed</span></span></span></span></li>
		<li><span><span><span><span>Use the Excel link to download the file to compare usage.</span></span></span></span></li>
	</ul>
	</li>
</ul>

<p><strong>*Note:</strong> To get the &ldquo;Billing Period ID,&rdquo; you can use the following operation:</p>

<ul>
	<li>
	<p><span><span><span><span>Billing/MINT Management/From Azure Subscription Get Billing Periods</span></span></span></span></p>
	</li>
</ul>

<h4><strong><a id="Perform Subscription Swap (Data Migration)" name="Perform Subscription Swap (Data Migration)"></a>Perform Subscription Swap (Data Migration)</strong></h4>

<p><span>D</span>ata Migration has several limitations that must be followed, please follow the process exactly. Instructions can be found within the TSGs for <a href="https://internal.support.services.microsoft.com/en-us/help/2856526/asms---account-portal-account-subs-migration-simple-data-migration">simple migration</a> and <a href="https://internal.support.services.microsoft.com/en-us/help/2892044/AZURESMSAccountPortalSubSubscriptionMigrationForcedMigration">forced migration</a>.</p>

<h4><strong><a id="List RBAC Roles (TA Only)" name="List RBAC Roles (TA Only)"></a>List RBAC Roles (TA Only)</strong></h4>

<p>This operation will list out role-based access control&nbsp;(RBAC) roles for a subscription.<br>
Due to the sensitive nature of the data involved, this operation can only be carried out by a TA. JIT requests to use this command by non-TAs will not be approved.</p>

<p><strong>To access this operation:</strong><br>
<strong>AAD Developer Acceleration</strong> &gt; <strong>PAS Management Workflows</strong> &gt; <strong>Get Role Assignments With Extended Info</strong></p>

<ul>
	<li>Tenant ID: <em>&lt;Tenant ID the subscription is currently in.&gt;</em></li>
	<li>Subscription ID: <em>&lt;Subscription ID&gt;</em></li>
	<li>Display Results Format: Short/InDetail</li>
</ul>

<p><strong>For JIT access (TA Only):</strong></p>

<ul>
	<li><span lang="EN-IN"></span><span lang="EN-IN"><span>ResourceType: ACIS</span></span></li>
	<li><span lang="EN-IN"></span><span lang="EN-IN"><span>Scope: AADDA</span></span></li>
	<li><span lang="EN-IN"></span><span lang="EN-IN"><span>Access Level: CustomerServiceViewer</span></span></li>
</ul>

<p><strong>Output:</strong></p>

<ul>
	<li>This command outputs a zip file. Extract the contents&nbsp;and open the file&nbsp;<strong>RoleAssignmentsWithExtendedInfo.json&nbsp;</strong>with Notepad or Visual Studio.</li>
</ul>

<p><strong>Notes on this command:</strong></p>

<ul>
	<li><span><span>The output&nbsp;lists RBAC roles in the scopes of <strong>subscription</strong>, <strong>resource groups</strong> and <strong>resources</strong>.</span></span></li>
	<li><span><span>The output&nbsp;lists built-in roles as well as custom roles (if any).</span></span></li>
	<li><span><span>Roles that are inherited from resource groups or subscriptions are not listed. Only explicitly given roles are listed.</span></span></li>
	<li><span><span>The roles given to both users and groups are listed.</span></span></li>
	<li><span><span>If the output&nbsp;lists a role but the <strong>&ldquo;Mail:&rdquo;</strong> field shows as <strong>NULL</strong> (and does not show an&nbsp;email address), you can use the Principal ID of that object to query the email address (or PUID). You would use this&nbsp;operation: <strong>Azure Resource Manager &gt; User Management &gt; Get user details from principal id</strong>. This is not applicable for groups.</span></span></li>
	<li><span><span>In the <strong><em>InDetail</em></strong> version of the results, you can&nbsp;also see when the object was added and updated with the RBAC role. You would again see only the Principal IDs and could use the earlier operation to look up the actual email address (or PUID).</span></span></li>
</ul>

<h3><strong><a id="Online References" name="Online References"></a>Online References</strong></h3>

<p>The following links are provided as additional resources:</p>

<ul>
	<li>
	<p><span><a href="https://azure.microsoft.com/en-us/documentation/articles/resource-manager-deployment-model/"><span><span><span>Understanding Resource Manager deployment and classic deployment</span></span></span></a></span></p>
	</li>
</ul>

<h3><span><strong>Engagement and Escalation Path </strong></span></h3>

<p>Create support requests using <a href="https://aka.ms/GenevaSupport" managed-link="" target="_blank">Geneva Actions Support</a>.</p>

<h4>&nbsp;</h4>

<h4><strong>TSG Change Log</strong></h4>

<div>
<table class="table">
	<tbody>
		<tr>
			<td>
			<p><strong><span>Date </span></strong></p>
			</td>
			<td>
			<p><strong><span>Updated By</span></strong></p>
			</td>
			<td>
			<p><strong><span>Content Updated</span></strong></p>
			</td>
		</tr>
		<tr>
			<td>02/01/2018</td>
			<td>mievan</td>
			<td>Added steps on how to increase HD Insight Quota</td>
		</tr>
		<tr>
			<td>02/14/2018</td>
			<td>kuharr</td>
			<td>Updated JiT request for HD Insight.</td>
		</tr>
		<tr>
			<td>02/27/2018</td>
			<td>v-adhigg</td>
			<td>
			<p>Added the Online References section.<br>
			Added Support Scenario - How to Check the Quota of an ARM Subscription in Jarvis.<br>
			Added clarifying screenshots to the Increase HD Insight Quota section.</p>
			</td>
		</tr>
		<tr>
			<td>06/15/2018</td>
			<td>v-adhigg</td>
			<td>Updated this article as part of Modtrack 1436. This update added the&nbsp;<em>List RBAC Roles (TA Only)</em><strong>&nbsp;</strong>scenario to this TSG.</td>
		</tr>
		<tr>
			<td>08/14/2018</td>
			<td>v-brgosn</td>
			<td>Added information from ModTrack 1497 regarding No Quota Limit on LocalNetworkGateway (ARM).</td>
		</tr>
		<tr>
			<td>09/20/2018</td>
			<td>v-adhigg</td>
			<td>Corrected the information in the&nbsp;<em>Increase Network Security Group/Rules per Network Security Group/Routes per Route Table Quotas for&nbsp;ARM&nbsp;Resource </em><span>section.</span></td>
		</tr>
		<tr>
			<td>12/12/2018</td>
			<td>v-adhigg</td>
			<td>Added <em>DC Series</em>&nbsp;to the&nbsp;<em>RDQuotaSKU</em> table.</td>
		</tr>
		<tr>
			<td>12/20/2018</td>
			<td>mievan</td>
			<td>Updated HD Insight section to point back to TSG&nbsp;2834676&nbsp;and&nbsp; updated contnet to only provide&nbsp; steps on how to check HDI quota, not increase it.&nbsp;</td>
		</tr>
		<tr>
			<td>03/06/2019</td>
			<td>v-ajbur</td>
			<td>Added information for guidance to increase DDOS plan quota.</td>
		</tr>
		<tr>
			<td>04/08/2019</td>
			<td>kuharr</td>
			<td>Added Public IP Prefix for NRP quota.</td>
		</tr>
		<tr>
			<td>06/24/2019</td>
			<td>v-brgosn</td>
			<td>Added Note regarding ASMS allowed Jarvis action.</td>
		</tr>
		<tr>
			<td>01/23/2020</td>
			<td>v-katzma</td>
			<td>Updated Find Email ID from PUID scenario per <a href="https://sharepoint/sites/fastrack/Lists/ModTrack/DispForm.aspx?ID=2618&amp;e=7mkt1K" managed-link="" target="_blank">ModTrack 2618</a></td>
		</tr>
		<tr>
			<td>02/19/2020</td>
			<td>kuharr</td>
			<td>Updated NRP OD doc&nbsp;</td>
		</tr>
		<tr>
			<td>02/27/2020</td>
			<td>v-katzma</td>
			<td>Updated Engagement and Escalation Path section per ModTrack 2698.</td>
		</tr>
		<tr>
			<td>03/18/2020</td>
			<td>v-ishan</td>
			<td>Added note under Increase Network Resource Provider as per ModTrack 2740.</td>
		</tr>
		<tr>
			<td>03/27/2020</td>
			<td>v-ishan</td>
			<td>Updated link in Increase Quota section as per ModTrack 2764.</td>
		</tr>
		<tr>
			<td>04/14/2020</td>
			<td>mievan</td>
			<td>NRP process link updated to reflect new limits. &nbsp;</td>
		</tr>
	</tbody>
</table>
</div>
</div>
</div>
</div>

<p>&nbsp;</p>
