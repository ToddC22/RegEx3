<header><h1>A Certificate Request That Uses a New Template Is Unsuccessful</h1></header><div class='kb-notice-section section'><span><span class='text-base'>IMPORTANT</span>: This article contains information about modifying the registry. Before you modify the registry, make sure to back it up and make sure that you understand how to restore the registry if a problem occurs. For information about how to back up, restore, and edit the registry, click the following article number to view the article in the Microsoft Knowledge Base: <div class='indent'><a id='kb-link-1' href='/EN-US/help/256986'>256986 </a> Description of the Microsoft Windows Registry<br></div></span></div><div class='kb-symptoms-section section'> When you try to enroll for a certificate against an enterprise certification authority (CA), you may receive one of the following error messages:<br><br> Web enrollment:<div class='sbody-error'> Certificate Request Denied<br><br> Your certificate request was denied.<br><br> Contact your administrator for further information. </div><br> Certificate Request Wizard: <div class='sbody-error'> The certification authority denied your request. Unspecified error. </div></div><div class='kb-cause-section section'> This behavior may occur if the certificate enrollment request is using a recently-created certificate template. When a new template is added to the CA, the <strong class='sbody-strong'>HKEY_CURRENT_USER</strong> cache is immediately updated but the <strong class='sbody-strong'>HKEY_LOCAL_MACHINE</strong> cache is not immediately updated. The <strong class='sbody-strong'>HKEY_LOCAL_ MACHINE</strong> cache is updated in the next 15 minutes if the CA or the domain controller are on the same computer, and in the next 10 minutes if the CA or the domain controller are in a distributed configuration.<br> </div><div class='kb-resolution-section section'><span><span class='text-base'>WARNING</span>: If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.<br></span><br> To resolve this behavior, if you cannot wait for the applicable length of time, you can manually update the certificate template cache. The cache for computer certificates is in<br> <strong class='sbody-strong'>HKEY_LOCAL_MACHINE</strong> and the cache for user certificates is in <strong class='sbody-strong'>HKEY_CURRENT_USER</strong>. <br> <ul class='sbody-free_list'><li>To force the cache update for a user certificate request, delete the following registry value from the client:<div class='indent'><strong class='sbody-strong'>HKEY_CURRENT_USER\Software\Microsoft\Cryptography\CertificateTemplateCache\Timestamp</strong></div></li></ul>To force the cache update for a computer certificate request: <br> <ol class='sbody-num_list'><li>Delete the following registry value from the client:<div class='indent'><strong class='sbody-strong'>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography\CertificateTemplateCache\Timestamp</strong></div></li><li>Delete the following registry value from the CA:<div class='indent'><strong class='sbody-strong'>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography\CertificateTemplateCache\Timestamp</strong></div></li><li>Restart the Certificate Services on the CA.</li></ol></div><div class='kb-moreinformation-section section'> In addition to the preceding error message, the CA logs the following event message in the program log:<br> </div><div class='kb-textlegacy-section section'>Author: slight (2000-12-01T07:40:00) Edit Reviewer: V-NIKHI (2001-03-22T16:04:00) Tech Reviewer: SHETZEL (2001-02-21T09:17:00)<br> </div>